# Comparing `tmp/aistudio_sdk-0.2.3-py3-none-any.whl.zip` & `tmp/aistudio_sdk-0.2.4-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,25 +1,25 @@
-Zip file size: 27542 bytes, number of entries: 23
--rw-r--r--  2.0 unx      534 b- defN 24-Mar-26 11:53 aistudio_sdk/__init__.py
--rw-r--r--  2.0 unx     4896 b- defN 24-Apr-09 06:54 aistudio_sdk/cmdline.py
--rw-r--r--  2.0 unx     1389 b- defN 24-Apr-16 12:50 aistudio_sdk/config.py
--rw-r--r--  2.0 unx    25057 b- defN 24-Apr-18 07:28 aistudio_sdk/hub.py
--rw-r--r--  2.0 unx     1898 b- defN 24-Mar-27 05:51 aistudio_sdk/log.py
--rw-r--r--  2.0 unx        0 b- defN 24-Feb-02 08:07 aistudio_sdk/constant/__init__.py
--rw-r--r--  2.0 unx      626 b- defN 24-Mar-27 05:41 aistudio_sdk/constant/const.py
--rw-r--r--  2.0 unx     2388 b- defN 24-Apr-16 12:39 aistudio_sdk/constant/err_code.py
--rw-r--r--  2.0 unx      387 b- defN 24-Apr-18 07:28 aistudio_sdk/constant/version.py
--rw-r--r--  2.0 unx        0 b- defN 24-Feb-02 08:07 aistudio_sdk/requests/__init__.py
--rw-r--r--  2.0 unx    16394 b- defN 24-Apr-16 12:36 aistudio_sdk/requests/hub.py
--rw-r--r--  2.0 unx     5201 b- defN 24-Apr-08 09:04 aistudio_sdk/requests/pipeline.py
--rw-r--r--  2.0 unx        0 b- defN 24-Mar-02 07:06 aistudio_sdk/sdk/__init__.py
--rw-r--r--  2.0 unx    12521 b- defN 24-Mar-28 07:00 aistudio_sdk/sdk/pipeline.py
--rw-r--r--  2.0 unx        0 b- defN 24-Feb-02 08:07 aistudio_sdk/tests/__init__.py
--rw-r--r--  2.0 unx        0 b- defN 24-Feb-02 08:07 aistudio_sdk/utils/__init__.py
--rw-r--r--  2.0 unx     5653 b- defN 24-Mar-05 07:19 aistudio_sdk/utils/bos_sdk.py
--rw-r--r--  2.0 unx     4785 b- defN 24-Mar-05 13:56 aistudio_sdk/utils/util.py
--rw-r--r--  2.0 unx     1047 b- defN 24-Apr-18 07:32 aistudio_sdk-0.2.3.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 24-Apr-18 07:32 aistudio_sdk-0.2.3.dist-info/WHEEL
--rw-r--r--  2.0 unx       55 b- defN 24-Apr-18 07:32 aistudio_sdk-0.2.3.dist-info/entry_points.txt
--rw-r--r--  2.0 unx       13 b- defN 24-Apr-18 07:32 aistudio_sdk-0.2.3.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     1929 b- defN 24-Apr-18 07:32 aistudio_sdk-0.2.3.dist-info/RECORD
-23 files, 84865 bytes uncompressed, 24386 bytes compressed:  71.3%
+Zip file size: 28802 bytes, number of entries: 23
+-rw-r--r--  2.0 unx      534 b- defN 24-May-17 11:12 aistudio_sdk/__init__.py
+-rw-r--r--  2.0 unx     4896 b- defN 24-May-17 11:12 aistudio_sdk/cmdline.py
+-rw-r--r--  2.0 unx     1778 b- defN 24-May-17 11:12 aistudio_sdk/config.py
+-rw-r--r--  2.0 unx    29035 b- defN 24-May-17 11:12 aistudio_sdk/hub.py
+-rw-r--r--  2.0 unx     1898 b- defN 24-May-17 11:12 aistudio_sdk/log.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-17 11:12 aistudio_sdk/constant/__init__.py
+-rw-r--r--  2.0 unx      626 b- defN 24-May-17 11:12 aistudio_sdk/constant/const.py
+-rw-r--r--  2.0 unx     2383 b- defN 24-May-17 11:12 aistudio_sdk/constant/err_code.py
+-rw-r--r--  2.0 unx      387 b- defN 24-May-17 11:12 aistudio_sdk/constant/version.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-17 11:12 aistudio_sdk/requests/__init__.py
+-rw-r--r--  2.0 unx    17204 b- defN 24-May-17 11:12 aistudio_sdk/requests/hub.py
+-rw-r--r--  2.0 unx     5201 b- defN 24-May-17 11:12 aistudio_sdk/requests/pipeline.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-17 11:12 aistudio_sdk/sdk/__init__.py
+-rw-r--r--  2.0 unx    12521 b- defN 24-May-17 11:12 aistudio_sdk/sdk/pipeline.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-17 11:12 aistudio_sdk/tests/__init__.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-17 11:12 aistudio_sdk/utils/__init__.py
+-rw-r--r--  2.0 unx     5653 b- defN 24-May-17 11:12 aistudio_sdk/utils/bos_sdk.py
+-rw-r--r--  2.0 unx     5014 b- defN 24-May-17 11:12 aistudio_sdk/utils/util.py
+-rw-r--r--  2.0 unx     1047 b- defN 24-May-17 11:13 aistudio_sdk-0.2.4.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-May-17 11:13 aistudio_sdk-0.2.4.dist-info/WHEEL
+-rw-r--r--  2.0 unx       55 b- defN 24-May-17 11:13 aistudio_sdk-0.2.4.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx       13 b- defN 24-May-17 11:13 aistudio_sdk-0.2.4.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     1929 b- defN 24-May-17 11:13 aistudio_sdk-0.2.4.dist-info/RECORD
+23 files, 90266 bytes uncompressed, 25646 bytes compressed:  71.6%
```

## zipnote {}

```diff
@@ -48,23 +48,23 @@
 
 Filename: aistudio_sdk/utils/bos_sdk.py
 Comment: 
 
 Filename: aistudio_sdk/utils/util.py
 Comment: 
 
-Filename: aistudio_sdk-0.2.3.dist-info/METADATA
+Filename: aistudio_sdk-0.2.4.dist-info/METADATA
 Comment: 
 
-Filename: aistudio_sdk-0.2.3.dist-info/WHEEL
+Filename: aistudio_sdk-0.2.4.dist-info/WHEEL
 Comment: 
 
-Filename: aistudio_sdk-0.2.3.dist-info/entry_points.txt
+Filename: aistudio_sdk-0.2.4.dist-info/entry_points.txt
 Comment: 
 
-Filename: aistudio_sdk-0.2.3.dist-info/top_level.txt
+Filename: aistudio_sdk-0.2.4.dist-info/top_level.txt
 Comment: 
 
-Filename: aistudio_sdk-0.2.3.dist-info/RECORD
+Filename: aistudio_sdk-0.2.4.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## aistudio_sdk/config.py

```diff
@@ -7,33 +7,44 @@
 ################################################################################
 """
 config
 
 Authors: xiangyiqing(xiangyiqing@baidu.com)
 Date:    2023/07/24
 """
+import os
+
+ENV = os.environ.get("CURRENT_ENV", "online")  # sandbox or online
 
 # Set to either 'debug' or 'info', controls console logging
+
 DEFAULT_LOG_LEVEL = "info"
 CONNECTION_TIMEOUT = 30     # second
 CONNECTION_RETRY_TIMES = 1
 CONNECTION_TIMEOUT_UPLOAD = 60 * 60     # second
 CONNECTION_TIMEOUT_DOWNLOAD = 60 * 60     # second
 
 COMMON_FILE_SIZE_LIMIT = 5 * 1024 * 1024  # 5M
 LFS_FILE_SIZE_LIMIT = 50 * 1024 * 1024 * 1024 # 50G
 LFS_FILE_SIZE_LIMIT_PUT = 5 * 1024 * 1024 * 1024 # 5G
 
 # host
-STUDIO_GIT_HOST_DEFAULT = "http://git.aistudio.baidu.com"
-STUDIO_MODEL_API_URL_PREFIX_DEFAULT = "https://aistudio.baidu.com"
+if ENV == "sandbox":
+    STUDIO_GIT_HOST_DEFAULT = "http://sandbox-git.aistudio.baidu.com"
+    STUDIO_MODEL_API_URL_PREFIX_DEFAULT = "https://sandbox-aistudio.baidu.com"
+elif ENV == "online":
+    STUDIO_GIT_HOST_DEFAULT = "http://git.aistudio.baidu.com"
+    STUDIO_MODEL_API_URL_PREFIX_DEFAULT = "https://aistudio.baidu.com"
+else:
+    raise ValueError("Invalid ENV: {}".format(ENV))
 
 # Hub API
 HUB_URL = "/studio/model/sdk/add"
 HUB_URL_VISIBLE_CHECK = "/modelcenter/v2/models/sdk/checkPermit"
+APP_SERVICE_URL = "/serving/web/highapp/sdk/create"
 
 # PP Pipeline API
 MOUNT_DATASET_LIMIT = 3
 PIPELINE_CODE_SIZE_LIMIT = 50 * 1024 * 1024     # bytes
 PIPELINE_CREATE_URL = "/paddlex/v3/pipelines/sdk/create"
 PIPELINE_CREATE_CALLBACK_URL = "/paddlex/v3/pipelines/sdk/create/callback"
 PIPELINE_BOSACL_URL = "/paddlex/v3/file/api/bosacl"
```

## aistudio_sdk/hub.py

```diff
@@ -22,27 +22,28 @@
 """
 import os
 import logging
 import traceback
 from pathlib import Path
 from urllib.parse import quote
 from aistudio_sdk.constant.err_code import ErrorEnum
-from aistudio_sdk.requests.hub import request_aistudio_hub
+from aistudio_sdk.requests.hub import request_aistudio_hub, request_aistudio_app_service
 from aistudio_sdk.requests.hub import request_aistudio_git_download
 from aistudio_sdk.requests.hub import request_aistudio_git_file_info
 from aistudio_sdk.requests.hub import request_aistudio_git_file_type
 from aistudio_sdk.requests.hub import request_aistudio_git_upload_access
 from aistudio_sdk.requests.hub import request_bos_upload
 from aistudio_sdk.requests.hub import request_aistudio_git_upload_pointer
 from aistudio_sdk.requests.hub import request_aistudio_git_upload_common
 from aistudio_sdk.requests.hub import get_exist_file_old_sha
 from aistudio_sdk.requests.hub import request_aistudio_repo_visible
 from aistudio_sdk.requests.hub import request_aistudio_verify_lfs_file
 from aistudio_sdk.utils.util import convert_to_dict_object, is_valid_host, calculate_sha256
 from aistudio_sdk.utils.util import err_resp
+from aistudio_sdk import log
 from aistudio_sdk import config
 
 
 __all__ = [
     "create_repo",
     "download",
     "upload",
@@ -74,89 +75,160 @@
         if not os.getenv("AISTUDIO_ACCESS_TOKEN", default=""):
             cache_home = os.getenv("AISTUDIO_CACHE_HOME", default=os.getenv("HOME"))
             token_file_path = f'{cache_home}/.cache/aistudio/.auth/token'
             if os.path.exists(token_file_path):
                 with open(token_file_path, 'r') as file:
                     os.environ["AISTUDIO_ACCESS_TOKEN"] = file.read().strip()
 
-
     def create_repo(self, **kwargs):
         """
         创建一个repo仓库并返回创建成功后的信息。
+        Params:
+            repo_id (str): 仓库名称，格式为user_name/repo_name 或者 repo_name，必填。
+            repo_type (str): 仓库类型，取值为app/model，分别为应用仓库和模型仓库。如果未指定，默认为model。
+            app_name (str): 应用名称，如果repo_type为app，则必填。默认值为repo_id (如果不填，后端自动生成）。
+
+            app_sdk (str): 应用SDK, 如果repo_type为app，则必填，可以填写 streamlit, gradio, static 三种
+            version (str): streamlit 或 gradio 版本，必填
+                * gradio版本支持"4.26.0", "4.0.0"
+                * streamlit版本支持"1.33.0", "1.30.0"
+            model_name (str): 模型名称，如果repo_type为model，则必填。默认值为repo_id。
+            desc (str): 仓库描述，可选，默认为空。
+            license (str): 仓库许可证，可选，默认为"Apache License 2.0"。
+            private (bool): 是否私有仓库，可选，默认为False。
+            token (str): 认证令牌，可选，默认为环境变量的值。
+        Demo:
+            创建应用仓库：
+            create_repo(repo_id='app_repo_0425',
+                        app_sdk='streamlit',
+                        version="1.33.0"
+                        desc='my app demo')
+        Returns:
+            dict: 仓库创建结果。
         """
-        # 参数检查
-        str_params_not_valid = 'params not valid.'
+        params = {}
         if "repo_id" not in kwargs:
-            return err_resp(ErrorEnum.PARAMS_INVALID.code, 
-                            ErrorEnum.PARAMS_INVALID.message)
+            return err_resp(ErrorEnum.PARAMS_INVALID.code, ErrorEnum.PARAMS_INVALID.message)
+
+        # 设置默认repo_type为'model'
+        repo_type = kwargs.get('repo_type', 'model')
+        if repo_type == 'app':
+            if 'app_name' not in kwargs:
+                return err_resp(ErrorEnum.PARAMS_INVALID.code,
+                                ErrorEnum.PARAMS_INVALID.message + "should provide param app_name")
+
+            app_sdk = kwargs.get('app_sdk')
+            if not app_sdk or app_sdk not in ['streamlit', 'gradio', 'static']:
+                return err_resp(ErrorEnum.PARAMS_INVALID.code,
+                                ErrorEnum.PARAMS_INVALID.message + "app_sdk should be streamlit, gradio or static.")
+            if app_sdk == "streamlit":
+                if 'version' not in kwargs or kwargs['version'] not in ["1.33.0", "1.30.0"]:
+                    return err_resp(ErrorEnum.PARAMS_INVALID.code,
+                                    "streamlit version should be in ['1.33.0', '1.30.0'].")
+                params["streamlitVersion"] = kwargs['version']
+
+            if app_sdk == "gradio":
+                if 'version' not in kwargs or kwargs['version'] not in ["4.26.0", "4.0.0"]:
+                    return err_resp(ErrorEnum.PARAMS_INVALID.code,
+                                    "gradio version should be in ['4.26.0', '4.0.0'].")
+                params["gradioVersion"] = kwargs['version']
+
+        elif repo_type == 'model' and 'model_name' not in kwargs:
+            kwargs['model_name'] = kwargs.get('repo_id')
+
+        if 'private' in kwargs and not isinstance(kwargs['private'], bool):
+            return err_resp(ErrorEnum.PARAMS_INVALID.code, "private should be bool type.")
 
-        if 'private' in kwargs and kwargs['private'] not in (True, False):
-            return err_resp(ErrorEnum.PARAMS_INVALID.code, 
-                            ErrorEnum.PARAMS_INVALID.message)
         for key in ['repo_id', 'model_name', 'license', 'token']:
             if key in kwargs:
-                if type(kwargs[key]) != str:
-                    return err_resp(ErrorEnum.PARAMS_INVALID.code, 
-                                    ErrorEnum.PARAMS_INVALID.message)
+                if not isinstance(kwargs[key], str):
+                    return err_resp(ErrorEnum.PARAMS_INVALID.code, "should be str type: " + key)
                 kwargs[key] = kwargs[key].strip()
                 if not kwargs[key]:
-                    return err_resp(ErrorEnum.PARAMS_INVALID.code, 
-                                    ErrorEnum.PARAMS_INVALID.message)
+                    return err_resp(ErrorEnum.PARAMS_INVALID.code, "should not be empty: " + key)
 
         if not os.getenv("AISTUDIO_ACCESS_TOKEN") and 'token' not in kwargs:
-            return err_resp(ErrorEnum.TOKEN_IS_EMPTY.code,
-                            ErrorEnum.TOKEN_IS_EMPTY.message)
+            return err_resp(ErrorEnum.TOKEN_IS_EMPTY.code, ErrorEnum.TOKEN_IS_EMPTY.message)
 
-        if 'desc' in kwargs \
-                and type(kwargs['desc']) != str:
-            return err_resp(ErrorEnum.PARAMS_INVALID.code, 
-                            ErrorEnum.PARAMS_INVALID.message)
+        if 'desc' in kwargs and not isinstance(kwargs['desc'], str):
+            return err_resp(ErrorEnum.PARAMS_INVALID.code, ErrorEnum.PARAMS_INVALID.message)
 
-        # 兼容 带前缀的入参写法
         repo_name_raw = kwargs['repo_id']
         if "/" in repo_name_raw:
             user_name, repo_name = repo_name_raw.split('/')
             user_name = user_name.strip()
             repo_name = repo_name.strip()
             if not repo_name or not user_name:
-                return err_resp(ErrorEnum.PARAMS_INVALID.code, 
-                                ErrorEnum.PARAMS_INVALID.message)
+                return err_resp(ErrorEnum.PARAMS_INVALID.code,
+                                "user_name or repo_name is empty. repo_id should be user_name/repo_name format.")
             kwargs['repo_id'] = repo_name
         else:
-            kwargs['repo_id'] = repo_name_raw
+            kwargs['repo_id'] = repo_name_raw.strip()
+            # return err_resp(ErrorEnum.PARAMS_INVALID.code,
+            #                 "r epo_id should be user_name/repo_name format.")
+
+        if repo_type == 'model':
+
+            more_params = {
+                'repoType': 0 if kwargs.get('private') else 1,
+                'repoName': kwargs['repo_id'],
+                'modelName': kwargs.get('model_name', ''),  # 添加模型名
+                'desc': kwargs.get('desc', ''),
+                'license': kwargs.get('license', 'Apache License 2.0'),
+                'token': kwargs.get('token', '')
+            }
+            params.update(more_params)
+            resp = convert_to_dict_object(request_aistudio_hub(**params))
+        else:
+            more_params = {
+                'repoType': 0 if kwargs.get('private') else 1,
+                'repoName': kwargs['repo_id'],
+                'appName': kwargs.get('app_name', ''),
+                'appType': kwargs.get('app_sdk', ''),
+                'desc': kwargs.get('desc', ''),
+                'license': kwargs.get('license', 'Apache License 2.0'),
+                'token': kwargs.get('token', '')
+            }
+            params.update(more_params)
+
+            resp_raw = request_aistudio_app_service(**params)
+            log.debug(f"create_repo resp: {resp_raw}")
+            resp = convert_to_dict_object(resp_raw)
+            log.debug(f"create_repo resp dict: {resp}")
 
-        params = {
-            'repoType': 0 if kwargs.get('private') else 1,
-            'repoName': kwargs['repo_id'],
-            'modelName': kwargs['model_name'] if kwargs.get('model_name') else kwargs['repo_id'],
-            'desc': kwargs.get('desc', ''),
-            'license': kwargs['license'].strip() if kwargs.get('license') else 'Apache License 2.0',
-            'token': kwargs['token'] if 'token' in kwargs else ''
-        }
-        resp = convert_to_dict_object(request_aistudio_hub(**params))
         if 'errorCode' in resp and resp['errorCode'] != 0:
+            log.error(f"create_repo failed: {resp}")
             if "repo already created" in resp['errorMsg']:
                 res = err_resp(ErrorEnum.REPO_ALREADY_EXIST.code, 
                                resp['errorMsg'],
                                resp['errorCode'],
                                resp['logId'])  # 错误logid透传
             else:
                 res = err_resp(ErrorEnum.AISTUDIO_CREATE_REPO_FAILED.code, 
                                resp['errorMsg'],
                                resp['errorCode'],
                                resp['logId'])
             return res
 
-        res = {
-            'model_name': resp['result']['modelName'],
-            'repo_id': resp['result']['repoName'],
-            'private': True if resp['result']['repoType'] == 0 else False,
-            'desc': resp['result']['desc'],
-            'license': resp['result']['license']
-        }
+        if repo_type == 'model':
+            res = {
+                'model_name': resp['result']['modelName'],
+                'repo_id': resp['result']['repoName'],
+                'private': True if resp['result']['repoType'] == 0 else False,
+                'desc': resp['result']['desc'],
+                'license': resp['result']['license']
+            }
+        else:
+            res = {
+                'app_id': resp['result']['appId'],
+                'app_name': resp['result']['appName'],
+                'repo_id': resp['result']['repoName'],
+                'desc': resp['result']['desc'],
+                'license': resp['result']['license']
+            }
         return res
 
 
     def download(self, **kwargs):
         """
         下载:
         params:
```

## aistudio_sdk/constant/err_code.py

```diff
@@ -24,15 +24,15 @@
         print(ErrorEnum.SUCCESS.message)
     """
     
     SUCCESS = (0, "成功")
     
     # SDK Error
     INTERNAL_ERROR = (10000, "SDK Internal Error")
-    PARAMS_INVALID = (10001, "params not valid.")
+    PARAMS_INVALID = (10001, "参数无效")
     TOKEN_IS_EMPTY = (10002, "未设置Token")
     REPO_ALREADY_EXIST = (10003, "repo已经存在, 不能重复创建")
     FILE_NOT_FOUND = (10004, "文件不存在")
     UPLOAD_FILE_NOT_FOUND = (10005, "找不到要上传的本地文件")
     FILE_TOO_LARGE = (10006, "文件过大")
     UPLOAD_FOLDER_NO_SUPPORT = (10007, "不支持上传文件夹")
     NEED_FOLDER = (10008, "仅支持文件夹")
```

## aistudio_sdk/constant/version.py

```diff
@@ -7,8 +7,8 @@
 ################################################################################
 """
 本文件注明版本号
 
 Authors: xiangyiqing(xiangyiqing@baidu.com)
 Date:    2023/07/24
 """
-VERSION = "0.2.3"
+VERSION = "0.2.4"
```

## aistudio_sdk/requests/hub.py

```diff
@@ -12,15 +12,14 @@
 Date:    2023/07/24
 """
 import os
 import time
 import tqdm
 import json
 import requests
-import logging
 from urllib.parse import quote
 from aistudio_sdk.constant.err_code import ErrorEnum
 from aistudio_sdk import config, log
 from aistudio_sdk.utils.util import err_resp
 from aistudio_sdk.utils.util import gen_ISO_format_datestr
 from aistudio_sdk.utils.util import file_to_base64
 from aistudio_sdk.utils.util import create_sha256_file_and_encode_base64
@@ -35,48 +34,68 @@
 #################### AIStudio 云端模型库 API ####################
 def _request_aistudio_hub(method, url, headers, data):
     """
     request aistudio hub
     """
     for _ in range(CONNECTION_RETRY_TIMES):
         try:
-            err_msg = ''
             response = requests.request(method, url, headers=headers,
                                         data=data, timeout=CONNECTION_TIMEOUT)
             return response.json()
         except requests.exceptions.JSONDecodeError:
-            err_msg = "Response body does not contain valid json: {}".format(response)
+            err_msg = "Response body does not contain valid json: {}".format(response.text)
             biz_code = response.status_code
-
-    log.debug(err_msg)
+            log.debug(err_msg)
     return err_resp(ErrorEnum.INTERNAL_ERROR.code, 
                     err_msg[:500],
                     biz_code)
 
 
 def request_aistudio_hub(**kwargs):
     """
-    请求AIStudio hub
+    请求AIStudio hub: 模型库
     """
     headers = _header_fill(token=kwargs['token'])
     kwargs.pop('token')
 
     url = "{}{}".format(
         os.getenv("STUDIO_MODEL_API_URL_PREFIX", default=config.STUDIO_MODEL_API_URL_PREFIX_DEFAULT), 
         config.HUB_URL
     )
 
     body = {k: v for k, v in kwargs.items()}
-    log.debug(body)
+    log.debug(f"request_aistudio_hub url: {url}")
+    log.debug(f"request_aistudio_hub body: {body}")
 
     payload = json.dumps(body)
     resp = _request_aistudio_hub('POST', url, headers, payload)
 
     return resp
 
+def request_aistudio_app_service(**kwargs):
+    """
+    请求AIStudio hub：应用库
+    """
+
+    headers = _header_fill(token=kwargs['token'])
+    kwargs.pop('token')
+
+    url = "{}{}".format(
+        os.getenv("STUDIO_MODEL_API_URL_PREFIX", default=config.STUDIO_MODEL_API_URL_PREFIX_DEFAULT),
+        config.APP_SERVICE_URL
+    )
+
+    body = {k: v for k, v in kwargs.items()}
+    log.debug(f"request_aistudio_app_service url: {url}")
+    log.debug(f"request_aistudio_app_service body: {body}")
+    # log.debug(f"request_aistudio_app_service headers: {headers}")
+    payload = json.dumps(body)
+    resp = _request_aistudio_hub('POST', url, headers, payload)
+
+    return resp
 
 def request_aistudio_repo_visible(**kwargs):
     """
     请求AIStudio hub 查看repo可见权限
     """
     headers = _header_fill(token=kwargs['token'])
 
@@ -107,14 +126,15 @@
     """
     for _ in range(CONNECTION_RETRY_TIMES):
         session = requests.Session()
         response = session.request(method, url, headers=headers, data=data, timeout=CONNECTION_TIMEOUT)
         session.close()
 
         if response.status_code not in (200, 201):
+            log.debug(f"response: {response.text} {response.status_code}")
             return err_resp(ErrorEnum.GITEA_DOWNLOAD_FILE_FAILED.code if
                             method == "GET" else ErrorEnum.GITEA_UPLOAD_FILE_FAILED.code,
                             response.content.decode()[:500],
                             biz_code=response.status_code)
         else:
             return response.json()
 
@@ -217,15 +237,15 @@
     url = f"{call_host}/api/v1/repos/{quote(user_name, safe='')}/" \
       f"{quote(repo_name, safe='')}/contents/{quote(file_path, safe='')}"
     if revision != 'master':
         url += f"?ref={quote(revision, safe='')}"
 
     headers = _header_fill(token=token)
     res = _request_gitea('GET', url, headers, "")
-    logging.debug(f"...result of GET /contents/{file_path}: {res}")
+    log.debug(f"...result of GET /contents/{file_path}: {res}")
     return res
 
 
 def request_aistudio_git_file_type(call_host, user_name, repo_name, revision, 
                                    path_in_repo, token):
     """
     请求AIStudio gitea 确认文件类型
@@ -238,15 +258,15 @@
         "files": [{
             "path": path_in_repo # 远程文件路径（相对于仓库根路径）
         }]
     }
 
     payload = json.dumps(params)
     result = _request_gitea('POST', url, headers, data=payload)
-    logging.debug(f"...result of POST /preupload: {result}")
+    log.debug(f"...result of POST /preupload: {url}: {result}")
     if 'error_code' in result:
         res = result
     elif 'files' not in result or not result['files'] or 'lfs' not in result['files'][0]:
         res = err_resp(ErrorEnum.GITEA_FAILED.code, 
                         str(result)[:500])
     else:
         res = {
@@ -321,15 +341,15 @@
             "name": f"refs/heads/{revision}" # 分支
         },
         "hash_algo": "sha256"
     }
     
     payload = json.dumps(params)
     result = _request_gitea('POST', url, headers, payload)
-    logging.debug(f"...result of POST /batch: {result}")
+    log.debug(f"...result of POST /batch: {result}")
     if 'error_code' in result:
         res = result
     elif 'objects' not in result or not result['objects']:
         res = err_resp(ErrorEnum.GITEA_FAILED.code, 
                         str(result)[:500])
     else:
         tmp = result['objects'][0]
@@ -471,15 +491,15 @@
     }
     params = {
         "oid": oid,
         "size": size
     }
     header = _header_fill(headers, token=token)
     res = requests.request("POST", call_host, headers=header, json=params, data=json.dumps(params))
-    logging.debug(f"...result of POST /verify: {res.text}")
+    log.debug(f"...result of POST /verify: {res.text}")
     if res.status_code not in (200, 201):
         return err_resp(ErrorEnum.GITEA_UPLOAD_FILE_FAILED.code,
                         res.json(),
                         biz_code=res.status_code)
     else:
         return res.json()
```

## aistudio_sdk/utils/util.py

```diff
@@ -40,27 +40,30 @@
         return Dict(resp)
     
     return resp
 
 
 def err_resp(sdk_code, msg, biz_code=None, log_id=None):
     """
-    Params
-        :error_code: sdk错误码
-        :msg: 错误信息
-        :biz_code: 上游接口错误码透传
-        :log_id: 上游接口错误日志id透传
-    Rerurns
-        formatted error msg
+    构造错误响应信息。
+
+    Params:
+        sdk_code (str): SDK错误码，标识错误类型。
+        msg (str): 错误描述信息。
+        biz_code (str, optional): 业务层面的错误码，透传自上游接口。
+        log_id (str, optional): 与错误相关的日志ID，透传自上游接口。
+
+    Returns:
+        dict: 格式化好的错误信息。
     """
     return {
-        "error_code": sdk_code,
-        "error_msg": msg,
-        "biz_code": biz_code,
-        "log_id": log_id
+        "error_code": sdk_code,  # 错误码
+        "error_msg": msg,  # 错误消息
+        "biz_code": biz_code,  # 业务错误码
+        "log_id": log_id  # 日志ID
     }
 
 
 def is_valid_host(host):
     """检测host合法性"""
     # 去除可能的协议前缀 如http://、https://
     host = re.sub(r'^https?://', '', host, flags=re.IGNORECASE)
```

## Comparing `aistudio_sdk-0.2.3.dist-info/METADATA` & `aistudio_sdk-0.2.4.dist-info/METADATA`

 * *Files 8% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: aistudio-sdk
-Version: 0.2.3
+Version: 0.2.4
 Summary: Python client library for the AIStudio API
 Classifier: Programming Language :: Python
 Description-Content-Type: text/markdown
 Requires-Dist: requests
 Requires-Dist: tqdm
 Requires-Dist: bce-python-sdk
 Requires-Dist: prettytable
```

## Comparing `aistudio_sdk-0.2.3.dist-info/RECORD` & `aistudio_sdk-0.2.4.dist-info/RECORD`

 * *Files 26% similar despite different names*

```diff
@@ -1,23 +1,23 @@
 aistudio_sdk/__init__.py,sha256=4oyJtPCAfg6YBNzeJ0d-MS10vaQfkO9O86z3nbH5Y8k,534
 aistudio_sdk/cmdline.py,sha256=KAbCUBCv9AKvHTindIzUtr39z7zDm9IP6tzBGdp-5Ng,4896
-aistudio_sdk/config.py,sha256=pv42pDoGYQEc14IhEMnzaD3eZ9eDxVlyHnyYHhH67Yw,1389
-aistudio_sdk/hub.py,sha256=TBeGp5RJEGjxlxmMflPt8HwGr94uz2dG56VzdGnbv68,25057
+aistudio_sdk/config.py,sha256=96hetuXohTqeMr533XiZnP5P83E6WMFp1BjcAexS7hc,1778
+aistudio_sdk/hub.py,sha256=wssHsSw4-l9lDNI6mkPHeyRFNh-DSBQUbYxXG4nMoVY,29035
 aistudio_sdk/log.py,sha256=eylK9nw-orLahseNTkI5_X0ZneUxiAweYPZDReOZxkY,1898
 aistudio_sdk/constant/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 aistudio_sdk/constant/const.py,sha256=jn2cpKRoNTuZQ5Uau76p6P1A6Gdty1W9lsxgDc7kt8k,626
-aistudio_sdk/constant/err_code.py,sha256=ZFybkcHn2AeNAJp05xMv1SDAl7IW6_9XYCI8wyFCwy4,2388
-aistudio_sdk/constant/version.py,sha256=hxpuvVTasiO1V9LT4qynwzwCYN4xNVWCH0YmwNtu9ks,387
+aistudio_sdk/constant/err_code.py,sha256=lI8m2fCT-9_RsbIwpxmS5j87ziEJWV7E0MlnE2YDAqw,2383
+aistudio_sdk/constant/version.py,sha256=ULcYP_Uo8wh7_rPTvN8ddjjHnJQNApFdCL7nonoa-1s,387
 aistudio_sdk/requests/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-aistudio_sdk/requests/hub.py,sha256=1tH6Yj7RbkLYkoPLxR_wSvr4crb8hks3AXNJ3wigVR0,16394
+aistudio_sdk/requests/hub.py,sha256=3TlFB3KKS-IQpYG4r-4eRqQfKLvOoy0SYrKoTKWVDAU,17204
 aistudio_sdk/requests/pipeline.py,sha256=_NHbuTea7D4aDV5tsdQof-meFAAurjCFO2_ckLBPrH0,5201
 aistudio_sdk/sdk/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 aistudio_sdk/sdk/pipeline.py,sha256=TanllZPc-xyuFuYLDQfpXC7ZdqkVoa0Gx5nphJ_eu18,12521
 aistudio_sdk/tests/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 aistudio_sdk/utils/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 aistudio_sdk/utils/bos_sdk.py,sha256=RnORp8P6MYbmjorfBYFM0BfgIr5tgp5epV60rduT73g,5653
-aistudio_sdk/utils/util.py,sha256=Sm3pAjykh3nT86RzMIaGxjcPh__2TTYdyAfC0aKN47M,4785
-aistudio_sdk-0.2.3.dist-info/METADATA,sha256=O-kBU_9rggnDw9vlLJBg4B_5HcfndOr0YMOKU4THxGY,1047
-aistudio_sdk-0.2.3.dist-info/WHEEL,sha256=U88EhGIw8Sj2_phqajeu_EAi3RAo8-C6zV3REsWbWbs,92
-aistudio_sdk-0.2.3.dist-info/entry_points.txt,sha256=2S1UPsawP86d_GKOtesmj2dfoQl0yD7tgJqvPjbPMzY,55
-aistudio_sdk-0.2.3.dist-info/top_level.txt,sha256=-gcmvd8vRpFAPY7aqcgeoSPvF1A0NBW2_zNEcqmme74,13
-aistudio_sdk-0.2.3.dist-info/RECORD,,
+aistudio_sdk/utils/util.py,sha256=VecM7zD2RPgB_NmzHSO-ltuQerjfw-ID0lgLjpHoJ2o,5014
+aistudio_sdk-0.2.4.dist-info/METADATA,sha256=ScroQVIbtkg1TPDLZLjR-AS48q6JxKD7OsPm5mJS_fE,1047
+aistudio_sdk-0.2.4.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
+aistudio_sdk-0.2.4.dist-info/entry_points.txt,sha256=2S1UPsawP86d_GKOtesmj2dfoQl0yD7tgJqvPjbPMzY,55
+aistudio_sdk-0.2.4.dist-info/top_level.txt,sha256=-gcmvd8vRpFAPY7aqcgeoSPvF1A0NBW2_zNEcqmme74,13
+aistudio_sdk-0.2.4.dist-info/RECORD,,
```

