# Comparing `tmp/tecton-0.9.2.tar.gz` & `tmp/tecton-0.9.3.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "tecton-0.9.2.tar", last modified: Fri May  3 16:22:11 2024, max compression
+gzip compressed data, was "tecton-0.9.3.tar", last modified: Fri May 10 18:29:52 2024, max compression
```

## Comparing `tecton-0.9.2.tar` & `tecton-0.9.3.tar`

### file list

```diff
@@ -1,674 +1,675 @@
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.605142 tecton-0.9.2/
--rwxr-xr-x   0 nobody   (65534) nogroup  (65534)      206 2024-05-03 16:22:04.000000 tecton-0.9.2/MANIFEST.in
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3952 2024-05-03 16:22:11.605142 tecton-0.9.2/PKG-INFO
--rwxr-xr-x   0 nobody   (65534) nogroup  (65534)     3143 2024-05-03 16:22:04.000000 tecton-0.9.2/README.md
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.477131 tecton-0.9.2/protoc_gen_openapiv2/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/protoc_gen_openapiv2/__init__.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.481131 tecton-0.9.2/protoc_gen_openapiv2/options/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/protoc_gen_openapiv2/options/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2693 2024-05-03 16:22:05.000000 tecton-0.9.2/protoc_gen_openapiv2/options/annotations_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    18717 2024-05-03 16:22:05.000000 tecton-0.9.2/protoc_gen_openapiv2/options/openapiv2_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)       38 2024-05-03 16:22:11.605142 tecton-0.9.2/setup.cfg
--rwxr-xr-x   0 nobody   (65534) nogroup  (65534)     2590 2024-05-03 16:22:04.000000 tecton-0.9.2/setup.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.481131 tecton-0.9.2/tecton/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     6026 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)       17 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton/_gen_version.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.489132 tecton-0.9.2/tecton/_internals/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    10733 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/analytics.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2279 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/athena_api.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1168 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/data_frame_helper.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     6558 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/delete_keys_api.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     8122 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/display.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      930 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/env_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    29109 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/errors.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      881 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/find_spark.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3193 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/ingest_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2359 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/ingestion.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    12345 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/materialization_api.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1448 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/metadata_service.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.489132 tecton-0.9.2/tecton/_internals/metadata_service_impl/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton/_internals/metadata_service_impl/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      492 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/metadata_service_impl/auth_lib.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1870 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/metadata_service_impl/request_lib.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      615 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/metadata_service_impl/service_modules.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5408 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/mock_source_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1357 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/offline_store_credentials.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1037 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/pandas_compat.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    16160 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/query_helper.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    21223 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/querytree_api.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.489132 tecton-0.9.2/tecton/_internals/repo/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton/_internals/repo/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    11416 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/repo/function_serialization.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    12059 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/rewrite.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    16298 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/run_api.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    13055 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/sdk_decorators.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2059 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/secret_resolver.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7119 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/snowflake_api.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7214 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/spark_api.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2823 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/spark_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5615 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/tecton_pydantic.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.489132 tecton-0.9.2/tecton/_internals/tests/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton/_internals/tests/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      342 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/tests/test_spark_api.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7071 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/time_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3769 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/type_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    14505 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4985 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_internals/validations_api.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      322 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/_stamp.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3067 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/aggregation_functions.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.497133 tecton-0.9.2/tecton/cli/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    26054 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/access_control.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1583 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/api_key.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3083 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/auth.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5469 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/cli.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     8462 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/cli_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5967 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/command.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2027 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/completion.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    18539 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/engine.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1323 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/engine_renderer.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    32012 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/environment.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     8982 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/environment_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7691 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/error_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3759 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/materialization.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      515 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/pex_wrapper.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1786 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/printer.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5135 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/repo.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     9759 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/repo_config.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7739 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/repo_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5011 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/secrets.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5824 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/service_account.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5620 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/test.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2403 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/user.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4917 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/workspace.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2711 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/cli/workspace_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2450 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/fco_listers.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.501133 tecton-0.9.2/tecton/framework/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/framework/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     6920 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/framework/base_tecton_object.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)   119684 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/framework/configs.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    29027 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/framework/data_frame.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    40898 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/framework/data_source.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    13976 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/framework/dataset.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7683 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/framework/entity.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2641 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/framework/feature.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    42636 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/framework/feature_service.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)   228559 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/framework/feature_view.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3854 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/framework/filtered_source.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4922 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/framework/repo_config.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    21258 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/framework/transformation.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2071 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/framework/utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2091 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/framework/validation_mode.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    22520 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/framework/workspace.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.501133 tecton-0.9.2/tecton/identities/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/identities/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1521 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/identities/api_keys.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    14640 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/identities/credentials.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    12333 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/identities/okta.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2374 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/pytest_tecton.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      381 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/run_api_consts.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      709 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/snowflake_context.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2747 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/tecton_context.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     6326 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/types.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.501133 tecton-0.9.2/tecton/vendor/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton/vendor/__init__.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.501133 tecton-0.9.2/tecton/vendor/dill/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton/vendor/dill/__init__.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.505133 tecton-0.9.2/tecton/vendor/dill/dill/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7211 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/dill/dill/__diff.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3634 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/dill/dill/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    54753 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/dill/dill/_dill.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    20428 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/dill/dill/_objects.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    11822 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/dill/dill/detect.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7444 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/dill/dill/info.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      755 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/dill/dill/objtypes.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4467 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/dill/dill/pointers.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      719 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/dill/dill/settings.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    44906 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/dill/dill/source.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     8238 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/dill/dill/temp.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.505133 tecton-0.9.2/tecton/vendor/pyspark/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton/vendor/pyspark/__init__.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.505133 tecton-0.9.2/tecton/vendor/pyspark/py4j/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      111 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/py4j/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    26941 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/py4j/clientserver.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2329 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/py4j/compat.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4306 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/py4j/finalizer.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    18289 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/py4j/java_collections.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    96550 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/py4j/java_gateway.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    14805 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/py4j/protocol.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4361 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/py4j/signals.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)       23 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/py4j/version.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.513134 tecton-0.9.2/tecton/vendor/pyspark/pyspark/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4777 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2282 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/_globals.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     9940 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/accumulators.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7386 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/broadcast.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.513134 tecton-0.9.2/tecton/vendor/pyspark/pyspark/cloudpickle/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      201 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/cloudpickle/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    30084 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/cloudpickle/cloudpickle.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    29668 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/cloudpickle/cloudpickle_fast.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      354 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/cloudpickle/compat.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7831 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/conf.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    54613 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/context.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7619 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/daemon.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1891 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/files.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3969 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/find_spark_home.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     6654 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/install.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    10025 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/java_gateway.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3994 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/join.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.517134 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1530 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    10846 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/base.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)   126616 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/classification.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    62498 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/clustering.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4294 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/common.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    34149 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/evaluation.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)   212823 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/feature.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    17053 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/fpm.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4603 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/functions.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     8092 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/image.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.517134 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/linalg/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    39791 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/linalg/__init__.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.517134 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/param/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    18532 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/param/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     9556 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/param/_shared_params_code_gen.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    22295 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/param/shared.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    13656 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/pipeline.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    23213 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/recommendation.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    91533 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/regression.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    18317 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/stat.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    13108 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/tree.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    57402 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/tuning.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    22016 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/util.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    15371 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/wrapper.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.521135 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1372 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    28695 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/classification.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    39889 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/clustering.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4976 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/common.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    20443 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/evaluation.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    28134 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/feature.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7028 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/fpm.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.521135 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/linalg/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    46744 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/linalg/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    57731 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/linalg/distributed.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    19517 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/random.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    12101 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/recommendation.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    32842 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/regression.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.525135 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/stat/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1969 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/stat/KernelDensity.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1309 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/stat/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    14081 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/stat/_statistics.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1289 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/stat/distribution.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2301 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/stat/test.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    25342 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/tree.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    21149 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/util.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5755 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/profiler.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.525135 tecton-0.9.2/tecton/vendor/pyspark/pyspark/python/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/python/__init__.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.525135 tecton-0.9.2/tecton/vendor/pyspark/pyspark/python/pyspark/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/python/pyspark/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2473 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/python/pyspark/shell.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)   109373 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/rdd.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4250 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/rddsampler.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.525135 tecton-0.9.2/tecton/vendor/pyspark/pyspark/resource/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1317 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/resource/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1590 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/resource/information.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7097 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/resource/profile.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    10946 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/resource/requests.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1224 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/resultiterable.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    20586 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/serializers.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2473 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/shell.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    27959 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/shuffle.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.529135 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2590 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/__init__.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.529135 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/avro/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      809 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/avro/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5993 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/avro/functions.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    12110 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/catalog.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    29664 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/column.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2999 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/conf.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    23884 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/context.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    99829 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/dataframe.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)   157099 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/functions.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    10681 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/group.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.533136 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/pandas/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      959 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/pandas/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    21163 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/pandas/conversion.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    28130 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/pandas/functions.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    14683 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/pandas/group_ops.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3806 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/pandas/map_ops.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    12308 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/pandas/serializers.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     6324 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/pandas/typehints.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    13225 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/pandas/types.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2745 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/pandas/utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    77056 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/readwriter.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    31188 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/session.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    69121 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/streaming.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    55203 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/types.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    20068 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/udf.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     6976 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    12863 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/window.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5149 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/statcounter.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3756 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/status.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2785 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/storagelevel.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.533136 tecton-0.9.2/tecton/vendor/pyspark/pyspark/streaming/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1007 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/streaming/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    16448 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/streaming/context.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    27879 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/streaming/dstream.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5436 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/streaming/kinesis.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2333 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/streaming/listener.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5614 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/streaming/util.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     9189 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/taskcontext.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2679 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/traceback_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    11623 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/util.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)       20 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/version.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    27875 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/pyspark/pyspark/worker.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1334 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/vendor_dill.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1448 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/vendor/vendor_pyspark.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1154 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton/version.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.481131 tecton-0.9.2/tecton.egg-info/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3952 2024-05-03 16:22:08.000000 tecton-0.9.2/tecton.egg-info/PKG-INFO
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    22978 2024-05-03 16:22:09.000000 tecton-0.9.2/tecton.egg-info/SOURCES.txt
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        1 2024-05-03 16:22:08.000000 tecton-0.9.2/tecton.egg-info/dependency_links.txt
--rw-r--r--   0 nobody   (65534) nogroup  (65534)       96 2024-05-03 16:22:09.000000 tecton-0.9.2/tecton.egg-info/entry_points.txt
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1128 2024-05-03 16:22:09.000000 tecton-0.9.2/tecton.egg-info/requires.txt
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      120 2024-05-03 16:22:09.000000 tecton-0.9.2/tecton.egg-info/top_level.txt
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.533136 tecton-0.9.2/tecton_athena/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_athena/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    14977 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_athena/athena_session.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     8797 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_athena/data_catalog_helper.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5764 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_athena/odfv_helper.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.537136 tecton-0.9.2/tecton_athena/query/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_athena/query/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2381 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_athena/query/translate.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    17721 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_athena/sql_helper.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.537136 tecton-0.9.2/tecton_athena/templates/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_athena/templates/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1956 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_athena/templates/create_table.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      267 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_athena/templates/data_source.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     9544 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_athena/templates/historical_features.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      672 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_athena/templates/materialization_tile.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3975 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_athena/templates/run_full_aggregation.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      503 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_athena/templates/run_partial_aggregation.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1046 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_athena/templates/time_limit.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      277 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_athena/templates/transformation_pipeline.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      656 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_athena/templates_utils.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.541136 tecton-0.9.2/tecton_core/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_core/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)       17 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/_gen_version.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    13149 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/aggregation_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1598 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/arrow.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1956 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/aws_credentials.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3464 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/compute_mode.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    24797 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/conf.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7234 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/data_types.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3981 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/duckdb_context.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.545137 tecton-0.9.2/tecton_core/embeddings/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/embeddings/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      302 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/embeddings/config.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7404 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/errors.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5113 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/fco_container.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    27206 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/feature_definition_wrapper.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     9838 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/feature_set_config.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      749 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/feature_view_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      302 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/filter_context.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2507 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/function_deserialization.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      739 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/http.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      616 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/id_helper.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      546 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/iterators.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7440 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/materialization_context.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.545137 tecton-0.9.2/tecton_core/metadata_service_impl/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/metadata_service_impl/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      195 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_core/metadata_service_impl/base_stub.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2665 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_core/metadata_service_impl/error_lib.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3488 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_core/metadata_service_impl/http_client.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      901 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_core/metadata_service_impl/providers.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1990 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_core/metadata_service_impl/response.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2273 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_core/metadata_service_impl/service_calls.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      206 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_core/metadata_service_impl/trace.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    20281 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/offline_store.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1427 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/online_serving_index.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7383 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/pipeline_common.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.549137 tecton-0.9.2/tecton_core/query/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    22026 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/aggregation_plans.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    56183 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/builder.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5286 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/compaction_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      179 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/dialect.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.549137 tecton-0.9.2/tecton_core/query/duckdb/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/duckdb/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    10983 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/duckdb/compute.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7820 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/duckdb/nodes.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      714 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/duckdb/rewrite.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1526 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/errors.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      746 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/executor_params.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1735 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/executor_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    10749 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/node_interface.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7303 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/node_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)   126322 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/nodes.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.549137 tecton-0.9.2/tecton_core/query/pandas/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/pandas/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3556 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/pandas/compute.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4033 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/pandas/node.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    22035 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/pandas/nodes.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     6169 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/pandas/pipeline_helper.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5054 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/pandas/rewrite.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      192 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/pandas/sql.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1948 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/pandas/translate.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5944 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/pipeline_sql_builder.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      786 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/prefixed_uri_resolver.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4204 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/query_tree_compute.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    21774 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/query_tree_executor.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      227 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/rewrite.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.549137 tecton-0.9.2/tecton_core/query/snowflake/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/snowflake/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    12630 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/snowflake/compute.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    20202 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query/sql_compat.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3294 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/query_consts.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5280 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/repo_file_handler.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      867 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_core/request_context.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3149 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/schema.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    11989 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/schema_derivation_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5597 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_core/schema_validation.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1063 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_core/secrets.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2126 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/snowflake_context.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.549137 tecton-0.9.2/tecton_core/specs/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      777 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_core/specs/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    44686 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_core/specs/data_source_spec.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1457 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_core/specs/entity_spec.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5460 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_core/specs/feature_service_spec.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    43407 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_core/specs/feature_view_spec.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4440 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_core/specs/tecton_object_spec.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     9179 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_core/specs/time_window_spec.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2440 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_core/specs/transformation_spec.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4952 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_core/specs/utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     9725 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/time_utils.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.553137 tecton-0.9.2/tecton_core/vendor/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/vendor/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     9361 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/vendor/queue.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.553137 tecton-0.9.2/tecton_core/vendor/treelib/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1594 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/vendor/treelib/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      943 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/vendor/treelib/exceptions.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1575 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/vendor/treelib/misc.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     9595 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/vendor/treelib/node.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1265 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/vendor/treelib/plugins.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    37469 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/vendor/treelib/tree.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1275 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_core/vendor/vendor_treelib.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.553137 tecton-0.9.2/tecton_materialization/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      718 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    23147 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/batch_materialization.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.553137 tecton-0.9.2/tecton_materialization/common/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_materialization/common/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2835 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/common/job_metadata.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5803 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/common/job_metadata_aws.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2222 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/common/job_metadata_gcp.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2693 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/common/task_params.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4811 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/consumption.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1070 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/delta_maintenance.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3731 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/entity_deletion.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5200 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/feature_export.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5090 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/ingest_materialization.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7159 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/job_metadata.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     9316 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/materialization.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7780 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/materialization_utils.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.557138 tecton-0.9.2/tecton_materialization/ray/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_materialization/ray/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5242 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/ray/batch_materialization.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    23853 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/ray/delta.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5973 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/ray/feature_export.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5009 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/ray/ingest_materialization.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     6869 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/ray/job_status.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    10181 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/ray/materialization.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4190 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/ray/materialization_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3172 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/ray/nodes.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.557138 tecton-0.9.2/tecton_materialization/remote_host/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/remote_host/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    20100 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/remote_host/pyspark_remote_host.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1996 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/secrets.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     6666 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_materialization/stream_materialization.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.557138 tecton-0.9.2/tecton_proto/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/__init__.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.557138 tecton-0.9.2/tecton_proto/amplitude/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/amplitude/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4642 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/amplitude/amplitude_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3093 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/amplitude/client_logging_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.557138 tecton-0.9.2/tecton_proto/api/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/api/__init__.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.557138 tecton-0.9.2/tecton_proto/api/featureservice/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/api/featureservice/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    81835 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/api/featureservice/feature_service_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     9573 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/api/featureservice/feature_service_request_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.561138 tecton-0.9.2/tecton_proto/args/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/args/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2864 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/args/basic_info_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1897 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/args/data_source_config_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    21470 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/args/data_source_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3996 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/args/diff_options_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     6990 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/args/diff_test_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3059 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/args/entity_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2415 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/args/fco_args_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5172 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/args/feature_service_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    41778 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/args/feature_view_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     6092 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/args/pipeline_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1694 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/args/repo_metadata_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4704 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/args/transformation_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1637 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/args/user_defined_function_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1893 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/args/version_constraints_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     8163 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/args/virtual_data_source_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.561138 tecton-0.9.2/tecton_proto/auditlog/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/auditlog/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2716 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/auditlog/metadata_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.565138 tecton-0.9.2/tecton_proto/auth/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/auth/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1422 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/auth/acl_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    29023 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/auth/authorization_service_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3224 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/auth/principal_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     6551 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/auth/resource_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3058 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/auth/resource_role_assignments_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3058 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/auth/service_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.565138 tecton-0.9.2/tecton_proto/canary/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/canary/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1208 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/canary/type_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2195 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/canary/update_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.565138 tecton-0.9.2/tecton_proto/cli/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/cli/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3075 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/cli/repo_diff_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.569139 tecton-0.9.2/tecton_proto/common/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/common/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3459 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/common/aggregation_function_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1717 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/common/analytics_options_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1823 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/common/aws_credentials_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1672 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/common/column_type_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1336 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/common/compute_mode_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1934 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/common/container_image_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1373 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/common/data_source_type_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2431 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/common/data_type_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1735 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/common/fco_locator_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1286 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/common/framework_version_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1725 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/common/id_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1150 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/common/pair_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1368 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/common/schema_container_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2819 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/common/schema_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1518 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/common/secret_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1381 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/common/spark_schema_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2183 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/common/time_window_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.569139 tecton-0.9.2/tecton_proto/consumption/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/consumption/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5600 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/consumption/consumption_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.577139 tecton-0.9.2/tecton_proto/data/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7900 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/batch_data_source_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2313 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/entity_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2848 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/fco_metadata_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2916 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/fco_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5025 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/feature_service_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1487 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/feature_store_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    20207 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/feature_view_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2121 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/freshness_status_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4810 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/fv_materialization_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1366 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/hive_metastore_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1975 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/internal_spark_cluster_status_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1683 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/materialization_roles_allowlists_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5831 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/materialization_status_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1752 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/odfv_compute_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2317 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/onboarding_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2614 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/principal_group_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     6827 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/remote_compute_environment_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    15757 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/data/remote_spark_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3468 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/saved_feature_data_frame_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4545 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/serving_status_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    10895 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/state_update_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4799 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/stream_data_source_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1828 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/summary_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2349 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/tecton_api_key_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2795 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/transformation_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    10456 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/user_deployment_settings_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1650 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/user_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3433 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/virtual_data_source_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2355 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/data/workspace_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.577139 tecton-0.9.2/tecton_proto/databricks_api/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/databricks_api/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     8276 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/databricks_api/clusters_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1889 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/databricks_api/dbfs_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1276 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/databricks_api/error_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3593 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/databricks_api/execution_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1501 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/databricks_api/instance_profiles_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     8112 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/databricks_api/jobs_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1912 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/databricks_api/libraries_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2911 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/databricks_api/permissions_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1253 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/databricks_api/scim_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2391 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/databricks_api/secrets_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2613 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/databricks_api/workspace_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.581140 tecton-0.9.2/tecton_proto/dataobs/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/dataobs/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2490 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/dataobs/config_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2553 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/dataobs/expectation_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3691 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/dataobs/metric_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5748 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/dataobs/validation_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3723 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/dataobs/validation_task_params_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4629 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/dataobs/validation_task_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.581140 tecton-0.9.2/tecton_proto/feature_server/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/feature_server/__init__.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.581140 tecton-0.9.2/tecton_proto/feature_server/configuration/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/feature_server/configuration/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    19997 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/feature_server/configuration/feature_server_configuration_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.581140 tecton-0.9.2/tecton_proto/materialization/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/materialization/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     9821 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/materialization/job_metadata_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2610 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/materialization/materialization_states_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    14634 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/materialization/materialization_task_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     8173 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/materialization/params_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2752 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/materialization/spark_cluster_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.581140 tecton-0.9.2/tecton_proto/materializationjobservice/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/materializationjobservice/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    16111 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/materializationjobservice/materialization_job_service_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.585140 tecton-0.9.2/tecton_proto/metadataservice/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/metadataservice/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2776 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/metadataservice/http_over_grpc_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)   121489 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/metadataservice/metadata_service_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.585140 tecton-0.9.2/tecton_proto/offlinestore/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/offlinestore/__init__.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.585140 tecton-0.9.2/tecton_proto/offlinestore/delta/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/offlinestore/delta/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1570 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/offlinestore/delta/metadata_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     6554 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/offlinestore/delta/transaction_writer_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.585140 tecton-0.9.2/tecton_proto/online_store/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/online_store/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5408 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/online_store/feature_value_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1306 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/online_store/status_entry_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.585140 tecton-0.9.2/tecton_proto/online_store_writer/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/online_store_writer/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2401 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/online_store_writer/config_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5522 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/online_store_writer/copier_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.585140 tecton-0.9.2/tecton_proto/remoteenvironmentservice/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/remoteenvironmentservice/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    13213 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/remoteenvironmentservice/remote_environment_service_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.585140 tecton-0.9.2/tecton_proto/secrets/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/secrets/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    10485 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/secrets/secrets_service_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.589140 tecton-0.9.2/tecton_proto/snowflake/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/snowflake/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1246 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/snowflake/location_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1392 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/snowflake/snowflake_credentials_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.589140 tecton-0.9.2/tecton_proto/spark_api/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/spark_api/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1195 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/spark_api/error_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7388 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/spark_api/jobs_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.589140 tecton-0.9.2/tecton_proto/spark_common/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/spark_common/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7786 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/spark_common/clusters_pb2.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2386 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/spark_common/libraries_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.589140 tecton-0.9.2/tecton_proto/testhelperservice/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/testhelperservice/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3516 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_proto/testhelperservice/test_helper_service_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.589140 tecton-0.9.2/tecton_proto/validation/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/validation/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4609 2024-05-03 16:22:04.000000 tecton-0.9.2/tecton_proto/validation/validator_pb2.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.593141 tecton-0.9.2/tecton_snowflake/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    30085 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/pipeline_helper.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.593141 tecton-0.9.2/tecton_snowflake/query/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/query/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    10160 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/query/aggregation_plans.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      806 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/query/dataframe_helper.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    13676 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/query/nodes.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     6314 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/query/queries.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      741 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/query/rewrite.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3704 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/query/translate.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     8392 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/schema_derivation_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2246 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/snowflake_type_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    33774 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/sql_helper.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.597141 tecton-0.9.2/tecton_snowflake/templates/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/templates/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1025 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/templates/copier_macro.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      396 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/templates/create_temp_table_for_bfv.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      363 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/templates/create_temp_table_for_bwafv.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      255 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/templates/data_source.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1248 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/templates/delete_orphaned_schemas.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      698 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/templates/delete_staged_files.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3069 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/templates/historical_features.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7892 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/templates/historical_features_macros.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1795 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/templates/materialization_tile.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2575 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/templates/materialized_feature_view.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      937 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/templates/offline_materialization_macros.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      126 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/templates/online_store_copier.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     6777 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/templates/run_full_aggregation.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      583 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/templates/run_partial_aggregation.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      569 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/templates/time_limit.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      213 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/templates/transformation_pipeline.sql
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      806 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/templates_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      249 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_snowflake/utils.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.601141 tecton-0.9.2/tecton_spark/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      808 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    30278 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/aggregation_plans.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2263 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/data_observability.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      926 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/data_source_credentials.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    35476 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/data_source_helper.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      425 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/errors_spark.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     6470 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/feature_view_spark_utils.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.601141 tecton-0.9.2/tecton_spark/jars/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/jars/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2633 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/jars/class_loader.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)  1794322 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/jars/tecton-udfs-spark-3.jar
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7182 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/materialization_plan.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    27440 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/offline_store.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    15491 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/partial_aggregations.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    33278 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/pipeline_helper.py
-drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:11.605142 tecton-0.9.2/tecton_spark/query/
--rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/query/__init__.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3356 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/query/data_source.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    10751 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/query/filter.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    37167 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/query/join.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1515 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/query/node.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     7583 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/query/pipeline.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    14752 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/query/projection.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    10712 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/query/translate.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)    17887 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/schema_derivation_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     5434 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/schema_spark_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     2317 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/spark_helper.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     1697 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/spark_schema_wrapper.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     4858 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/time_utils.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)      393 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/udf_jar.py
--rw-r--r--   0 nobody   (65534) nogroup  (65534)     3257 2024-05-03 16:22:05.000000 tecton-0.9.2/tecton_spark/udfs.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.228607 tecton-0.9.3/
+-rwxr-xr-x   0 nobody   (65534) nogroup  (65534)      206 2024-05-10 18:29:48.000000 tecton-0.9.3/MANIFEST.in
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3952 2024-05-10 18:29:52.228607 tecton-0.9.3/PKG-INFO
+-rwxr-xr-x   0 nobody   (65534) nogroup  (65534)     3143 2024-05-10 18:29:48.000000 tecton-0.9.3/README.md
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.160602 tecton-0.9.3/protoc_gen_openapiv2/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/protoc_gen_openapiv2/__init__.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.160602 tecton-0.9.3/protoc_gen_openapiv2/options/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/protoc_gen_openapiv2/options/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2693 2024-05-10 18:29:48.000000 tecton-0.9.3/protoc_gen_openapiv2/options/annotations_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    18717 2024-05-10 18:29:48.000000 tecton-0.9.3/protoc_gen_openapiv2/options/openapiv2_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)       38 2024-05-10 18:29:52.228607 tecton-0.9.3/setup.cfg
+-rwxr-xr-x   0 nobody   (65534) nogroup  (65534)     2590 2024-05-10 18:29:48.000000 tecton-0.9.3/setup.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.164602 tecton-0.9.3/tecton/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     6026 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)       17 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_gen_version.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.168603 tecton-0.9.3/tecton/_internals/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    10733 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/analytics.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2279 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/athena_api.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1168 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/data_frame_helper.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     6558 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/delete_keys_api.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     8122 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/display.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      930 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/env_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    29291 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/errors.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      881 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/find_spark.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3193 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/ingest_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2359 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/ingestion.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    12345 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/materialization_api.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1448 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/metadata_service.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.168603 tecton-0.9.3/tecton/_internals/metadata_service_impl/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/metadata_service_impl/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      492 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/metadata_service_impl/auth_lib.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1870 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/metadata_service_impl/request_lib.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      615 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/metadata_service_impl/service_modules.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5408 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/mock_source_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1357 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/offline_store_credentials.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1037 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/pandas_compat.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    16160 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/query_helper.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    20864 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/querytree_api.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.168603 tecton-0.9.3/tecton/_internals/repo/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/repo/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    11416 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/repo/function_serialization.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    12059 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/rewrite.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    18229 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/run_api.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    13055 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/sdk_decorators.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2059 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/secret_resolver.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7119 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/snowflake_api.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7214 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/spark_api.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2996 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/spark_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5615 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/tecton_pydantic.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.168603 tecton-0.9.3/tecton/_internals/tests/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/tests/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      342 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/tests/test_spark_api.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7071 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/time_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3769 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/type_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    14505 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4985 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_internals/validations_api.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      322 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/_stamp.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3067 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/aggregation_functions.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.168603 tecton-0.9.3/tecton/cli/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    26054 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/access_control.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1583 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/api_key.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3083 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/auth.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5469 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/cli.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     8462 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/cli_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5967 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/command.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2027 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/completion.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    18539 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/engine.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1323 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/engine_renderer.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    32013 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/environment.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     8982 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/environment_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7691 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/error_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3759 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/materialization.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      515 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/pex_wrapper.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1786 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/printer.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5135 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/repo.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     9759 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/repo_config.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7739 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/repo_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5011 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/secrets.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5824 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/service_account.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5620 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/test.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2403 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/user.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4917 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/workspace.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2711 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/cli/workspace_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2450 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/fco_listers.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.172603 tecton-0.9.3/tecton/framework/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/framework/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     6920 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/framework/base_tecton_object.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)   119859 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/framework/configs.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    29108 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/framework/data_frame.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    40898 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/framework/data_source.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    13976 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/framework/dataset.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7683 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/framework/entity.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2641 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/framework/feature.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    42636 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/framework/feature_service.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)   229521 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/framework/feature_view.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3854 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/framework/filtered_source.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4922 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/framework/repo_config.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    21258 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/framework/transformation.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2071 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/framework/utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2091 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/framework/validation_mode.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    22520 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/framework/workspace.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.172603 tecton-0.9.3/tecton/identities/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/identities/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1521 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/identities/api_keys.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    14640 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/identities/credentials.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    12333 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/identities/okta.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2374 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/pytest_tecton.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      381 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/run_api_consts.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      709 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/snowflake_context.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2747 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/tecton_context.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     6326 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/types.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.172603 tecton-0.9.3/tecton/vendor/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/__init__.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.172603 tecton-0.9.3/tecton/vendor/dill/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/dill/__init__.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.176603 tecton-0.9.3/tecton/vendor/dill/dill/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7211 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/dill/dill/__diff.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3634 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/dill/dill/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    54753 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/dill/dill/_dill.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    20428 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/dill/dill/_objects.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    11822 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/dill/dill/detect.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7444 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/dill/dill/info.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      755 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/dill/dill/objtypes.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4467 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/dill/dill/pointers.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      719 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/dill/dill/settings.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    44906 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/dill/dill/source.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     8238 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/dill/dill/temp.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.176603 tecton-0.9.3/tecton/vendor/pyspark/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/__init__.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.176603 tecton-0.9.3/tecton/vendor/pyspark/py4j/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      111 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/py4j/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    26941 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/py4j/clientserver.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2329 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/py4j/compat.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4306 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/py4j/finalizer.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    18289 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/py4j/java_collections.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    96550 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/py4j/java_gateway.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    14805 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/py4j/protocol.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4361 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/py4j/signals.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)       23 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/py4j/version.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.180604 tecton-0.9.3/tecton/vendor/pyspark/pyspark/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4777 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2282 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/_globals.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     9940 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/accumulators.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7386 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/broadcast.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.180604 tecton-0.9.3/tecton/vendor/pyspark/pyspark/cloudpickle/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      201 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/cloudpickle/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    30084 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/cloudpickle/cloudpickle.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    29668 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/cloudpickle/cloudpickle_fast.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      354 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/cloudpickle/compat.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7831 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/conf.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    54613 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/context.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7619 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/daemon.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1891 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/files.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3969 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/find_spark_home.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     6654 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/install.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    10025 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/java_gateway.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3994 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/join.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.180604 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1530 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    10846 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/base.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)   126616 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/classification.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    62498 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/clustering.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4294 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/common.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    34149 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/evaluation.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)   212823 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/feature.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    17053 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/fpm.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4603 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/functions.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     8092 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/image.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.180604 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/linalg/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    39791 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/linalg/__init__.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.184604 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/param/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    18532 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/param/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     9556 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/param/_shared_params_code_gen.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    22295 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/param/shared.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    13656 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/pipeline.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    23213 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/recommendation.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    91533 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/regression.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    18317 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/stat.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    13108 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/tree.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    57402 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/tuning.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    22016 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/util.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    15371 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/wrapper.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.184604 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1372 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    28695 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/classification.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    39889 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/clustering.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4976 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/common.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    20443 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/evaluation.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    28134 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/feature.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7028 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/fpm.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.184604 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/linalg/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    46744 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/linalg/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    57731 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/linalg/distributed.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    19517 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/random.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    12101 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/recommendation.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    32842 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/regression.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.184604 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/stat/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1969 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/stat/KernelDensity.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1309 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/stat/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    14081 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/stat/_statistics.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1289 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/stat/distribution.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2301 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/stat/test.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    25342 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/tree.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    21149 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/util.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5755 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/profiler.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.184604 tecton-0.9.3/tecton/vendor/pyspark/pyspark/python/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/python/__init__.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.184604 tecton-0.9.3/tecton/vendor/pyspark/pyspark/python/pyspark/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/python/pyspark/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2473 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/python/pyspark/shell.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)   109373 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/rdd.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4250 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/rddsampler.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.184604 tecton-0.9.3/tecton/vendor/pyspark/pyspark/resource/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1317 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/resource/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1590 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/resource/information.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7097 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/resource/profile.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    10946 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/resource/requests.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1224 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/resultiterable.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    20586 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/serializers.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2473 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/shell.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    27959 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/shuffle.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.188604 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2590 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/__init__.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.188604 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/avro/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      809 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/avro/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5993 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/avro/functions.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    12110 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/catalog.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    29664 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/column.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2999 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/conf.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    23884 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/context.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    99829 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/dataframe.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)   157099 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/functions.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    10681 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/group.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.188604 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/pandas/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      959 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/pandas/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    21251 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/pandas/conversion.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    28130 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/pandas/functions.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    14683 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/pandas/group_ops.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3806 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/pandas/map_ops.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    12308 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/pandas/serializers.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     6324 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/pandas/typehints.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    13225 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/pandas/types.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2745 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/pandas/utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    77056 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/readwriter.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    31188 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/session.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    69121 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/streaming.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    55203 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/types.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    20068 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/udf.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     6976 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    12863 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/window.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5149 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/statcounter.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3756 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/status.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2785 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/storagelevel.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.188604 tecton-0.9.3/tecton/vendor/pyspark/pyspark/streaming/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1007 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/streaming/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    16448 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/streaming/context.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    27879 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/streaming/dstream.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5436 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/streaming/kinesis.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2333 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/streaming/listener.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5614 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/streaming/util.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     9189 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/taskcontext.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2679 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/traceback_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    11623 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/util.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)       20 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/version.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    27875 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/pyspark/pyspark/worker.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1334 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/vendor_dill.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1448 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/vendor/vendor_pyspark.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1154 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton/version.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.164602 tecton-0.9.3/tecton.egg-info/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3952 2024-05-10 18:29:50.000000 tecton-0.9.3/tecton.egg-info/PKG-INFO
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    23011 2024-05-10 18:29:50.000000 tecton-0.9.3/tecton.egg-info/SOURCES.txt
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        1 2024-05-10 18:29:50.000000 tecton-0.9.3/tecton.egg-info/dependency_links.txt
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)       96 2024-05-10 18:29:50.000000 tecton-0.9.3/tecton.egg-info/entry_points.txt
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1128 2024-05-10 18:29:50.000000 tecton-0.9.3/tecton.egg-info/requires.txt
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      120 2024-05-10 18:29:50.000000 tecton-0.9.3/tecton.egg-info/top_level.txt
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.192604 tecton-0.9.3/tecton_athena/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_athena/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    14977 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_athena/athena_session.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     8797 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_athena/data_catalog_helper.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5708 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_athena/odfv_helper.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.192604 tecton-0.9.3/tecton_athena/query/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_athena/query/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2381 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_athena/query/translate.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    17721 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_athena/sql_helper.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.192604 tecton-0.9.3/tecton_athena/templates/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_athena/templates/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1956 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_athena/templates/create_table.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      267 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_athena/templates/data_source.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     9544 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_athena/templates/historical_features.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      672 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_athena/templates/materialization_tile.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3975 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_athena/templates/run_full_aggregation.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      503 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_athena/templates/run_partial_aggregation.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1046 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_athena/templates/time_limit.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      277 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_athena/templates/transformation_pipeline.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      656 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_athena/templates_utils.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.196605 tecton-0.9.3/tecton_core/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)       17 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/_gen_version.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    13149 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/aggregation_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1598 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/arrow.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1956 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/aws_credentials.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3464 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/compute_mode.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    24797 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/conf.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7234 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/data_types.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3981 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/duckdb_context.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.196605 tecton-0.9.3/tecton_core/embeddings/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/embeddings/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      302 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/embeddings/config.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7404 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/errors.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5113 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/fco_container.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    27600 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/feature_definition_wrapper.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     9838 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/feature_set_config.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      749 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/feature_view_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      302 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/filter_context.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2507 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/function_deserialization.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      739 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/http.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      616 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/id_helper.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      546 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/iterators.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7440 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/materialization_context.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.196605 tecton-0.9.3/tecton_core/metadata_service_impl/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/metadata_service_impl/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      195 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/metadata_service_impl/base_stub.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2665 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/metadata_service_impl/error_lib.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3488 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/metadata_service_impl/http_client.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      901 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/metadata_service_impl/providers.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1990 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/metadata_service_impl/response.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2273 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/metadata_service_impl/service_calls.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      206 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/metadata_service_impl/trace.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    20281 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/offline_store.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1427 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/online_serving_index.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7766 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/pipeline_common.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.200605 tecton-0.9.3/tecton_core/query/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    22026 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/aggregation_plans.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    56183 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/builder.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5286 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/compaction_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      179 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/dialect.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.200605 tecton-0.9.3/tecton_core/query/duckdb/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/duckdb/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    10983 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/duckdb/compute.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7820 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/duckdb/nodes.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      714 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/duckdb/rewrite.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1526 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/errors.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      746 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/executor_params.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1735 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/executor_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    10749 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/node_interface.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7303 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/node_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)   126322 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/nodes.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.200605 tecton-0.9.3/tecton_core/query/pandas/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/pandas/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3556 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/pandas/compute.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4033 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/pandas/node.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    21975 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/pandas/nodes.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     6169 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/pandas/pipeline_helper.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5054 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/pandas/rewrite.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      192 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/pandas/sql.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1948 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/pandas/translate.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5944 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/pipeline_sql_builder.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      786 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/prefixed_uri_resolver.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4204 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/query_tree_compute.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    21774 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/query_tree_executor.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      227 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/rewrite.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.200605 tecton-0.9.3/tecton_core/query/snowflake/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/snowflake/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    12630 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/snowflake/compute.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    20202 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query/sql_compat.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3294 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/query_consts.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5280 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/repo_file_handler.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      867 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/request_context.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3149 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/schema.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    11989 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/schema_derivation_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5597 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/schema_validation.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1063 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/secrets.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2126 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/snowflake_context.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.200605 tecton-0.9.3/tecton_core/specs/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      777 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/specs/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    44686 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/specs/data_source_spec.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1457 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/specs/entity_spec.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5460 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/specs/feature_service_spec.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    43407 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/specs/feature_view_spec.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4440 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/specs/tecton_object_spec.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     9179 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/specs/time_window_spec.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2440 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/specs/transformation_spec.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4952 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/specs/utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     9725 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/time_utils.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.200605 tecton-0.9.3/tecton_core/vendor/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/vendor/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     9361 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/vendor/queue.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.200605 tecton-0.9.3/tecton_core/vendor/treelib/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1594 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/vendor/treelib/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      943 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/vendor/treelib/exceptions.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1575 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/vendor/treelib/misc.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     9595 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/vendor/treelib/node.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1265 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/vendor/treelib/plugins.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    37469 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/vendor/treelib/tree.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1275 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_core/vendor/vendor_treelib.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.204605 tecton-0.9.3/tecton_materialization/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      718 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    23147 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/batch_materialization.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.204605 tecton-0.9.3/tecton_materialization/common/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/common/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2835 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/common/job_metadata.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5803 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/common/job_metadata_aws.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2222 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/common/job_metadata_gcp.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2693 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/common/task_params.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4811 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/consumption.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1070 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/delta_maintenance.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3731 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/entity_deletion.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5200 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/feature_export.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5090 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/ingest_materialization.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7159 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/job_metadata.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     9316 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/materialization.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7780 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/materialization_utils.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.204605 tecton-0.9.3/tecton_materialization/ray/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/ray/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5242 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/ray/batch_materialization.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    23853 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/ray/delta.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5973 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/ray/feature_export.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5009 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/ray/ingest_materialization.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     6869 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/ray/job_status.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    10181 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/ray/materialization.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4190 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/ray/materialization_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3172 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/ray/nodes.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.204605 tecton-0.9.3/tecton_materialization/remote_host/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/remote_host/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    20100 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/remote_host/pyspark_remote_host.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1996 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/secrets.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     6666 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_materialization/stream_materialization.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.204605 tecton-0.9.3/tecton_proto/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/__init__.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.204605 tecton-0.9.3/tecton_proto/amplitude/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/amplitude/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4642 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/amplitude/amplitude_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3093 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/amplitude/client_logging_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.204605 tecton-0.9.3/tecton_proto/api/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/api/__init__.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.204605 tecton-0.9.3/tecton_proto/api/featureservice/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/api/featureservice/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    81835 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/api/featureservice/feature_service_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     9573 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/api/featureservice/feature_service_request_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.208606 tecton-0.9.3/tecton_proto/args/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/args/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2864 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/args/basic_info_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1897 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/args/data_source_config_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    21536 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/args/data_source_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3996 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/args/diff_options_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     6990 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/args/diff_test_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3059 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/args/entity_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2415 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/args/fco_args_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5172 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/args/feature_service_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    41778 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/args/feature_view_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     6092 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/args/pipeline_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1694 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/args/repo_metadata_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4704 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/args/transformation_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1637 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/args/user_defined_function_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1893 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/args/version_constraints_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     8163 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/args/virtual_data_source_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.208606 tecton-0.9.3/tecton_proto/auditlog/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/auditlog/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2716 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/auditlog/metadata_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.208606 tecton-0.9.3/tecton_proto/auth/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/auth/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1422 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/auth/acl_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    29023 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/auth/authorization_service_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3224 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/auth/principal_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     6551 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/auth/resource_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3058 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/auth/resource_role_assignments_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3058 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/auth/service_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.208606 tecton-0.9.3/tecton_proto/canary/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/canary/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1208 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/canary/type_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2195 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/canary/update_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.208606 tecton-0.9.3/tecton_proto/cli/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/cli/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3075 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/cli/repo_diff_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.212606 tecton-0.9.3/tecton_proto/common/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/common/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3459 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/common/aggregation_function_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1717 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/common/analytics_options_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1823 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/common/aws_credentials_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1672 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/common/column_type_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1336 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/common/compute_mode_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1934 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/common/container_image_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1373 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/common/data_source_type_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2431 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/common/data_type_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1735 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/common/fco_locator_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1286 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/common/framework_version_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1725 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/common/id_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1150 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/common/pair_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1368 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/common/schema_container_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2819 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/common/schema_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1518 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/common/secret_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1381 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/common/spark_schema_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2183 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/common/time_window_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.212606 tecton-0.9.3/tecton_proto/consumption/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/consumption/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5600 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/consumption/consumption_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.216606 tecton-0.9.3/tecton_proto/data/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7900 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/batch_data_source_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2313 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/entity_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2848 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/fco_metadata_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2916 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/fco_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5025 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/feature_service_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1487 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/feature_store_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    20207 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/feature_view_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2121 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/freshness_status_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4810 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/fv_materialization_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1366 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/hive_metastore_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1975 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/internal_spark_cluster_status_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1683 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/materialization_roles_allowlists_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5831 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/materialization_status_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1752 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/odfv_compute_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2317 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/onboarding_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2614 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/principal_group_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     6827 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/remote_compute_environment_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    15757 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/remote_spark_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3468 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/saved_feature_data_frame_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4545 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/serving_status_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    10895 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/state_update_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4799 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/stream_data_source_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1828 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/summary_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2349 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/tecton_api_key_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2795 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/transformation_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    10456 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/user_deployment_settings_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1650 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/user_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3433 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/virtual_data_source_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2355 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/data/workspace_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.216606 tecton-0.9.3/tecton_proto/databricks_api/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/databricks_api/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     8276 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/databricks_api/clusters_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1889 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/databricks_api/dbfs_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1276 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/databricks_api/error_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3593 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/databricks_api/execution_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1501 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/databricks_api/instance_profiles_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     8112 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/databricks_api/jobs_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1912 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/databricks_api/libraries_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2911 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/databricks_api/permissions_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1253 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/databricks_api/scim_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2391 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/databricks_api/secrets_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2613 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/databricks_api/workspace_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.216606 tecton-0.9.3/tecton_proto/dataobs/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/dataobs/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2490 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/dataobs/config_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2553 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/dataobs/expectation_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3691 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/dataobs/metric_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5748 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/dataobs/validation_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3723 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/dataobs/validation_task_params_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4629 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/dataobs/validation_task_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.216606 tecton-0.9.3/tecton_proto/feature_server/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/feature_server/__init__.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.216606 tecton-0.9.3/tecton_proto/feature_server/configuration/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/feature_server/configuration/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    19997 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/feature_server/configuration/feature_server_configuration_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.216606 tecton-0.9.3/tecton_proto/materialization/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/materialization/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     9821 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/materialization/job_metadata_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2610 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/materialization/materialization_states_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    14634 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/materialization/materialization_task_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     8173 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/materialization/params_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2752 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/materialization/spark_cluster_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.216606 tecton-0.9.3/tecton_proto/materializationjobservice/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/materializationjobservice/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    16111 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/materializationjobservice/materialization_job_service_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.216606 tecton-0.9.3/tecton_proto/metadataservice/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/metadataservice/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2776 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/metadataservice/http_over_grpc_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)   121489 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/metadataservice/metadata_service_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.220607 tecton-0.9.3/tecton_proto/offlinestore/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/offlinestore/__init__.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.220607 tecton-0.9.3/tecton_proto/offlinestore/delta/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/offlinestore/delta/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1570 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/offlinestore/delta/metadata_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     6554 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/offlinestore/delta/transaction_writer_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.220607 tecton-0.9.3/tecton_proto/online_store/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/online_store/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5408 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/online_store/feature_value_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1306 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/online_store/status_entry_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.220607 tecton-0.9.3/tecton_proto/online_store_writer/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/online_store_writer/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2401 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/online_store_writer/config_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5522 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/online_store_writer/copier_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.220607 tecton-0.9.3/tecton_proto/remoteenvironmentservice/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/remoteenvironmentservice/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    13213 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/remoteenvironmentservice/remote_environment_service_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.220607 tecton-0.9.3/tecton_proto/secrets/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/secrets/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    10485 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/secrets/secrets_service_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.220607 tecton-0.9.3/tecton_proto/snowflake/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/snowflake/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1246 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/snowflake/location_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1392 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/snowflake/snowflake_credentials_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.220607 tecton-0.9.3/tecton_proto/spark_api/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/spark_api/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1195 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/spark_api/error_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7388 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/spark_api/jobs_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.220607 tecton-0.9.3/tecton_proto/spark_common/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/spark_common/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7786 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/spark_common/clusters_pb2.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2386 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/spark_common/libraries_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.220607 tecton-0.9.3/tecton_proto/testhelperservice/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/testhelperservice/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3516 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/testhelperservice/test_helper_service_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.220607 tecton-0.9.3/tecton_proto/validation/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/validation/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     4609 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_proto/validation/validator_pb2.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.220607 tecton-0.9.3/tecton_snowflake/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    30085 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/pipeline_helper.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.224607 tecton-0.9.3/tecton_snowflake/query/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/query/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    10160 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/query/aggregation_plans.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      806 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/query/dataframe_helper.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    13676 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/query/nodes.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     6314 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/query/queries.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      741 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/query/rewrite.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3704 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/query/translate.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     8392 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/schema_derivation_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2246 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/snowflake_type_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    33774 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/sql_helper.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.224607 tecton-0.9.3/tecton_snowflake/templates/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/templates/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1025 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/templates/copier_macro.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      396 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/templates/create_temp_table_for_bfv.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      363 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/templates/create_temp_table_for_bwafv.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      255 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/templates/data_source.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1248 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/templates/delete_orphaned_schemas.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      698 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/templates/delete_staged_files.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3069 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/templates/historical_features.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7892 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/templates/historical_features_macros.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1795 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/templates/materialization_tile.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2575 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/templates/materialized_feature_view.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      937 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/templates/offline_materialization_macros.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      126 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/templates/online_store_copier.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     6777 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/templates/run_full_aggregation.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      583 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/templates/run_partial_aggregation.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      569 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/templates/time_limit.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      213 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/templates/transformation_pipeline.sql
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      806 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/templates_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      249 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_snowflake/utils.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.228607 tecton-0.9.3/tecton_spark/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      808 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    30278 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/aggregation_plans.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2263 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/data_observability.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      926 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/data_source_credentials.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    35732 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/data_source_helper.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      425 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/errors_spark.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     6470 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/feature_view_spark_utils.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.228607 tecton-0.9.3/tecton_spark/jars/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/jars/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2633 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/jars/class_loader.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)  1794322 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/jars/tecton-udfs-spark-3.jar
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7182 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/materialization_plan.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    27440 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/offline_store.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    15491 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/partial_aggregations.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    33450 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/pipeline_helper.py
+drwxr-xr-x   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:52.228607 tecton-0.9.3/tecton_spark/query/
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)        0 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/query/__init__.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3356 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/query/data_source.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    10751 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/query/filter.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    37167 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/query/join.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1515 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/query/node.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     7583 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/query/pipeline.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    14752 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/query/projection.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    10712 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/query/translate.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)    17838 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/schema_derivation_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5434 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/schema_spark_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     2317 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/spark_helper.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     1697 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/spark_schema_wrapper.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     5028 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/time_utils.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      880 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/type_annotations.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)      393 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/udf_jar.py
+-rw-r--r--   0 nobody   (65534) nogroup  (65534)     3257 2024-05-10 18:29:48.000000 tecton-0.9.3/tecton_spark/udfs.py
```

### Comparing `tecton-0.9.2/PKG-INFO` & `tecton-0.9.3/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: tecton
-Version: 0.9.2
+Version: 0.9.3
 Summary: Tecton Python SDK
 Home-page: https://tecton.ai
 Author: Tecton, Inc.
 Author-email: support@tecton.ai
 License: Tecton Proprietary
 Classifier: Programming Language :: Python :: 3
 Classifier: Operating System :: OS Independent
```

### Comparing `tecton-0.9.2/README.md` & `tecton-0.9.3/README.md`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/protoc_gen_openapiv2/options/annotations_pb2.py` & `tecton-0.9.3/protoc_gen_openapiv2/options/annotations_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/protoc_gen_openapiv2/options/openapiv2_pb2.py` & `tecton-0.9.3/protoc_gen_openapiv2/options/openapiv2_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/setup.py` & `tecton-0.9.3/setup.py`

 * *Files 0% similar despite different names*

```diff
@@ -22,14 +22,14 @@
     author_email='support@tecton.ai',
     url='https://tecton.ai',
     license='Tecton Proprietary',
     include_package_data=True,
     description='Tecton Python SDK',
     entry_points={'console_scripts': ['tecton=tecton.cli.cli:main'], 'pytest11': ['pytest_tecton=tecton.pytest_tecton']},
     name='tecton',
-    version='0.9.2',
+    version='0.9.3',
     long_description=long_description,
     long_description_content_type='text/markdown',
     install_requires=['attrs>=21.3.0', 'boto3', 'googleapis-common-protos<2,>=1.57.0', 'jinja2~=3.0', 'numpy~=1.16', 'pathspec', 'pendulum~=2.1', 'protobuf>=3.20.0', 'pypika~=0.48.9', 'pytimeparse', 'pandas>=1.0', 'texttable', 'requests', 'colorama~=0.4', 'tqdm~=4.41', 'yaspin<3,>=0.16', 'typing-extensions~=4.1', 'pygments>=2.7.4', 'pytest', 'click~=8.0', 'typeguard~=2.0', 'sqlparse', 'semantic_version', 'pyarrow<15,>=8', 'pydantic<3,>=1.10.13', 'pyyaml', 'setuptools', 'pip', 'pex~=2.1'],
     extras_require={'databricks-connect': ['databricks-connect[sql]~=10.4.12'], 'databricks-connect9': ['databricks-connect[sql]~=9.1.23'], 'databricks-connect10': ['databricks-connect[sql]~=10.4.12'], 'databricks-connect11': ['databricks-connect[sql]~=11.3.12'], 'pyspark': ['pyspark[sql]~=3.2.1'], 'pyspark3': ['pyspark[sql]~=3.2.1'], 'pyspark3.1': ['pyspark[sql]~=3.1.2'], 'pyspark3.2': ['pyspark[sql]~=3.2.1'], 'pyspark3.3': ['pyspark[sql]~=3.3.2'], 'rift': ['duckdb==0.10.0', 'deltalake~=0.15', 'pyarrow>=11.0.0'], 'rift-materialization': ['duckdb==0.10.0', 'deltalake~=0.15', 'pyarrow>=11.0.0', 'snowflake-connector-python[pandas]~=3.6', 'snowflake-snowpark-python[pandas]~=1.0', 'pydantic<2', 'urllib3<1.27'], 'snowflake': ['snowflake-snowpark-python[pandas]~=1.0'], 'athena': ['awswrangler~=3.0'], 'materialization': ['statsd==3.3.0', 'urllib3<2.0.0']},
     packages=packages,
 )
```

### Comparing `tecton-0.9.2/tecton/__init__.py` & `tecton-0.9.3/tecton/__init__.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/analytics.py` & `tecton-0.9.3/tecton/_internals/analytics.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/athena_api.py` & `tecton-0.9.3/tecton/_internals/athena_api.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/data_frame_helper.py` & `tecton-0.9.3/tecton/_internals/data_frame_helper.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/delete_keys_api.py` & `tecton-0.9.3/tecton/_internals/delete_keys_api.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/display.py` & `tecton-0.9.3/tecton/_internals/display.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/env_utils.py` & `tecton-0.9.3/tecton/_internals/env_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/errors.py` & `tecton-0.9.3/tecton/_internals/errors.py`

 * *Files 1% similar despite different names*

```diff
@@ -594,14 +594,18 @@
     "get_partial_aggregates() is only supported for Feature Views with Tecton Managed Aggregations."
 )
 
 GET_PARTIAL_AGGREGATES_UNSUPPORTED_COMPACTED = TectonValidationError(
     "get_partial_aggregates() is only supported for Aggregate Feature Views with Compaction Disabled."
 )
 
+GET_PARTIAL_AGGREGATES_UNSUPPORTED_CONTINUOUS = TectonValidationError(
+    'Tecton does not create partial aggregates for Feature Views with "Continuous" Stream Processing Mode.'
+)
+
 RUN_TRANSFORMATION_UNSUPPORTED = TectonValidationError(
     "run_transformation() for Batch and Stream Feature Views is only supported for SPARK and RIFT Compute Modes."
 )
 
 
 def READ_API_DEPRECATION_TEMPLATE(old_method, new_method):
     return f"{old_method}() has been deprecated in Tecton 0.9 and will be fully removed in the next major SDK release. Please use {new_method}() instead. See https://docs.tecton.ai/docs/reading-feature-data/reading-feature-data-for-training/offline-retrieval-methods for more information."
```

### Comparing `tecton-0.9.2/tecton/_internals/find_spark.py` & `tecton-0.9.3/tecton/_internals/find_spark.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/ingest_utils.py` & `tecton-0.9.3/tecton/_internals/ingest_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/ingestion.py` & `tecton-0.9.3/tecton/_internals/ingestion.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/materialization_api.py` & `tecton-0.9.3/tecton/_internals/materialization_api.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/metadata_service.py` & `tecton-0.9.3/tecton/_internals/metadata_service.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/metadata_service_impl/request_lib.py` & `tecton-0.9.3/tecton/_internals/metadata_service_impl/request_lib.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/metadata_service_impl/service_modules.py` & `tecton-0.9.3/tecton/_internals/metadata_service_impl/service_modules.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/mock_source_utils.py` & `tecton-0.9.3/tecton/_internals/mock_source_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/offline_store_credentials.py` & `tecton-0.9.3/tecton/_internals/offline_store_credentials.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/pandas_compat.py` & `tecton-0.9.3/tecton/_internals/pandas_compat.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/query_helper.py` & `tecton-0.9.3/tecton/_internals/query_helper.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/querytree_api.py` & `tecton-0.9.3/tecton/_internals/querytree_api.py`

 * *Files 1% similar despite different names*

```diff
@@ -109,17 +109,15 @@
     compute_mode: ComputeMode,
     feature_definition: FeatureDefinitionWrapper,
     start_time: Union[pendulum.DateTime, datetime],
     end_time: Union[pendulum.DateTime, datetime],
     max_lookback: Optional[timedelta],
     entities: Optional[Union[pyspark_sql.DataFrame, pd.DataFrame, TectonDataFrame]],
     from_source: Optional[bool],
-    save: bool,
-    save_as: Optional[str],
-    mock_data_sources: Dict[str, pyspark_sql.DataFrame],
+    mock_data_sources: Dict[str, NodeRef],
 ) -> TectonDataFrame:
     if not feature_definition.is_on_demand:
         check_spark_version(feature_definition.fv_spec.batch_cluster_config)
 
     if entities is not None:
         if not isinstance(entities, TectonDataFrame):
             entities = TectonDataFrame._create(entities)
@@ -160,34 +158,26 @@
             entities=entities,
         )
 
     rewrite.MockDataRewrite(mock_data_sources).rewrite(qt)
 
     df = TectonDataFrame._create(qt)
 
-    if save or save_as is not None:
-        return Dataset._create(
-            df=df,
-            save_as=save_as,
-            workspace=feature_definition.workspace,
-            feature_definition_id=feature_definition.id,
-            spine=None,
-        )
     return df
 
 
 def get_partial_aggregates(
     dialect: Dialect,
     compute_mode: ComputeMode,
     feature_definition: FeatureDefinitionWrapper,
     start_time: Union[pendulum.DateTime, datetime],
     end_time: Union[pendulum.DateTime, datetime],
     entities: Optional[TectonDataFrame],
     from_source: Optional[bool],
-    mock_data_sources: Dict[str, pyspark_sql.DataFrame],
+    mock_data_sources: Dict[str, NodeRef],
 ) -> TectonDataFrame:
     check_spark_version(feature_definition.fv_spec.batch_cluster_config)
 
     start_time = pendulum.instance(start_time)
     if feature_definition.feature_start_timestamp is not None:
         start_time = max(start_time, feature_definition.feature_start_timestamp)
 
@@ -219,15 +209,15 @@
     compute_mode: ComputeMode,
     feature_definition: FeatureDefinitionWrapper,
     spine: Optional[Union[pyspark_sql.DataFrame, pd.DataFrame, TectonDataFrame, str]],
     timestamp_key: Optional[str],
     from_source: Optional[bool],
     save: bool,
     save_as: Optional[str],
-    mock_data_sources: Dict[str, pyspark_sql.DataFrame],
+    mock_data_sources: Dict[str, NodeRef],
 ):
     if not feature_definition.is_on_demand:
         check_spark_version(feature_definition.fv_spec.batch_cluster_config)
 
     _validate_sql_string_support(dialect, spine)
 
     if _should_infer_timestamp_of_spine(feature_definition, timestamp_key):
@@ -266,15 +256,15 @@
     timestamp_key: Optional[str],
     start_time: Optional[Union[pendulum.DateTime, datetime]],
     end_time: Optional[Union[pendulum.DateTime, datetime]],
     entities: Optional[Union[pyspark_sql.DataFrame, pd.DataFrame, TectonDataFrame]],
     from_source: Optional[bool],
     save: bool,
     save_as: Optional[str],
-    mock_data_sources: Dict[str, pyspark_sql.DataFrame],
+    mock_data_sources: Dict[str, NodeRef],
 ) -> TectonDataFrame:
     if not feature_definition.is_on_demand:
         check_spark_version(feature_definition.fv_spec.batch_cluster_config)
 
     if spine is not None:
         logger.warning(errors.GET_HISTORICAL_FEATURES_DEPRECATED_SPINE)
```

### Comparing `tecton-0.9.2/tecton/_internals/repo/function_serialization.py` & `tecton-0.9.3/tecton/_internals/repo/function_serialization.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/rewrite.py` & `tecton-0.9.3/tecton/_internals/rewrite.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/run_api.py` & `tecton-0.9.3/tecton/_internals/run_api.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,24 +1,26 @@
 import logging
 import tempfile
 from datetime import datetime
 from typing import Any
 from typing import Dict
 from typing import Optional
+from typing import Tuple
 from typing import Union
 
 import pandas
 import pendulum
 from pyspark.sql import DataFrame
 from pyspark.sql.streaming import StreamingQuery
 
 import tecton
 from tecton._internals import errors
 from tecton._internals import mock_source_utils
 from tecton._internals.rewrite import MockDataRewrite
+from tecton.framework import transformation as framework_transformation
 from tecton.framework.data_frame import TectonDataFrame
 from tecton.run_api_consts import AGGREGATION_LEVEL_DISABLED
 from tecton.run_api_consts import AGGREGATION_LEVEL_FULL
 from tecton.run_api_consts import AGGREGATION_LEVEL_PARTIAL
 from tecton.run_api_consts import DEFAULT_AGGREGATION_TILES_WINDOW_END_COLUMN_NAME
 from tecton.run_api_consts import DEFAULT_AGGREGATION_TILES_WINDOW_START_COLUMN_NAME
 from tecton.run_api_consts import SUPPORTED_AGGREGATION_LEVEL_VALUES
@@ -35,14 +37,15 @@
 from tecton_core.query.nodes import AddAnchorTimeNode
 from tecton_core.query.nodes import ConvertEpochToTimestampNode
 from tecton_core.query.nodes import RenameColsNode
 from tecton_core.query_consts import anchor_time
 from tecton_core.query_consts import window_end_column_name
 from tecton_core.schema import Schema
 from tecton_proto.args import pipeline_pb2
+from tecton_proto.args.transformation_pb2 import TransformationMode
 from tecton_spark import materialization_plan
 from tecton_spark.partial_aggregations import partial_aggregate_column_renames
 from tecton_spark.pipeline_helper import get_all_input_keys
 from tecton_spark.pipeline_helper import get_fco_ids_to_input_keys
 from tecton_spark.pipeline_helper import run_mock_odfv_pipeline
 from tecton_spark.spark_helper import check_spark_version
 
@@ -220,25 +223,55 @@
             .queryName(output_temp_table)
             .option("checkpointLocation", d)
             .outputMode("update")
             .start()
         )
 
 
+def validate_run_transformation_args_match_transformation_mode(
+    input_data: Dict[str, Union[Dict[str, Any], pandas.DataFrame, DataFrame]], transformation_mode: TransformationMode
+):
+    for key, value in input_data.items():
+        if transformation_mode == TransformationMode.TRANSFORMATION_MODE_PANDAS:
+            if not isinstance(value, pandas.DataFrame) and not isinstance(value, DataFrame):
+                msg = f"Expected input of type DataFrame for key '{key}' in 'pandas' mode, got {type(value).__name__}."
+                raise errors.TectonValidationError(msg)
+        elif transformation_mode == TransformationMode.TRANSFORMATION_MODE_PYTHON:
+            if not isinstance(value, Dict):
+                msg = f"Expected input of type Dict for key '{key}' in 'python' mode, got {type(value).__name__}."
+                raise errors.TectonValidationError(msg)
+
+
+def run_realtime_unvalidated(
+    fv_name: str,
+    mock_inputs: Dict[str, Union[Dict[str, Any], pandas.DataFrame, DataFrame]],
+    transformations: Tuple[framework_transformation.Transformation, ...],
+    pipeline: pipeline_pb2.Pipeline,
+) -> Union[Dict[str, Any], "tecton.framework.data_frame.TectonDataFrame"]:
+    validate_ondemand_mock_inputs_match_expected_shape(mock_inputs, pipeline)
+    transformation_specs = [transformation._create_unvalidated_spec() for transformation in transformations]
+    output = run_mock_odfv_pipeline(pipeline, transformation_specs, fv_name, mock_inputs)
+    if isinstance(output, pandas.DataFrame):
+        output = TectonDataFrame._create(output)
+    return output
+
+
 def run_ondemand(
     fd: FeatureDefinitionWrapper,
     fv_name: str,
     mock_inputs: Dict[str, Union[Dict[str, Any], pandas.DataFrame, DataFrame]],
+    transformation_mode: TransformationMode,
 ) -> Union[Dict[str, Any], "tecton.framework.data_frame.TectonDataFrame"]:
+    validate_run_transformation_args_match_transformation_mode(mock_inputs, transformation_mode)
     for key in mock_inputs:
         if isinstance(mock_inputs[key], DataFrame):
             mock_inputs[key] = mock_inputs[key].toPandas()
 
-    # Validate that all the mock_inputs matchs with FV inputs, and that num rows match across all mock_inputs.
-    validate_ondemand_mock_inputs(mock_inputs, fd.pipeline, fd)
+    # Validate that all the mock_inputs match with FV inputs, and that num rows match across all mock_inputs.
+    validate_ondemand_mock_inputs_match_expected_shape(mock_inputs, fd.pipeline, fd)
 
     # Execute ODFV pipeline to get output DataFrame.
     output = run_mock_odfv_pipeline(
         pipeline=fd.pipeline,
         transformations=fd.transformations,
         name=fv_name,
         mock_inputs=mock_inputs,
@@ -270,15 +303,15 @@
     elif aggregation_level == AGGREGATION_LEVEL_DISABLED:
         logger.warning(errors.RUN_DEPRECATED_TRANSFORMATION)
     elif aggregation_level == AGGREGATION_LEVEL_PARTIAL:
         logger.warning(errors.RUN_DEPRECATED_PARTIAL_AGGS)
 
 
 # Validate that mock_inputs keys are exact match with expected inputs.
-def validate_ondemand_mock_inputs(
+def validate_ondemand_mock_inputs_match_expected_shape(
     mock_inputs: Dict[str, Union[Dict[str, Any], pandas.DataFrame]],
     pipeline: pipeline_pb2.Pipeline,
     odfv_fd: Optional[FeatureDefinitionWrapper] = None,
 ):
     """Validate the mock_inputs for `run` or `test_run` match expected inputs.
 
     If a feature definition is passed, this will additionally check inputs against batch feature view schemas.
```

### Comparing `tecton-0.9.2/tecton/_internals/sdk_decorators.py` & `tecton-0.9.3/tecton/_internals/sdk_decorators.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/secret_resolver.py` & `tecton-0.9.3/tecton/_internals/secret_resolver.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/snowflake_api.py` & `tecton-0.9.3/tecton/_internals/snowflake_api.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/spark_api.py` & `tecton-0.9.3/tecton/_internals/spark_api.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/spark_utils.py` & `tecton-0.9.3/tecton/_internals/spark_utils.py`

 * *Files 4% similar despite different names*

```diff
@@ -54,15 +54,18 @@
         # Sadly, Spark will always attempt to retrieve the driver's local IP
         # even if the "spark.driver.host" conf is set. This will
         # result in an error if Spark's code is unable to retrieve the local IP
         # (which happens in the case of SageMaker notebooks). The only way to override Spark's
         # behavior is by setting the SPARK_LOCAL_IP env variable
         os.environ["SPARK_LOCAL_IP"] = conf.get_or_none("SPARK_DRIVER_LOCAL_IP")
 
-    builder = builder.master("local")
+    # Databricks 14.3 Shared Access Mode has `Spark_REMOTE` set by defaut, which is conflict with master("local")
+    # config.
+    if "SPARK_REMOTE" not in os.environ:
+        builder = builder.master("local")
 
     builder = builder.config("spark.jars", get_udf_jar_path())
 
     # For some reason using the property spark.pyspark.python does not
     # work for this like it should
     os.environ["PYSPARK_PYTHON"] = sys.executable
```

### Comparing `tecton-0.9.2/tecton/_internals/tecton_pydantic.py` & `tecton-0.9.3/tecton/_internals/tecton_pydantic.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/time_utils.py` & `tecton-0.9.3/tecton/_internals/time_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/type_utils.py` & `tecton-0.9.3/tecton/_internals/type_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/utils.py` & `tecton-0.9.3/tecton/_internals/utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/_internals/validations_api.py` & `tecton-0.9.3/tecton/_internals/validations_api.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/aggregation_functions.py` & `tecton-0.9.3/tecton/aggregation_functions.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/access_control.py` & `tecton-0.9.3/tecton/cli/access_control.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/api_key.py` & `tecton-0.9.3/tecton/cli/api_key.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/auth.py` & `tecton-0.9.3/tecton/cli/auth.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/cli.py` & `tecton-0.9.3/tecton/cli/cli.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/cli_utils.py` & `tecton-0.9.3/tecton/cli/cli_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/command.py` & `tecton-0.9.3/tecton/cli/command.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/completion.py` & `tecton-0.9.3/tecton/cli/completion.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/engine.py` & `tecton-0.9.3/tecton/cli/engine.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/engine_renderer.py` & `tecton-0.9.3/tecton/cli/engine_renderer.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/environment.py` & `tecton-0.9.3/tecton/cli/environment.py`

 * *Files 0% similar despite different names*

```diff
@@ -335,15 +335,15 @@
             (
                 i.id,
                 i.name,
                 i.description,
                 RemoteComputeType.Name(i.type).split("_")[-1],
                 RemoteEnvironmentStatus.Name(i.status).split("_")[-1],
                 i.rift_batch_job_environment.tecton_materialization_runtime_version or "N/A",
-                i.realtime_job_environment.tecton_transform_runtime_version or "N/A",
+                i.on_demand_job_environment.tecton_transform_runtime_version or "N/A",
                 _timestamp_to_string(i.created_at),
             )
             for i in environments
         ],
     )
```

### Comparing `tecton-0.9.2/tecton/cli/environment_utils.py` & `tecton-0.9.3/tecton/cli/environment_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/error_utils.py` & `tecton-0.9.3/tecton/cli/error_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/materialization.py` & `tecton-0.9.3/tecton/cli/materialization.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/pex_wrapper.py` & `tecton-0.9.3/tecton/cli/pex_wrapper.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/printer.py` & `tecton-0.9.3/tecton/cli/printer.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/repo.py` & `tecton-0.9.3/tecton/cli/repo.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/repo_config.py` & `tecton-0.9.3/tecton/cli/repo_config.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/repo_utils.py` & `tecton-0.9.3/tecton/cli/repo_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/secrets.py` & `tecton-0.9.3/tecton/cli/secrets.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/service_account.py` & `tecton-0.9.3/tecton/cli/service_account.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/test.py` & `tecton-0.9.3/tecton/cli/test.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/user.py` & `tecton-0.9.3/tecton/cli/user.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/workspace.py` & `tecton-0.9.3/tecton/cli/workspace.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/cli/workspace_utils.py` & `tecton-0.9.3/tecton/cli/workspace_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/fco_listers.py` & `tecton-0.9.3/tecton/fco_listers.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/framework/base_tecton_object.py` & `tecton-0.9.3/tecton/framework/base_tecton_object.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/framework/configs.py` & `tecton-0.9.3/tecton/framework/configs.py`

 * *Files 1% similar despite different names*

```diff
@@ -174,7308 +174,7319 @@
 00000ad0: 3420 3d20 2231 302e 342e 782d 7363 616c  4 = "10.4.x-scal
 00000ae0: 6132 2e31 3222 0a20 2020 2044 6272 3131  a2.12".    Dbr11
 00000af0: 5f33 203d 2022 3131 2e33 2e78 2d73 6361  _3 = "11.3.x-sca
 00000b00: 6c61 322e 3132 220a 2020 2020 4462 7231  la2.12".    Dbr1
 00000b10: 325f 3220 3d20 2231 322e 322e 782d 7363  2_2 = "12.2.x-sc
 00000b20: 616c 6132 2e31 3222 0a20 2020 2044 6272  ala2.12".    Dbr
 00000b30: 3133 5f33 203d 2022 3133 2e33 2e78 2d73  13_3 = "13.3.x-s
-00000b40: 6361 6c61 322e 3132 220a 0a0a 4445 4641  cala2.12"...DEFA
-00000b50: 554c 545f 5350 4152 4b5f 5645 5253 494f  ULT_SPARK_VERSIO
-00000b60: 4e53 203d 207b 0a20 2020 2022 6461 7461  NS = {.    "data
-00000b70: 6272 6963 6b73 5f73 7061 726b 5f76 6572  bricks_spark_ver
-00000b80: 7369 6f6e 223a 2053 7061 726b 5665 7273  sion": SparkVers
-00000b90: 696f 6e73 2e44 6272 3131 5f33 2c0a 2020  ions.Dbr11_3,.  
-00000ba0: 2020 2265 6d72 5f73 7061 726b 5f76 6572    "emr_spark_ver
-00000bb0: 7369 6f6e 223a 2053 7061 726b 5665 7273  sion": SparkVers
-00000bc0: 696f 6e73 2e45 6d72 365f 395f 312c 0a7d  ions.Emr6_9_1,.}
-00000bd0: 0a45 4d52 5f53 5550 504f 5254 4544 5f53  .EMR_SUPPORTED_S
-00000be0: 5041 524b 203d 207b 0a20 2020 2053 7061  PARK = {.    Spa
-00000bf0: 726b 5665 7273 696f 6e73 2e45 6d72 365f  rkVersions.Emr6_
-00000c00: 352c 0a20 2020 2053 7061 726b 5665 7273  5,.    SparkVers
-00000c10: 696f 6e73 2e45 6d72 365f 372c 0a20 2020  ions.Emr6_7,.   
-00000c20: 2053 7061 726b 5665 7273 696f 6e73 2e45   SparkVersions.E
-00000c30: 6d72 365f 392c 0a20 2020 2053 7061 726b  mr6_9,.    Spark
-00000c40: 5665 7273 696f 6e73 2e45 6d72 365f 395f  Versions.Emr6_9_
-00000c50: 312c 0a20 2020 2053 7061 726b 5665 7273  1,.    SparkVers
-00000c60: 696f 6e73 2e45 6d72 365f 3132 2c0a 2020  ions.Emr6_12,.  
-00000c70: 2020 5370 6172 6b56 6572 7369 6f6e 732e    SparkVersions.
-00000c80: 456d 7237 5f30 2c0a 7d0a 4441 5441 4252  Emr7_0,.}.DATABR
-00000c90: 4943 4b53 5f53 5550 504f 5254 4544 5f53  ICKS_SUPPORTED_S
-00000ca0: 5041 524b 203d 207b 0a20 2020 2053 7061  PARK = {.    Spa
-00000cb0: 726b 5665 7273 696f 6e73 2e44 6272 395f  rkVersions.Dbr9_
-00000cc0: 312c 0a20 2020 2053 7061 726b 5665 7273  1,.    SparkVers
-00000cd0: 696f 6e73 2e44 6272 3130 5f34 2c0a 2020  ions.Dbr10_4,.  
-00000ce0: 2020 5370 6172 6b56 6572 7369 6f6e 732e    SparkVersions.
-00000cf0: 4462 7231 315f 332c 0a20 2020 2053 7061  Dbr11_3,.    Spa
-00000d00: 726b 5665 7273 696f 6e73 2e44 6272 3132  rkVersions.Dbr12
-00000d10: 5f32 2c0a 2020 2020 5370 6172 6b56 6572  _2,.    SparkVer
-00000d20: 7369 6f6e 732e 4462 7231 335f 332c 0a7d  sions.Dbr13_3,.}
-00000d30: 0a0a 5445 4354 4f4e 5f43 4f4d 5055 5445  ..TECTON_COMPUTE
-00000d40: 5f44 4546 4155 4c54 5320 3d20 7b22 7465  _DEFAULTS = {"te
-00000d50: 6374 6f6e 5f63 6f6d 7075 7465 5f69 6e73  cton_compute_ins
-00000d60: 7461 6e63 655f 7479 7065 223a 2022 6d36  tance_type": "m6
-00000d70: 612e 3278 6c61 7267 6522 7d0a 0a0a 2320  a.2xlarge"}...# 
-00000d80: 4b65 6570 2075 702d 746f 2d64 6174 6520  Keep up-to-date 
-00000d90: 7769 7468 2055 6e69 7479 4361 7461 6c6f  with UnityCatalo
-00000da0: 6741 6363 6573 734d 6f64 6520 6672 6f6d  gAccessMode from
-00000db0: 2074 6563 746f 6e5f 7072 6f74 6f2f 6172   tecton_proto/ar
-00000dc0: 6773 2f64 6174 615f 736f 7572 6365 2e70  gs/data_source.p
-00000dd0: 726f 746f 0a63 6c61 7373 2055 6e69 7479  roto.class Unity
-00000de0: 4361 7461 6c6f 6741 6363 6573 734d 6f64  CatalogAccessMod
-00000df0: 6528 456e 756d 293a 0a20 2020 2053 494e  e(Enum):.    SIN
-00000e00: 474c 455f 5553 4552 203d 2064 6174 615f  GLE_USER = data_
-00000e10: 736f 7572 6365 5f70 6232 2e55 6e69 7479  source_pb2.Unity
-00000e20: 4361 7461 6c6f 6741 6363 6573 734d 6f64  CatalogAccessMod
-00000e30: 652e 554e 4954 595f 4341 5441 4c4f 475f  e.UNITY_CATALOG_
-00000e40: 4143 4345 5353 5f4d 4f44 455f 5349 4e47  ACCESS_MODE_SING
-00000e50: 4c45 5f55 5345 520a 2020 2020 5348 4152  LE_USER.    SHAR
-00000e60: 4544 203d 2064 6174 615f 736f 7572 6365  ED = data_source
-00000e70: 5f70 6232 2e55 6e69 7479 4361 7461 6c6f  _pb2.UnityCatalo
-00000e80: 6741 6363 6573 734d 6f64 652e 554e 4954  gAccessMode.UNIT
-00000e90: 595f 4341 5441 4c4f 475f 4143 4345 5353  Y_CATALOG_ACCESS
-00000ea0: 5f4d 4f44 455f 5348 4152 4544 0a0a 0a64  _MODE_SHARED...d
-00000eb0: 6566 205f 7374 7269 6e67 5f74 6f5f 7469  ef _string_to_ti
-00000ec0: 6d65 6465 6c74 6128 7661 6c75 653a 2041  medelta(value: A
-00000ed0: 6e79 2920 2d3e 2041 6e79 3a0a 2020 2020  ny) -> Any:.    
-00000ee0: 6966 2069 7369 6e73 7461 6e63 6528 7661  if isinstance(va
-00000ef0: 6c75 652c 2073 7472 293a 0a20 2020 2020  lue, str):.     
-00000f00: 2020 2072 6574 7572 6e20 7469 6d65 5f75     return time_u
-00000f10: 7469 6c73 2e70 6172 7365 5f74 6f5f 7469  tils.parse_to_ti
-00000f20: 6d65 6465 6c74 6128 7661 6c75 6529 0a20  medelta(value). 
-00000f30: 2020 2072 6574 7572 6e20 7661 6c75 650a     return value.
-00000f40: 0a0a 6465 6620 5f64 6174 655f 746f 5f64  ..def _date_to_d
-00000f50: 6174 6574 696d 6528 7661 6c75 653a 2041  atetime(value: A
-00000f60: 6e79 2920 2d3e 2041 6e79 3a0a 2020 2020  ny) -> Any:.    
-00000f70: 6966 2069 7369 6e73 7461 6e63 6528 7661  if isinstance(va
-00000f80: 6c75 652c 2064 6174 6574 696d 652e 6461  lue, datetime.da
-00000f90: 7465 293a 0a20 2020 2020 2020 2072 6574  te):.        ret
-00000fa0: 7572 6e20 6461 7465 7469 6d65 2e64 6174  urn datetime.dat
-00000fb0: 6574 696d 6528 7965 6172 3d76 616c 7565  etime(year=value
-00000fc0: 2e79 6561 722c 206d 6f6e 7468 3d76 616c  .year, month=val
-00000fd0: 7565 2e6d 6f6e 7468 2c20 6461 793d 7661  ue.month, day=va
-00000fe0: 6c75 652e 6461 7929 0a20 2020 2072 6574  lue.day).    ret
-00000ff0: 7572 6e20 7661 6c75 650a 0a0a 6465 6620  urn value...def 
-00001000: 5f73 7472 5f74 6f5f 6a73 6f6e 5f73 7472  _str_to_json_str
-00001010: 7563 7428 7661 6c75 653a 2041 6e79 2920  uct(value: Any) 
-00001020: 2d3e 2041 6e79 3a0a 2020 2020 6966 2069  -> Any:.    if i
-00001030: 7369 6e73 7461 6e63 6528 7661 6c75 652c  sinstance(value,
-00001040: 2073 7472 293a 0a20 2020 2020 2020 2072   str):.        r
-00001050: 6574 7572 6e20 6a73 6f6e 2e6c 6f61 6473  eturn json.loads
-00001060: 2876 616c 7565 290a 2020 2020 7265 7475  (value).    retu
-00001070: 726e 2076 616c 7565 0a0a 0a63 6c61 7373  rn value...class
-00001080: 205f 4465 6661 756c 7443 6c75 7374 6572   _DefaultCluster
-00001090: 436f 6e66 6967 2853 7472 6963 744d 6f64  Config(StrictMod
-000010a0: 656c 293a 0a20 2020 2022 2222 4120 6465  el):.    """A de
-000010b0: 6661 756c 7420 636c 7573 7465 7220 636f  fault cluster co
-000010c0: 6e66 6967 7572 6174 696f 6e2e 2053 686f  nfiguration. Sho
-000010d0: 756c 6420 6e6f 7420 6265 2065 7870 6c69  uld not be expli
-000010e0: 6369 746c 7920 7365 7420 6279 2075 7365  citly set by use
-000010f0: 7273 2e0a 0a20 2020 2055 7365 6420 746f  rs...    Used to
-00001100: 2063 6f75 706c 6520 6368 616e 6765 7320   couple changes 
-00001110: 746f 2064 6566 6175 6c74 2063 6f6d 7075  to default compu
-00001120: 7465 2073 6574 7469 6e67 7320 746f 2053  te settings to S
-00001130: 444b 2072 656c 6561 7365 732e 0a20 2020  DK releases..   
-00001140: 2022 2222 0a0a 2020 2020 2320 5573 6564   """..    # Used
-00001150: 2066 6f72 2059 414d 4c20 7061 7273 696e   for YAML parsin
-00001160: 6720 6173 2061 2050 7964 616e 7469 6320  g as a Pydantic 
-00001170: 6469 7363 7269 6d69 6e61 746f 722e 0a20  discriminator.. 
-00001180: 2020 206b 696e 643a 204c 6974 6572 616c     kind: Literal
-00001190: 5b22 5f44 6566 6175 6c74 436c 7573 7465  ["_DefaultCluste
-000011a0: 7243 6f6e 6669 6722 5d20 3d20 225f 4465  rConfig"] = "_De
-000011b0: 6661 756c 7443 6c75 7374 6572 436f 6e66  faultClusterConf
-000011c0: 6967 220a 0a20 2020 2064 6566 205f 746f  ig"..    def _to
-000011d0: 5f63 6c75 7374 6572 5f70 726f 746f 2873  _cluster_proto(s
-000011e0: 656c 6629 202d 3e20 6665 6174 7572 655f  elf) -> feature_
-000011f0: 7669 6577 5f70 6232 2e43 6c75 7374 6572  view_pb2.Cluster
-00001200: 436f 6e66 6967 3a0a 2020 2020 2020 2020  Config:.        
-00001210: 7265 7475 726e 2066 6561 7475 7265 5f76  return feature_v
-00001220: 6965 775f 7062 322e 436c 7573 7465 7243  iew_pb2.ClusterC
-00001230: 6f6e 6669 6728 0a20 2020 2020 2020 2020  onfig(.         
-00001240: 2020 2069 6d70 6c69 6369 745f 636f 6e66     implicit_conf
-00001250: 6967 3d66 6561 7475 7265 5f76 6965 775f  ig=feature_view_
-00001260: 7062 322e 4465 6661 756c 7443 6c75 7374  pb2.DefaultClust
-00001270: 6572 436f 6e66 6967 280a 2020 2020 2020  erConfig(.      
-00001280: 2020 2020 2020 2020 2020 2a2a 7b0a 2020            **{.  
-00001290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000012a0: 2020 2a2a 4445 4641 554c 545f 5350 4152    **DEFAULT_SPAR
-000012b0: 4b5f 5645 5253 494f 4e53 2c0a 2020 2020  K_VERSIONS,.    
-000012c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000012d0: 2a2a 5445 4354 4f4e 5f43 4f4d 5055 5445  **TECTON_COMPUTE
-000012e0: 5f44 4546 4155 4c54 532c 0a20 2020 2020  _DEFAULTS,.     
-000012f0: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
-00001300: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00001310: 2020 2029 0a0a 0a63 6c61 7373 2045 7869     )...class Exi
-00001320: 7374 696e 6743 6c75 7374 6572 436f 6e66  stingClusterConf
-00001330: 6967 2853 7472 6963 744d 6f64 656c 293a  ig(StrictModel):
-00001340: 0a20 2020 2022 2222 5573 6520 616e 2065  .    """Use an e
-00001350: 7869 7374 696e 6720 4461 7461 6272 6963  xisting Databric
-00001360: 6b73 2063 6c75 7374 6572 2e0a 0a20 2020  ks cluster...   
-00001370: 203a 7061 7261 6d20 6578 6973 7469 6e67   :param existing
-00001380: 5f63 6c75 7374 6572 5f69 643a 2049 4420  _cluster_id: ID 
-00001390: 6f66 2074 6865 2065 7869 7374 696e 6720  of the existing 
-000013a0: 636c 7573 7465 722e 0a20 2020 2022 2222  cluster..    """
-000013b0: 0a0a 2020 2020 2320 5573 6564 2066 6f72  ..    # Used for
-000013c0: 2059 414d 4c20 7061 7273 696e 6720 6173   YAML parsing as
-000013d0: 2061 2050 7964 616e 7469 6320 6469 7363   a Pydantic disc
-000013e0: 7269 6d69 6e61 746f 722e 0a20 2020 206b  riminator..    k
-000013f0: 696e 643a 204c 6974 6572 616c 5b22 4578  ind: Literal["Ex
-00001400: 6973 7469 6e67 436c 7573 7465 7243 6f6e  istingClusterCon
-00001410: 6669 6722 5d20 3d20 2245 7869 7374 696e  fig"] = "Existin
-00001420: 6743 6c75 7374 6572 436f 6e66 6967 220a  gClusterConfig".
-00001430: 2020 2020 6578 6973 7469 6e67 5f63 6c75      existing_clu
-00001440: 7374 6572 5f69 643a 2073 7472 0a0a 2020  ster_id: str..  
-00001450: 2020 6465 6620 5f74 6f5f 7072 6f74 6f28    def _to_proto(
-00001460: 7365 6c66 2920 2d3e 2066 6561 7475 7265  self) -> feature
-00001470: 5f76 6965 775f 7062 322e 4578 6973 7469  _view_pb2.Existi
-00001480: 6e67 436c 7573 7465 7243 6f6e 6669 673a  ngClusterConfig:
-00001490: 0a20 2020 2020 2020 2070 726f 746f 203d  .        proto =
-000014a0: 2066 6561 7475 7265 5f76 6965 775f 7062   feature_view_pb
-000014b0: 322e 4578 6973 7469 6e67 436c 7573 7465  2.ExistingCluste
-000014c0: 7243 6f6e 6669 6728 290a 2020 2020 2020  rConfig().      
-000014d0: 2020 7072 6f74 6f2e 6578 6973 7469 6e67    proto.existing
-000014e0: 5f63 6c75 7374 6572 5f69 6420 3d20 7365  _cluster_id = se
-000014f0: 6c66 2e65 7869 7374 696e 675f 636c 7573  lf.existing_clus
-00001500: 7465 725f 6964 0a0a 2020 2020 2020 2020  ter_id..        
-00001510: 7265 7475 726e 2070 726f 746f 0a0a 2020  return proto..  
-00001520: 2020 6465 6620 5f74 6f5f 636c 7573 7465    def _to_cluste
-00001530: 725f 7072 6f74 6f28 7365 6c66 2920 2d3e  r_proto(self) ->
-00001540: 2066 6561 7475 7265 5f76 6965 775f 7062   feature_view_pb
-00001550: 322e 436c 7573 7465 7243 6f6e 6669 673a  2.ClusterConfig:
-00001560: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00001570: 6665 6174 7572 655f 7669 6577 5f70 6232  feature_view_pb2
-00001580: 2e43 6c75 7374 6572 436f 6e66 6967 2865  .ClusterConfig(e
-00001590: 7869 7374 696e 675f 636c 7573 7465 723d  xisting_cluster=
-000015a0: 7365 6c66 2e5f 746f 5f70 726f 746f 2829  self._to_proto()
-000015b0: 290a 0a0a 6465 6620 5f74 6f5f 6a73 6f6e  )...def _to_json
-000015c0: 5f63 6c75 7374 6572 5f70 726f 746f 2876  _cluster_proto(v
-000015d0: 616c 7565 3a20 4d61 7070 696e 675b 7374  alue: Mapping[st
-000015e0: 722c 2041 6e79 5d29 202d 3e20 6665 6174  r, Any]) -> feat
-000015f0: 7572 655f 7669 6577 5f70 6232 2e4a 736f  ure_view_pb2.Jso
-00001600: 6e43 6c75 7374 6572 436f 6e66 6967 3a0a  nClusterConfig:.
-00001610: 2020 2020 6a73 6f6e 5f73 7472 7563 7420      json_struct 
-00001620: 3d20 7374 7275 6374 5f70 6232 2e53 7472  = struct_pb2.Str
-00001630: 7563 7428 290a 2020 2020 6a73 6f6e 5f73  uct().    json_s
-00001640: 7472 7563 742e 7570 6461 7465 2876 616c  truct.update(val
-00001650: 7565 290a 2020 2020 7265 7475 726e 2066  ue).    return f
-00001660: 6561 7475 7265 5f76 6965 775f 7062 322e  eature_view_pb2.
-00001670: 4a73 6f6e 436c 7573 7465 7243 6f6e 6669  JsonClusterConfi
-00001680: 6728 6a73 6f6e 3d6a 736f 6e5f 7374 7275  g(json=json_stru
-00001690: 6374 290a 0a0a 636c 6173 7320 454d 5243  ct)...class EMRC
-000016a0: 6c75 7374 6572 436f 6e66 6967 2853 7472  lusterConfig(Str
-000016b0: 6963 744d 6f64 656c 293a 0a20 2020 2022  ictModel):.    "
-000016c0: 2222 436f 6e66 6967 7572 6174 696f 6e20  ""Configuration 
-000016d0: 7573 6564 2074 6f20 7370 6563 6966 7920  used to specify 
-000016e0: 6d61 7465 7269 616c 697a 6174 696f 6e20  materialization 
-000016f0: 636c 7573 7465 7220 6f70 7469 6f6e 7320  cluster options 
-00001700: 6f6e 2045 4d52 2e0a 0a20 2020 2054 6869  on EMR...    Thi
-00001710: 7320 636c 6173 7320 6465 7363 7269 6265  s class describe
-00001720: 7320 7468 6520 6174 7472 6962 7574 6573  s the attributes
-00001730: 206f 6620 7468 6520 6e65 7720 636c 7573   of the new clus
-00001740: 7465 7273 2077 6869 6368 2061 7265 2063  ters which are c
-00001750: 7265 6174 6564 2069 6e20 454d 5220 6475  reated in EMR du
-00001760: 7269 6e67 0a20 2020 206d 6174 6572 6961  ring.    materia
-00001770: 6c69 7a61 7469 6f6e 206a 6f62 732e 2059  lization jobs. Y
-00001780: 6f75 2063 616e 2063 6f6e 6669 6775 7265  ou can configure
-00001790: 206f 7074 696f 6e73 206f 6620 7468 6573   options of thes
-000017a0: 6520 636c 7573 7465 7273 2c20 6c69 6b65  e clusters, like
-000017b0: 2063 6c75 7374 6572 2073 697a 6520 616e   cluster size an
-000017c0: 6420 6578 7472 6120 7069 7020 6465 7065  d extra pip depe
-000017d0: 6e64 656e 6369 6573 2e0a 0a20 2020 203a  ndencies...    :
-000017e0: 7061 7261 6d20 696e 7374 616e 6365 5f74  param instance_t
-000017f0: 7970 653a 2049 6e73 7461 6e63 6520 7479  ype: Instance ty
-00001800: 7065 2066 6f72 2074 6865 2063 6c75 7374  pe for the clust
-00001810: 6572 2e20 4d75 7374 2062 6520 6120 7661  er. Must be a va
-00001820: 6c69 6420 7479 7065 2061 7320 6c69 7374  lid type as list
-00001830: 6564 2069 6e20 6874 7470 733a 2f2f 646f  ed in https://do
-00001840: 6373 2e61 7773 2e61 6d61 7a6f 6e2e 636f  cs.aws.amazon.co
-00001850: 6d2f 656d 722f 6c61 7465 7374 2f4d 616e  m/emr/latest/Man
-00001860: 6167 656d 656e 7447 7569 6465 2f65 6d72  agementGuide/emr
-00001870: 2d73 7570 706f 7274 6564 2d69 6e73 7461  -supported-insta
-00001880: 6e63 652d 7479 7065 732e 6874 6d6c 2e0a  nce-types.html..
-00001890: 2020 2020 2020 2020 4164 6469 7469 6f6e          Addition
-000018a0: 616c 6c79 2c20 4772 6176 6974 6f6e 2069  ally, Graviton i
-000018b0: 6e73 7461 6e63 6573 2073 7563 6820 6173  nstances such as
-000018c0: 2074 6865 206d 3667 2066 616d 696c 7920   the m6g family 
-000018d0: 6172 6520 6e6f 7420 7375 7070 6f72 7465  are not supporte
-000018e0: 642e 2049 6620 6e6f 7420 7370 6563 6966  d. If not specif
-000018f0: 6965 642c 2061 2076 616c 7565 2064 6574  ied, a value det
-00001900: 6572 6d69 6e65 6420 6279 2074 6865 2054  ermined by the T
-00001910: 6563 746f 6e20 6261 636b 656e 6420 6973  ecton backend is
-00001920: 2075 7365 642e 0a20 2020 203a 7061 7261   used..    :para
-00001930: 6d20 696e 7374 616e 6365 5f61 7661 696c  m instance_avail
-00001940: 6162 696c 6974 793a 2049 6e73 7461 6e63  ability: Instanc
-00001950: 6520 6176 6169 6c61 6269 6c69 7479 2066  e availability f
-00001960: 6f72 2074 6865 2063 6c75 7374 6572 203a  or the cluster :
-00001970: 2022 7370 6f74 222c 2022 6f6e 5f64 656d   "spot", "on_dem
-00001980: 616e 6422 2c20 6f72 2022 7370 6f74 5f77  and", or "spot_w
-00001990: 6974 685f 6661 6c6c 6261 636b 222e 0a20  ith_fallback".. 
-000019a0: 2020 2020 2020 2049 6620 6e6f 7420 7370         If not sp
-000019b0: 6563 6966 6965 642c 2064 6566 6175 6c74  ecified, default
-000019c0: 2069 7320 7370 6f74 2e0a 2020 2020 3a70   is spot..    :p
-000019d0: 6172 616d 206e 756d 6265 725f 6f66 5f77  aram number_of_w
-000019e0: 6f72 6b65 7273 3a20 4e75 6d62 6572 206f  orkers: Number o
-000019f0: 6620 696e 7374 616e 6365 7320 666f 7220  f instances for 
-00001a00: 7468 6520 6d61 7465 7269 616c 697a 6174  the materializat
-00001a10: 696f 6e20 6a6f 622e 2049 6620 6e6f 7420  ion job. If not 
-00001a20: 7370 6563 6966 6965 642c 2061 2076 616c  specified, a val
-00001a30: 7565 2064 6574 6572 6d69 6e65 6420 6279  ue determined by
-00001a40: 2074 6865 2054 6563 746f 6e20 6261 636b   the Tecton back
-00001a50: 656e 6420 6973 2075 7365 640a 2020 2020  end is used.    
-00001a60: 3a70 6172 616d 2066 6972 7374 5f6f 6e5f  :param first_on_
-00001a70: 6465 6d61 6e64 3a20 5468 6520 6669 7273  demand: The firs
-00001a80: 7420 6066 6972 7374 5f6f 6e5f 6465 6d61  t `first_on_dema
-00001a90: 6e64 6020 6e6f 6465 7320 6f66 2074 6865  nd` nodes of the
-00001aa0: 2063 6c75 7374 6572 2077 696c 6c20 7573   cluster will us
-00001ab0: 6520 6f6e 5f64 656d 616e 6420 696e 7374  e on_demand inst
-00001ac0: 616e 6365 732e 2054 6865 2072 6573 7420  ances. The rest 
-00001ad0: 7769 6c6c 2075 7365 2074 6865 2074 7970  will use the typ
-00001ae0: 6520 7370 6563 6966 6965 6420 6279 2069  e specified by i
-00001af0: 6e73 7461 6e63 655f 6176 6169 6c61 6269  nstance_availabi
-00001b00: 6c69 7479 2e0a 2020 2020 2020 2020 4966  lity..        If
-00001b10: 2066 6972 7374 5f6f 6e5f 6465 6d61 6e64   first_on_demand
-00001b20: 203e 3d20 312c 2074 6865 206d 6173 7465   >= 1, the maste
-00001b30: 7220 6e6f 6465 2077 696c 6c20 7573 6520  r node will use 
-00001b40: 6f6e 5f64 656d 616e 6420 696e 7374 616e  on_demand instan
-00001b50: 6365 2074 7970 652e 2060 6669 7273 745f  ce type. `first_
-00001b60: 6f6e 5f64 656d 616e 6460 2069 7320 7265  on_demand` is re
-00001b70: 636f 6d6d 656e 6465 6420 746f 2062 6520  commended to be 
-00001b80: 7365 7420 3e3d 2031 2066 6f72 2063 6c75  set >= 1 for clu
-00001b90: 7374 6572 2063 6f6e 6669 6773 2066 6f72  ster configs for
-00001ba0: 2063 7269 7469 6361 6c20 7374 7265 616d   critical stream
-00001bb0: 696e 6720 6665 6174 7572 6573 2e0a 2020  ing features..  
-00001bc0: 2020 3a70 6172 616d 2072 6f6f 745f 766f    :param root_vo
-00001bd0: 6c75 6d65 5f73 697a 655f 696e 5f67 623a  lume_size_in_gb:
-00001be0: 2053 697a 6520 6f66 2074 6865 2072 6f6f   Size of the roo
-00001bf0: 7420 766f 6c75 6d65 2069 6e20 4742 2070  t volume in GB p
-00001c00: 6572 2069 6e73 7461 6e63 6520 666f 7220  er instance for 
-00001c10: 7468 6520 6d61 7465 7269 616c 697a 6174  the materializat
-00001c20: 696f 6e20 6a6f 622e 0a20 2020 2020 2020  ion job..       
-00001c30: 2049 6620 6e6f 7420 7370 6563 6966 6965   If not specifie
-00001c40: 642c 2061 2076 616c 7565 2064 6574 6572  d, a value deter
-00001c50: 6d69 6e65 6420 6279 2074 6865 2054 6563  mined by the Tec
-00001c60: 746f 6e20 6261 636b 656e 6420 6973 2075  ton backend is u
-00001c70: 7365 642e 0a20 2020 203a 7061 7261 6d20  sed..    :param 
-00001c80: 6578 7472 615f 7069 705f 6465 7065 6e64  extra_pip_depend
-00001c90: 656e 6369 6573 3a20 4578 7472 6120 7069  encies: Extra pi
-00001ca0: 7020 6465 7065 6e64 656e 6369 6573 2074  p dependencies t
-00001cb0: 6f20 6265 2069 6e73 7461 6c6c 6564 206f  o be installed o
-00001cc0: 6e20 7468 6520 6d61 7465 7269 616c 697a  n the materializ
-00001cd0: 6174 696f 6e20 636c 7573 7465 722e 204d  ation cluster. M
-00001ce0: 7573 7420 6265 2050 7950 4920 7061 636b  ust be PyPI pack
-00001cf0: 6167 6573 2c20 6f72 2077 6865 656c 732f  ages, or wheels/
-00001d00: 6567 6773 2069 6e20 5333 206f 7220 4442  eggs in S3 or DB
-00001d10: 4653 2e0a 2020 2020 3a70 6172 616d 2073  FS..    :param s
-00001d20: 7061 726b 5f63 6f6e 6669 673a 204d 6170  park_config: Map
-00001d30: 206f 6620 5370 6172 6b20 636f 6e66 6967   of Spark config
-00001d40: 7572 6174 696f 6e20 6f70 7469 6f6e 7320  uration options 
-00001d50: 616e 6420 7468 6569 7220 7265 7370 6563  and their respec
-00001d60: 7469 7665 2076 616c 7565 7320 7468 6174  tive values that
-00001d70: 2077 696c 6c20 6265 2070 6173 7365 6420   will be passed 
-00001d80: 746f 2074 6865 0a20 2020 2020 2020 2046  to the.        F
-00001d90: 6561 7475 7265 5669 6577 206d 6174 6572  eatureView mater
-00001da0: 6961 6c69 7a61 7469 6f6e 2053 7061 726b  ialization Spark
-00001db0: 2063 6c75 7374 6572 2e0a 2020 2020 3a70   cluster..    :p
-00001dc0: 6172 616d 2065 6d72 5f76 6572 7369 6f6e  aram emr_version
-00001dd0: 3a20 454d 5220 7665 7273 696f 6e20 6f66  : EMR version of
-00001de0: 2074 6865 2063 6c75 7374 6572 2e20 5375   the cluster. Su
-00001df0: 7070 6f72 7465 6420 7665 7273 696f 6e73  pported versions
-00001e00: 2069 6e63 6c75 6465 2022 656d 722d 362e   include "emr-6.
-00001e10: 392e 3022 2c20 2265 6d72 2d36 2e37 2e30  9.0", "emr-6.7.0
-00001e20: 2220 616e 6420 2265 6d72 2d36 2e35 2e30  " and "emr-6.5.0
-00001e30: 222e 2028 4465 6661 756c 743a 2065 6d72  ". (Default: emr
-00001e40: 2d36 2e37 2e30 290a 0a20 2020 204e 6f74  -6.7.0)..    Not
-00001e50: 6520 6f6e 2060 6065 7874 7261 5f70 6970  e on ``extra_pip
-00001e60: 5f64 6570 656e 6465 6e63 6965 7360 603a  _dependencies``:
-00001e70: 2054 6869 7320 6973 2061 206c 6973 7420   This is a list 
-00001e80: 6f66 2070 6163 6b61 6765 7320 7468 6174  of packages that
-00001e90: 2077 696c 6c20 6265 2069 6e73 7461 6c6c   will be install
-00001ea0: 6564 2064 7572 696e 6720 6d61 7465 7269  ed during materi
-00001eb0: 616c 697a 6174 696f 6e2e 0a20 2020 2054  alization..    T
-00001ec0: 6f20 7573 6520 5079 5049 2070 6163 6b61  o use PyPI packa
-00001ed0: 6765 732c 2073 7065 6369 6679 2074 6865  ges, specify the
-00001ee0: 2070 6163 6b61 6765 206e 616d 6520 616e   package name an
-00001ef0: 6420 6f70 7469 6f6e 616c 6c79 2074 6865  d optionally the
-00001f00: 2076 6572 7369 6f6e 2c20 652e 672e 2060   version, e.g. `
-00001f10: 6022 7465 6e73 6f72 666c 6f77 2260 6020  `"tensorflow"`` 
-00001f20: 6f72 2060 6022 7465 6e73 6f72 666c 6f77  or ``"tensorflow
-00001f30: 3d3d 322e 322e 3022 6060 2e0a 2020 2020  ==2.2.0"``..    
-00001f40: 546f 2075 7365 2063 7573 746f 6d20 636f  To use custom co
-00001f50: 6465 2c20 7061 636b 6167 6520 6974 2061  de, package it a
-00001f60: 7320 6120 5079 7468 6f6e 2077 6865 656c  s a Python wheel
-00001f70: 206f 7220 6567 6720 6669 6c65 2069 6e20   or egg file in 
-00001f80: 5333 206f 7220 4442 4653 2c20 7468 656e  S3 or DBFS, then
-00001f90: 2073 7065 6369 6679 2074 6865 2070 6174   specify the pat
-00001fa0: 6820 746f 2074 6865 2066 696c 652c 0a20  h to the file,. 
-00001fb0: 2020 2065 2e67 2e20 6060 2273 333a 2f2f     e.g. ``"s3://
-00001fc0: 6d79 2d62 7563 6b65 742f 7061 7468 2f63  my-bucket/path/c
-00001fd0: 7573 746f 6d2e 7768 6c22 6060 2c20 6f72  ustom.whl"``, or
-00001fe0: 2060 6022 6462 6673 3a2f 7061 7468 2f74   ``"dbfs:/path/t
-00001ff0: 6f2f 6375 7374 6f6d 2e77 686c 2260 602e  o/custom.whl"``.
-00002000: 0a0a 2020 2020 5468 6573 6520 6c69 6272  ..    These libr
-00002010: 6172 6965 7320 7769 6c6c 206f 6e6c 7920  aries will only 
-00002020: 6265 2061 7661 696c 6162 6c65 2074 6f20  be available to 
-00002030: 7573 6520 696e 7369 6465 2053 7061 726b  use inside Spark
-00002040: 2055 4446 732e 2046 6f72 2065 7861 6d70   UDFs. For examp
-00002050: 6c65 2c20 6966 2079 6f75 2073 6574 0a20  le, if you set. 
-00002060: 2020 2060 6065 7874 7261 5f70 6970 5f64     ``extra_pip_d
-00002070: 6570 656e 6465 6e63 6965 733d 5b22 7465  ependencies=["te
-00002080: 6e73 6f72 666c 6f77 225d 6060 2c20 796f  nsorflow"]``, yo
-00002090: 7520 6361 6e20 7573 6520 6974 2069 6e20  u can use it in 
-000020a0: 796f 7572 2074 7261 6e73 666f 726d 6174  your transformat
-000020b0: 696f 6e20 6173 2073 686f 776e 2062 656c  ion as shown bel
-000020c0: 6f77 2e0a 0a20 2020 2041 6e20 6578 616d  ow...    An exam
-000020d0: 706c 6520 6f66 2045 4d52 436c 7573 7465  ple of EMRCluste
-000020e0: 7243 6f6e 6669 672e 0a0a 2020 2020 2e2e  rConfig...    ..
-000020f0: 2063 6f64 652d 626c 6f63 6b3a 3a20 7079   code-block:: py
-00002100: 7468 6f6e 0a0a 2020 2020 2020 2020 6672  thon..        fr
-00002110: 6f6d 2074 6563 746f 6e20 696d 706f 7274  om tecton import
-00002120: 2062 6174 6368 5f66 6561 7475 7265 5f76   batch_feature_v
-00002130: 6965 772c 2049 6e70 7574 2c20 454d 5243  iew, Input, EMRC
-00002140: 6c75 7374 6572 436f 6e66 6967 0a0a 2020  lusterConfig..  
-00002150: 2020 2020 2020 4062 6174 6368 5f66 6561        @batch_fea
-00002160: 7475 7265 5f76 6965 7728 0a20 2020 2020  ture_view(.     
-00002170: 2020 2020 2020 2073 6f75 7263 6573 3d5b         sources=[
-00002180: 4669 6c74 6572 6564 536f 7572 6365 2863  FilteredSource(c
-00002190: 7265 6469 745f 7363 6f72 6573 5f62 6174  redit_scores_bat
-000021a0: 6368 295d 2c0a 2020 2020 2020 2020 2020  ch)],.          
-000021b0: 2020 2320 4361 6e20 6265 2061 6e20 6172    # Can be an ar
-000021c0: 6775 6d65 6e74 2069 6e73 7461 6e63 6520  gument instance 
-000021d0: 746f 2061 2062 6174 6368 2066 6561 7475  to a batch featu
-000021e0: 7265 2076 6965 7720 6465 636f 7261 746f  re view decorato
-000021f0: 720a 2020 2020 2020 2020 2020 2020 6261  r.            ba
-00002200: 7463 685f 636f 6d70 7574 6520 3d20 454d  tch_compute = EM
-00002210: 5243 6c75 7374 6572 436f 6e66 6967 280a  RClusterConfig(.
-00002220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002230: 696e 7374 616e 6365 5f74 7970 6520 3d20  instance_type = 
-00002240: 276d 352e 3278 6c61 7267 6527 2c0a 2020  'm5.2xlarge',.  
-00002250: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
-00002260: 6d62 6572 5f6f 665f 776f 726b 6572 733d  mber_of_workers=
-00002270: 342c 0a20 2020 2020 2020 2020 2020 2020  4,.             
-00002280: 2020 2065 7874 7261 5f70 6970 5f64 6570     extra_pip_dep
-00002290: 656e 6465 6e63 6965 733d 5b22 7465 6e73  endencies=["tens
-000022a0: 6f72 666c 6f77 3d3d 322e 322e 3022 5d2c  orflow==2.2.0"],
-000022b0: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
-000022c0: 2020 2020 2020 2020 2020 2020 2320 4f74              # Ot
-000022d0: 6865 7220 6e61 6d65 6420 6172 6775 6d65  her named argume
-000022e0: 6e74 7320 746f 2062 6174 6368 2066 6561  nts to batch fea
-000022f0: 7475 7265 2076 6965 770a 2020 2020 2020  ture view.      
-00002300: 2020 2020 2020 2e2e 2e0a 2020 2020 2020        ....      
-00002310: 2020 290a 0a20 2020 2020 2020 2023 2055    )..        # U
-00002320: 7365 2074 6865 2074 656e 736f 7266 6c6f  se the tensorflo
-00002330: 7720 7061 636b 6167 6520 696e 2074 6865  w package in the
-00002340: 2055 4446 2073 696e 6365 2074 656e 736f   UDF since tenso
-00002350: 7266 6c6f 7720 7769 6c6c 2062 6520 696e  rflow will be in
-00002360: 7374 616c 6c65 640a 2020 2020 2020 2020  stalled.        
-00002370: 2320 6f6e 2074 6865 2045 4d52 2053 7061  # on the EMR Spa
-00002380: 726b 2063 6c75 7374 6572 2e20 5468 6520  rk cluster. The 
-00002390: 696d 706f 7274 2068 6173 2074 6f20 6265  import has to be
-000023a0: 2077 6974 6869 6e20 7468 6520 5544 4620   within the UDF 
-000023b0: 626f 6479 2e20 5075 7474 696e 6720 6974  body. Putting it
-000023c0: 2061 7420 7468 650a 2020 2020 2020 2020   at the.        
-000023d0: 2320 746f 7020 6f66 2074 6865 2066 696c  # top of the fil
-000023e0: 6520 6f72 2069 6e73 6964 6520 7472 616e  e or inside tran
-000023f0: 7366 6f72 6d61 7469 6f6e 2066 756e 6374  sformation funct
-00002400: 696f 6e20 776f 6e27 7420 776f 726b 2e0a  ion won't work..
-00002410: 0a20 2020 2020 2020 2040 7472 616e 7366  .        @transf
-00002420: 6f72 6d61 7469 6f6e 286d 6f64 653d 2770  ormation(mode='p
-00002430: 7973 7061 726b 2729 0a20 2020 2020 2020  yspark').       
-00002440: 2064 6566 2074 6573 745f 7472 616e 7366   def test_transf
-00002450: 6f72 6d61 7469 6f6e 2874 7261 6e73 666f  ormation(transfo
-00002460: 726d 6174 696f 6e5f 696e 7075 7429 3a0a  rmation_input):.
-00002470: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
-00002480: 2070 7973 7061 726b 2e73 716c 2069 6d70   pyspark.sql imp
-00002490: 6f72 7420 6675 6e63 7469 6f6e 7320 6173  ort functions as
-000024a0: 2046 0a20 2020 2020 2020 2020 2020 2066   F.            f
-000024b0: 726f 6d20 7079 7370 6172 6b2e 7371 6c2e  rom pyspark.sql.
-000024c0: 7479 7065 7320 696d 706f 7274 2049 6e74  types import Int
-000024d0: 6567 6572 5479 7065 0a0a 2020 2020 2020  egerType..      
-000024e0: 2020 2020 2020 6465 6620 6d79 5f74 656e        def my_ten
-000024f0: 736f 7266 6c6f 7728 7829 3a0a 2020 2020  sorflow(x):.    
-00002500: 2020 2020 2020 2020 2020 2020 696d 706f              impo
-00002510: 7274 2074 656e 736f 7266 6c6f 7720 6173  rt tensorflow as
-00002520: 2074 660a 2020 2020 2020 2020 2020 2020   tf.            
-00002530: 2020 2020 7265 7475 726e 2069 6e74 2874      return int(t
-00002540: 662e 6d61 7468 2e6c 6f67 3170 2866 6c6f  f.math.log1p(flo
-00002550: 6174 2878 2929 2e6e 756d 7079 2829 290a  at(x)).numpy()).
-00002560: 0a20 2020 2020 2020 2020 2020 206d 795f  .            my_
-00002570: 7465 6e73 6f72 666c 6f77 5f75 6466 203d  tensorflow_udf =
-00002580: 2046 2e75 6466 286d 795f 7465 6e73 6f72   F.udf(my_tensor
-00002590: 666c 6f77 2c20 496e 7465 6765 7254 7970  flow, IntegerTyp
-000025a0: 6528 2929 0a0a 2020 2020 2020 2020 2020  e())..          
-000025b0: 2020 7265 7475 726e 2074 7261 6e73 666f    return transfo
-000025c0: 726d 6174 696f 6e5f 696e 7075 742e 7365  rmation_input.se
-000025d0: 6c65 6374 280a 2020 2020 2020 2020 2020  lect(.          
-000025e0: 2020 2020 2020 2765 6e74 6974 795f 6964        'entity_id
-000025f0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-00002600: 2020 2027 7469 6d65 7374 616d 7027 2c0a     'timestamp',.
-00002610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002620: 6d79 5f74 656e 736f 7266 6c6f 775f 7564  my_tensorflow_ud
-00002630: 6628 2763 6c69 636b 7327 292e 616c 6961  f('clicks').alia
-00002640: 7328 276c 6f67 3170 5f63 6c69 636b 7327  s('log1p_clicks'
-00002650: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
-00002660: 2020 2020 2222 220a 0a20 2020 206b 696e      """..    kin
-00002670: 643a 204c 6974 6572 616c 5b22 454d 5243  d: Literal["EMRC
-00002680: 6c75 7374 6572 436f 6e66 6967 225d 203d  lusterConfig"] =
-00002690: 2022 454d 5243 6c75 7374 6572 436f 6e66   "EMRClusterConf
-000026a0: 6967 2220 2023 2055 7365 6420 666f 7220  ig"  # Used for 
-000026b0: 5941 4d4c 2070 6172 7369 6e67 2061 7320  YAML parsing as 
-000026c0: 6120 5079 6461 6e74 6963 2064 6973 6372  a Pydantic discr
-000026d0: 696d 696e 6174 6f72 2e0a 2020 2020 696e  iminator..    in
-000026e0: 7374 616e 6365 5f74 7970 653a 204f 7074  stance_type: Opt
-000026f0: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
-00002700: 650a 2020 2020 696e 7374 616e 6365 5f61  e.    instance_a
-00002710: 7661 696c 6162 696c 6974 793a 204f 7074  vailability: Opt
-00002720: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
-00002730: 650a 2020 2020 6e75 6d62 6572 5f6f 665f  e.    number_of_
-00002740: 776f 726b 6572 733a 204f 7074 696f 6e61  workers: Optiona
-00002750: 6c5b 696e 745d 203d 204e 6f6e 650a 2020  l[int] = None.  
-00002760: 2020 6669 7273 745f 6f6e 5f64 656d 616e    first_on_deman
-00002770: 643a 204f 7074 696f 6e61 6c5b 696e 745d  d: Optional[int]
-00002780: 203d 204e 6f6e 650a 2020 2020 726f 6f74   = None.    root
-00002790: 5f76 6f6c 756d 655f 7369 7a65 5f69 6e5f  _volume_size_in_
-000027a0: 6762 3a20 4f70 7469 6f6e 616c 5b69 6e74  gb: Optional[int
-000027b0: 5d20 3d20 4e6f 6e65 0a20 2020 2065 7874  ] = None.    ext
-000027c0: 7261 5f70 6970 5f64 6570 656e 6465 6e63  ra_pip_dependenc
-000027d0: 6965 733a 204f 7074 696f 6e61 6c5b 4c69  ies: Optional[Li
-000027e0: 7374 5b73 7472 5d5d 203d 204e 6f6e 650a  st[str]] = None.
-000027f0: 2020 2020 7370 6172 6b5f 636f 6e66 6967      spark_config
-00002800: 3a20 4f70 7469 6f6e 616c 5b44 6963 745b  : Optional[Dict[
-00002810: 7374 722c 2073 7472 5d5d 203d 204e 6f6e  str, str]] = Non
-00002820: 650a 2020 2020 656d 725f 7665 7273 696f  e.    emr_versio
-00002830: 6e3a 2073 7472 203d 2044 4546 4155 4c54  n: str = DEFAULT
-00002840: 5f53 5041 524b 5f56 4552 5349 4f4e 535b  _SPARK_VERSIONS[
-00002850: 2265 6d72 5f73 7061 726b 5f76 6572 7369  "emr_spark_versi
-00002860: 6f6e 225d 0a0a 2020 2020 6465 6620 5f74  on"]..    def _t
-00002870: 6f5f 7072 6f74 6f28 7365 6c66 2920 2d3e  o_proto(self) ->
-00002880: 2066 6561 7475 7265 5f76 6965 775f 7062   feature_view_pb
-00002890: 322e 4e65 7743 6c75 7374 6572 436f 6e66  2.NewClusterConf
-000028a0: 6967 3a0a 2020 2020 2020 2020 7072 6f74  ig:.        prot
-000028b0: 6f20 3d20 6665 6174 7572 655f 7669 6577  o = feature_view
-000028c0: 5f70 6232 2e4e 6577 436c 7573 7465 7243  _pb2.NewClusterC
-000028d0: 6f6e 6669 6728 290a 2020 2020 2020 2020  onfig().        
-000028e0: 6966 2073 656c 662e 696e 7374 616e 6365  if self.instance
-000028f0: 5f74 7970 653a 0a20 2020 2020 2020 2020  _type:.         
-00002900: 2020 2070 726f 746f 2e69 6e73 7461 6e63     proto.instanc
-00002910: 655f 7479 7065 203d 2073 656c 662e 696e  e_type = self.in
-00002920: 7374 616e 6365 5f74 7970 650a 2020 2020  stance_type.    
-00002930: 2020 2020 6966 2073 656c 662e 696e 7374      if self.inst
-00002940: 616e 6365 5f61 7661 696c 6162 696c 6974  ance_availabilit
-00002950: 793a 0a20 2020 2020 2020 2020 2020 2069  y:.            i
-00002960: 6620 7365 6c66 2e69 6e73 7461 6e63 655f  f self.instance_
-00002970: 6176 6169 6c61 6269 6c69 7479 206e 6f74  availability not
-00002980: 2069 6e20 454d 525f 5355 5050 4f52 5445   in EMR_SUPPORTE
-00002990: 445f 4156 4149 4c41 4249 4c49 5459 3a0a  D_AVAILABILITY:.
-000029a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000029b0: 6d73 6720 3d20 6622 496e 7374 616e 6365  msg = f"Instance
-000029c0: 2061 7661 696c 6162 696c 6974 7920 7b73   availability {s
-000029d0: 656c 662e 696e 7374 616e 6365 5f61 7661  elf.instance_ava
-000029e0: 696c 6162 696c 6974 797d 2069 7320 6e6f  ilability} is no
-000029f0: 7420 7375 7070 6f72 7465 642e 2043 686f  t supported. Cho
-00002a00: 6f73 6520 6f6e 6520 6f66 207b 454d 525f  ose one of {EMR_
-00002a10: 5355 5050 4f52 5445 445f 4156 4149 4c41  SUPPORTED_AVAILA
-00002a20: 4249 4c49 5459 7d22 0a20 2020 2020 2020  BILITY}".       
-00002a30: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00002a40: 616c 7565 4572 726f 7228 6d73 6729 0a20  alueError(msg). 
-00002a50: 2020 2020 2020 2020 2020 2070 726f 746f             proto
-00002a60: 2e69 6e73 7461 6e63 655f 6176 6169 6c61  .instance_availa
-00002a70: 6269 6c69 7479 203d 2073 656c 662e 696e  bility = self.in
-00002a80: 7374 616e 6365 5f61 7661 696c 6162 696c  stance_availabil
-00002a90: 6974 790a 2020 2020 2020 2020 6966 2073  ity.        if s
-00002aa0: 656c 662e 656d 725f 7665 7273 696f 6e20  elf.emr_version 
-00002ab0: 6e6f 7420 696e 2045 4d52 5f53 5550 504f  not in EMR_SUPPO
-00002ac0: 5254 4544 5f53 5041 524b 3a0a 2020 2020  RTED_SPARK:.    
-00002ad0: 2020 2020 2020 2020 6d73 6720 3d20 6622          msg = f"
-00002ae0: 454d 5220 7665 7273 696f 6e20 7b73 656c  EMR version {sel
-00002af0: 662e 656d 725f 7665 7273 696f 6e7d 2069  f.emr_version} i
-00002b00: 7320 6e6f 7420 7375 7070 6f72 7465 642e  s not supported.
-00002b10: 2053 7570 706f 7274 6564 2076 6572 7369   Supported versi
-00002b20: 6f6e 733a 207b 454d 525f 5355 5050 4f52  ons: {EMR_SUPPOR
-00002b30: 5445 445f 5350 4152 4b7d 220a 2020 2020  TED_SPARK}".    
-00002b40: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00002b50: 6c75 6545 7272 6f72 286d 7367 290a 2020  lueError(msg).  
-00002b60: 2020 2020 2020 6966 2073 656c 662e 6e75        if self.nu
-00002b70: 6d62 6572 5f6f 665f 776f 726b 6572 733a  mber_of_workers:
-00002b80: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
-00002b90: 746f 2e6e 756d 6265 725f 6f66 5f77 6f72  to.number_of_wor
-00002ba0: 6b65 7273 203d 2073 656c 662e 6e75 6d62  kers = self.numb
-00002bb0: 6572 5f6f 665f 776f 726b 6572 730a 2020  er_of_workers.  
-00002bc0: 2020 2020 2020 6966 2073 656c 662e 6669        if self.fi
-00002bd0: 7273 745f 6f6e 5f64 656d 616e 643a 0a20  rst_on_demand:. 
-00002be0: 2020 2020 2020 2020 2020 2070 726f 746f             proto
-00002bf0: 2e66 6972 7374 5f6f 6e5f 6465 6d61 6e64  .first_on_demand
-00002c00: 203d 2073 656c 662e 6669 7273 745f 6f6e   = self.first_on
-00002c10: 5f64 656d 616e 640a 2020 2020 2020 2020  _demand.        
-00002c20: 6966 2073 656c 662e 726f 6f74 5f76 6f6c  if self.root_vol
-00002c30: 756d 655f 7369 7a65 5f69 6e5f 6762 3a0a  ume_size_in_gb:.
-00002c40: 2020 2020 2020 2020 2020 2020 7072 6f74              prot
-00002c50: 6f2e 726f 6f74 5f76 6f6c 756d 655f 7369  o.root_volume_si
-00002c60: 7a65 5f69 6e5f 6762 203d 2073 656c 662e  ze_in_gb = self.
-00002c70: 726f 6f74 5f76 6f6c 756d 655f 7369 7a65  root_volume_size
-00002c80: 5f69 6e5f 6762 0a20 2020 2020 2020 2069  _in_gb.        i
-00002c90: 6620 7365 6c66 2e65 7874 7261 5f70 6970  f self.extra_pip
-00002ca0: 5f64 6570 656e 6465 6e63 6965 733a 0a20  _dependencies:. 
-00002cb0: 2020 2020 2020 2020 2020 2070 726f 746f             proto
-00002cc0: 2e65 7874 7261 5f70 6970 5f64 6570 656e  .extra_pip_depen
-00002cd0: 6465 6e63 6965 732e 6578 7465 6e64 2873  dencies.extend(s
-00002ce0: 656c 662e 6578 7472 615f 7069 705f 6465  elf.extra_pip_de
-00002cf0: 7065 6e64 656e 6369 6573 290a 2020 2020  pendencies).    
-00002d00: 2020 2020 6966 2073 656c 662e 7370 6172      if self.spar
-00002d10: 6b5f 636f 6e66 6967 3a0a 2020 2020 2020  k_config:.      
-00002d20: 2020 2020 2020 7370 6172 6b5f 636f 6e66        spark_conf
-00002d30: 6967 203d 2053 7061 726b 436f 6e66 6967  ig = SparkConfig
-00002d40: 5772 6170 7065 7228 7370 6172 6b5f 636f  Wrapper(spark_co
-00002d50: 6e66 6967 5f6d 6170 3d73 656c 662e 7370  nfig_map=self.sp
-00002d60: 6172 6b5f 636f 6e66 6967 292e 5f74 6f5f  ark_config)._to_
-00002d70: 7072 6f74 6f28 290a 2020 2020 2020 2020  proto().        
-00002d80: 2020 2020 7072 6f74 6f2e 7370 6172 6b5f      proto.spark_
-00002d90: 636f 6e66 6967 2e43 6f70 7946 726f 6d28  config.CopyFrom(
-00002da0: 7370 6172 6b5f 636f 6e66 6967 290a 2020  spark_config).  
-00002db0: 2020 2020 2020 7072 6f74 6f2e 7069 6e6e        proto.pinn
-00002dc0: 6564 5f73 7061 726b 5f76 6572 7369 6f6e  ed_spark_version
-00002dd0: 203d 2073 656c 662e 656d 725f 7665 7273   = self.emr_vers
-00002de0: 696f 6e0a 0a20 2020 2020 2020 2072 6574  ion..        ret
-00002df0: 7572 6e20 7072 6f74 6f0a 0a20 2020 2064  urn proto..    d
-00002e00: 6566 205f 746f 5f63 6c75 7374 6572 5f70  ef _to_cluster_p
-00002e10: 726f 746f 2873 656c 6629 202d 3e20 6665  roto(self) -> fe
-00002e20: 6174 7572 655f 7669 6577 5f70 6232 2e43  ature_view_pb2.C
-00002e30: 6c75 7374 6572 436f 6e66 6967 3a0a 2020  lusterConfig:.  
-00002e40: 2020 2020 2020 7265 7475 726e 2066 6561        return fea
-00002e50: 7475 7265 5f76 6965 775f 7062 322e 436c  ture_view_pb2.Cl
-00002e60: 7573 7465 7243 6f6e 6669 6728 6e65 775f  usterConfig(new_
-00002e70: 656d 723d 7365 6c66 2e5f 746f 5f70 726f  emr=self._to_pro
-00002e80: 746f 2829 290a 0a0a 636c 6173 7320 454d  to())...class EM
-00002e90: 524a 736f 6e43 6c75 7374 6572 436f 6e66  RJsonClusterConf
-00002ea0: 6967 2853 7472 6963 744d 6f64 656c 293a  ig(StrictModel):
-00002eb0: 0a20 2020 2022 2222 436f 6e66 6967 7572  .    """Configur
-00002ec0: 6174 696f 6e20 7573 6564 2074 6f20 7370  ation used to sp
-00002ed0: 6563 6966 7920 6d61 7465 7269 616c 697a  ecify materializ
-00002ee0: 6174 696f 6e20 636c 7573 7465 7273 2075  ation clusters u
-00002ef0: 7369 6e67 206a 736f 6e20 6f6e 2045 4d52  sing json on EMR
-00002f00: 2e0a 0a20 2020 2054 6869 7320 636c 6173  ...    This clas
-00002f10: 7320 6465 7363 7269 6265 7320 7468 6520  s describes the 
-00002f20: 6174 7472 6962 7574 6573 206f 6620 7468  attributes of th
-00002f30: 6520 6e65 7720 636c 7573 7465 7273 2077  e new clusters w
-00002f40: 6869 6368 2061 7265 2063 7265 6174 6564  hich are created
-00002f50: 2069 6e20 454d 5220 6475 7269 6e67 0a20   in EMR during. 
-00002f60: 2020 206d 6174 6572 6961 6c69 7a61 7469     materializati
-00002f70: 6f6e 206a 6f62 732e 2050 6c65 6173 6520  on jobs. Please 
-00002f80: 6669 6e64 206d 6f72 6520 6465 7461 696c  find more detail
-00002f90: 7320 696e 2060 5573 6572 2047 7569 6465  s in `User Guide
-00002fa0: 605f 2e0a 0a20 2020 203a 7061 7261 6d20  `_...    :param 
-00002fb0: 6a73 6f6e 3a20 4120 4a53 4f4e 2073 7472  json: A JSON str
-00002fc0: 696e 6720 7573 6564 2074 6f20 6469 7265  ing used to dire
-00002fd0: 6374 6c79 2063 6f6e 6669 6775 7265 2074  ctly configure t
-00002fe0: 6865 2063 6c75 7374 6572 2075 7365 6420  he cluster used 
-00002ff0: 696e 206d 6174 6572 6961 6c69 7a61 7469  in materializati
-00003000: 6f6e 2e0a 0a20 2020 202e 2e20 5f55 7365  on...    .. _Use
-00003010: 7220 4775 6964 653a 2068 7474 7073 3a2f  r Guide: https:/
-00003020: 2f64 6f63 732e 7465 6374 6f6e 2e61 692f  /docs.tecton.ai/
-00003030: 646f 6373 2f6d 6174 6572 6961 6c69 7a69  docs/materializi
-00003040: 6e67 2d66 6561 7475 7265 732f 636f 6e66  ng-features/conf
-00003050: 6967 7572 696e 672d 6a6f 622d 636c 7573  iguring-job-clus
-00003060: 7465 7273 2d76 6961 2d6a 736f 6e23 636f  ters-via-json#co
-00003070: 6e66 6967 7572 696e 672d 656d 722d 6a6f  nfiguring-emr-jo
-00003080: 622d 636c 7573 7465 7273 0a20 2020 2022  b-clusters.    "
-00003090: 2222 0a0a 2020 2020 2320 5573 6564 2066  ""..    # Used f
-000030a0: 6f72 2059 414d 4c20 7061 7273 696e 6720  or YAML parsing 
-000030b0: 6173 2061 2050 7964 616e 7469 6320 6469  as a Pydantic di
-000030c0: 7363 7269 6d69 6e61 746f 722e 0a20 2020  scriminator..   
-000030d0: 206b 696e 643a 204c 6974 6572 616c 5b22   kind: Literal["
-000030e0: 454d 524a 736f 6e43 6c75 7374 6572 436f  EMRJsonClusterCo
-000030f0: 6e66 6967 225d 203d 2022 454d 524a 736f  nfig"] = "EMRJso
-00003100: 6e43 6c75 7374 6572 436f 6e66 6967 220a  nClusterConfig".
-00003110: 0a20 2020 2023 2055 7365 206a 736f 6e5f  .    # Use json_
-00003120: 2077 6974 6820 616e 2061 6c69 6173 2074   with an alias t
-00003130: 6f20 6176 6f69 6420 636f 6e66 6c69 6374  o avoid conflict
-00003140: 696e 6720 7769 7468 2061 2050 7964 616e  ing with a Pydan
-00003150: 7469 6320 4261 7365 4d6f 6465 6c20 6d65  tic BaseModel me
-00003160: 7468 6f64 206a 736f 6e28 292e 2053 6861  thod json(). Sha
-00003170: 646f 7720 7468 6174 206d 6574 686f 6420  dow that method 
-00003180: 7769 7468 0a20 2020 2023 2061 206a 736f  with.    # a jso
-00003190: 6e20 7072 6f70 6572 7479 2073 6f20 7468  n property so th
-000031a0: 6174 2063 616c 6c65 7273 2063 616e 2061  at callers can a
-000031b0: 6363 6573 7320 7468 6520 6669 656c 6420  ccess the field 
-000031c0: 696e 7475 6974 6976 656c 792e 0a20 2020  intuitively..   
-000031d0: 206a 736f 6e5f 3a20 4469 6374 5b73 7472   json_: Dict[str
-000031e0: 2c20 416e 795d 203d 2070 7964 616e 7469  , Any] = pydanti
-000031f0: 635f 7631 2e46 6965 6c64 2861 6c69 6173  c_v1.Field(alias
-00003200: 3d22 6a73 6f6e 2229 0a0a 2020 2020 2320  ="json")..    # 
-00003210: 4120 5079 6461 6e74 6963 2070 7265 2d76  A Pydantic pre-v
-00003220: 616c 6964 6174 6f72 2074 6f20 636f 6e76  alidator to conv
-00003230: 6572 7420 6a73 6f6e 2073 7472 696e 6773  ert json strings
-00003240: 2074 6f20 6120 6e61 7469 7665 2070 7974   to a native pyt
-00003250: 686f 6e20 6f62 6a65 6374 2e0a 2020 2020  hon object..    
-00003260: 5f6a 736f 6e5f 7374 725f 746f 5f64 6963  _json_str_to_dic
-00003270: 7420 3d20 7079 6461 6e74 6963 5f76 312e  t = pydantic_v1.
-00003280: 7661 6c69 6461 746f 7228 226a 736f 6e5f  validator("json_
-00003290: 222c 2061 6c6c 6f77 5f72 6575 7365 3d54  ", allow_reuse=T
-000032a0: 7275 652c 2070 7265 3d54 7275 6529 285f  rue, pre=True)(_
-000032b0: 7374 725f 746f 5f6a 736f 6e5f 7374 7275  str_to_json_stru
-000032c0: 6374 290a 0a20 2020 2064 6566 205f 746f  ct)..    def _to
-000032d0: 5f63 6c75 7374 6572 5f70 726f 746f 2873  _cluster_proto(s
-000032e0: 656c 6629 202d 3e20 6665 6174 7572 655f  elf) -> feature_
-000032f0: 7669 6577 5f70 6232 2e43 6c75 7374 6572  view_pb2.Cluster
-00003300: 436f 6e66 6967 3a0a 2020 2020 2020 2020  Config:.        
-00003310: 7265 7475 726e 2066 6561 7475 7265 5f76  return feature_v
-00003320: 6965 775f 7062 322e 436c 7573 7465 7243  iew_pb2.ClusterC
-00003330: 6f6e 6669 6728 6a73 6f6e 5f65 6d72 3d5f  onfig(json_emr=_
-00003340: 746f 5f6a 736f 6e5f 636c 7573 7465 725f  to_json_cluster_
-00003350: 7072 6f74 6f28 7365 6c66 2e6a 736f 6e29  proto(self.json)
-00003360: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-00003370: 0a20 2020 2064 6566 206a 736f 6e28 7365  .    def json(se
-00003380: 6c66 2920 2d3e 2044 6963 745b 7374 722c  lf) -> Dict[str,
-00003390: 2041 6e79 5d3a 0a20 2020 2020 2020 2072   Any]:.        r
-000033a0: 6574 7572 6e20 7365 6c66 2e6a 736f 6e5f  eturn self.json_
-000033b0: 0a0a 0a63 6c61 7373 2044 6174 6170 726f  ...class Datapro
-000033c0: 634a 736f 6e43 6c75 7374 6572 436f 6e66  cJsonClusterConf
-000033d0: 6967 2853 7472 6963 744d 6f64 656c 293a  ig(StrictModel):
-000033e0: 0a20 2020 2022 2222 436f 6e66 6967 7572  .    """Configur
-000033f0: 6174 696f 6e20 7573 6564 2074 6f20 7370  ation used to sp
-00003400: 6563 6966 7920 6d61 7465 7269 616c 697a  ecify materializ
-00003410: 6174 696f 6e20 636c 7573 7465 7273 2075  ation clusters u
-00003420: 7369 6e67 206a 736f 6e20 6f6e 2044 6174  sing json on Dat
-00003430: 6170 726f 632e 0a0a 2020 2020 5468 6973  aproc...    This
-00003440: 2063 6c61 7373 2064 6573 6372 6962 6573   class describes
-00003450: 2074 6865 2061 7474 7269 6275 7465 7320   the attributes 
-00003460: 6f66 2074 6865 206e 6577 2063 6c75 7374  of the new clust
-00003470: 6572 7320 7768 6963 6820 6172 6520 6372  ers which are cr
-00003480: 6561 7465 6420 696e 2044 6174 6170 726f  eated in Datapro
-00003490: 6320 6475 7269 6e67 0a20 2020 206d 6174  c during.    mat
-000034a0: 6572 6961 6c69 7a61 7469 6f6e 206a 6f62  erialization job
-000034b0: 732e 2054 6869 7320 6665 6174 7572 6520  s. This feature 
-000034c0: 6973 206f 6e6c 7920 6176 6169 6c61 626c  is only availabl
-000034d0: 6520 666f 7220 7072 6976 6174 6520 7072  e for private pr
-000034e0: 6576 6965 772e 0a0a 2020 2020 3a70 6172  eview...    :par
-000034f0: 616d 206a 736f 6e3a 2041 204a 534f 4e20  am json: A JSON 
-00003500: 7374 7269 6e67 2075 7365 6420 746f 2064  string used to d
-00003510: 6972 6563 746c 7920 636f 6e66 6967 7572  irectly configur
-00003520: 6520 7468 6520 636c 7573 7465 7220 7573  e the cluster us
-00003530: 6564 2069 6e20 6d61 7465 7269 616c 697a  ed in materializ
-00003540: 6174 696f 6e2e 0a20 2020 2022 2222 0a0a  ation..    """..
-00003550: 2020 2020 2320 5573 6564 2066 6f72 2059      # Used for Y
-00003560: 414d 4c20 7061 7273 696e 6720 6173 2061  AML parsing as a
-00003570: 2050 7964 616e 7469 6320 6469 7363 7269   Pydantic discri
-00003580: 6d69 6e61 746f 722e 0a20 2020 206b 696e  minator..    kin
-00003590: 643a 204c 6974 6572 616c 5b22 4461 7461  d: Literal["Data
-000035a0: 7072 6f63 4a73 6f6e 436c 7573 7465 7243  procJsonClusterC
-000035b0: 6f6e 6669 6722 5d20 3d20 2244 6174 6170  onfig"] = "Datap
-000035c0: 726f 634a 736f 6e43 6c75 7374 6572 436f  rocJsonClusterCo
-000035d0: 6e66 6967 220a 0a20 2020 2023 2055 7365  nfig"..    # Use
-000035e0: 206a 736f 6e5f 2077 6974 6820 616e 2061   json_ with an a
-000035f0: 6c69 6173 2074 6f20 6176 6f69 6420 636f  lias to avoid co
-00003600: 6e66 6c69 6374 696e 6720 7769 7468 2061  nflicting with a
-00003610: 2050 7964 616e 7469 6320 4261 7365 4d6f   Pydantic BaseMo
-00003620: 6465 6c20 6d65 7468 6f64 206a 736f 6e28  del method json(
-00003630: 292e 2053 6861 646f 7720 7468 6174 206d  ). Shadow that m
-00003640: 6574 686f 6420 7769 7468 0a20 2020 2023  ethod with.    #
-00003650: 2061 206a 736f 6e20 7072 6f70 6572 7479   a json property
-00003660: 2073 6f20 7468 6174 2063 616c 6c65 7273   so that callers
-00003670: 2063 616e 2061 6363 6573 7320 7468 6520   can access the 
-00003680: 6669 656c 6420 696e 7475 6974 6976 656c  field intuitivel
-00003690: 792e 0a20 2020 206a 736f 6e5f 3a20 4469  y..    json_: Di
-000036a0: 6374 5b73 7472 2c20 416e 795d 203d 2070  ct[str, Any] = p
-000036b0: 7964 616e 7469 635f 7631 2e46 6965 6c64  ydantic_v1.Field
-000036c0: 2861 6c69 6173 3d22 6a73 6f6e 2229 0a0a  (alias="json")..
-000036d0: 2020 2020 2320 4120 5079 6461 6e74 6963      # A Pydantic
-000036e0: 2070 7265 2d76 616c 6964 6174 6f72 2074   pre-validator t
-000036f0: 6f20 636f 6e76 6572 7420 6a73 6f6e 2073  o convert json s
-00003700: 7472 696e 6773 2074 6f20 6120 6e61 7469  trings to a nati
-00003710: 7665 2070 7974 686f 6e20 6f62 6a65 6374  ve python object
-00003720: 2e0a 2020 2020 5f6a 736f 6e5f 7374 725f  ..    _json_str_
-00003730: 746f 5f64 6963 7420 3d20 7079 6461 6e74  to_dict = pydant
-00003740: 6963 5f76 312e 7661 6c69 6461 746f 7228  ic_v1.validator(
-00003750: 226a 736f 6e5f 222c 2061 6c6c 6f77 5f72  "json_", allow_r
-00003760: 6575 7365 3d54 7275 652c 2070 7265 3d54  euse=True, pre=T
-00003770: 7275 6529 285f 7374 725f 746f 5f6a 736f  rue)(_str_to_jso
-00003780: 6e5f 7374 7275 6374 290a 0a20 2020 2064  n_struct)..    d
-00003790: 6566 205f 746f 5f63 6c75 7374 6572 5f70  ef _to_cluster_p
-000037a0: 726f 746f 2873 656c 6629 202d 3e20 6665  roto(self) -> fe
-000037b0: 6174 7572 655f 7669 6577 5f70 6232 2e43  ature_view_pb2.C
-000037c0: 6c75 7374 6572 436f 6e66 6967 3a0a 2020  lusterConfig:.  
-000037d0: 2020 2020 2020 7265 7475 726e 2066 6561        return fea
-000037e0: 7475 7265 5f76 6965 775f 7062 322e 436c  ture_view_pb2.Cl
-000037f0: 7573 7465 7243 6f6e 6669 6728 6a73 6f6e  usterConfig(json
-00003800: 5f64 6174 6170 726f 633d 5f74 6f5f 6a73  _dataproc=_to_js
-00003810: 6f6e 5f63 6c75 7374 6572 5f70 726f 746f  on_cluster_proto
-00003820: 2873 656c 662e 6a73 6f6e 2929 0a0a 2020  (self.json))..  
-00003830: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00003840: 6465 6620 6a73 6f6e 2873 656c 6629 202d  def json(self) -
-00003850: 3e20 4469 6374 5b73 7472 2c20 416e 795d  > Dict[str, Any]
-00003860: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00003870: 2073 656c 662e 6a73 6f6e 5f0a 0a0a 636c   self.json_...cl
-00003880: 6173 7320 4461 7461 6272 6963 6b73 4a73  ass DatabricksJs
-00003890: 6f6e 436c 7573 7465 7243 6f6e 6669 6728  onClusterConfig(
-000038a0: 5374 7269 6374 4d6f 6465 6c29 3a0a 2020  StrictModel):.  
-000038b0: 2020 2222 2243 6f6e 6669 6775 7261 7469    """Configurati
-000038c0: 6f6e 2075 7365 6420 746f 2073 7065 6369  on used to speci
-000038d0: 6679 206d 6174 6572 6961 6c69 7a61 7469  fy materializati
-000038e0: 6f6e 2063 6c75 7374 6572 7320 7573 696e  on clusters usin
-000038f0: 6720 6a73 6f6e 206f 6e20 4461 7461 6272  g json on Databr
-00003900: 6963 6b73 2e0a 0a20 2020 2054 6869 7320  icks...    This 
-00003910: 636c 6173 7320 6465 7363 7269 6265 7320  class describes 
-00003920: 7468 6520 6174 7472 6962 7574 6573 206f  the attributes o
-00003930: 6620 7468 6520 6e65 7720 636c 7573 7465  f the new cluste
-00003940: 7273 2077 6869 6368 2061 7265 2063 7265  rs which are cre
-00003950: 6174 6564 2069 6e20 4461 7461 6272 6963  ated in Databric
-00003960: 6b73 2064 7572 696e 670a 2020 2020 6d61  ks during.    ma
-00003970: 7465 7269 616c 697a 6174 696f 6e20 6a6f  terialization jo
-00003980: 6273 2e20 506c 6561 7365 2066 696e 6420  bs. Please find 
-00003990: 6d6f 7265 2064 6574 6169 6c73 2069 6e20  more details in 
-000039a0: 6055 7365 7220 4775 6964 6560 5f2e 0a0a  `User Guide`_...
-000039b0: 2020 2020 3a70 6172 616d 206a 736f 6e3a      :param json:
-000039c0: 2041 204a 534f 4e20 7374 7269 6e67 2075   A JSON string u
-000039d0: 7365 6420 746f 2064 6972 6563 746c 7920  sed to directly 
-000039e0: 636f 6e66 6967 7572 6520 7468 6520 636c  configure the cl
-000039f0: 7573 7465 7220 7573 6564 2069 6e20 6d61  uster used in ma
-00003a00: 7465 7269 616c 697a 6174 696f 6e2e 0a0a  terialization...
-00003a10: 2020 2020 2e2e 205f 5573 6572 2047 7569      .. _User Gui
-00003a20: 6465 3a20 6874 7470 733a 2f2f 646f 6373  de: https://docs
-00003a30: 2e74 6563 746f 6e2e 6169 2f64 6f63 732f  .tecton.ai/docs/
-00003a40: 6d61 7465 7269 616c 697a 696e 672d 6665  materializing-fe
-00003a50: 6174 7572 6573 2f63 6f6e 6669 6775 7269  atures/configuri
-00003a60: 6e67 2d6a 6f62 2d63 6c75 7374 6572 732d  ng-job-clusters-
-00003a70: 7669 612d 6a73 6f6e 2363 6f6e 6669 6775  via-json#configu
-00003a80: 7269 6e67 2d64 6174 6162 7269 636b 732d  ring-databricks-
-00003a90: 6a6f 622d 636c 7573 7465 7273 0a20 2020  job-clusters.   
-00003aa0: 2022 2222 0a0a 2020 2020 2320 5573 6564   """..    # Used
-00003ab0: 2066 6f72 2059 414d 4c20 7061 7273 696e   for YAML parsin
-00003ac0: 6720 6173 2061 2050 7964 616e 7469 6320  g as a Pydantic 
-00003ad0: 6469 7363 7269 6d69 6e61 746f 722e 0a20  discriminator.. 
-00003ae0: 2020 206b 696e 643a 204c 6974 6572 616c     kind: Literal
-00003af0: 5b22 4461 7461 6272 6963 6b73 4a73 6f6e  ["DatabricksJson
-00003b00: 436c 7573 7465 7243 6f6e 6669 6722 5d20  ClusterConfig"] 
-00003b10: 3d20 2244 6174 6162 7269 636b 734a 736f  = "DatabricksJso
-00003b20: 6e43 6c75 7374 6572 436f 6e66 6967 220a  nClusterConfig".
-00003b30: 0a20 2020 2023 2055 7365 206a 736f 6e5f  .    # Use json_
-00003b40: 2077 6974 6820 616e 2061 6c69 6173 2074   with an alias t
-00003b50: 6f20 6176 6f69 6420 636f 6e66 6c69 6374  o avoid conflict
-00003b60: 696e 6720 7769 7468 2061 2050 7964 616e  ing with a Pydan
-00003b70: 7469 6320 4261 7365 4d6f 6465 6c20 6d65  tic BaseModel me
-00003b80: 7468 6f64 206a 736f 6e28 292e 2053 6861  thod json(). Sha
-00003b90: 646f 7720 7468 6174 206d 6574 686f 6420  dow that method 
-00003ba0: 7769 7468 0a20 2020 2023 2061 206a 736f  with.    # a jso
-00003bb0: 6e20 7072 6f70 6572 7479 2073 6f20 7468  n property so th
-00003bc0: 6174 2063 616c 6c65 7273 2063 616e 2061  at callers can a
-00003bd0: 6363 6573 7320 7468 6520 6669 656c 6420  ccess the field 
-00003be0: 696e 7475 6974 6976 656c 792e 0a20 2020  intuitively..   
-00003bf0: 206a 736f 6e5f 3a20 4469 6374 5b73 7472   json_: Dict[str
-00003c00: 2c20 416e 795d 203d 2070 7964 616e 7469  , Any] = pydanti
-00003c10: 635f 7631 2e46 6965 6c64 2861 6c69 6173  c_v1.Field(alias
-00003c20: 3d22 6a73 6f6e 2229 0a0a 2020 2020 2320  ="json")..    # 
-00003c30: 4120 5079 6461 6e74 6963 2070 7265 2d76  A Pydantic pre-v
-00003c40: 616c 6964 6174 6f72 2074 6f20 636f 6e76  alidator to conv
-00003c50: 6572 7420 6a73 6f6e 2073 7472 696e 6773  ert json strings
-00003c60: 2074 6f20 6120 6e61 7469 7665 2070 7974   to a native pyt
-00003c70: 686f 6e20 6f62 6a65 6374 2e0a 2020 2020  hon object..    
-00003c80: 5f6a 736f 6e5f 7374 725f 746f 5f64 6963  _json_str_to_dic
-00003c90: 7420 3d20 7079 6461 6e74 6963 5f76 312e  t = pydantic_v1.
-00003ca0: 7661 6c69 6461 746f 7228 226a 736f 6e5f  validator("json_
-00003cb0: 222c 2061 6c6c 6f77 5f72 6575 7365 3d54  ", allow_reuse=T
-00003cc0: 7275 652c 2070 7265 3d54 7275 6529 285f  rue, pre=True)(_
-00003cd0: 7374 725f 746f 5f6a 736f 6e5f 7374 7275  str_to_json_stru
-00003ce0: 6374 290a 0a20 2020 2064 6566 205f 746f  ct)..    def _to
-00003cf0: 5f63 6c75 7374 6572 5f70 726f 746f 2873  _cluster_proto(s
-00003d00: 656c 6629 202d 3e20 6665 6174 7572 655f  elf) -> feature_
-00003d10: 7669 6577 5f70 6232 2e43 6c75 7374 6572  view_pb2.Cluster
-00003d20: 436f 6e66 6967 3a0a 2020 2020 2020 2020  Config:.        
-00003d30: 7265 7475 726e 2066 6561 7475 7265 5f76  return feature_v
-00003d40: 6965 775f 7062 322e 436c 7573 7465 7243  iew_pb2.ClusterC
-00003d50: 6f6e 6669 6728 6a73 6f6e 5f64 6174 6162  onfig(json_datab
-00003d60: 7269 636b 733d 5f74 6f5f 6a73 6f6e 5f63  ricks=_to_json_c
-00003d70: 6c75 7374 6572 5f70 726f 746f 2873 656c  luster_proto(sel
-00003d80: 662e 6a73 6f6e 2929 0a0a 2020 2020 4070  f.json))..    @p
-00003d90: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00003da0: 6a73 6f6e 2873 656c 6629 202d 3e20 4469  json(self) -> Di
-00003db0: 6374 5b73 7472 2c20 416e 795d 3a0a 2020  ct[str, Any]:.  
-00003dc0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00003dd0: 662e 6a73 6f6e 5f0a 0a0a 636c 6173 7320  f.json_...class 
-00003de0: 4461 7461 6272 6963 6b73 436c 7573 7465  DatabricksCluste
-00003df0: 7243 6f6e 6669 6728 5374 7269 6374 4d6f  rConfig(StrictMo
-00003e00: 6465 6c29 3a0a 2020 2020 2222 2243 6f6e  del):.    """Con
-00003e10: 6669 6775 7261 7469 6f6e 2075 7365 6420  figuration used 
-00003e20: 746f 2073 7065 6369 6679 206d 6174 6572  to specify mater
-00003e30: 6961 6c69 7a61 7469 6f6e 2063 6c75 7374  ialization clust
-00003e40: 6572 206f 7074 696f 6e73 206f 6e20 4461  er options on Da
-00003e50: 7461 6272 6963 6b73 2e0a 0a20 2020 2054  tabricks...    T
-00003e60: 6869 7320 636c 6173 7320 6465 7363 7269  his class descri
-00003e70: 6265 7320 7468 6520 6174 7472 6962 7574  bes the attribut
-00003e80: 6573 206f 6620 7468 6520 6e65 7720 636c  es of the new cl
-00003e90: 7573 7465 7273 2077 6869 6368 2061 7265  usters which are
-00003ea0: 2063 7265 6174 6564 2069 6e20 4461 7461   created in Data
-00003eb0: 6272 6963 6b73 2064 7572 696e 670a 2020  bricks during.  
-00003ec0: 2020 6d61 7465 7269 616c 697a 6174 696f    materializatio
-00003ed0: 6e20 6a6f 6273 2e20 596f 7520 6361 6e20  n jobs. You can 
-00003ee0: 636f 6e66 6967 7572 6520 6f70 7469 6f6e  configure option
-00003ef0: 7320 6f66 2074 6865 7365 2063 6c75 7374  s of these clust
-00003f00: 6572 732c 206c 696b 6520 636c 7573 7465  ers, like cluste
-00003f10: 7220 7369 7a65 2061 6e64 2065 7874 7261  r size and extra
-00003f20: 2070 6970 2064 6570 656e 6465 6e63 6965   pip dependencie
-00003f30: 732e 0a0a 2020 2020 3a70 6172 616d 2069  s...    :param i
-00003f40: 6e73 7461 6e63 655f 7479 7065 3a20 496e  nstance_type: In
-00003f50: 7374 616e 6365 2074 7970 6520 666f 7220  stance type for 
-00003f60: 7468 6520 636c 7573 7465 722e 204d 7573  the cluster. Mus
-00003f70: 7420 6265 2061 2076 616c 6964 2074 7970  t be a valid typ
-00003f80: 6520 6173 206c 6973 7465 6420 696e 2068  e as listed in h
-00003f90: 7474 7073 3a2f 2f64 6174 6162 7269 636b  ttps://databrick
-00003fa0: 732e 636f 6d2f 7072 6f64 7563 742f 6177  s.com/product/aw
-00003fb0: 732d 7072 6963 696e 672f 696e 7374 616e  s-pricing/instan
-00003fc0: 6365 2d74 7970 6573 2e0a 2020 2020 2020  ce-types..      
-00003fd0: 2020 4164 6469 7469 6f6e 616c 6c79 2c20    Additionally, 
-00003fe0: 4772 6176 6974 6f6e 2069 6e73 7461 6e63  Graviton instanc
-00003ff0: 6573 2073 7563 6820 6173 2074 6865 206d  es such as the m
-00004000: 3667 2066 616d 696c 7920 6172 6520 6e6f  6g family are no
-00004010: 7420 7375 7070 6f72 7465 642e 2049 6620  t supported. If 
-00004020: 6e6f 7420 7370 6563 6966 6965 642c 2061  not specified, a
-00004030: 2076 616c 7565 2064 6574 6572 6d69 6e65   value determine
-00004040: 6420 6279 2074 6865 2054 6563 746f 6e20  d by the Tecton 
-00004050: 6261 636b 656e 6420 6973 2075 7365 642e  backend is used.
-00004060: 0a20 2020 203a 7061 7261 6d20 696e 7374  .    :param inst
-00004070: 616e 6365 5f61 7661 696c 6162 696c 6974  ance_availabilit
-00004080: 793a 2049 6e73 7461 6e63 6520 6176 6169  y: Instance avai
-00004090: 6c61 6269 6c69 7479 2066 6f72 2074 6865  lability for the
-000040a0: 2063 6c75 7374 6572 203a 2022 7370 6f74   cluster : "spot
-000040b0: 222c 2022 6f6e 5f64 656d 616e 6422 2c20  ", "on_demand", 
-000040c0: 6f72 2022 7370 6f74 5f77 6974 685f 6661  or "spot_with_fa
-000040d0: 6c6c 6261 636b 222e 0a20 2020 2020 2020  llback"..       
-000040e0: 2049 6620 6e6f 7420 7370 6563 6966 6965   If not specifie
-000040f0: 642c 2064 6566 6175 6c74 2069 7320 7370  d, default is sp
-00004100: 6f74 2e0a 2020 2020 3a70 6172 616d 2066  ot..    :param f
-00004110: 6972 7374 5f6f 6e5f 6465 6d61 6e64 3a20  irst_on_demand: 
-00004120: 5468 6520 6669 7273 7420 6066 6972 7374  The first `first
-00004130: 5f6f 6e5f 6465 6d61 6e64 6020 6e6f 6465  _on_demand` node
-00004140: 7320 6f66 2074 6865 2063 6c75 7374 6572  s of the cluster
-00004150: 2077 696c 6c20 7573 6520 6f6e 5f64 656d   will use on_dem
-00004160: 616e 6420 696e 7374 616e 6365 732e 2054  and instances. T
-00004170: 6865 2072 6573 7420 7769 6c6c 2075 7365  he rest will use
-00004180: 2074 6865 2074 7970 6520 7370 6563 6966   the type specif
-00004190: 6965 6420 6279 2069 6e73 7461 6e63 655f  ied by instance_
-000041a0: 6176 6169 6c61 6269 6c69 7479 2e0a 2020  availability..  
-000041b0: 2020 2020 2020 4966 2066 6972 7374 5f6f        If first_o
-000041c0: 6e5f 6465 6d61 6e64 203e 3d20 312c 2074  n_demand >= 1, t
-000041d0: 6865 2064 7269 7665 7220 6e6f 6465 2075  he driver node u
-000041e0: 7365 206f 6e5f 6465 6d61 6e64 2069 6e73  se on_demand ins
-000041f0: 7461 6e63 6520 7479 7065 2e0a 2020 2020  tance type..    
-00004200: 3a70 6172 616d 206e 756d 6265 725f 6f66  :param number_of
-00004210: 5f77 6f72 6b65 7273 3a20 4e75 6d62 6572  _workers: Number
-00004220: 206f 6620 696e 7374 616e 6365 7320 666f   of instances fo
-00004230: 7220 7468 6520 6d61 7465 7269 616c 697a  r the materializ
-00004240: 6174 696f 6e20 6a6f 622e 2049 6620 6e6f  ation job. If no
-00004250: 7420 7370 6563 6966 6965 642c 2061 2076  t specified, a v
-00004260: 616c 7565 2064 6574 6572 6d69 6e65 6420  alue determined 
-00004270: 6279 2074 6865 2054 6563 746f 6e20 6261  by the Tecton ba
-00004280: 636b 656e 6420 6973 2075 7365 642e 0a20  ckend is used.. 
-00004290: 2020 2020 2020 2049 6620 7365 7420 746f         If set to
-000042a0: 2030 2074 6865 6e20 6a6f 6273 2077 696c   0 then jobs wil
-000042b0: 6c20 6265 2072 756e 2069 6e20 7369 6e67  l be run in sing
-000042c0: 6c65 2d6e 6f64 6520 636c 7573 7465 7273  le-node clusters
-000042d0: 2e0a 2020 2020 3a70 6172 616d 2065 7874  ..    :param ext
-000042e0: 7261 5f70 6970 5f64 6570 656e 6465 6e63  ra_pip_dependenc
-000042f0: 6965 733a 2045 7874 7261 2070 6970 2064  ies: Extra pip d
-00004300: 6570 656e 6465 6e63 6965 7320 746f 2062  ependencies to b
-00004310: 6520 696e 7374 616c 6c65 6420 6f6e 2074  e installed on t
-00004320: 6865 206d 6174 6572 6961 6c69 7a61 7469  he materializati
-00004330: 6f6e 2063 6c75 7374 6572 2e20 4d75 7374  on cluster. Must
-00004340: 2062 6520 5079 5049 2070 6163 6b61 6765   be PyPI package
-00004350: 732c 206f 7220 7768 6565 6c73 2f65 6767  s, or wheels/egg
-00004360: 7320 696e 2053 3320 6f72 2044 4246 532e  s in S3 or DBFS.
-00004370: 0a20 2020 203a 7061 7261 6d20 7370 6172  .    :param spar
-00004380: 6b5f 636f 6e66 6967 3a20 4d61 7020 6f66  k_config: Map of
-00004390: 2053 7061 726b 2063 6f6e 6669 6775 7261   Spark configura
-000043a0: 7469 6f6e 206f 7074 696f 6e73 2061 6e64  tion options and
-000043b0: 2074 6865 6972 2072 6573 7065 6374 6976   their respectiv
-000043c0: 6520 7661 6c75 6573 2074 6861 7420 7769  e values that wi
-000043d0: 6c6c 2062 6520 7061 7373 6564 2074 6f20  ll be passed to 
-000043e0: 7468 650a 2020 2020 2020 2020 4665 6174  the.        Feat
-000043f0: 7572 6556 6965 7720 6d61 7465 7269 616c  ureView material
-00004400: 697a 6174 696f 6e20 5370 6172 6b20 636c  ization Spark cl
-00004410: 7573 7465 722e 0a20 2020 203a 7061 7261  uster..    :para
-00004420: 6d20 6462 725f 7665 7273 696f 6e3a 2044  m dbr_version: D
-00004430: 4252 2076 6572 7369 6f6e 206f 6620 7468  BR version of th
-00004440: 6520 636c 7573 7465 722e 2053 7570 706f  e cluster. Suppo
-00004450: 7274 6564 2076 6572 7369 6f6e 7320 696e  rted versions in
-00004460: 636c 7564 6520 392e 312e 782d 7363 616c  clude 9.1.x-scal
-00004470: 6132 2e31 322c 2031 302e 342e 782d 7363  a2.12, 10.4.x-sc
-00004480: 616c 6132 2e31 322c 2061 6e64 2031 312e  ala2.12, and 11.
-00004490: 332e 782d 7363 616c 6132 2e31 322e 2028  3.x-scala2.12. (
-000044a0: 4465 6661 756c 743a 2031 302e 342e 782d  Default: 10.4.x-
-000044b0: 7363 616c 6132 2e31 3229 0a0a 2020 2020  scala2.12)..    
-000044c0: 4e6f 7465 206f 6e20 6060 6578 7472 615f  Note on ``extra_
-000044d0: 7069 705f 6465 7065 6e64 656e 6369 6573  pip_dependencies
-000044e0: 6060 3a20 5468 6973 2069 7320 6120 6c69  ``: This is a li
-000044f0: 7374 206f 6620 7061 636b 6167 6573 2074  st of packages t
-00004500: 6861 7420 7769 6c6c 2062 6520 696e 7374  hat will be inst
-00004510: 616c 6c65 6420 6475 7269 6e67 206d 6174  alled during mat
-00004520: 6572 6961 6c69 7a61 7469 6f6e 2e0a 2020  erialization..  
-00004530: 2020 546f 2075 7365 2050 7950 4920 7061    To use PyPI pa
-00004540: 636b 6167 6573 2c20 7370 6563 6966 7920  ckages, specify 
-00004550: 7468 6520 7061 636b 6167 6520 6e61 6d65  the package name
-00004560: 2061 6e64 206f 7074 696f 6e61 6c6c 7920   and optionally 
-00004570: 7468 6520 7665 7273 696f 6e2c 2065 2e67  the version, e.g
-00004580: 2e20 6060 2274 656e 736f 7266 6c6f 7722  . ``"tensorflow"
-00004590: 6060 206f 7220 6060 2274 656e 736f 7266  `` or ``"tensorf
-000045a0: 6c6f 773d 3d32 2e32 2e30 2260 602e 0a20  low==2.2.0"``.. 
-000045b0: 2020 2054 6f20 7573 6520 6375 7374 6f6d     To use custom
-000045c0: 2063 6f64 652c 2070 6163 6b61 6765 2069   code, package i
-000045d0: 7420 6173 2061 2050 7974 686f 6e20 7768  t as a Python wh
-000045e0: 6565 6c20 6f72 2065 6767 2066 696c 6520  eel or egg file 
-000045f0: 696e 2053 3320 6f72 2044 4246 532c 2074  in S3 or DBFS, t
-00004600: 6865 6e20 7370 6563 6966 7920 7468 6520  hen specify the 
-00004610: 7061 7468 2074 6f20 7468 6520 6669 6c65  path to the file
-00004620: 2c0a 2020 2020 652e 672e 2060 6022 7333  ,.    e.g. ``"s3
-00004630: 3a2f 2f6d 792d 6275 636b 6574 2f70 6174  ://my-bucket/pat
-00004640: 682f 6375 7374 6f6d 2e77 686c 2260 602c  h/custom.whl"``,
-00004650: 206f 7220 6060 2264 6266 733a 2f70 6174   or ``"dbfs:/pat
-00004660: 682f 746f 2f63 7573 746f 6d2e 7768 6c22  h/to/custom.whl"
-00004670: 6060 2e0a 0a20 2020 2054 6865 7365 206c  ``...    These l
-00004680: 6962 7261 7269 6573 2077 696c 6c20 6f6e  ibraries will on
-00004690: 6c79 2062 6520 6176 6169 6c61 626c 6520  ly be available 
-000046a0: 746f 2075 7365 2069 6e73 6964 6520 5370  to use inside Sp
-000046b0: 6172 6b20 5544 4673 2e20 466f 7220 6578  ark UDFs. For ex
-000046c0: 616d 706c 652c 2069 6620 796f 7520 7365  ample, if you se
-000046d0: 740a 2020 2020 6060 6578 7472 615f 7069  t.    ``extra_pi
-000046e0: 705f 6465 7065 6e64 656e 6369 6573 3d5b  p_dependencies=[
-000046f0: 2274 656e 736f 7266 6c6f 7722 5d60 602c  "tensorflow"]``,
-00004700: 2079 6f75 2063 616e 2075 7365 2069 7420   you can use it 
-00004710: 696e 2079 6f75 7220 7472 616e 7366 6f72  in your transfor
-00004720: 6d61 7469 6f6e 2061 7320 7368 6f77 6e20  mation as shown 
-00004730: 6265 6c6f 772e 0a0a 2020 2020 416e 2065  below...    An e
-00004740: 7861 6d70 6c65 206f 6620 4461 7461 6272  xample of Databr
-00004750: 6963 6b73 436c 7573 7465 7243 6f6e 6669  icksClusterConfi
-00004760: 672e 0a0a 2020 2020 2e2e 2063 6f64 652d  g...    .. code-
-00004770: 626c 6f63 6b3a 3a20 7079 7468 6f6e 0a0a  block:: python..
-00004780: 2020 2020 2020 2020 6672 6f6d 2074 6563          from tec
-00004790: 746f 6e20 696d 706f 7274 2062 6174 6368  ton import batch
-000047a0: 5f66 6561 7475 7265 5f76 6965 772c 2049  _feature_view, I
-000047b0: 6e70 7574 2c20 4461 7461 6272 6963 6b73  nput, Databricks
-000047c0: 436c 7573 7465 7243 6f6e 6669 670a 0a20  ClusterConfig.. 
-000047d0: 2020 2020 2020 2040 6261 7463 685f 6665         @batch_fe
-000047e0: 6174 7572 655f 7669 6577 280a 2020 2020  ature_view(.    
-000047f0: 2020 2020 2020 2020 736f 7572 6365 733d          sources=
-00004800: 5b46 696c 7465 7265 6453 6f75 7263 6528  [FilteredSource(
-00004810: 6372 6564 6974 5f73 636f 7265 735f 6261  credit_scores_ba
-00004820: 7463 6829 5d2c 0a20 2020 2020 2020 2020  tch)],.         
-00004830: 2020 2023 2043 616e 2062 6520 616e 2061     # Can be an a
-00004840: 7267 756d 656e 7420 696e 7374 616e 6365  rgument instance
-00004850: 2074 6f20 6120 6261 7463 6820 6665 6174   to a batch feat
-00004860: 7572 6520 7669 6577 2064 6563 6f72 6174  ure view decorat
-00004870: 6f72 0a20 2020 2020 2020 2020 2020 2062  or.            b
-00004880: 6174 6368 5f63 6f6d 7075 7465 203d 2044  atch_compute = D
-00004890: 6174 6162 7269 636b 7343 6c75 7374 6572  atabricksCluster
-000048a0: 436f 6e66 6967 280a 2020 2020 2020 2020  Config(.        
-000048b0: 2020 2020 2020 2020 696e 7374 616e 6365          instance
-000048c0: 5f74 7970 6520 3d20 276d 352e 3278 6c61  _type = 'm5.2xla
-000048d0: 7267 6527 2c0a 2020 2020 2020 2020 2020  rge',.          
-000048e0: 2020 2020 2020 7370 6172 6b5f 636f 6e66        spark_conf
-000048f0: 6967 203d 207b 2273 7061 726b 2e65 7865  ig = {"spark.exe
-00004900: 6375 746f 722e 6d65 6d6f 7279 2220 3a20  cutor.memory" : 
-00004910: 2231 3267 227d 0a20 2020 2020 2020 2020  "12g"}.         
-00004920: 2020 2020 2020 2065 7874 7261 5f70 6970         extra_pip
-00004930: 5f64 6570 656e 6465 6e63 6965 733d 5b22  _dependencies=["
-00004940: 7465 6e73 6f72 666c 6f77 225d 2c0a 2020  tensorflow"],.  
-00004950: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
-00004960: 2020 2020 2020 2020 2023 204f 7468 6572           # Other
-00004970: 206e 616d 6564 2061 7267 756d 656e 7473   named arguments
-00004980: 2074 6f20 6261 7463 6820 6665 6174 7572   to batch featur
-00004990: 6520 7669 6577 0a20 2020 2020 2020 2020  e view.         
-000049a0: 2020 202e 2e2e 0a20 2020 2020 2020 2029     ....        )
-000049b0: 0a0a 2020 2020 2020 2020 2320 5573 6520  ..        # Use 
-000049c0: 7468 6520 7465 6e73 6f72 666c 6f77 2070  the tensorflow p
-000049d0: 6163 6b61 6765 2069 6e20 7468 6520 5544  ackage in the UD
-000049e0: 4620 7369 6e63 6520 7465 6e73 6f72 666c  F since tensorfl
-000049f0: 6f77 2077 696c 6c20 6265 2069 6e73 7461  ow will be insta
-00004a00: 6c6c 6564 0a20 2020 2020 2020 2023 206f  lled.        # o
-00004a10: 6e20 7468 6520 4461 7461 6272 6963 6b73  n the Databricks
-00004a20: 2053 7061 726b 2063 6c75 7374 6572 2e20   Spark cluster. 
-00004a30: 5468 6520 696d 706f 7274 2068 6173 2074  The import has t
-00004a40: 6f20 6265 2077 6974 6869 6e20 7468 6520  o be within the 
-00004a50: 5544 4620 626f 6479 2e20 5075 7474 696e  UDF body. Puttin
-00004a60: 6720 6974 2061 7420 7468 650a 2020 2020  g it at the.    
-00004a70: 2020 2020 2320 746f 7020 6f66 2074 6865      # top of the
-00004a80: 2066 696c 6520 6f72 2069 6e73 6964 6520   file or inside 
-00004a90: 7472 616e 7366 6f72 6d61 7469 6f6e 2066  transformation f
-00004aa0: 756e 6374 696f 6e20 776f 6e27 7420 776f  unction won't wo
-00004ab0: 726b 2e0a 0a20 2020 2020 2020 2040 7472  rk...        @tr
-00004ac0: 616e 7366 6f72 6d61 7469 6f6e 286d 6f64  ansformation(mod
-00004ad0: 653d 2770 7973 7061 726b 2729 0a20 2020  e='pyspark').   
-00004ae0: 2020 2020 2064 6566 2074 6573 745f 7472       def test_tr
-00004af0: 616e 7366 6f72 6d61 7469 6f6e 2874 7261  ansformation(tra
-00004b00: 6e73 666f 726d 6174 696f 6e5f 696e 7075  nsformation_inpu
-00004b10: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-00004b20: 6672 6f6d 2070 7973 7061 726b 2e73 716c  from pyspark.sql
-00004b30: 2069 6d70 6f72 7420 6675 6e63 7469 6f6e   import function
-00004b40: 7320 6173 2046 0a20 2020 2020 2020 2020  s as F.         
-00004b50: 2020 2066 726f 6d20 7079 7370 6172 6b2e     from pyspark.
-00004b60: 7371 6c2e 7479 7065 7320 696d 706f 7274  sql.types import
-00004b70: 2049 6e74 6567 6572 5479 7065 0a0a 2020   IntegerType..  
-00004b80: 2020 2020 2020 2020 2020 6465 6620 6d79            def my
-00004b90: 5f74 656e 736f 7266 6c6f 7728 7829 3a0a  _tensorflow(x):.
-00004ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004bb0: 696d 706f 7274 2074 656e 736f 7266 6c6f  import tensorflo
-00004bc0: 7720 6173 2074 660a 2020 2020 2020 2020  w as tf.        
-00004bd0: 2020 2020 2020 2020 7265 7475 726e 2069          return i
-00004be0: 6e74 2874 662e 6d61 7468 2e6c 6f67 3170  nt(tf.math.log1p
-00004bf0: 2866 6c6f 6174 2878 2929 2e6e 756d 7079  (float(x)).numpy
-00004c00: 2829 290a 0a20 2020 2020 2020 2020 2020  ())..           
-00004c10: 206d 795f 7465 6e73 6f72 666c 6f77 5f75   my_tensorflow_u
-00004c20: 6466 203d 2046 2e75 6466 286d 795f 7465  df = F.udf(my_te
-00004c30: 6e73 6f72 666c 6f77 2c20 496e 7465 6765  nsorflow, Intege
-00004c40: 7254 7970 6528 2929 0a0a 2020 2020 2020  rType())..      
-00004c50: 2020 2020 2020 7265 7475 726e 2074 7261        return tra
-00004c60: 6e73 666f 726d 6174 696f 6e5f 696e 7075  nsformation_inpu
-00004c70: 742e 7365 6c65 6374 280a 2020 2020 2020  t.select(.      
-00004c80: 2020 2020 2020 2020 2020 2765 6e74 6974            'entit
-00004c90: 795f 6964 272c 0a20 2020 2020 2020 2020  y_id',.         
-00004ca0: 2020 2020 2020 2027 7469 6d65 7374 616d         'timestam
-00004cb0: 7027 2c0a 2020 2020 2020 2020 2020 2020  p',.            
-00004cc0: 2020 2020 6d79 5f74 656e 736f 7266 6c6f      my_tensorflo
-00004cd0: 775f 7564 6628 2763 6c69 636b 7327 292e  w_udf('clicks').
-00004ce0: 616c 6961 7328 276c 6f67 3170 5f63 6c69  alias('log1p_cli
-00004cf0: 636b 7327 290a 2020 2020 2020 2020 2020  cks').          
-00004d00: 2020 290a 0a20 2020 2022 2222 0a0a 2020    )..    """..  
-00004d10: 2020 2320 5573 6564 2066 6f72 2059 414d    # Used for YAM
-00004d20: 4c20 7061 7273 696e 6720 6173 2061 2050  L parsing as a P
-00004d30: 7964 616e 7469 6320 6469 7363 7269 6d69  ydantic discrimi
-00004d40: 6e61 746f 722e 0a20 2020 206b 696e 643a  nator..    kind:
-00004d50: 204c 6974 6572 616c 5b22 4461 7461 6272   Literal["Databr
-00004d60: 6963 6b73 436c 7573 7465 7243 6f6e 6669  icksClusterConfi
-00004d70: 6722 5d20 3d20 2244 6174 6162 7269 636b  g"] = "Databrick
-00004d80: 7343 6c75 7374 6572 436f 6e66 6967 220a  sClusterConfig".
-00004d90: 2020 2020 696e 7374 616e 6365 5f74 7970      instance_typ
-00004da0: 653a 204f 7074 696f 6e61 6c5b 7374 725d  e: Optional[str]
-00004db0: 203d 204e 6f6e 650a 2020 2020 696e 7374   = None.    inst
-00004dc0: 616e 6365 5f61 7661 696c 6162 696c 6974  ance_availabilit
-00004dd0: 793a 204f 7074 696f 6e61 6c5b 7374 725d  y: Optional[str]
-00004de0: 203d 204e 6f6e 650a 2020 2020 6e75 6d62   = None.    numb
-00004df0: 6572 5f6f 665f 776f 726b 6572 733a 204f  er_of_workers: O
-00004e00: 7074 696f 6e61 6c5b 696e 745d 203d 204e  ptional[int] = N
-00004e10: 6f6e 650a 2020 2020 6669 7273 745f 6f6e  one.    first_on
-00004e20: 5f64 656d 616e 643a 204f 7074 696f 6e61  _demand: Optiona
-00004e30: 6c5b 696e 745d 203d 204e 6f6e 650a 2020  l[int] = None.  
-00004e40: 2020 6578 7472 615f 7069 705f 6465 7065    extra_pip_depe
-00004e50: 6e64 656e 6369 6573 3a20 4f70 7469 6f6e  ndencies: Option
-00004e60: 616c 5b4c 6973 745b 7374 725d 5d20 3d20  al[List[str]] = 
-00004e70: 4e6f 6e65 0a20 2020 2073 7061 726b 5f63  None.    spark_c
-00004e80: 6f6e 6669 673a 204f 7074 696f 6e61 6c5b  onfig: Optional[
-00004e90: 4469 6374 5b73 7472 2c20 7374 725d 5d20  Dict[str, str]] 
-00004ea0: 3d20 4e6f 6e65 0a20 2020 2064 6272 5f76  = None.    dbr_v
-00004eb0: 6572 7369 6f6e 3a20 7374 7220 3d20 4445  ersion: str = DE
-00004ec0: 4641 554c 545f 5350 4152 4b5f 5645 5253  FAULT_SPARK_VERS
-00004ed0: 494f 4e53 5b22 6461 7461 6272 6963 6b73  IONS["databricks
-00004ee0: 5f73 7061 726b 5f76 6572 7369 6f6e 225d  _spark_version"]
-00004ef0: 0a0a 2020 2020 6465 6620 5f74 6f5f 7072  ..    def _to_pr
-00004f00: 6f74 6f28 7365 6c66 2920 2d3e 2066 6561  oto(self) -> fea
-00004f10: 7475 7265 5f76 6965 775f 7062 322e 4e65  ture_view_pb2.Ne
-00004f20: 7743 6c75 7374 6572 436f 6e66 6967 3a0a  wClusterConfig:.
-00004f30: 2020 2020 2020 2020 7072 6f74 6f20 3d20          proto = 
-00004f40: 6665 6174 7572 655f 7669 6577 5f70 6232  feature_view_pb2
-00004f50: 2e4e 6577 436c 7573 7465 7243 6f6e 6669  .NewClusterConfi
-00004f60: 6728 290a 2020 2020 2020 2020 6966 2073  g().        if s
-00004f70: 656c 662e 696e 7374 616e 6365 5f74 7970  elf.instance_typ
-00004f80: 653a 0a20 2020 2020 2020 2020 2020 2070  e:.            p
-00004f90: 726f 746f 2e69 6e73 7461 6e63 655f 7479  roto.instance_ty
-00004fa0: 7065 203d 2073 656c 662e 696e 7374 616e  pe = self.instan
-00004fb0: 6365 5f74 7970 650a 2020 2020 2020 2020  ce_type.        
-00004fc0: 6966 2073 656c 662e 696e 7374 616e 6365  if self.instance
-00004fd0: 5f61 7661 696c 6162 696c 6974 793a 0a20  _availability:. 
-00004fe0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00004ff0: 6c66 2e69 6e73 7461 6e63 655f 6176 6169  lf.instance_avai
-00005000: 6c61 6269 6c69 7479 206e 6f74 2069 6e20  lability not in 
-00005010: 4441 5441 4252 4943 4b53 5f53 5550 504f  DATABRICKS_SUPPO
-00005020: 5254 4544 5f41 5641 494c 4142 494c 4954  RTED_AVAILABILIT
-00005030: 593a 0a20 2020 2020 2020 2020 2020 2020  Y:.             
-00005040: 2020 206d 7367 203d 2066 2249 6e73 7461     msg = f"Insta
-00005050: 6e63 6520 6176 6169 6c61 6269 6c69 7479  nce availability
-00005060: 207b 7365 6c66 2e69 6e73 7461 6e63 655f   {self.instance_
-00005070: 6176 6169 6c61 6269 6c69 7479 7d20 6973  availability} is
-00005080: 206e 6f74 2073 7570 706f 7274 6564 2e20   not supported. 
-00005090: 4368 6f6f 7365 207b 4156 4149 4c41 4249  Choose {AVAILABI
-000050a0: 4c49 5459 5f53 504f 547d 2c20 7b41 5641  LITY_SPOT}, {AVA
-000050b0: 494c 4142 494c 4954 595f 4f4e 5f44 454d  ILABILITY_ON_DEM
-000050c0: 414e 447d 206f 7220 7b41 5641 494c 4142  AND} or {AVAILAB
-000050d0: 494c 4954 595f 5350 4f54 5f46 414c 4c42  ILITY_SPOT_FALLB
-000050e0: 4143 4b7d 220a 2020 2020 2020 2020 2020  ACK}".          
-000050f0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00005100: 6545 7272 6f72 286d 7367 290a 2020 2020  eError(msg).    
-00005110: 2020 2020 2020 2020 7072 6f74 6f2e 696e          proto.in
-00005120: 7374 616e 6365 5f61 7661 696c 6162 696c  stance_availabil
-00005130: 6974 7920 3d20 7365 6c66 2e69 6e73 7461  ity = self.insta
-00005140: 6e63 655f 6176 6169 6c61 6269 6c69 7479  nce_availability
-00005150: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00005160: 2e64 6272 5f76 6572 7369 6f6e 206e 6f74  .dbr_version not
-00005170: 2069 6e20 4441 5441 4252 4943 4b53 5f53   in DATABRICKS_S
-00005180: 5550 504f 5254 4544 5f53 5041 524b 3a0a  UPPORTED_SPARK:.
-00005190: 2020 2020 2020 2020 2020 2020 6d73 6720              msg 
-000051a0: 3d20 6622 4461 7461 6272 6963 6b73 2076  = f"Databricks v
-000051b0: 6572 7369 6f6e 207b 7365 6c66 2e64 6272  ersion {self.dbr
-000051c0: 5f76 6572 7369 6f6e 7d20 6973 206e 6f74  _version} is not
-000051d0: 2073 7570 706f 7274 6564 2e20 5375 7070   supported. Supp
-000051e0: 6f72 7465 6420 7665 7273 696f 6e73 3a20  orted versions: 
-000051f0: 7b44 4154 4142 5249 434b 535f 5355 5050  {DATABRICKS_SUPP
-00005200: 4f52 5445 445f 5350 4152 4b7d 220a 2020  ORTED_SPARK}".  
-00005210: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00005220: 5661 6c75 6545 7272 6f72 286d 7367 290a  ValueError(msg).
-00005230: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00005240: 2e6e 756d 6265 725f 6f66 5f77 6f72 6b65  .number_of_worke
-00005250: 7273 2069 7320 6e6f 7420 4e6f 6e65 3a0a  rs is not None:.
-00005260: 2020 2020 2020 2020 2020 2020 7072 6f74              prot
-00005270: 6f2e 6e75 6d62 6572 5f6f 665f 776f 726b  o.number_of_work
-00005280: 6572 7320 3d20 7365 6c66 2e6e 756d 6265  ers = self.numbe
-00005290: 725f 6f66 5f77 6f72 6b65 7273 0a20 2020  r_of_workers.   
-000052a0: 2020 2020 2069 6620 7365 6c66 2e66 6972       if self.fir
-000052b0: 7374 5f6f 6e5f 6465 6d61 6e64 3a0a 2020  st_on_demand:.  
-000052c0: 2020 2020 2020 2020 2020 7072 6f74 6f2e            proto.
-000052d0: 6669 7273 745f 6f6e 5f64 656d 616e 6420  first_on_demand 
-000052e0: 3d20 7365 6c66 2e66 6972 7374 5f6f 6e5f  = self.first_on_
-000052f0: 6465 6d61 6e64 0a20 2020 2020 2020 2069  demand.        i
-00005300: 6620 7365 6c66 2e65 7874 7261 5f70 6970  f self.extra_pip
-00005310: 5f64 6570 656e 6465 6e63 6965 733a 0a20  _dependencies:. 
-00005320: 2020 2020 2020 2020 2020 2023 2050 7265             # Pre
-00005330: 7474 7920 6561 7379 2074 6f20 646f 2065  tty easy to do e
-00005340: 2e67 2e20 6578 7472 615f 7069 705f 6465  .g. extra_pip_de
-00005350: 7065 6e64 656e 6369 6573 3d22 7465 6e73  pendencies="tens
-00005360: 6f72 666c 6f77 2220 6279 206d 6973 7461  orflow" by mista
-00005370: 6b65 2061 6e64 2065 6e64 2075 7020 7769  ke and end up wi
-00005380: 7468 0a20 2020 2020 2020 2020 2020 2023  th.            #
-00005390: 205b 742c 2065 2c20 6e2c 2073 2c20 6f2c   [t, e, n, s, o,
-000053a0: 2072 2c20 662c 206c 2c20 6f2c 2077 5d20   r, f, l, o, w] 
-000053b0: 6173 2061 206c 6973 7420 6f66 2064 6570  as a list of dep
-000053c0: 656e 6465 6e63 6965 7320 7061 7373 6564  endencies passed
-000053d0: 2074 6f20 7468 6520 5370 6172 6b20 6a6f   to the Spark jo
-000053e0: 622e 0a20 2020 2020 2020 2020 2020 2023  b..            #
-000053f0: 0a20 2020 2020 2020 2020 2020 2023 2053  .            # S
-00005400: 696e 6365 2074 6869 7320 6973 2061 6e6e  ince this is ann
-00005410: 6f79 696e 6720 746f 2064 6562 7567 2c20  oying to debug, 
-00005420: 7765 2063 6865 636b 2066 6f72 2074 6861  we check for tha
-00005430: 7420 6865 7265 2e0a 2020 2020 2020 2020  t here..        
-00005440: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00005450: 6528 7365 6c66 2e65 7874 7261 5f70 6970  e(self.extra_pip
-00005460: 5f64 6570 656e 6465 6e63 6965 732c 2073  _dependencies, s
-00005470: 7472 293a 0a20 2020 2020 2020 2020 2020  tr):.           
-00005480: 2020 2020 206d 7367 203d 2022 6578 7472       msg = "extr
-00005490: 615f 7069 705f 6465 7065 6e64 656e 6369  a_pip_dependenci
-000054a0: 6573 206d 7573 7420 6265 2061 206c 6973  es must be a lis
-000054b0: 7422 0a20 2020 2020 2020 2020 2020 2020  t".             
-000054c0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000054d0: 726f 7228 6d73 6729 0a20 2020 2020 2020  ror(msg).       
-000054e0: 2020 2020 2070 726f 746f 2e65 7874 7261       proto.extra
-000054f0: 5f70 6970 5f64 6570 656e 6465 6e63 6965  _pip_dependencie
-00005500: 732e 6578 7465 6e64 2873 656c 662e 6578  s.extend(self.ex
-00005510: 7472 615f 7069 705f 6465 7065 6e64 656e  tra_pip_dependen
-00005520: 6369 6573 290a 2020 2020 2020 2020 6966  cies).        if
-00005530: 2073 656c 662e 7370 6172 6b5f 636f 6e66   self.spark_conf
-00005540: 6967 3a0a 2020 2020 2020 2020 2020 2020  ig:.            
-00005550: 7370 6172 6b5f 636f 6e66 6967 203d 2053  spark_config = S
-00005560: 7061 726b 436f 6e66 6967 5772 6170 7065  parkConfigWrappe
-00005570: 7228 7370 6172 6b5f 636f 6e66 6967 5f6d  r(spark_config_m
-00005580: 6170 3d73 656c 662e 7370 6172 6b5f 636f  ap=self.spark_co
-00005590: 6e66 6967 292e 5f74 6f5f 7072 6f74 6f28  nfig)._to_proto(
-000055a0: 290a 2020 2020 2020 2020 2020 2020 7072  ).            pr
-000055b0: 6f74 6f2e 7370 6172 6b5f 636f 6e66 6967  oto.spark_config
-000055c0: 2e43 6f70 7946 726f 6d28 7370 6172 6b5f  .CopyFrom(spark_
-000055d0: 636f 6e66 6967 290a 2020 2020 2020 2020  config).        
-000055e0: 7072 6f74 6f2e 7069 6e6e 6564 5f73 7061  proto.pinned_spa
-000055f0: 726b 5f76 6572 7369 6f6e 203d 2073 656c  rk_version = sel
-00005600: 662e 6462 725f 7665 7273 696f 6e0a 0a20  f.dbr_version.. 
-00005610: 2020 2020 2020 2072 6574 7572 6e20 7072         return pr
-00005620: 6f74 6f0a 0a20 2020 2064 6566 205f 746f  oto..    def _to
-00005630: 5f63 6c75 7374 6572 5f70 726f 746f 2873  _cluster_proto(s
-00005640: 656c 6629 202d 3e20 6665 6174 7572 655f  elf) -> feature_
-00005650: 7669 6577 5f70 6232 2e43 6c75 7374 6572  view_pb2.Cluster
-00005660: 436f 6e66 6967 3a0a 2020 2020 2020 2020  Config:.        
-00005670: 7265 7475 726e 2066 6561 7475 7265 5f76  return feature_v
-00005680: 6965 775f 7062 322e 436c 7573 7465 7243  iew_pb2.ClusterC
-00005690: 6f6e 6669 6728 6e65 775f 6461 7461 6272  onfig(new_databr
-000056a0: 6963 6b73 3d73 656c 662e 5f74 6f5f 7072  icks=self._to_pr
-000056b0: 6f74 6f28 2929 0a0a 0a63 6c61 7373 2052  oto())...class R
-000056c0: 6966 7442 6174 6368 436f 6e66 6967 2853  iftBatchConfig(S
-000056d0: 7472 6963 744d 6f64 656c 293a 0a20 2020  trictModel):.   
-000056e0: 2022 2222 436f 6e66 6967 7572 6174 696f   """Configuratio
-000056f0: 6e20 7573 6564 2074 6f20 7370 6563 6966  n used to specif
-00005700: 7920 6d61 7465 7269 616c 697a 6174 696f  y materializatio
-00005710: 6e20 636f 6d70 7574 6520 6f70 7469 6f6e  n compute option
-00005720: 7320 6f6e 2052 6966 742e 0a0a 2020 2020  s on Rift...    
-00005730: 3a70 6172 616d 2069 6e73 7461 6e63 655f  :param instance_
-00005740: 7479 7065 3a20 496e 7374 616e 6365 2074  type: Instance t
-00005750: 7970 6520 666f 7220 7468 6520 6d61 7465  ype for the mate
-00005760: 7269 616c 697a 6174 696f 6e20 6a6f 622e  rialization job.
-00005770: 204d 7573 7420 6265 2061 2076 616c 6964   Must be a valid
-00005780: 2045 4332 2069 6e73 7461 6e63 6520 7479   EC2 instance ty
-00005790: 7065 2061 7320 6c69 7374 6564 2069 6e0a  pe as listed in.
-000057a0: 2020 2020 2020 2020 6874 7470 733a 2f2f          https://
-000057b0: 6177 732e 616d 617a 6f6e 2e63 6f6d 2f65  aws.amazon.com/e
-000057c0: 6332 2f69 6e73 7461 6e63 652d 7479 7065  c2/instance-type
-000057d0: 732f 2e20 4966 206e 6f74 2073 7065 6369  s/. If not speci
-000057e0: 6669 6564 2c20 6120 7661 6c75 6520 6465  fied, a value de
-000057f0: 7465 726d 696e 6564 2062 7920 7468 6520  termined by the 
-00005800: 5465 6374 6f6e 2062 6163 6b65 6e64 2069  Tecton backend i
-00005810: 7320 7573 6564 2e0a 2020 2020 2222 220a  s used..    """.
-00005820: 0a20 2020 2023 2055 7365 6420 666f 7220  .    # Used for 
-00005830: 5941 4d4c 2070 6172 7369 6e67 2061 7320  YAML parsing as 
-00005840: 6120 5079 6461 6e74 6963 2064 6973 6372  a Pydantic discr
-00005850: 696d 696e 6174 6f72 2e0a 2020 2020 6b69  iminator..    ki
-00005860: 6e64 3a20 4c69 7465 7261 6c5b 2252 6966  nd: Literal["Rif
-00005870: 7442 6174 6368 436f 6e66 6967 225d 203d  tBatchConfig"] =
-00005880: 2022 5269 6674 4261 7463 6843 6f6e 6669   "RiftBatchConfi
-00005890: 6722 0a20 2020 2069 6e73 7461 6e63 655f  g".    instance_
-000058a0: 7479 7065 3a20 4f70 7469 6f6e 616c 5b73  type: Optional[s
-000058b0: 7472 5d20 3d20 4e6f 6e65 0a0a 2020 2020  tr] = None..    
-000058c0: 6465 6620 5f74 6f5f 7072 6f74 6f28 7365  def _to_proto(se
-000058d0: 6c66 2920 2d3e 2066 6561 7475 7265 5f76  lf) -> feature_v
-000058e0: 6965 775f 7062 322e 5269 6674 436c 7573  iew_pb2.RiftClus
-000058f0: 7465 7243 6f6e 6669 673a 0a20 2020 2020  terConfig:.     
-00005900: 2020 2070 726f 746f 203d 2066 6561 7475     proto = featu
-00005910: 7265 5f76 6965 775f 7062 322e 5269 6674  re_view_pb2.Rift
-00005920: 436c 7573 7465 7243 6f6e 6669 6728 290a  ClusterConfig().
-00005930: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00005940: 696e 7374 616e 6365 5f74 7970 653a 0a20  instance_type:. 
-00005950: 2020 2020 2020 2020 2020 2070 726f 746f             proto
-00005960: 2e69 6e73 7461 6e63 655f 7479 7065 203d  .instance_type =
-00005970: 2073 656c 662e 696e 7374 616e 6365 5f74   self.instance_t
-00005980: 7970 650a 0a20 2020 2020 2020 2072 6574  ype..        ret
-00005990: 7572 6e20 7072 6f74 6f0a 0a20 2020 2064  urn proto..    d
-000059a0: 6566 205f 746f 5f63 6c75 7374 6572 5f70  ef _to_cluster_p
-000059b0: 726f 746f 2873 656c 6629 202d 3e20 6665  roto(self) -> fe
-000059c0: 6174 7572 655f 7669 6577 5f70 6232 2e43  ature_view_pb2.C
-000059d0: 6c75 7374 6572 436f 6e66 6967 3a0a 2020  lusterConfig:.  
-000059e0: 2020 2020 2020 7265 7475 726e 2066 6561        return fea
-000059f0: 7475 7265 5f76 6965 775f 7062 322e 436c  ture_view_pb2.Cl
-00005a00: 7573 7465 7243 6f6e 6669 6728 7269 6674  usterConfig(rift
-00005a10: 3d73 656c 662e 5f74 6f5f 7072 6f74 6f28  =self._to_proto(
-00005a20: 2929 0a0a 0a63 6c61 7373 2053 7061 726b  ))...class Spark
-00005a30: 436f 6e66 6967 5772 6170 7065 7228 5374  ConfigWrapper(St
-00005a40: 7269 6374 4d6f 6465 6c29 3a0a 2020 2020  rictModel):.    
-00005a50: 7370 6172 6b5f 636f 6e66 6967 5f6d 6170  spark_config_map
-00005a60: 3a20 4469 6374 5b73 7472 2c20 7374 725d  : Dict[str, str]
-00005a70: 0a0a 2020 2020 4841 5244 434f 4445 445f  ..    HARDCODED_
-00005a80: 4f50 5453 3a20 436c 6173 7356 6172 5b44  OPTS: ClassVar[D
-00005a90: 6963 745b 7374 722c 2073 7472 5d5d 203d  ict[str, str]] =
-00005aa0: 207b 0a20 2020 2020 2020 2022 7370 6172   {.        "spar
-00005ab0: 6b2e 6472 6976 6572 2e6d 656d 6f72 7922  k.driver.memory"
-00005ac0: 3a20 2273 7061 726b 5f64 7269 7665 725f  : "spark_driver_
-00005ad0: 6d65 6d6f 7279 222c 0a20 2020 2020 2020  memory",.       
-00005ae0: 2022 7370 6172 6b2e 6578 6563 7574 6f72   "spark.executor
-00005af0: 2e6d 656d 6f72 7922 3a20 2273 7061 726b  .memory": "spark
-00005b00: 5f65 7865 6375 746f 725f 6d65 6d6f 7279  _executor_memory
-00005b10: 222c 0a20 2020 2020 2020 2022 7370 6172  ",.        "spar
-00005b20: 6b2e 6472 6976 6572 2e6d 656d 6f72 794f  k.driver.memoryO
-00005b30: 7665 7268 6561 6422 3a20 2273 7061 726b  verhead": "spark
-00005b40: 5f64 7269 7665 725f 6d65 6d6f 7279 5f6f  _driver_memory_o
-00005b50: 7665 7268 6561 6422 2c0a 2020 2020 2020  verhead",.      
-00005b60: 2020 2273 7061 726b 2e65 7865 6375 746f    "spark.executo
-00005b70: 722e 6d65 6d6f 7279 4f76 6572 6865 6164  r.memoryOverhead
-00005b80: 223a 2022 7370 6172 6b5f 6578 6563 7574  ": "spark_execut
-00005b90: 6f72 5f6d 656d 6f72 795f 6f76 6572 6865  or_memory_overhe
-00005ba0: 6164 222c 0a20 2020 207d 0a0a 2020 2020  ad",.    }..    
-00005bb0: 6465 6620 5f74 6f5f 7072 6f74 6f28 7365  def _to_proto(se
-00005bc0: 6c66 293a 0a20 2020 2020 2020 2070 726f  lf):.        pro
-00005bd0: 746f 203d 2066 6561 7475 7265 5f76 6965  to = feature_vie
-00005be0: 775f 7062 322e 5370 6172 6b43 6f6e 6669  w_pb2.SparkConfi
-00005bf0: 6728 290a 2020 2020 2020 2020 666f 7220  g().        for 
-00005c00: 6f70 742c 2076 616c 2069 6e20 7365 6c66  opt, val in self
-00005c10: 2e73 7061 726b 5f63 6f6e 6669 675f 6d61  .spark_config_ma
-00005c20: 702e 6974 656d 7328 293a 0a20 2020 2020  p.items():.     
-00005c30: 2020 2020 2020 2069 6620 6f70 7420 696e         if opt in
-00005c40: 2073 656c 662e 4841 5244 434f 4445 445f   self.HARDCODED_
-00005c50: 4f50 5453 3a0a 2020 2020 2020 2020 2020  OPTS:.          
-00005c60: 2020 2020 2020 7365 7461 7474 7228 7072        setattr(pr
-00005c70: 6f74 6f2c 2073 656c 662e 4841 5244 434f  oto, self.HARDCO
-00005c80: 4445 445f 4f50 5453 5b6f 7074 5d2c 2076  DED_OPTS[opt], v
-00005c90: 616c 290a 2020 2020 2020 2020 2020 2020  al).            
-00005ca0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00005cb0: 2020 2020 2020 7072 6f74 6f2e 7370 6172        proto.spar
-00005cc0: 6b5f 636f 6e66 5b6f 7074 5d20 3d20 7661  k_conf[opt] = va
-00005cd0: 6c0a 0a20 2020 2020 2020 2072 6574 7572  l..        retur
-00005ce0: 6e20 7072 6f74 6f0a 0a0a 636c 6173 7320  n proto...class 
-00005cf0: 5365 6372 6574 2853 7472 6963 744d 6f64  Secret(StrictMod
-00005d00: 656c 293a 0a20 2020 2022 2222 4120 7265  el):.    """A re
-00005d10: 6665 7265 6e63 6520 746f 2061 2073 6563  ference to a sec
-00005d20: 7265 7420 666f 7220 7573 6520 696e 2054  ret for use in T
-00005d30: 6563 746f 6e20 6f62 6a65 6374 2064 6566  ecton object def
-00005d40: 696e 6974 696f 6e73 2e0a 0a20 2020 203a  initions...    :
-00005d50: 7061 7261 6d20 7363 6f70 653a 2054 6865  param scope: The
-00005d60: 2073 636f 7065 206f 6620 7468 6520 7365   scope of the se
-00005d70: 6372 6574 2c20 7370 6563 6966 7969 6e67  cret, specifying
-00005d80: 2069 7473 2064 6f6d 6169 6e20 6f72 2063   its domain or c
-00005d90: 6174 6567 6f72 792e 0a20 2020 203a 7061  ategory..    :pa
-00005da0: 7261 6d20 6b65 793a 2054 6865 206b 6579  ram key: The key
-00005db0: 206f 6620 7468 6520 7365 6372 6574 2c20   of the secret, 
-00005dc0: 756e 6971 7565 6c79 2069 6465 6e74 6966  uniquely identif
-00005dd0: 7969 6e67 2077 6974 6869 6e20 6974 7320  ying within its 
-00005de0: 7363 6f70 652e 0a20 2020 2022 2222 0a0a  scope..    """..
-00005df0: 2020 2020 7363 6f70 653a 2073 7472 0a20      scope: str. 
-00005e00: 2020 206b 6579 3a20 7374 720a 0a20 2020     key: str..   
-00005e10: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-00005e20: 6c66 2c20 7363 6f70 653a 2073 7472 2c20  lf, scope: str, 
-00005e30: 6b65 793a 2073 7472 2c20 2a2a 6b77 6172  key: str, **kwar
-00005e40: 6773 293a 0a20 2020 2020 2020 2073 7570  gs):.        sup
-00005e50: 6572 2829 2e5f 5f69 6e69 745f 5f28 7363  er().__init__(sc
-00005e60: 6f70 653d 7363 6f70 652c 206b 6579 3d6b  ope=scope, key=k
-00005e70: 6579 2c20 2a2a 6b77 6172 6773 290a 0a20  ey, **kwargs).. 
-00005e80: 2020 2064 6566 2074 6f5f 7072 6f74 6f28     def to_proto(
-00005e90: 7365 6c66 2920 2d3e 2053 6563 7265 7452  self) -> SecretR
-00005ea0: 6566 6572 656e 6365 3a0a 2020 2020 2020  eference:.      
-00005eb0: 2020 7265 7475 726e 2053 6563 7265 7452    return SecretR
-00005ec0: 6566 6572 656e 6365 2873 636f 7065 3d73  eference(scope=s
-00005ed0: 656c 662e 7363 6f70 652c 206b 6579 3d73  elf.scope, key=s
-00005ee0: 656c 662e 6b65 7929 0a0a 0a64 6566 205f  elf.key)...def _
-00005ef0: 636f 6e76 6572 745f 7365 6372 6574 5f74  convert_secret_t
-00005f00: 6f5f 7361 6e69 7469 7a65 645f 7265 6665  o_sanitized_refe
-00005f10: 7265 6e63 6528 7365 6372 6574 3a20 556e  rence(secret: Un
-00005f20: 696f 6e5b 7374 722c 2053 6563 7265 745d  ion[str, Secret]
-00005f30: 2920 2d3e 2053 6563 7265 7452 6566 6572  ) -> SecretRefer
-00005f40: 656e 6365 3a0a 2020 2020 2222 2243 6f6e  ence:.    """Con
-00005f50: 7665 7274 2061 2073 6563 7265 7420 636f  vert a secret co
-00005f60: 6e66 6967 2074 6f20 6120 7365 6372 6574  nfig to a secret
-00005f70: 2072 6566 6572 656e 6365 2070 726f 746f   reference proto
-00005f80: 2e20 5374 6f72 6520 6c6f 6361 6c20 7365  . Store local se
-00005f90: 6372 6574 7320 696e 2074 6865 206c 6f63  crets in the loc
-00005fa0: 616c 2073 6563 7265 7420 7374 6f72 652e  al secret store.
-00005fb0: 2222 220a 2020 2020 6966 2069 7369 6e73  """.    if isins
-00005fc0: 7461 6e63 6528 7365 6372 6574 2c20 7374  tance(secret, st
-00005fd0: 7229 3a0a 2020 2020 2020 2020 6765 6e65  r):.        gene
-00005fe0: 7261 7465 645f 6b65 7920 3d20 4964 4865  rated_key = IdHe
-00005ff0: 6c70 6572 2e67 656e 6572 6174 655f 7374  lper.generate_st
-00006000: 7269 6e67 5f69 6428 290a 2020 2020 2020  ring_id().      
-00006010: 2020 7365 745f 6c6f 6361 6c5f 7365 6372    set_local_secr
-00006020: 6574 2873 636f 7065 3d22 4c4f 4341 4c5f  et(scope="LOCAL_
-00006030: 5345 4352 4554 222c 206b 6579 3d67 656e  SECRET", key=gen
-00006040: 6572 6174 6564 5f6b 6579 2c20 7661 6c75  erated_key, valu
-00006050: 653d 7365 6372 6574 290a 2020 2020 2020  e=secret).      
-00006060: 2020 7265 7475 726e 2053 6563 7265 7452    return SecretR
-00006070: 6566 6572 656e 6365 2873 636f 7065 3d22  eference(scope="
-00006080: 4c4f 4341 4c5f 5345 4352 4554 222c 206b  LOCAL_SECRET", k
-00006090: 6579 3d67 656e 6572 6174 6564 5f6b 6579  ey=generated_key
-000060a0: 2c20 6973 5f6c 6f63 616c 3d54 7275 6529  , is_local=True)
-000060b0: 0a20 2020 2065 6c69 6620 6973 696e 7374  .    elif isinst
-000060c0: 616e 6365 2873 6563 7265 742c 2053 6563  ance(secret, Sec
-000060d0: 7265 7429 3a0a 2020 2020 2020 2020 7265  ret):.        re
-000060e0: 7475 726e 2053 6563 7265 7452 6566 6572  turn SecretRefer
-000060f0: 656e 6365 2873 636f 7065 3d73 6563 7265  ence(scope=secre
-00006100: 742e 7363 6f70 652c 206b 6579 3d73 6563  t.scope, key=sec
-00006110: 7265 742e 6b65 792c 2069 735f 6c6f 6361  ret.key, is_loca
-00006120: 6c3d 4661 6c73 6529 0a20 2020 2065 6c73  l=False).    els
-00006130: 653a 0a20 2020 2020 2020 206d 7367 203d  e:.        msg =
-00006140: 2066 2249 6e76 616c 6964 2073 6563 7265   f"Invalid secre
-00006150: 7420 7479 7065 3a20 7b74 7970 6528 7365  t type: {type(se
-00006160: 6372 6574 297d 220a 2020 2020 2020 2020  cret)}".        
-00006170: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-00006180: 6d73 6729 0a0a 0a63 6c61 7373 2050 6172  msg)...class Par
-00006190: 7175 6574 436f 6e66 6967 2853 7472 6963  quetConfig(Stric
-000061a0: 744d 6f64 656c 293a 0a20 2020 2022 2222  tModel):.    """
-000061b0: 2843 6f6e 6669 6720 436c 6173 7329 2050  (Config Class) P
-000061c0: 6172 7175 6574 436f 6e66 6967 2043 6c61  arquetConfig Cla
-000061d0: 7373 2e0a 0a20 2020 2054 6869 7320 636c  ss...    This cl
-000061e0: 6173 7320 6465 7363 7269 6265 7320 7468  ass describes th
-000061f0: 6520 6174 7472 6962 7574 6573 206f 6620  e attributes of 
-00006200: 5061 7271 7565 742d 6261 7365 6420 6f66  Parquet-based of
-00006210: 666c 696e 6520 6665 6174 7572 6520 7374  fline feature st
-00006220: 6f72 6520 7374 6f72 6167 6520 666f 7220  ore storage for 
-00006230: 7468 6520 6665 6174 7572 6520 6465 6669  the feature defi
-00006240: 6e69 7469 6f6e 2e0a 0a20 2020 203a 7061  nition...    :pa
-00006250: 7261 6d20 7375 6264 6972 6563 746f 7279  ram subdirectory
-00006260: 5f6f 7665 7272 6964 653a 2054 6869 7320  _override: This 
-00006270: 6973 2066 6f72 2074 6865 206c 6f63 6174  is for the locat
-00006280: 696f 6e20 6f66 2074 6865 2066 6561 7475  ion of the featu
-00006290: 7265 2064 6174 6120 696e 2074 6865 206f  re data in the o
-000062a0: 6666 6c69 6e65 2073 746f 7265 2e20 4279  ffline store. By
-000062b0: 2064 6566 6175 6c74 2c20 616c 6c20 6665   default, all fe
-000062c0: 6174 7572 6520 7669 6577 7320 7769 6c6c  ature views will
-000062d0: 2062 6520 756e 6465 7220 7468 6520 7375   be under the su
-000062e0: 6264 6972 6563 746f 7279 203c 776f 726b  bdirectory <work
-000062f0: 7370 6163 655f 6e61 6d65 3e20 6966 2074  space_name> if t
-00006300: 6869 7320 7061 7261 6d20 6973 206e 6f74  his param is not
-00006310: 2073 7065 6369 6669 6564 2e0a 2020 2020   specified..    
-00006320: 2222 220a 0a20 2020 206b 696e 643a 204c  """..    kind: L
-00006330: 6974 6572 616c 5b22 5061 7271 7565 7443  iteral["ParquetC
-00006340: 6f6e 6669 6722 5d20 3d20 2250 6172 7175  onfig"] = "Parqu
-00006350: 6574 436f 6e66 6967 2220 2023 2055 7365  etConfig"  # Use
-00006360: 6420 666f 7220 5941 4d4c 2070 6172 7369  d for YAML parsi
-00006370: 6e67 2061 7320 6120 5079 6461 6e74 6963  ng as a Pydantic
-00006380: 2064 6973 6372 696d 696e 6174 6f72 2e0a   discriminator..
-00006390: 2020 2020 7375 6264 6972 6563 746f 7279      subdirectory
-000063a0: 5f6f 7665 7272 6964 653a 204f 7074 696f  _override: Optio
-000063b0: 6e61 6c5b 7374 725d 203d 204e 6f6e 650a  nal[str] = None.
-000063c0: 0a20 2020 2064 6566 205f 746f 5f70 726f  .    def _to_pro
-000063d0: 746f 2873 656c 6629 3a0a 2020 2020 2020  to(self):.      
-000063e0: 2020 7374 6f72 655f 636f 6e66 6967 203d    store_config =
-000063f0: 2066 6561 7475 7265 5f76 6965 775f 7062   feature_view_pb
-00006400: 322e 4f66 666c 696e 6546 6561 7475 7265  2.OfflineFeature
-00006410: 5374 6f72 6543 6f6e 6669 6728 290a 2020  StoreConfig().  
-00006420: 2020 2020 2020 7374 6f72 655f 636f 6e66        store_conf
-00006430: 6967 2e70 6172 7175 6574 2e53 6574 496e  ig.parquet.SetIn
-00006440: 5061 7265 6e74 2829 0a20 2020 2020 2020  Parent().       
-00006450: 2069 6620 7365 6c66 2e73 7562 6469 7265   if self.subdire
-00006460: 6374 6f72 795f 6f76 6572 7269 6465 3a0a  ctory_override:.
-00006470: 2020 2020 2020 2020 2020 2020 7374 6f72              stor
-00006480: 655f 636f 6e66 6967 2e73 7562 6469 7265  e_config.subdire
-00006490: 6374 6f72 795f 6f76 6572 7269 6465 203d  ctory_override =
-000064a0: 2073 656c 662e 7375 6264 6972 6563 746f   self.subdirecto
-000064b0: 7279 5f6f 7665 7272 6964 650a 2020 2020  ry_override.    
-000064c0: 2020 2020 7265 7475 726e 2073 746f 7265      return store
-000064d0: 5f63 6f6e 6669 670a 0a0a 636c 6173 7320  _config...class 
-000064e0: 4465 6c74 6143 6f6e 6669 6728 5374 7269  DeltaConfig(Stri
-000064f0: 6374 4d6f 6465 6c29 3a0a 2020 2020 2222  ctModel):.    ""
-00006500: 2228 436f 6e66 6967 2043 6c61 7373 2920  "(Config Class) 
-00006510: 4465 6c74 6143 6f6e 6669 6720 436c 6173  DeltaConfig Clas
-00006520: 732e 0a0a 2020 2020 5468 6973 2063 6c61  s...    This cla
-00006530: 7373 2064 6573 6372 6962 6573 2074 6865  ss describes the
-00006540: 2061 7474 7269 6275 7465 7320 6f66 2044   attributes of D
-00006550: 656c 7461 4c61 6b65 2d62 6173 6564 206f  eltaLake-based o
-00006560: 6666 6c69 6e65 2066 6561 7475 7265 2073  ffline feature s
-00006570: 746f 7265 2073 746f 7261 6765 2066 6f72  tore storage for
-00006580: 2074 6865 2066 6561 7475 7265 2064 6566   the feature def
-00006590: 696e 6974 696f 6e2e 0a0a 2020 2020 3a70  inition...    :p
-000065a0: 6172 616d 2074 696d 655f 7061 7274 6974  aram time_partit
-000065b0: 696f 6e5f 7369 7a65 3a20 5468 6520 7369  ion_size: The si
-000065c0: 7a65 206f 6620 6120 7469 6d65 2070 6172  ze of a time par
-000065d0: 7469 7469 6f6e 2069 6e20 7468 6520 4465  tition in the De
-000065e0: 6c74 614c 616b 6520 7461 626c 652c 2073  ltaLake table, s
-000065f0: 7065 6369 6669 6564 2061 7320 6120 6461  pecified as a da
-00006600: 7465 7469 6d65 2e74 696d 6564 656c 7461  tetime.timedelta
-00006610: 2e20 4465 6661 756c 7473 2074 6f20 3234  . Defaults to 24
-00006620: 2068 6f75 7273 2e0a 2020 2020 3a70 6172   hours..    :par
-00006630: 616d 2073 7562 6469 7265 6374 6f72 795f  am subdirectory_
-00006640: 6f76 6572 7269 6465 3a20 5468 6973 2069  override: This i
-00006650: 7320 666f 7220 7468 6520 6c6f 6361 7469  s for the locati
-00006660: 6f6e 206f 6620 7468 6520 6665 6174 7572  on of the featur
-00006670: 6520 6461 7461 2069 6e20 7468 6520 6f66  e data in the of
-00006680: 666c 696e 6520 7374 6f72 652e 2042 7920  fline store. By 
-00006690: 6465 6661 756c 742c 2061 6c6c 2066 6561  default, all fea
-000066a0: 7475 7265 2076 6965 7773 2077 696c 6c20  ture views will 
-000066b0: 6265 2075 6e64 6572 2074 6865 2073 7562  be under the sub
-000066c0: 6469 7265 6374 6f72 7920 3c77 6f72 6b73  directory <works
-000066d0: 7061 6365 5f6e 616d 653e 2069 6620 7468  pace_name> if th
-000066e0: 6973 2070 6172 616d 2069 7320 6e6f 7420  is param is not 
-000066f0: 7370 6563 6966 6965 642e 0a20 2020 2022  specified..    "
-00006700: 2222 0a0a 2020 2020 6b69 6e64 3a20 4c69  ""..    kind: Li
-00006710: 7465 7261 6c5b 2244 656c 7461 436f 6e66  teral["DeltaConf
-00006720: 6967 225d 203d 2022 4465 6c74 6143 6f6e  ig"] = "DeltaCon
-00006730: 6669 6722 2020 2320 5573 6564 2066 6f72  fig"  # Used for
-00006740: 2059 414d 4c20 7061 7273 696e 6720 6173   YAML parsing as
-00006750: 2061 2050 7964 616e 7469 6320 6469 7363   a Pydantic disc
-00006760: 7269 6d69 6e61 746f 722e 0a20 2020 2074  riminator..    t
-00006770: 696d 655f 7061 7274 6974 696f 6e5f 7369  ime_partition_si
-00006780: 7a65 3a20 4f70 7469 6f6e 616c 5b64 6174  ze: Optional[dat
-00006790: 6574 696d 652e 7469 6d65 6465 6c74 615d  etime.timedelta]
-000067a0: 203d 2064 6174 6574 696d 652e 7469 6d65   = datetime.time
-000067b0: 6465 6c74 6128 686f 7572 733d 3234 290a  delta(hours=24).
-000067c0: 2020 2020 7375 6264 6972 6563 746f 7279      subdirectory
-000067d0: 5f6f 7665 7272 6964 653a 204f 7074 696f  _override: Optio
-000067e0: 6e61 6c5b 7374 725d 203d 204e 6f6e 650a  nal[str] = None.
-000067f0: 0a20 2020 2040 7079 6461 6e74 6963 5f76  .    @pydantic_v
-00006800: 312e 7661 6c69 6461 746f 7228 2274 696d  1.validator("tim
-00006810: 655f 7061 7274 6974 696f 6e5f 7369 7a65  e_partition_size
-00006820: 222c 2070 7265 3d54 7275 6529 0a20 2020  ", pre=True).   
-00006830: 2064 6566 205f 7374 7269 6e67 5f74 6f5f   def _string_to_
-00006840: 7469 6d65 6465 6c74 6128 636c 732c 2076  timedelta(cls, v
-00006850: 616c 7565 293a 0a20 2020 2020 2020 2069  alue):.        i
-00006860: 6620 6973 696e 7374 616e 6365 2876 616c  f isinstance(val
-00006870: 7565 2c20 7374 7229 3a0a 2020 2020 2020  ue, str):.      
-00006880: 2020 2020 2020 7265 7475 726e 2074 696d        return tim
-00006890: 655f 7574 696c 732e 7061 7273 655f 746f  e_utils.parse_to
-000068a0: 5f74 696d 6564 656c 7461 2876 616c 7565  _timedelta(value
-000068b0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-000068c0: 2076 616c 7565 0a0a 2020 2020 6465 6620   value..    def 
-000068d0: 5f74 6f5f 7072 6f74 6f28 7365 6c66 293a  _to_proto(self):
-000068e0: 0a20 2020 2020 2020 2073 746f 7265 5f63  .        store_c
-000068f0: 6f6e 6669 6720 3d20 6665 6174 7572 655f  onfig = feature_
-00006900: 7669 6577 5f70 6232 2e4f 6666 6c69 6e65  view_pb2.Offline
-00006910: 4665 6174 7572 6553 746f 7265 436f 6e66  FeatureStoreConf
-00006920: 6967 2829 0a20 2020 2020 2020 2073 746f  ig().        sto
-00006930: 7265 5f63 6f6e 6669 672e 6465 6c74 612e  re_config.delta.
-00006940: 7469 6d65 5f70 6172 7469 7469 6f6e 5f73  time_partition_s
-00006950: 697a 652e 4672 6f6d 5469 6d65 6465 6c74  ize.FromTimedelt
-00006960: 6128 7365 6c66 2e74 696d 655f 7061 7274  a(self.time_part
-00006970: 6974 696f 6e5f 7369 7a65 290a 2020 2020  ition_size).    
-00006980: 2020 2020 6966 2073 656c 662e 7375 6264      if self.subd
-00006990: 6972 6563 746f 7279 5f6f 7665 7272 6964  irectory_overrid
-000069a0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-000069b0: 746f 7265 5f63 6f6e 6669 672e 7375 6264  tore_config.subd
-000069c0: 6972 6563 746f 7279 5f6f 7665 7272 6964  irectory_overrid
-000069d0: 6520 3d20 7365 6c66 2e73 7562 6469 7265  e = self.subdire
-000069e0: 6374 6f72 795f 6f76 6572 7269 6465 0a20  ctory_override. 
-000069f0: 2020 2020 2020 2072 6574 7572 6e20 7374         return st
-00006a00: 6f72 655f 636f 6e66 6967 0a0a 0a63 6c61  ore_config...cla
-00006a10: 7373 204f 6666 6c69 6e65 5374 6f72 6543  ss OfflineStoreC
-00006a20: 6f6e 6669 6728 5374 7269 6374 4d6f 6465  onfig(StrictMode
-00006a30: 6c29 3a0a 2020 2020 2222 2243 6f6e 6669  l):.    """Confi
-00006a40: 6775 7261 7469 6f6e 206f 7074 696f 6e73  guration options
-00006a50: 2074 6f20 7370 6563 6966 7920 686f 7720   to specify how 
-00006a60: 6120 4665 6174 7572 6520 5669 6577 2073  a Feature View s
-00006a70: 686f 756c 6420 6d61 7465 7269 616c 697a  hould materializ
-00006a80: 6520 746f 2074 6865 204f 6666 6c69 6e65  e to the Offline
-00006a90: 2053 746f 7265 2e0a 0a20 2020 203a 7061   Store...    :pa
-00006aa0: 7261 6d20 7374 6167 696e 675f 7461 626c  ram staging_tabl
-00006ab0: 655f 666f 726d 6174 3a20 5468 6520 7461  e_format: The ta
-00006ac0: 626c 6520 666f 726d 6174 2066 6f72 2074  ble format for t
-00006ad0: 6865 2073 7461 6769 6e67 2074 6162 6c65  he staging table
-00006ae0: 2e20 5468 6520 7374 6167 696e 6720 7461  . The staging ta
-00006af0: 626c 6520 636f 6e74 6169 6e73 2070 6172  ble contains par
-00006b00: 7469 616c 6c79 0a20 2020 2020 2020 2074  tially.        t
-00006b10: 7261 6e73 666f 726d 6564 2066 6561 7475  ransformed featu
-00006b20: 7265 2076 616c 7565 7320 7468 6174 2068  re values that h
-00006b30: 6176 6520 6e6f 7420 6265 656e 2066 756c  ave not been ful
-00006b40: 6c79 2061 6767 7265 6761 7465 642e 0a20  ly aggregated.. 
-00006b50: 2020 203a 7061 7261 6d20 7075 626c 6973     :param publis
-00006b60: 685f 6675 6c6c 5f66 6561 7475 7265 733a  h_full_features:
-00006b70: 2049 6620 5472 7565 2c20 5465 6374 6f6e   If True, Tecton
-00006b80: 2077 696c 6c20 7075 626c 6973 6820 6120   will publish a 
-00006b90: 6675 6c6c 2066 6561 7475 7265 2076 616c  full feature val
-00006ba0: 7565 7320 746f 2061 2073 6570 6172 6174  ues to a separat
-00006bb0: 6520 7461 626c 6520 6166 7465 720a 2020  e table after.  
-00006bc0: 2020 2020 2020 6d61 7465 7269 616c 697a        materializ
-00006bd0: 6174 696f 6e20 6a6f 6273 2074 6f20 7468  ation jobs to th
-00006be0: 6520 7374 6167 696e 6720 7461 626c 6520  e staging table 
-00006bf0: 6861 7665 2063 6f6d 706c 6574 6564 2e20  have completed. 
-00006c00: 5573 6572 7320 6361 6e20 7175 6572 7920  Users can query 
-00006c10: 7468 6573 6520 6665 6174 7572 6520 7661  these feature va
-00006c20: 6c75 6573 2064 6972 6563 746c 790a 2020  lues directly.  
-00006c30: 2020 2020 2020 7769 7468 6f75 7420 6675        without fu
-00006c40: 7274 6865 7220 7472 616e 7366 6f72 6d61  rther transforma
-00006c50: 7469 6f6e 7320 6f72 2061 6767 7265 6761  tions or aggrega
-00006c60: 7469 6f6e 732e 0a20 2020 203a 7061 7261  tions..    :para
-00006c70: 6d20 7075 626c 6973 685f 7374 6172 745f  m publish_start_
-00006c80: 7469 6d65 3a20 4966 2073 6574 2c20 5465  time: If set, Te
-00006c90: 6374 6f6e 2077 696c 6c20 7075 626c 6973  cton will publis
-00006ca0: 6820 6665 6174 7572 6573 2073 7461 7274  h features start
-00006cb0: 696e 6720 6672 6f6d 2074 6865 2066 6561  ing from the fea
-00006cc0: 7475 7265 2074 696d 652e 2049 6620 6e6f  ture time. If no
-00006cd0: 7420 7365 742c 0a20 2020 2020 2020 2054  t set,.        T
-00006ce0: 6563 746f 6e20 7769 6c6c 2064 6566 6175  ecton will defau
-00006cf0: 6c74 2074 6f20 7468 6520 4665 6174 7572  lt to the Featur
-00006d00: 6520 5669 6577 2773 2066 6561 7475 7265  e View's feature
-00006d10: 5f73 7461 7274 5f74 696d 652e 0a20 2020  _start_time..   
-00006d20: 2022 2222 0a0a 2020 2020 6b69 6e64 3a20   """..    kind: 
-00006d30: 4c69 7465 7261 6c5b 224f 6666 6c69 6e65  Literal["Offline
-00006d40: 5374 6f72 6543 6f6e 6669 6722 5d20 3d20  StoreConfig"] = 
-00006d50: 224f 6666 6c69 6e65 5374 6f72 6543 6f6e  "OfflineStoreCon
-00006d60: 6669 6722 2020 2320 5573 6564 2066 6f72  fig"  # Used for
-00006d70: 2059 414d 4c20 7061 7273 696e 6720 6173   YAML parsing as
-00006d80: 2061 2050 7964 616e 7469 6320 6469 7363   a Pydantic disc
-00006d90: 7269 6d69 6e61 746f 722e 0a20 2020 2073  riminator..    s
-00006da0: 7461 6769 6e67 5f74 6162 6c65 5f66 6f72  taging_table_for
-00006db0: 6d61 743a 2055 6e69 6f6e 5b44 656c 7461  mat: Union[Delta
-00006dc0: 436f 6e66 6967 2c20 5061 7271 7565 7443  Config, ParquetC
-00006dd0: 6f6e 6669 675d 203d 2070 7964 616e 7469  onfig] = pydanti
-00006de0: 635f 7631 2e46 6965 6c64 280a 2020 2020  c_v1.Field(.    
-00006df0: 2020 2020 6465 6661 756c 745f 6661 6374      default_fact
-00006e00: 6f72 793d 4465 6c74 6143 6f6e 6669 672c  ory=DeltaConfig,
-00006e10: 2064 6973 6372 696d 696e 6174 6f72 3d22   discriminator="
-00006e20: 6b69 6e64 220a 2020 2020 290a 2020 2020  kind".    ).    
-00006e30: 7075 626c 6973 685f 6675 6c6c 5f66 6561  publish_full_fea
-00006e40: 7475 7265 733a 2062 6f6f 6c20 3d20 4661  tures: bool = Fa
-00006e50: 6c73 650a 2020 2020 7075 626c 6973 685f  lse.    publish_
-00006e60: 7374 6172 745f 7469 6d65 3a20 4f70 7469  start_time: Opti
-00006e70: 6f6e 616c 5b64 6174 6574 696d 652e 6461  onal[datetime.da
-00006e80: 7465 7469 6d65 5d20 3d20 4e6f 6e65 0a0a  tetime] = None..
-00006e90: 2020 2020 4070 7964 616e 7469 635f 7631      @pydantic_v1
-00006ea0: 2e76 616c 6964 6174 6f72 2822 7075 626c  .validator("publ
-00006eb0: 6973 685f 7374 6172 745f 7469 6d65 222c  ish_start_time",
-00006ec0: 2070 7265 3d54 7275 6529 0a20 2020 2064   pre=True).    d
-00006ed0: 6566 205f 6461 7465 5f74 6f5f 6461 7465  ef _date_to_date
-00006ee0: 7469 6d65 2863 6c73 2c20 7661 6c75 6529  time(cls, value)
-00006ef0: 3a0a 2020 2020 2020 2020 6966 2069 7369  :.        if isi
-00006f00: 6e73 7461 6e63 6528 7661 6c75 652c 2064  nstance(value, d
-00006f10: 6174 6574 696d 652e 6461 7465 293a 0a20  atetime.date):. 
-00006f20: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00006f30: 6e20 6461 7465 7469 6d65 2e64 6174 6574  n datetime.datet
-00006f40: 696d 6528 7965 6172 3d76 616c 7565 2e79  ime(year=value.y
-00006f50: 6561 722c 206d 6f6e 7468 3d76 616c 7565  ear, month=value
-00006f60: 2e6d 6f6e 7468 2c20 6461 793d 7661 6c75  .month, day=valu
-00006f70: 652e 6461 7929 0a20 2020 2020 2020 2072  e.day).        r
-00006f80: 6574 7572 6e20 7661 6c75 650a 0a20 2020  eturn value..   
-00006f90: 2064 6566 205f 746f 5f70 726f 746f 2873   def _to_proto(s
-00006fa0: 656c 6629 202d 3e20 6665 6174 7572 655f  elf) -> feature_
-00006fb0: 7669 6577 5f70 6232 2e4f 6666 6c69 6e65  view_pb2.Offline
-00006fc0: 5374 6f72 6543 6f6e 6669 673a 0a20 2020  StoreConfig:.   
-00006fd0: 2020 2020 2072 6574 7572 6e20 6665 6174       return feat
-00006fe0: 7572 655f 7669 6577 5f70 6232 2e4f 6666  ure_view_pb2.Off
-00006ff0: 6c69 6e65 5374 6f72 6543 6f6e 6669 6728  lineStoreConfig(
-00007000: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
-00007010: 6769 6e67 5f74 6162 6c65 5f66 6f72 6d61  ging_table_forma
-00007020: 743d 7365 6c66 2e73 7461 6769 6e67 5f74  t=self.staging_t
-00007030: 6162 6c65 5f66 6f72 6d61 742e 5f74 6f5f  able_format._to_
-00007040: 7072 6f74 6f28 292c 0a20 2020 2020 2020  proto(),.       
-00007050: 2020 2020 2070 7562 6c69 7368 5f66 756c       publish_ful
-00007060: 6c5f 6665 6174 7572 6573 3d73 656c 662e  l_features=self.
-00007070: 7075 626c 6973 685f 6675 6c6c 5f66 6561  publish_full_fea
-00007080: 7475 7265 732c 0a20 2020 2020 2020 2020  tures,.         
-00007090: 2020 2070 7562 6c69 7368 5f73 7461 7274     publish_start
-000070a0: 5f74 696d 653d 7469 6d65 5f75 7469 6c73  _time=time_utils
-000070b0: 2e64 6174 6574 696d 655f 746f 5f70 726f  .datetime_to_pro
-000070c0: 746f 2873 656c 662e 7075 626c 6973 685f  to(self.publish_
-000070d0: 7374 6172 745f 7469 6d65 292c 0a20 2020  start_time),.   
-000070e0: 2020 2020 2029 0a0a 0a63 6c61 7373 2044       )...class D
-000070f0: 796e 616d 6f43 6f6e 6669 6728 5374 7269  ynamoConfig(Stri
-00007100: 6374 4d6f 6465 6c29 3a0a 2020 2020 2222  ctModel):.    ""
-00007110: 2228 436f 6e66 6967 2043 6c61 7373 2920  "(Config Class) 
-00007120: 4479 6e61 6d6f 436f 6e66 6967 2043 6c61  DynamoConfig Cla
-00007130: 7373 2e0a 0a20 2020 2054 6869 7320 636c  ss...    This cl
-00007140: 6173 7320 6465 7363 7269 6265 7320 7468  ass describes th
-00007150: 6520 6174 7472 6962 7574 6573 206f 6620  e attributes of 
-00007160: 4479 6e61 6d6f 4442 2062 6173 6564 206f  DynamoDB based o
-00007170: 6e6c 696e 6520 6665 6174 7572 6520 7374  nline feature st
-00007180: 6f72 6520 666f 7220 7468 6520 6665 6174  ore for the feat
-00007190: 7572 6520 6465 6669 6e69 7469 6f6e 2e0a  ure definition..
-000071a0: 2020 2020 4375 7272 656e 746c 7920 7468      Currently th
-000071b0: 6572 6520 6172 6520 6e6f 2061 7474 7269  ere are no attri
-000071c0: 6275 7465 7320 666f 7220 7468 6973 2063  butes for this c
-000071d0: 6c61 7373 2e0a 2020 2020 5573 6572 7320  lass..    Users 
-000071e0: 6361 6e20 7370 6563 6966 7920 6f6e 6c69  can specify onli
-000071f0: 6e65 5f73 746f 7265 203d 2044 796e 616d  ne_store = Dynam
-00007200: 6f43 6f6e 6669 6728 290a 2020 2020 2222  oConfig().    ""
-00007210: 220a 0a20 2020 206b 696e 643a 204c 6974  "..    kind: Lit
-00007220: 6572 616c 5b22 4479 6e61 6d6f 436f 6e66  eral["DynamoConf
-00007230: 6967 225d 203d 2022 4479 6e61 6d6f 436f  ig"] = "DynamoCo
-00007240: 6e66 6967 2220 2023 2055 7365 6420 666f  nfig"  # Used fo
-00007250: 7220 5941 4d4c 2070 6172 7369 6e67 2061  r YAML parsing a
-00007260: 7320 6120 5079 6461 6e74 6963 2064 6973  s a Pydantic dis
-00007270: 6372 696d 696e 6174 6f72 2e0a 0a20 2020  criminator...   
-00007280: 2064 6566 205f 746f 5f70 726f 746f 2873   def _to_proto(s
-00007290: 656c 6629 3a0a 2020 2020 2020 2020 7374  elf):.        st
-000072a0: 6f72 655f 636f 6e66 6967 203d 2066 6561  ore_config = fea
-000072b0: 7475 7265 5f76 6965 775f 7062 322e 4f6e  ture_view_pb2.On
-000072c0: 6c69 6e65 5374 6f72 6543 6f6e 6669 6728  lineStoreConfig(
-000072d0: 290a 2020 2020 2020 2020 7374 6f72 655f  ).        store_
-000072e0: 636f 6e66 6967 2e64 796e 616d 6f2e 656e  config.dynamo.en
-000072f0: 6162 6c65 6420 3d20 5472 7565 0a20 2020  abled = True.   
-00007300: 2020 2020 2073 746f 7265 5f63 6f6e 6669       store_confi
-00007310: 672e 6479 6e61 6d6f 2e53 6574 496e 5061  g.dynamo.SetInPa
-00007320: 7265 6e74 2829 0a20 2020 2020 2020 2072  rent().        r
-00007330: 6574 7572 6e20 7374 6f72 655f 636f 6e66  eturn store_conf
-00007340: 6967 0a0a 0a63 6c61 7373 2052 6564 6973  ig...class Redis
-00007350: 436f 6e66 6967 2853 7472 6963 744d 6f64  Config(StrictMod
-00007360: 656c 293a 0a20 2020 2022 2222 2843 6f6e  el):.    """(Con
-00007370: 6669 6720 436c 6173 7329 2052 6564 6973  fig Class) Redis
-00007380: 436f 6e66 6967 2043 6c61 7373 2e0a 0a20  Config Class... 
-00007390: 2020 2054 6869 7320 636c 6173 7320 6465     This class de
-000073a0: 7363 7269 6265 7320 7468 6520 6174 7472  scribes the attr
-000073b0: 6962 7574 6573 206f 6620 5265 6469 732d  ibutes of Redis-
-000073c0: 6261 7365 6420 6f6e 6c69 6e65 2066 6561  based online fea
-000073d0: 7475 7265 2073 746f 7265 2066 6f72 2074  ture store for t
-000073e0: 6865 2066 6561 7475 7265 2064 6566 696e  he feature defin
-000073f0: 6974 696f 6e2e 0a20 2020 204e 6f74 6520  ition..    Note 
-00007400: 3a20 596f 7572 2054 6563 746f 6e20 6465  : Your Tecton de
-00007410: 706c 6f79 6d65 6e74 206e 6565 6473 2074  ployment needs t
-00007420: 6f20 6265 2063 6f6e 6e65 6374 6564 2074  o be connected t
-00007430: 6f20 5265 6469 7320 6265 666f 7265 2079  o Redis before y
-00007440: 6f75 2063 616e 2075 7365 2074 6869 7320  ou can use this 
-00007450: 636f 6e66 6967 7572 6174 696f 6e20 6f70  configuration op
-00007460: 7469 6f6e 2e20 5365 6520 6874 7470 733a  tion. See https:
-00007470: 2f2f 646f 6373 2e74 6563 746f 6e2e 6169  //docs.tecton.ai
-00007480: 2f64 6f63 732f 7365 7474 696e 672d 7570  /docs/setting-up
-00007490: 2d74 6563 746f 6e2f 7365 7474 696e 672d  -tecton/setting-
-000074a0: 7570 2d6f 7468 6572 2d63 6f6d 706f 6e65  up-other-compone
-000074b0: 6e74 732f 636f 6e6e 6563 7469 6e67 2d72  nts/connecting-r
-000074c0: 6564 6973 2d61 732d 616e 2d6f 6e6c 696e  edis-as-an-onlin
-000074d0: 652d 7374 6f72 6520 666f 7220 6465 7461  e-store for deta
-000074e0: 696c 7320 616e 6420 706c 6561 7365 2063  ils and please c
-000074f0: 6f6e 7461 6374 2054 6563 746f 6e20 5375  ontact Tecton Su
-00007500: 7070 6f72 7420 6966 2079 6f75 206e 6565  pport if you nee
-00007510: 6420 6173 7369 7374 616e 6365 2e0a 0a20  d assistance... 
-00007520: 2020 203a 7061 7261 6d20 7072 696d 6172     :param primar
-00007530: 795f 656e 6470 6f69 6e74 3a20 5072 696d  y_endpoint: Prim
-00007540: 6172 7920 656e 6470 6f69 6e74 2066 6f72  ary endpoint for
-00007550: 2074 6865 2052 6564 6973 2043 6c75 7374   the Redis Clust
-00007560: 6572 2e20 5468 6973 2069 7320 6f70 7469  er. This is opti
-00007570: 6f6e 616c 2061 6e64 2069 6620 6162 7365  onal and if abse
-00007580: 6e74 2c20 5465 6374 6f6e 2077 696c 6c20  nt, Tecton will 
-00007590: 7573 6520 7468 6520 6465 6661 756c 7420  use the default 
-000075a0: 5265 6469 7320 436c 7573 7465 7220 636f  Redis Cluster co
-000075b0: 6e66 6967 7572 6564 2066 6f72 2079 6f75  nfigured for you
-000075c0: 7220 6465 706c 6f79 6d65 6e74 2e0a 2020  r deployment..  
-000075d0: 2020 3a70 6172 616d 2061 7574 6865 6e74    :param authent
-000075e0: 6963 6174 696f 6e5f 746f 6b65 6e3a 2041  ication_token: A
-000075f0: 7574 6865 6e74 6963 6174 696f 6e20 746f  uthentication to
-00007600: 6b65 6e20 666f 7220 7468 6520 5265 6469  ken for the Redi
-00007610: 7320 436c 7573 7465 722c 206d 7573 7420  s Cluster, must 
-00007620: 6265 2070 726f 7669 6465 6420 6966 2070  be provided if p
-00007630: 7269 6d61 7279 5f65 6e64 706f 696e 7420  rimary_endpoint 
-00007640: 6973 2070 7265 7365 6e74 2e0a 2020 2020  is present..    
-00007650: 2222 220a 0a20 2020 206b 696e 643a 204c  """..    kind: L
-00007660: 6974 6572 616c 5b22 5265 6469 7343 6f6e  iteral["RedisCon
-00007670: 6669 6722 5d20 3d20 2252 6564 6973 436f  fig"] = "RedisCo
-00007680: 6e66 6967 2220 2023 2055 7365 6420 666f  nfig"  # Used fo
-00007690: 7220 5941 4d4c 2070 6172 7369 6e67 2061  r YAML parsing a
-000076a0: 7320 6120 5079 6461 6e74 6963 2064 6973  s a Pydantic dis
-000076b0: 6372 696d 696e 6174 6f72 2e0a 2020 2020  criminator..    
-000076c0: 7072 696d 6172 795f 656e 6470 6f69 6e74  primary_endpoint
-000076d0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-000076e0: 3d20 4e6f 6e65 0a20 2020 2061 7574 6865  = None.    authe
-000076f0: 6e74 6963 6174 696f 6e5f 746f 6b65 6e3a  ntication_token:
-00007700: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
-00007710: 204e 6f6e 650a 0a20 2020 2064 6566 205f   None..    def _
-00007720: 746f 5f70 726f 746f 2873 656c 6629 3a0a  to_proto(self):.
-00007730: 2020 2020 2020 2020 2320 544f 444f 2854          # TODO(T
-00007740: 4543 2d31 3338 3839 293a 2052 656d 6f76  EC-13889): Remov
-00007750: 6520 7468 6520 746c 735f 656e 6162 6c65  e the tls_enable
-00007760: 6420 6669 656c 6420 6672 6f6d 2070 726f  d field from pro
-00007770: 746f 2061 6e64 2062 6163 6b65 6e64 2061  to and backend a
-00007780: 7320 7468 6973 2073 686f 756c 6420 616c  s this should al
-00007790: 7761 7973 2062 6520 7365 7420 746f 2074  ways be set to t
-000077a0: 7275 650a 2020 2020 2020 2020 7265 7475  rue.        retu
-000077b0: 726e 2066 6561 7475 7265 5f76 6965 775f  rn feature_view_
-000077c0: 7062 322e 4f6e 6c69 6e65 5374 6f72 6543  pb2.OnlineStoreC
-000077d0: 6f6e 6669 6728 0a20 2020 2020 2020 2020  onfig(.         
-000077e0: 2020 2072 6564 6973 3d66 6561 7475 7265     redis=feature
-000077f0: 5f76 6965 775f 7062 322e 5265 6469 734f  _view_pb2.RedisO
-00007800: 6e6c 696e 6553 746f 7265 280a 2020 2020  nlineStore(.    
-00007810: 2020 2020 2020 2020 2020 2020 656e 6162              enab
-00007820: 6c65 643d 5472 7565 2c0a 2020 2020 2020  led=True,.      
-00007830: 2020 2020 2020 2020 2020 7072 696d 6172            primar
-00007840: 795f 656e 6470 6f69 6e74 3d73 656c 662e  y_endpoint=self.
-00007850: 7072 696d 6172 795f 656e 6470 6f69 6e74  primary_endpoint
-00007860: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00007870: 2020 6175 7468 656e 7469 6361 7469 6f6e    authentication
-00007880: 5f74 6f6b 656e 3d73 656c 662e 6175 7468  _token=self.auth
-00007890: 656e 7469 6361 7469 6f6e 5f74 6f6b 656e  entication_token
-000078a0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-000078b0: 2020 2020 2020 2020 290a 0a0a 636c 6173          )...clas
-000078c0: 7320 4269 6774 6162 6c65 436f 6e66 6967  s BigtableConfig
-000078d0: 2853 7472 6963 744d 6f64 656c 293a 0a20  (StrictModel):. 
-000078e0: 2020 2022 2222 2843 6f6e 6669 6720 436c     """(Config Cl
-000078f0: 6173 7329 2042 6967 7461 626c 6543 6f6e  ass) BigtableCon
-00007900: 6669 6720 436c 6173 732e 0a0a 2020 2020  fig Class...    
-00007910: 5468 6973 2063 6c61 7373 2064 6573 6372  This class descr
-00007920: 6962 6573 2074 6865 2061 7474 7269 6275  ibes the attribu
-00007930: 7465 7320 6f66 2042 6967 7461 626c 6520  tes of Bigtable 
-00007940: 6261 7365 6420 6f6e 6c69 6e65 2066 6561  based online fea
-00007950: 7475 7265 2073 746f 7265 2066 6f72 2074  ture store for t
-00007960: 6865 2066 6561 7475 7265 2064 6566 696e  he feature defin
-00007970: 6974 696f 6e2e 0a20 2020 2043 7572 7265  ition..    Curre
-00007980: 6e74 6c79 2074 6865 7265 2061 7265 206e  ntly there are n
-00007990: 6f20 6174 7472 6962 7574 6573 2066 6f72  o attributes for
-000079a0: 2074 6869 7320 636c 6173 732e 0a20 2020   this class..   
-000079b0: 2055 7365 7273 2063 616e 2073 7065 6369   Users can speci
-000079c0: 6679 206f 6e6c 696e 655f 7374 6f72 6520  fy online_store 
-000079d0: 3d20 4269 6774 6162 6c65 436f 6e66 6967  = BigtableConfig
-000079e0: 2829 0a0a 2020 2020 2222 220a 0a20 2020  ()..    """..   
-000079f0: 206b 696e 643a 204c 6974 6572 616c 5b22   kind: Literal["
-00007a00: 4269 6774 6162 6c65 436f 6e66 6967 225d  BigtableConfig"]
-00007a10: 203d 2022 4269 6774 6162 6c65 436f 6e66   = "BigtableConf
-00007a20: 6967 2220 2023 2055 7365 6420 666f 7220  ig"  # Used for 
-00007a30: 5941 4d4c 2070 6172 7369 6e67 2061 7320  YAML parsing as 
-00007a40: 6120 5079 6461 6e74 6963 2064 6973 6372  a Pydantic discr
-00007a50: 696d 696e 6174 6f72 2e0a 0a20 2020 2064  iminator...    d
-00007a60: 6566 205f 746f 5f70 726f 746f 2873 656c  ef _to_proto(sel
-00007a70: 6629 3a0a 2020 2020 2020 2020 7374 6f72  f):.        stor
-00007a80: 655f 636f 6e66 6967 203d 2066 6561 7475  e_config = featu
-00007a90: 7265 5f76 6965 775f 7062 322e 4f6e 6c69  re_view_pb2.Onli
-00007aa0: 6e65 5374 6f72 6543 6f6e 6669 6728 290a  neStoreConfig().
-00007ab0: 2020 2020 2020 2020 7374 6f72 655f 636f          store_co
-00007ac0: 6e66 6967 2e62 6967 7461 626c 652e 656e  nfig.bigtable.en
-00007ad0: 6162 6c65 6420 3d20 5472 7565 0a20 2020  abled = True.   
-00007ae0: 2020 2020 2073 746f 7265 5f63 6f6e 6669       store_confi
-00007af0: 672e 6269 6774 6162 6c65 2e53 6574 496e  g.bigtable.SetIn
-00007b00: 5061 7265 6e74 2829 0a20 2020 2020 2020  Parent().       
-00007b10: 2072 6574 7572 6e20 7374 6f72 655f 636f   return store_co
-00007b20: 6e66 6967 0a0a 0a63 6c61 7373 204d 6f6e  nfig...class Mon
-00007b30: 6974 6f72 696e 6743 6f6e 6669 6728 5374  itoringConfig(St
-00007b40: 7269 6374 4d6f 6465 6c29 3a0a 2020 2020  rictModel):.    
-00007b50: 2222 2243 6f6e 6669 6775 7261 7469 6f6e  """Configuration
-00007b60: 2075 7365 6420 746f 2073 7065 6369 6679   used to specify
-00007b70: 206d 6f6e 6974 6f72 696e 6720 6f70 7469   monitoring opti
-00007b80: 6f6e 732e 0a0a 2020 2020 5468 6973 2063  ons...    This c
-00007b90: 6c61 7373 2064 6573 6372 6962 6573 2074  lass describes t
-00007ba0: 6865 2046 6561 7475 7265 5669 6577 206d  he FeatureView m
-00007bb0: 6174 6572 6961 6c69 7a61 7469 6f6e 2066  aterialization f
-00007bc0: 7265 7368 6e65 7373 2061 6e64 2061 6c65  reshness and ale
-00007bd0: 7274 696e 6720 636f 6e66 6967 7572 6174  rting configurat
-00007be0: 696f 6e73 2e20 5265 7175 6972 6573 0a20  ions. Requires. 
-00007bf0: 2020 206d 6174 6572 6961 6c69 7a61 7469     materializati
-00007c00: 6f6e 2074 6f20 6265 2065 6e61 626c 6564  on to be enabled
-00007c10: 2e20 4672 6573 686e 6573 7320 6d6f 6e69  . Freshness moni
-00007c20: 746f 7269 6e67 2072 6571 7569 7265 7320  toring requires 
-00007c30: 6f6e 6c69 6e65 206d 6174 6572 6961 6c69  online materiali
-00007c40: 7a61 7469 6f6e 2074 6f20 6265 2065 6e61  zation to be ena
-00007c50: 626c 6564 2e0a 2020 2020 5365 6520 604d  bled..    See `M
-00007c60: 6f6e 6974 6f72 696e 6720 4d61 7465 7269  onitoring Materi
-00007c70: 616c 697a 6174 696f 6e60 5f20 666f 7220  alization`_ for 
-00007c80: 6d6f 7265 2064 6574 6169 6c73 2e0a 0a20  more details... 
-00007c90: 2020 203a 7061 7261 6d20 6d6f 6e69 746f     :param monito
-00007ca0: 725f 6672 6573 686e 6573 733a 2044 6566  r_freshness: Def
-00007cb0: 696e 6573 2074 6865 2065 6e61 626c 6564  ines the enabled
-00007cc0: 2f64 6973 6162 6c65 6420 7374 6174 6520  /disabled state 
-00007cd0: 6f66 206d 6f6e 6974 6f72 696e 6720 7768  of monitoring wh
-00007ce0: 656e 2066 6561 7475 7265 2064 6174 6120  en feature data 
-00007cf0: 6973 206d 6174 6572 6961 6c69 7a65 6420  is materialized 
-00007d00: 746f 2074 6865 206f 6e6c 696e 6520 6665  to the online fe
-00007d10: 6174 7572 6520 7374 6f72 652e 0a20 2020  ature store..   
-00007d20: 203a 7479 7065 206d 6f6e 6974 6f72 5f66   :type monitor_f
-00007d30: 7265 7368 6e65 7373 3a20 626f 6f6c 0a20  reshness: bool. 
-00007d40: 2020 203a 7061 7261 6d20 6578 7065 6374     :param expect
-00007d50: 6564 5f66 7265 7368 6e65 7373 3a20 5468  ed_freshness: Th
-00007d60: 7265 7368 6f6c 6420 7573 6564 2074 6f20  reshold used to 
-00007d70: 6465 7465 726d 696e 6520 6966 2072 6563  determine if rec
-00007d80: 656e 746c 7920 6d61 7465 7269 616c 697a  ently materializ
-00007d90: 6564 2066 6561 7475 7265 2064 6174 6120  ed feature data 
-00007da0: 6973 2073 7461 6c65 2e0a 2020 2020 2020  is stale..      
-00007db0: 2020 4461 7461 2069 7320 7374 616c 6520    Data is stale 
-00007dc0: 6966 2060 606e 6f77 202d 2061 6e63 686f  if ``now - ancho
-00007dd0: 725f 7469 6d65 286d 6f73 745f 7265 6365  r_time(most_rece
-00007de0: 6e74 5f66 6561 7475 7265 5f76 616c 7565  nt_feature_value
-00007df0: 2920 3e20 6578 7065 6374 6564 5f66 7265  ) > expected_fre
-00007e00: 7368 6e65 7373 6060 2e0a 2020 2020 2020  shness``..      
-00007e10: 2020 5661 6c75 6520 6d75 7374 2062 6520    Value must be 
-00007e20: 6174 206c 6561 7374 2032 2074 696d 6573  at least 2 times
-00007e30: 2074 6865 2066 6561 7475 7265 2074 696c   the feature til
-00007e40: 6520 6c65 6e67 7468 2e0a 2020 2020 2020  e length..      
-00007e50: 2020 4966 206e 6f74 2073 7065 6369 6669    If not specifi
-00007e60: 6564 2c20 6120 7661 6c75 6520 6465 7465  ed, a value dete
-00007e70: 726d 696e 6564 2062 7920 7468 6520 5465  rmined by the Te
-00007e80: 6374 6f6e 2062 6163 6b65 6e64 2069 7320  cton backend is 
-00007e90: 7573 6564 0a20 2020 203a 7479 7065 2065  used.    :type e
-00007ea0: 7870 6563 7465 645f 6672 6573 686e 6573  xpected_freshnes
-00007eb0: 733a 2074 696d 6564 656c 7461 2c20 6f70  s: timedelta, op
-00007ec0: 7469 6f6e 616c 0a20 2020 203a 7061 7261  tional.    :para
-00007ed0: 6d20 616c 6572 745f 656d 6169 6c3a 2045  m alert_email: E
-00007ee0: 6d61 696c 2074 6861 7420 616c 6572 7473  mail that alerts
-00007ef0: 2066 6f72 2074 6869 7320 4665 6174 7572   for this Featur
-00007f00: 6556 6965 7720 7769 6c6c 2062 6520 7365  eView will be se
-00007f10: 6e74 2074 6f2e 0a20 2020 203a 7479 7065  nt to..    :type
-00007f20: 2061 6c65 7274 5f65 6d61 696c 3a20 7374   alert_email: st
-00007f30: 722c 206f 7074 696f 6e61 6c0a 0a20 2020  r, optional..   
-00007f40: 2041 6e20 6578 616d 706c 6520 6465 636c   An example decl
-00007f50: 6172 6174 696f 6e20 6f66 2061 204d 6f6e  aration of a Mon
-00007f60: 6974 6f72 436f 6e66 6967 0a0a 2020 2020  itorConfig..    
-00007f70: 2020 2020 2e2e 2063 6f64 652d 626c 6f63      .. code-bloc
-00007f80: 6b3a 3a20 7079 7468 6f6e 0a0a 2020 2020  k:: python..    
-00007f90: 2020 2020 2020 2020 6672 6f6d 2064 6174          from dat
-00007fa0: 6574 696d 6520 696d 706f 7274 2074 696d  etime import tim
-00007fb0: 6564 656c 7461 0a20 2020 2020 2020 2020  edelta.         
-00007fc0: 2020 2066 726f 6d20 7465 6374 6f6e 2069     from tecton i
-00007fd0: 6d70 6f72 7420 6261 7463 685f 6665 6174  mport batch_feat
-00007fe0: 7572 655f 7669 6577 2c20 496e 7075 742c  ure_view, Input,
-00007ff0: 204d 6f6e 6974 6f72 696e 6743 6f6e 6669   MonitoringConfi
-00008000: 670a 2020 2020 2020 2020 2020 2020 2320  g.            # 
-00008010: 466f 7220 616c 6c20 6e61 6d65 6420 6172  For all named ar
-00008020: 6775 6d65 6e74 7320 746f 2074 6865 2062  guments to the b
-00008030: 6174 6368 2066 6561 7475 7265 2076 6965  atch feature vie
-00008040: 772c 2073 6565 2064 6f63 7320 666f 7220  w, see docs for 
-00008050: 6465 7461 696c 7320 616e 6420 7479 7065  details and type
-00008060: 732e 0a20 2020 2020 2020 2020 2020 2040  s..            @
-00008070: 6261 7463 685f 6665 6174 7572 655f 7669  batch_feature_vi
-00008080: 6577 280a 2020 2020 2020 2020 2020 2020  ew(.            
-00008090: 2020 2020 736f 7572 6365 733d 5b46 696c      sources=[Fil
-000080a0: 7465 7265 6453 6f75 7263 6528 6372 6564  teredSource(cred
-000080b0: 6974 5f73 636f 7265 735f 6261 7463 6829  it_scores_batch)
-000080c0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-000080d0: 2020 2023 2043 616e 2062 6520 616e 2061     # Can be an a
-000080e0: 7267 756d 656e 7420 696e 7374 616e 6365  rgument instance
-000080f0: 2074 6f20 6120 6261 7463 6820 6665 6174   to a batch feat
-00008100: 7572 6520 7669 6577 2064 6563 6f72 6174  ure view decorat
-00008110: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
-00008120: 2020 206d 6f6e 6974 6f72 696e 6720 3d20     monitoring = 
-00008130: 4d6f 6e69 746f 7269 6e67 436f 6e66 6967  MonitoringConfig
-00008140: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00008150: 2020 2020 2020 6d6f 6e69 746f 725f 6672        monitor_fr
-00008160: 6573 686e 6573 733d 5472 7565 2c0a 2020  eshness=True,.  
-00008170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008180: 2020 6578 7065 6374 6564 5f66 7265 7368    expected_fresh
-00008190: 6e65 7373 3d74 696d 6564 656c 7461 2877  ness=timedelta(w
-000081a0: 6565 6b73 3d31 292c 0a20 2020 2020 2020  eeks=1),.       
-000081b0: 2020 2020 2020 2020 2020 2020 2061 6c65               ale
-000081c0: 7274 5f65 6d61 696c 3d22 6272 6961 6e40  rt_email="brian@
-000081d0: 7465 6374 6f6e 2e61 6922 0a20 2020 2020  tecton.ai".     
-000081e0: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
-000081f0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00008200: 4f74 6865 7220 6e61 6d65 6420 6172 6775  Other named argu
-00008210: 6d65 6e74 730a 2020 2020 2020 2020 2020  ments.          
-00008220: 2020 2020 2020 2e2e 2e0a 2020 2020 2020        ....      
-00008230: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00008240: 2020 2020 2023 2059 6f75 7220 6261 7463       # Your batc
-00008250: 6820 6665 6174 7572 6520 7669 6577 2066  h feature view f
-00008260: 756e 6374 696f 6e0a 2020 2020 2020 2020  unction.        
-00008270: 2020 2020 6465 6620 6372 6564 6974 5f62      def credit_b
-00008280: 6174 6368 5f66 6561 7475 7265 5f76 6965  atch_feature_vie
-00008290: 7728 6372 6564 6974 5f73 636f 7265 7329  w(credit_scores)
-000082a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000082b0: 2e2e 2e0a 0a20 2020 202e 2e20 5f4d 6f6e  .....    .. _Mon
-000082c0: 6974 6f72 696e 6720 4d61 7465 7269 616c  itoring Material
-000082d0: 697a 6174 696f 6e3a 2068 7474 7073 3a2f  ization: https:/
-000082e0: 2f64 6f63 732e 7465 6374 6f6e 2e61 692f  /docs.tecton.ai/
-000082f0: 646f 6373 2f6d 6f6e 6974 6f72 696e 672f  docs/monitoring/
-00008300: 6d6f 6e69 746f 7269 6e67 2d6d 6174 6572  monitoring-mater
-00008310: 6961 6c69 7a61 7469 6f6e 0a20 2020 2022  ialization.    "
-00008320: 2222 0a0a 2020 2020 6d6f 6e69 746f 725f  ""..    monitor_
-00008330: 6672 6573 686e 6573 733a 2062 6f6f 6c0a  freshness: bool.
-00008340: 2020 2020 6578 7065 6374 6564 5f66 7265      expected_fre
-00008350: 7368 6e65 7373 3a20 4f70 7469 6f6e 616c  shness: Optional
-00008360: 5b64 6174 6574 696d 652e 7469 6d65 6465  [datetime.timede
-00008370: 6c74 615d 203d 204e 6f6e 650a 2020 2020  lta] = None.    
-00008380: 616c 6572 745f 656d 6169 6c3a 204f 7074  alert_email: Opt
-00008390: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
-000083a0: 650a 0a20 2020 2064 6566 205f 746f 5f70  e..    def _to_p
-000083b0: 726f 746f 2873 656c 6629 202d 3e20 6665  roto(self) -> fe
-000083c0: 6174 7572 655f 7669 6577 5f70 6232 2e4d  ature_view_pb2.M
-000083d0: 6f6e 6974 6f72 696e 6743 6f6e 6669 673a  onitoringConfig:
-000083e0: 0a20 2020 2020 2020 2070 726f 746f 203d  .        proto =
-000083f0: 2066 6561 7475 7265 5f76 6965 775f 7062   feature_view_pb
-00008400: 322e 4d6f 6e69 746f 7269 6e67 436f 6e66  2.MonitoringConf
-00008410: 6967 2829 0a0a 2020 2020 2020 2020 6966  ig()..        if
-00008420: 2073 656c 662e 6578 7065 6374 6564 5f66   self.expected_f
-00008430: 7265 7368 6e65 7373 3a0a 2020 2020 2020  reshness:.      
-00008440: 2020 2020 2020 7072 6f74 6f2e 6578 7065        proto.expe
-00008450: 6374 6564 5f66 7265 7368 6e65 7373 2e46  cted_freshness.F
-00008460: 726f 6d54 696d 6564 656c 7461 2873 656c  romTimedelta(sel
-00008470: 662e 6578 7065 6374 6564 5f66 7265 7368  f.expected_fresh
-00008480: 6e65 7373 290a 0a20 2020 2020 2020 2070  ness)..        p
-00008490: 726f 746f 2e61 6c65 7274 5f65 6d61 696c  roto.alert_email
-000084a0: 203d 2073 656c 662e 616c 6572 745f 656d   = self.alert_em
-000084b0: 6169 6c20 6f72 2022 220a 2020 2020 2020  ail or "".      
-000084c0: 2020 7072 6f74 6f2e 6d6f 6e69 746f 725f    proto.monitor_
-000084d0: 6672 6573 686e 6573 7320 3d20 7365 6c66  freshness = self
-000084e0: 2e6d 6f6e 6974 6f72 5f66 7265 7368 6e65  .monitor_freshne
-000084f0: 7373 0a20 2020 2020 2020 2072 6574 7572  ss.        retur
-00008500: 6e20 7072 6f74 6f0a 0a0a 636c 6173 7320  n proto...class 
-00008510: 4c6f 6767 696e 6743 6f6e 6669 6728 5374  LoggingConfig(St
-00008520: 7269 6374 4d6f 6465 6c29 3a0a 2020 2020  rictModel):.    
-00008530: 2222 220a 2020 2020 436f 6e66 6967 7572  """.    Configur
-00008540: 6174 696f 6e20 7573 6564 2074 6f20 6465  ation used to de
-00008550: 7363 7269 6265 2066 6561 7475 7265 2061  scribe feature a
-00008560: 6e64 2072 6571 7565 7374 206c 6f67 6769  nd request loggi
-00008570: 6e67 2066 6f72 2046 6561 7475 7265 2053  ng for Feature S
-00008580: 6572 7669 6365 732e 0a0a 2020 2020 3a70  ervices...    :p
-00008590: 6172 616d 2073 616d 706c 655f 7261 7465  aram sample_rate
-000085a0: 3a20 5468 6520 7261 7465 206f 6620 6c6f  : The rate of lo
-000085b0: 6767 696e 6720 6665 6174 7572 6573 2e20  gging features. 
-000085c0: 4d75 7374 2062 6520 6265 7477 6565 6e20  Must be between 
-000085d0: 2830 2c20 315d 2e20 4465 6661 756c 7473  (0, 1]. Defaults
-000085e0: 2074 6f20 312e 0a20 2020 203a 7061 7261   to 1..    :para
-000085f0: 6d20 6c6f 675f 6566 6665 6374 6976 655f  m log_effective_
-00008600: 7469 6d65 733a 2057 6865 7468 6572 2074  times: Whether t
-00008610: 6f20 6c6f 6720 7468 6520 7469 6d65 7374  o log the timest
-00008620: 616d 7073 206f 6620 7468 6520 6c61 7374  amps of the last
-00008630: 2075 7064 6174 6520 6f66 2074 6865 206c   update of the l
-00008640: 6f67 6765 6420 6665 6174 7572 6520 7661  ogged feature va
-00008650: 6c75 6573 2e20 4465 6661 756c 7473 2074  lues. Defaults t
-00008660: 6f20 4661 6c73 652e 0a0a 2020 2020 416e  o False...    An
-00008670: 2065 7861 6d70 6c65 206f 6620 4c6f 6767   example of Logg
-00008680: 696e 6743 6f6e 6669 6720 6465 636c 6172  ingConfig declar
-00008690: 6174 696f 6e20 6173 2070 6172 7420 6f66  ation as part of
-000086a0: 2046 6561 7475 7265 5365 7276 6963 650a   FeatureService.
-000086b0: 0a20 2020 202e 2e20 636f 6465 2d62 6c6f  .    .. code-blo
-000086c0: 636b 3a3a 2050 7974 686f 6e0a 0a20 2020  ck:: Python..   
-000086d0: 2020 2020 2066 726f 6d20 7465 6374 6f6e       from tecton
-000086e0: 2069 6d70 6f72 7420 4665 6174 7572 6553   import FeatureS
-000086f0: 6572 7669 6365 2c20 4c6f 6767 696e 6743  ervice, LoggingC
-00008700: 6f6e 6669 670a 0a20 2020 2020 2020 2023  onfig..        #
-00008710: 204c 6f67 6769 6e67 436f 6e66 6967 2069   LoggingConfig i
-00008720: 7320 6e6f 726d 616c 7920 7573 6564 2061  s normaly used a
-00008730: 7320 6120 6e61 6d65 6420 6172 6775 6d65  s a named argume
-00008740: 6e74 2070 6172 616d 6574 6572 2074 6f20  nt parameter to 
-00008750: 6120 4665 6174 7572 6553 6572 7669 6365  a FeatureService
-00008760: 2069 6e73 7461 6e63 6520 6465 6669 6e69   instance defini
-00008770: 7469 6f6e 2e0a 2020 2020 2020 2020 6d79  tion..        my
-00008780: 5f66 6561 7475 7265 5f73 6572 7669 6365  _feature_service
-00008790: 203d 2046 6561 7475 7265 5365 7276 6963   = FeatureServic
-000087a0: 6528 0a20 2020 2020 2020 2020 2020 206e  e(.            n
-000087b0: 616d 653d 2241 6e20 6578 616d 706c 6520  ame="An example 
-000087c0: 6f66 2046 6561 7475 7265 2053 6572 7669  of Feature Servi
-000087d0: 6365 220a 2020 2020 2020 2020 2020 2020  ce".            
-000087e0: 2320 4f74 6865 7220 6e61 6d65 6420 6172  # Other named ar
-000087f0: 6775 6d65 6e74 730a 2020 2020 2020 2020  guments.        
-00008800: 2020 2020 2e2e 2e0a 2020 2020 2020 2020      ....        
-00008810: 2020 2020 2320 4120 4c6f 6767 696e 6743      # A LoggingC
-00008820: 6f6e 6669 6720 696e 7374 616e 6365 0a20  onfig instance. 
-00008830: 2020 2020 2020 2020 2020 206c 6f67 6769             loggi
-00008840: 6e67 3d4c 6f67 6769 6e67 436f 6e66 6967  ng=LoggingConfig
-00008850: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00008860: 2020 2020 2020 7361 6d70 6c65 5f72 6174        sample_rat
-00008870: 653d 302e 352c 0a20 2020 2020 2020 2020  e=0.5,.         
-00008880: 2020 2020 2020 2020 2020 206c 6f67 5f65             log_e
-00008890: 6666 6563 7469 7665 5f74 696d 6573 3d46  ffective_times=F
-000088a0: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-000088b0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-000088c0: 2e2e 2e0a 2020 2020 2020 2020 290a 2020  ....        ).  
-000088d0: 2020 2222 220a 0a20 2020 2073 616d 706c    """..    sampl
-000088e0: 655f 7261 7465 3a20 666c 6f61 7420 3d20  e_rate: float = 
-000088f0: 312e 300a 2020 2020 6c6f 675f 6566 6665  1.0.    log_effe
-00008900: 6374 6976 655f 7469 6d65 733a 2062 6f6f  ctive_times: boo
-00008910: 6c20 3d20 4661 6c73 650a 0a20 2020 2064  l = False..    d
-00008920: 6566 205f 746f 5f70 726f 746f 2873 656c  ef _to_proto(sel
-00008930: 6629 202d 3e20 6665 6174 7572 655f 7365  f) -> feature_se
-00008940: 7276 6963 655f 7062 322e 4c6f 6767 696e  rvice_pb2.Loggin
-00008950: 6743 6f6e 6669 6741 7267 733a 0a20 2020  gConfigArgs:.   
-00008960: 2020 2020 2072 6574 7572 6e20 6665 6174       return feat
-00008970: 7572 655f 7365 7276 6963 655f 7062 322e  ure_service_pb2.
-00008980: 4c6f 6767 696e 6743 6f6e 6669 6741 7267  LoggingConfigArg
-00008990: 7328 0a20 2020 2020 2020 2020 2020 2073  s(.            s
-000089a0: 616d 706c 655f 7261 7465 3d73 656c 662e  ample_rate=self.
-000089b0: 7361 6d70 6c65 5f72 6174 652c 206c 6f67  sample_rate, log
-000089c0: 5f65 6666 6563 7469 7665 5f74 696d 6573  _effective_times
-000089d0: 3d73 656c 662e 6c6f 675f 6566 6665 6374  =self.log_effect
-000089e0: 6976 655f 7469 6d65 730a 2020 2020 2020  ive_times.      
-000089f0: 2020 290a 0a20 2020 2040 636c 6173 736d    )..    @classm
-00008a00: 6574 686f 640a 2020 2020 6465 6620 5f66  ethod.    def _f
-00008a10: 726f 6d5f 7072 6f74 6f28 636c 732c 206c  rom_proto(cls, l
-00008a20: 6f67 6769 6e67 5f63 6f6e 6669 675f 7072  ogging_config_pr
-00008a30: 6f74 6f3a 2066 6561 7475 7265 5f73 6572  oto: feature_ser
-00008a40: 7669 6365 5f70 6232 2e4c 6f67 6769 6e67  vice_pb2.Logging
-00008a50: 436f 6e66 6967 4172 6773 2920 2d3e 2022  ConfigArgs) -> "
-00008a60: 4c6f 6767 696e 6743 6f6e 6669 6722 3a0a  LoggingConfig":.
-00008a70: 2020 2020 2020 2020 7265 7475 726e 204c          return L
-00008a80: 6f67 6769 6e67 436f 6e66 6967 286c 6f67  oggingConfig(log
-00008a90: 6769 6e67 5f63 6f6e 6669 675f 7072 6f74  ging_config_prot
-00008aa0: 6f2e 7361 6d70 6c65 5f72 6174 652c 206c  o.sample_rate, l
-00008ab0: 6f67 6769 6e67 5f63 6f6e 6669 675f 7072  ogging_config_pr
-00008ac0: 6f74 6f2e 6c6f 675f 6566 6665 6374 6976  oto.log_effectiv
-00008ad0: 655f 7469 6d65 7329 0a0a 0a63 6c61 7373  e_times)...class
-00008ae0: 204f 7574 7075 7453 7472 6561 6d28 5374   OutputStream(St
-00008af0: 7269 6374 4d6f 6465 6c29 3a0a 2020 2020  rictModel):.    
-00008b00: 2222 2242 6173 6520 636c 6173 7320 666f  """Base class fo
-00008b10: 7220 6f75 7470 7574 2073 7472 6561 6d20  r output stream 
-00008b20: 636f 6e66 6967 732e 2222 220a 0a20 2020  configs."""..   
-00008b30: 2064 6566 205f 746f 5f70 726f 746f 2829   def _to_proto()
-00008b40: 202d 3e20 6665 6174 7572 655f 7669 6577   -> feature_view
-00008b50: 5f70 6232 2e4f 7574 7075 7453 7472 6561  _pb2.OutputStrea
-00008b60: 6d3a 0a20 2020 2020 2020 2072 6169 7365  m:.        raise
-00008b70: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
-00008b80: 7272 6f72 0a0a 0a63 6c61 7373 204b 696e  rror...class Kin
-00008b90: 6573 6973 4f75 7470 7574 5374 7265 616d  esisOutputStream
-00008ba0: 284f 7574 7075 7453 7472 6561 6d29 3a0a  (OutputStream):.
-00008bb0: 2020 2020 2222 2243 6f6e 6669 6775 7261      """Configura
-00008bc0: 7469 6f6e 2075 7365 6420 666f 7220 6120  tion used for a 
-00008bd0: 4b69 6e65 7369 7320 6f75 7470 7574 2073  Kinesis output s
-00008be0: 7472 6561 6d2e 0a0a 2020 2020 3a70 6172  tream...    :par
-00008bf0: 616d 2073 7472 6561 6d5f 6e61 6d65 3a20  am stream_name: 
-00008c00: 4e61 6d65 206f 6620 7468 6520 4b69 6e65  Name of the Kine
-00008c10: 7369 7320 7374 7265 616d 2e0a 2020 2020  sis stream..    
-00008c20: 3a70 6172 616d 2072 6567 696f 6e3a 2041  :param region: A
-00008c30: 5753 2072 6567 696f 6e20 6f66 2074 6865  WS region of the
-00008c40: 2073 7472 6561 6d2c 2065 2e67 3a20 2275   stream, e.g: "u
-00008c50: 732d 7765 7374 2d32 222e 0a20 2020 203a  s-west-2"..    :
-00008c60: 7061 7261 6d20 6f70 7469 6f6e 733a 2041  param options: A
-00008c70: 206d 6170 206f 6620 6164 6469 7469 6f6e   map of addition
-00008c80: 616c 2053 7061 726b 2072 6561 6453 7472  al Spark readStr
-00008c90: 6561 6d20 6f70 7469 6f6e 732e 204f 6e6c  eam options. Onl
-00008ca0: 7920 6072 6f6c 6541 726e 6020 6973 2073  y `roleArn` is s
-00008cb0: 7570 706f 7274 6564 2e0a 2020 2020 3a70  upported..    :p
-00008cc0: 6172 616d 2069 6e63 6c75 6465 5f66 6561  aram include_fea
-00008cd0: 7475 7265 733a 2052 6574 7572 6e20 6665  tures: Return fe
-00008ce0: 6174 7572 6520 7661 6c75 6573 2069 6e20  ature values in 
-00008cf0: 6164 6469 7469 6f6e 2074 6f20 656e 7469  addition to enti
-00008d00: 7479 206b 6579 732e 204e 6f74 2073 7570  ty keys. Not sup
-00008d10: 706f 7274 6564 2066 6f72 2077 696e 646f  ported for windo
-00008d20: 7720 6167 6772 6567 6174 6520 4665 6174  w aggregate Feat
-00008d30: 7572 6520 5669 6577 732e 0a20 2020 2022  ure Views..    "
-00008d40: 2222 0a0a 2020 2020 7374 7265 616d 5f6e  ""..    stream_n
-00008d50: 616d 653a 2073 7472 0a20 2020 2072 6567  ame: str.    reg
-00008d60: 696f 6e3a 2073 7472 0a20 2020 206f 7074  ion: str.    opt
-00008d70: 696f 6e73 3a20 4f70 7469 6f6e 616c 5b44  ions: Optional[D
-00008d80: 6963 745b 7374 722c 2073 7472 5d5d 203d  ict[str, str]] =
-00008d90: 204e 6f6e 650a 2020 2020 696e 636c 7564   None.    includ
-00008da0: 655f 6665 6174 7572 6573 3a20 626f 6f6c  e_features: bool
-00008db0: 203d 2046 616c 7365 0a0a 2020 2020 6465   = False..    de
-00008dc0: 6620 5f74 6f5f 7072 6f74 6f28 7365 6c66  f _to_proto(self
-00008dd0: 2920 2d3e 2066 6561 7475 7265 5f76 6965  ) -> feature_vie
-00008de0: 775f 7062 322e 4f75 7470 7574 5374 7265  w_pb2.OutputStre
-00008df0: 616d 3a0a 2020 2020 2020 2020 6172 6773  am:.        args
-00008e00: 203d 2064 6174 615f 736f 7572 6365 5f70   = data_source_p
-00008e10: 6232 2e4b 696e 6573 6973 4461 7461 536f  b2.KinesisDataSo
-00008e20: 7572 6365 4172 6773 280a 2020 2020 2020  urceArgs(.      
-00008e30: 2020 2020 2020 7374 7265 616d 5f6e 616d        stream_nam
-00008e40: 653d 7365 6c66 2e73 7472 6561 6d5f 6e61  e=self.stream_na
-00008e50: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-00008e60: 7265 6769 6f6e 3d73 656c 662e 7265 6769  region=self.regi
-00008e70: 6f6e 2c0a 2020 2020 2020 2020 290a 2020  on,.        ).  
-00008e80: 2020 2020 2020 6f70 7469 6f6e 7320 3d20        options = 
-00008e90: 7365 6c66 2e6f 7074 696f 6e73 206f 7220  self.options or 
-00008ea0: 7b7d 0a20 2020 2020 2020 2066 6f72 206b  {}.        for k
-00008eb0: 6579 2069 6e20 736f 7274 6564 286f 7074  ey in sorted(opt
-00008ec0: 696f 6e73 2e6b 6579 7328 2929 3a0a 2020  ions.keys()):.  
-00008ed0: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
-00008ee0: 203d 2064 6174 615f 736f 7572 6365 5f70   = data_source_p
-00008ef0: 6232 2e4f 7074 696f 6e28 0a20 2020 2020  b2.Option(.     
-00008f00: 2020 2020 2020 2020 2020 206b 6579 3d6b             key=k
-00008f10: 6579 2c0a 2020 2020 2020 2020 2020 2020  ey,.            
-00008f20: 2020 2020 7661 6c75 653d 6f70 7469 6f6e      value=option
-00008f30: 735b 6b65 795d 2c0a 2020 2020 2020 2020  s[key],.        
-00008f40: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00008f50: 2020 6172 6773 2e6f 7074 696f 6e73 2e61    args.options.a
-00008f60: 7070 656e 6428 6f70 7469 6f6e 290a 0a20  ppend(option).. 
-00008f70: 2020 2020 2020 2072 6574 7572 6e20 6665         return fe
-00008f80: 6174 7572 655f 7669 6577 5f70 6232 2e4f  ature_view_pb2.O
-00008f90: 7574 7075 7453 7472 6561 6d28 0a20 2020  utputStream(.   
-00008fa0: 2020 2020 2020 2020 2069 6e63 6c75 6465           include
-00008fb0: 5f66 6561 7475 7265 733d 7365 6c66 2e69  _features=self.i
-00008fc0: 6e63 6c75 6465 5f66 6561 7475 7265 732c  nclude_features,
-00008fd0: 0a20 2020 2020 2020 2020 2020 206b 696e  .            kin
-00008fe0: 6573 6973 3d61 7267 732c 0a20 2020 2020  esis=args,.     
-00008ff0: 2020 2029 0a0a 0a63 6c61 7373 204b 6166     )...class Kaf
-00009000: 6b61 4f75 7470 7574 5374 7265 616d 284f  kaOutputStream(O
-00009010: 7574 7075 7453 7472 6561 6d29 3a0a 2020  utputStream):.  
-00009020: 2020 2222 2243 6f6e 6669 6775 7261 7469    """Configurati
-00009030: 6f6e 2075 7365 6420 666f 7220 6120 4b61  on used for a Ka
-00009040: 666b 6120 6f75 7470 7574 2073 7472 6561  fka output strea
-00009050: 6d2e 0a0a 2020 2020 3a70 6172 616d 206b  m...    :param k
-00009060: 6166 6b61 5f62 6f6f 7473 7472 6170 5f73  afka_bootstrap_s
-00009070: 6572 7665 7273 3a20 5468 6520 6c69 7374  ervers: The list
-00009080: 206f 6620 626f 6f74 7374 7261 7020 7365   of bootstrap se
-00009090: 7276 6572 7320 666f 7220 796f 7572 204b  rvers for your K
-000090a0: 6166 6b61 2062 726f 6b65 7273 2c20 652e  afka brokers, e.
-000090b0: 673a 2022 6162 632e 7879 7a2e 636f 6d3a  g: "abc.xyz.com:
-000090c0: 7878 7878 2c61 6263 322e 7879 7a2e 636f  xxxx,abc2.xyz.co
-000090d0: 6d3a 7878 7878 222e 0a20 2020 203a 7061  m:xxxx"..    :pa
-000090e0: 7261 6d20 746f 7069 6373 3a20 4120 636f  ram topics: A co
-000090f0: 6d6d 612d 7365 7061 7261 7465 6420 6c69  mma-separated li
-00009100: 7374 206f 6620 4b61 666b 6120 746f 7069  st of Kafka topi
-00009110: 6373 2074 6865 2072 6563 6f72 6420 7769  cs the record wi
-00009120: 6c6c 2062 6520 6170 7065 6e64 6564 2074  ll be appended t
-00009130: 6f2e 2043 7572 7265 6e74 6c79 206f 6e6c  o. Currently onl
-00009140: 7920 7375 7070 6f72 7473 206f 6e65 2074  y supports one t
-00009150: 6f70 6963 2e0a 2020 2020 3a70 6172 616d  opic..    :param
-00009160: 206f 7074 696f 6e73 3a20 4120 6d61 7020   options: A map 
-00009170: 6f66 2061 6464 6974 696f 6e61 6c20 5370  of additional Sp
-00009180: 6172 6b20 7265 6164 5374 7265 616d 206f  ark readStream o
-00009190: 7074 696f 6e73 2e20 4f6e 6c79 2060 726f  ptions. Only `ro
-000091a0: 6c65 4172 6e60 2069 7320 7375 7070 6f72  leArn` is suppor
-000091b0: 7465 6420 6174 2074 6865 206d 6f6d 656e  ted at the momen
-000091c0: 742e 0a20 2020 203a 7061 7261 6d20 696e  t..    :param in
-000091d0: 636c 7564 655f 6665 6174 7572 6573 3a20  clude_features: 
-000091e0: 5265 7475 726e 2066 6561 7475 7265 2076  Return feature v
-000091f0: 616c 7565 7320 696e 2061 6464 6974 696f  alues in additio
-00009200: 6e20 746f 2065 6e74 6974 7920 6b65 7973  n to entity keys
-00009210: 2e20 4e6f 7420 7375 7070 6f72 7465 6420  . Not supported 
-00009220: 666f 7220 7769 6e64 6f77 2061 6767 7265  for window aggre
-00009230: 6761 7465 2046 6561 7475 7265 2056 6965  gate Feature Vie
-00009240: 7773 2e0a 2020 2020 2222 220a 0a20 2020  ws..    """..   
-00009250: 206b 6166 6b61 5f62 6f6f 7473 7472 6170   kafka_bootstrap
-00009260: 5f73 6572 7665 7273 3a20 7374 720a 2020  _servers: str.  
-00009270: 2020 746f 7069 6373 3a20 7374 720a 2020    topics: str.  
-00009280: 2020 6f70 7469 6f6e 733a 204f 7074 696f    options: Optio
-00009290: 6e61 6c5b 4469 6374 5b73 7472 2c20 7374  nal[Dict[str, st
-000092a0: 725d 5d20 3d20 4e6f 6e65 0a20 2020 2069  r]] = None.    i
-000092b0: 6e63 6c75 6465 5f66 6561 7475 7265 733a  nclude_features:
-000092c0: 2062 6f6f 6c20 3d20 4661 6c73 650a 0a20   bool = False.. 
-000092d0: 2020 2064 6566 205f 746f 5f70 726f 746f     def _to_proto
-000092e0: 2873 656c 6629 202d 3e20 6665 6174 7572  (self) -> featur
-000092f0: 655f 7669 6577 5f70 6232 2e4f 7574 7075  e_view_pb2.Outpu
-00009300: 7453 7472 6561 6d3a 0a20 2020 2020 2020  tStream:.       
-00009310: 2061 7267 7320 3d20 6461 7461 5f73 6f75   args = data_sou
-00009320: 7263 655f 7062 322e 4b61 666b 6144 6174  rce_pb2.KafkaDat
-00009330: 6153 6f75 7263 6541 7267 7328 0a20 2020  aSourceArgs(.   
-00009340: 2020 2020 2020 2020 206b 6166 6b61 5f62           kafka_b
-00009350: 6f6f 7473 7472 6170 5f73 6572 7665 7273  ootstrap_servers
-00009360: 3d73 656c 662e 6b61 666b 615f 626f 6f74  =self.kafka_boot
-00009370: 7374 7261 705f 7365 7276 6572 732c 0a20  strap_servers,. 
-00009380: 2020 2020 2020 2020 2020 2074 6f70 6963             topic
-00009390: 733d 7365 6c66 2e74 6f70 6963 732c 0a20  s=self.topics,. 
-000093a0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000093b0: 206f 7074 696f 6e73 203d 2073 656c 662e   options = self.
-000093c0: 6f70 7469 6f6e 7320 6f72 207b 7d0a 2020  options or {}.  
-000093d0: 2020 2020 2020 666f 7220 6b65 7920 696e        for key in
-000093e0: 2073 6f72 7465 6428 6f70 7469 6f6e 732e   sorted(options.
-000093f0: 6b65 7973 2829 293a 0a20 2020 2020 2020  keys()):.       
-00009400: 2020 2020 206f 7074 696f 6e20 3d20 6461       option = da
-00009410: 7461 5f73 6f75 7263 655f 7062 322e 4f70  ta_source_pb2.Op
-00009420: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
-00009430: 2020 2020 2020 6b65 793d 6b65 792c 0a20        key=key,. 
-00009440: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00009450: 616c 7565 3d6f 7074 696f 6e73 5b6b 6579  alue=options[key
-00009460: 5d2c 0a20 2020 2020 2020 2020 2020 2029  ],.            )
-00009470: 0a20 2020 2020 2020 2020 2020 2061 7267  .            arg
-00009480: 732e 6f70 7469 6f6e 732e 6170 7065 6e64  s.options.append
-00009490: 286f 7074 696f 6e29 0a0a 2020 2020 2020  (option)..      
-000094a0: 2020 7265 7475 726e 2066 6561 7475 7265    return feature
-000094b0: 5f76 6965 775f 7062 322e 4f75 7470 7574  _view_pb2.Output
-000094c0: 5374 7265 616d 280a 2020 2020 2020 2020  Stream(.        
-000094d0: 2020 2020 696e 636c 7564 655f 6665 6174      include_feat
-000094e0: 7572 6573 3d73 656c 662e 696e 636c 7564  ures=self.includ
-000094f0: 655f 6665 6174 7572 6573 2c0a 2020 2020  e_features,.    
-00009500: 2020 2020 2020 2020 6b61 666b 613d 6172          kafka=ar
-00009510: 6773 2c0a 2020 2020 2020 2020 290a 0a0a  gs,.        )...
-00009520: 636c 6173 7320 4461 7465 7469 6d65 5061  class DatetimePa
-00009530: 7274 6974 696f 6e43 6f6c 756d 6e28 5374  rtitionColumn(St
-00009540: 7269 6374 4d6f 6465 6c29 3a0a 2020 2020  rictModel):.    
-00009550: 2222 2248 656c 7065 7220 636c 6173 7320  """Helper class 
-00009560: 746f 2074 656c 6c20 5465 6374 6f6e 2068  to tell Tecton h
-00009570: 6f77 2075 6e64 6572 6c79 696e 6720 666c  ow underlying fl
-00009580: 6174 2066 696c 6573 2061 7265 2064 6174  at files are dat
-00009590: 652f 7469 6d65 2070 6172 7469 7469 6f6e  e/time partition
-000095a0: 6564 2066 6f72 2048 6976 652f 476c 7565  ed for Hive/Glue
-000095b0: 2064 6174 6120 736f 7572 6365 732e 2054   data sources. T
-000095c0: 6869 7320 6361 6e20 7472 616e 736c 6174  his can translat
-000095d0: 6520 696e 746f 2061 2073 6967 6e69 6669  e into a signifi
-000095e0: 6361 6e74 2070 6572 666f 726d 616e 6365  cant performance
-000095f0: 2069 6e63 7265 6173 652e 0a0a 2020 2020   increase...    
-00009600: 596f 7520 7769 6c6c 2067 656e 6572 616c  You will general
-00009610: 6c79 2069 6e63 6c75 6465 2061 6e20 6f62  ly include an ob
-00009620: 6a65 6374 206f 6620 7468 6973 2063 6c61  ject of this cla
-00009630: 7373 2069 6e20 7468 6520 6060 6461 7465  ss in the ``date
-00009640: 7469 6d65 5f70 6172 7469 7469 6f6e 5f63  time_partition_c
-00009650: 6f6c 756d 6e73 6060 206f 7074 696f 6e20  olumns`` option 
-00009660: 696e 2061 203a 636c 6173 733a 6048 6976  in a :class:`Hiv
-00009670: 6543 6f6e 6669 6760 206f 626a 6563 742e  eConfig` object.
-00009680: 0a0a 2020 2020 3a70 6172 616d 2063 6f6c  ..    :param col
-00009690: 756d 6e5f 6e61 6d65 3a20 5468 6520 6e61  umn_name: The na
-000096a0: 6d65 206f 6620 7468 6520 636f 6c75 6d6e  me of the column
-000096b0: 2069 6e20 7468 6520 476c 7565 2f48 6976   in the Glue/Hiv
-000096c0: 6520 7363 6865 6d61 2074 6861 7420 636f  e schema that co
-000096d0: 7272 6573 706f 6e64 7320 746f 2074 6865  rresponds to the
-000096e0: 2075 6e64 6572 6c79 696e 6720 6461 7465   underlying date
-000096f0: 2f74 696d 6520 7061 7274 6974 696f 6e20  /time partition 
-00009700: 666f 6c64 6572 2e20 4e6f 7465 2074 6861  folder. Note tha
-00009710: 7420 6966 2079 6f75 2064 6f20 6e6f 7420  t if you do not 
-00009720: 6578 706c 6963 6974 6c79 2073 7065 6369  explicitly speci
-00009730: 6679 2061 206e 616d 6520 696e 2079 6f75  fy a name in you
-00009740: 7220 7061 7274 6974 696f 6e20 666f 6c64  r partition fold
-00009750: 6572 732c 2047 6c75 6520 7769 6c6c 206e  ers, Glue will n
-00009760: 616d 6520 7468 6520 636f 6c75 6d6e 206f  ame the column o
-00009770: 6620 7468 6520 666f 726d 2060 6070 6172  f the form ``par
-00009780: 7469 7469 6f6e 5f30 6060 2e0a 2020 2020  tition_0``..    
-00009790: 3a70 6172 616d 2064 6174 6570 6172 743a  :param datepart:
-000097a0: 2054 6865 2070 6172 7420 6f66 2074 6865   The part of the
-000097b0: 2064 6174 6520 7468 6174 2074 6869 7320   date that this 
-000097c0: 636f 6c75 6d6e 2073 7065 6369 6669 6573  column specifies
-000097d0: 2e20 4361 6e20 6265 206f 6e65 206f 6620  . Can be one of 
-000097e0: 2279 6561 7222 2c20 226d 6f6e 7468 222c  "year", "month",
-000097f0: 2022 6461 7922 2c20 2268 6f75 7222 2c20   "day", "hour", 
-00009800: 6f72 2074 6865 2066 756c 6c20 2264 6174  or the full "dat
-00009810: 6522 2e20 4966 2075 7365 6420 7769 7468  e". If used with
-00009820: 2060 6066 6f72 6d61 745f 7374 7269 6e67   ``format_string
-00009830: 6060 2c20 7468 6973 2073 686f 756c 6420  ``, this should 
-00009840: 6265 2074 6865 2073 697a 6520 6f66 2070  be the size of p
-00009850: 6172 7469 7469 6f6e 2062 6569 6e67 2072  artition being r
-00009860: 6570 7265 7365 6e74 6564 2c20 652e 672e  epresented, e.g.
-00009870: 2060 6064 6174 6570 6172 743d 226d 6f6e   ``datepart="mon
-00009880: 7468 2260 6020 666f 7220 6060 666f 726d  th"`` for ``form
-00009890: 6174 5f73 7472 696e 673d 2225 592d 256d  at_string="%Y-%m
-000098a0: 2260 602e 0a20 2020 203a 7061 7261 6d20  "``..    :param 
-000098b0: 7a65 726f 5f70 6164 6465 643a 2057 6865  zero_padded: Whe
-000098c0: 7468 6572 2074 6865 2060 6064 6174 6570  ther the ``datep
-000098d0: 6172 7460 6020 6861 7320 6120 6c65 6164  art`` has a lead
-000098e0: 696e 6720 7a65 726f 2069 6620 6c65 7373  ing zero if less
-000098f0: 2074 6861 6e20 7477 6f20 6469 6769 7473   than two digits
-00009900: 2e20 5468 6973 206d 7573 7420 6265 2073  . This must be s
-00009910: 6574 2074 6f20 5472 7565 2069 6620 6060  et to True if ``
-00009920: 6461 7465 7061 7274 3d22 6461 7465 2260  datepart="date"`
-00009930: 602e 2028 5368 6f75 6c64 206e 6f74 2062  `. (Should not b
-00009940: 6520 7365 7420 6966 2060 6066 6f72 6d61  e set if ``forma
-00009950: 745f 7374 7269 6e67 6060 2069 7320 7365  t_string`` is se
-00009960: 742e 290a 2020 2020 3a70 6172 616d 2066  t.).    :param f
-00009970: 6f72 6d61 745f 7374 7269 6e67 3a0a 2020  ormat_string:.  
-00009980: 2020 2020 2020 4120 6060 6461 7465 7469        A ``dateti
-00009990: 6d65 2e73 7472 6674 696d 6560 6020 666f  me.strftime`` fo
-000099a0: 726d 6174 2073 7472 696e 6720 6f76 6572  rmat string over
-000099b0: 7269 6465 2066 6f72 2022 6e6f 6e2d 6465  ride for "non-de
-000099c0: 6661 756c 7422 2070 6172 7469 7469 6f6e  fault" partition
-000099d0: 2063 6f6c 756d 6e73 2066 6f72 6d61 7473   columns formats
-000099e0: 2e20 452e 672e 2060 6022 2559 256d 2564  . E.g. ``"%Y%m%d
-000099f0: 2260 6020 666f 7220 6060 6461 7465 7061  "`` for ``datepa
-00009a00: 7274 3d22 6461 7465 2260 6020 696e 7374  rt="date"`` inst
-00009a10: 6561 6420 6f66 2074 6865 2054 6563 746f  ead of the Tecto
-00009a20: 6e20 6465 6661 756c 7420 6060 2225 592d  n default ``"%Y-
-00009a30: 256d 2d25 6422 6060 2c20 6f72 2060 6022  %m-%d"``, or ``"
-00009a40: 2559 2d25 6d22 6060 2066 6f72 2060 6064  %Y-%m"`` for ``d
-00009a50: 6174 6570 6172 743d 226d 6f6e 7468 2260  atepart="month"`
-00009a60: 6020 696e 7374 6561 6420 6f66 2074 6865  ` instead of the
-00009a70: 2054 6563 746f 6e20 6465 6661 756c 7420   Tecton default 
-00009a80: 6060 2225 6d22 6060 2e0a 0a20 2020 2020  ``"%m"``...     
-00009a90: 2020 2049 4d50 4f52 5441 4e54 3a20 5468     IMPORTANT: Th
-00009aa0: 6973 2066 6f72 6d61 7420 7374 7269 6e67  is format string
-00009ab0: 206d 7573 7420 636f 6e76 6572 7420 7079   must convert py
-00009ac0: 7468 6f6e 2064 6174 6574 696d 6573 2028  thon datetimes (
-00009ad0: 7669 6120 6060 6461 7465 7469 6d65 2e73  via ``datetime.s
-00009ae0: 7472 6674 696d 6528 666f 726d 6174 2960  trftime(format)`
-00009af0: 6029 2074 6f20 7374 7269 6e67 7320 7468  `) to strings th
-00009b00: 6174 2061 7265 2073 6f72 7461 626c 6520  at are sortable 
-00009b10: 696e 2074 696d 6520 6f72 6465 722e 2046  in time order. F
-00009b20: 6f72 2065 7861 6d70 6c65 2c20 6060 2225  or example, ``"%
-00009b30: 6d2d 2559 2260 6020 776f 756c 6420 6265  m-%Y"`` would be
-00009b40: 2061 6e20 696e 7661 6c69 6420 666f 726d   an invalid form
-00009b50: 6174 2073 7472 696e 6720 6265 6361 7573  at string becaus
-00009b60: 6520 6060 2230 392d 3230 3139 2220 3e20  e ``"09-2019" > 
-00009b70: 2230 352d 3230 3230 2260 602e 0a0a 2020  "05-2020"``...  
-00009b80: 2020 2020 2020 5365 6520 6874 7470 733a        See https:
-00009b90: 2f2f 646f 6373 2e70 7974 686f 6e2e 6f72  //docs.python.or
-00009ba0: 672f 332f 6c69 6272 6172 792f 6461 7465  g/3/library/date
-00009bb0: 7469 6d65 2e68 746d 6c23 7374 7266 7469  time.html#strfti
-00009bc0: 6d65 2d61 6e64 2d73 7472 7074 696d 652d  me-and-strptime-
-00009bd0: 666f 726d 6174 2d63 6f64 6573 2066 6f72  format-codes for
-00009be0: 2066 6f72 6d61 7420 636f 6465 732e 0a0a   format codes...
-00009bf0: 2020 2020 4578 616d 706c 6520 6465 6669      Example defi
-00009c00: 6e69 7469 6f6e 733a 0a0a 2020 2020 2020  nitions:..      
-00009c10: 2020 4173 7375 6d65 2079 6f75 2068 6176    Assume you hav
-00009c20: 6520 616e 2053 3320 6275 636b 6574 2077  e an S3 bucket w
-00009c30: 6974 6820 7061 7271 7565 7420 6669 6c65  ith parquet file
-00009c40: 7320 7374 6f72 6564 2069 6e20 7468 6520  s stored in the 
-00009c50: 666f 6c6c 6f77 696e 6720 7374 7275 6374  following struct
-00009c60: 7572 653a 2060 6073 333a 2f2f 6d79 6275  ure: ``s3://mybu
-00009c70: 636b 6574 2f32 3032 322f 3035 2f30 342f  cket/2022/05/04/
-00009c80: 3c6d 756c 7469 706c 6520 7061 7271 7565  <multiple parque
-00009c90: 7420 6669 6c65 733e 6060 202c 2077 6865  t files>`` , whe
-00009ca0: 7265 2060 6032 3032 3260 6020 6973 2074  re ``2022`` is t
-00009cb0: 6865 2079 6561 722c 2060 6030 3560 6020  he year, ``05`` 
-00009cc0: 6973 2074 6865 206d 6f6e 7468 2c20 616e  is the month, an
-00009cd0: 6420 6060 3034 6060 2069 7320 7468 6520  d ``04`` is the 
-00009ce0: 6461 7920 6f66 2074 6865 206d 6f6e 7468  day of the month
-00009cf0: 2e20 496e 2074 6869 7320 7363 656e 6172  . In this scenar
-00009d00: 696f 2c20 796f 7520 636f 756c 6420 7573  io, you could us
-00009d10: 6520 7468 6520 666f 6c6c 6f77 696e 6720  e the following 
-00009d20: 6465 6669 6e69 7469 6f6e 3a0a 0a20 2020  definition:..   
-00009d30: 2020 2020 202e 2e20 636f 6465 2d62 6c6f       .. code-blo
-00009d40: 636b 3a3a 2070 7974 686f 6e0a 0a20 2020  ck:: python..   
-00009d50: 2020 2020 2020 2020 2064 6174 6574 696d           datetim
-00009d60: 655f 7061 7274 6974 696f 6e5f 636f 6c75  e_partition_colu
-00009d70: 6d6e 7320 3d20 5b0a 2020 2020 2020 2020  mns = [.        
-00009d80: 2020 2020 2020 2020 4461 7465 7469 6d65          Datetime
-00009d90: 5061 7274 6974 696f 6e43 6f6c 756d 6e28  PartitionColumn(
-00009da0: 636f 6c75 6d6e 5f6e 616d 653d 2270 6172  column_name="par
-00009db0: 7469 7469 6f6e 5f30 222c 2064 6174 6570  tition_0", datep
-00009dc0: 6172 743d 2279 6561 7222 2c20 7a65 726f  art="year", zero
-00009dd0: 5f70 6164 6465 643d 5472 7565 292c 0a20  _padded=True),. 
-00009de0: 2020 2020 2020 2020 2020 2020 2020 2044                 D
-00009df0: 6174 6574 696d 6550 6172 7469 7469 6f6e  atetimePartition
-00009e00: 436f 6c75 6d6e 2863 6f6c 756d 6e5f 6e61  Column(column_na
-00009e10: 6d65 3d22 7061 7274 6974 696f 6e5f 3122  me="partition_1"
-00009e20: 2c20 6461 7465 7061 7274 3d22 6d6f 6e74  , datepart="mont
-00009e30: 6822 2c20 7a65 726f 5f70 6164 6465 643d  h", zero_padded=
-00009e40: 5472 7565 292c 0a20 2020 2020 2020 2020  True),.         
-00009e50: 2020 2020 2020 2044 6174 6574 696d 6550         DatetimeP
-00009e60: 6172 7469 7469 6f6e 436f 6c75 6d6e 2863  artitionColumn(c
-00009e70: 6f6c 756d 6e5f 6e61 6d65 3d22 7061 7274  olumn_name="part
-00009e80: 6974 696f 6e5f 3222 2c20 6461 7465 7061  ition_2", datepa
-00009e90: 7274 3d22 6461 7922 2c20 7a65 726f 5f70  rt="day", zero_p
-00009ea0: 6164 6465 643d 5472 7565 292c 0a20 2020  added=True),.   
-00009eb0: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
-00009ec0: 2020 2020 2020 2062 6174 6368 5f63 6f6e         batch_con
-00009ed0: 6669 6720 3d20 4869 7665 436f 6e66 6967  fig = HiveConfig
-00009ee0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00009ef0: 2020 6461 7461 6261 7365 3d27 6d79 5f64    database='my_d
-00009f00: 6227 2c0a 2020 2020 2020 2020 2020 2020  b',.            
-00009f10: 2020 2020 7461 626c 653d 276d 795f 7461      table='my_ta
-00009f20: 626c 6527 2c0a 2020 2020 2020 2020 2020  ble',.          
-00009f30: 2020 2020 2020 7469 6d65 7374 616d 705f        timestamp_
-00009f40: 6669 656c 643d 2774 696d 6573 7461 6d70  field='timestamp
-00009f50: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-00009f60: 2020 2064 6174 6574 696d 655f 7061 7274     datetime_part
-00009f70: 6974 696f 6e5f 636f 6c75 6d6e 733d 6461  ition_columns=da
-00009f80: 7465 7469 6d65 5f70 6172 7469 7469 6f6e  tetime_partition
-00009f90: 5f63 6f6c 756d 6e73 2c0a 2020 2020 2020  _columns,.      
-00009fa0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00009fb0: 2045 7861 6d70 6c65 2075 7369 6e67 2074   Example using t
-00009fc0: 6865 2060 6066 6f72 6d61 745f 7374 7269  he ``format_stri
-00009fd0: 6e67 6060 2070 6172 616d 6574 6572 2e20  ng`` parameter. 
-00009fe0: 4173 7375 6d65 2079 6f75 7220 6461 7461  Assume your data
-00009ff0: 2069 7320 7061 7274 6974 696f 6e65 6420   is partitioned 
-0000a000: 6279 2060 6022 5959 5959 2d4d 4d22 6060  by ``"YYYY-MM"``
-0000a010: 2c20 652e 672e 2060 6073 333a 2f2f 6d79  , e.g. ``s3://my
-0000a020: 6275 636b 6574 2f32 3032 322d 3035 2f3c  bucket/2022-05/<
-0000a030: 6d75 6c74 6970 6c65 2070 6172 7175 6574  multiple parquet
-0000a040: 2066 696c 6573 3e60 602e 2054 6563 746f   files>``. Tecto
-0000a050: 6e27 7320 6465 6661 756c 7420 6d6f 6e74  n's default mont
-0000a060: 6820 666f 726d 6174 2069 7320 6060 2225  h format is ``"%
-0000a070: 6d22 6060 2c20 7768 6963 6820 776f 756c  m"``, which woul
-0000a080: 6420 6661 696c 2074 6f20 666f 726d 6174  d fail to format
-0000a090: 2064 6174 6574 696d 6520 7374 7269 6e67   datetime string
-0000a0a0: 7320 7468 6174 2061 7265 2063 6f6d 7061  s that are compa
-0000a0b0: 7261 626c 6520 746f 2079 6f75 7220 7461  rable to your ta
-0000a0c0: 626c 6527 7320 7061 7274 6974 696f 6e20  ble's partition 
-0000a0d0: 636f 6c75 6d6e 2c20 736f 2074 6865 2064  column, so the d
-0000a0e0: 6566 696e 6974 696f 6e20 6e65 6564 7320  efinition needs 
-0000a0f0: 746f 2073 7065 6369 6679 2061 6e20 6f76  to specify an ov
-0000a100: 6572 7269 6465 2e0a 0a20 2020 2020 2020  erride...       
-0000a110: 202e 2e20 636f 6465 2d62 6c6f 636b 3a3a   .. code-block::
-0000a120: 2070 7974 686f 6e0a 0a20 2020 2020 2020   python..       
-0000a130: 2020 2020 2064 6174 6574 696d 655f 7061       datetime_pa
-0000a140: 7274 6974 696f 6e5f 636f 6c75 6d6e 7320  rtition_columns 
-0000a150: 3d20 5b0a 2020 2020 2020 2020 2020 2020  = [.            
-0000a160: 2020 2020 4461 7465 7469 6d65 5061 7274      DatetimePart
-0000a170: 6974 696f 6e43 6f6c 756d 6e28 636f 6c75  itionColumn(colu
-0000a180: 6d6e 5f6e 616d 653d 2270 6172 7469 7469  mn_name="partiti
-0000a190: 6f6e 5f31 222c 2064 6174 6570 6172 743d  on_1", datepart=
-0000a1a0: 226d 6f6e 7468 222c 2066 6f72 6d61 745f  "month", format_
-0000a1b0: 7374 7269 6e67 3d22 2559 2d25 6d22 292c  string="%Y-%m"),
-0000a1c0: 0a20 2020 2020 2020 2020 2020 205d 0a20  .            ]. 
-0000a1d0: 2020 2022 2222 0a0a 2020 2020 233a 2054     """..    #: T
-0000a1e0: 6865 206e 616d 6520 6f66 2074 6865 2063  he name of the c
-0000a1f0: 6f6c 756d 6e20 696e 2074 6865 2047 6c75  olumn in the Glu
-0000a200: 652f 4869 7665 2073 6368 656d 6120 7468  e/Hive schema th
-0000a210: 6174 2063 6f72 7265 7370 6f6e 6473 2074  at corresponds t
-0000a220: 6f20 7468 6520 756e 6465 726c 7969 6e67  o the underlying
-0000a230: 2064 6174 652f 7469 6d65 2070 6172 7469   date/time parti
-0000a240: 7469 6f6e 2066 6f6c 6465 722e 0a20 2020  tion folder..   
-0000a250: 2063 6f6c 756d 6e5f 6e61 6d65 3a20 7374   column_name: st
-0000a260: 720a 0a20 2020 2023 3a20 5468 6520 7061  r..    #: The pa
-0000a270: 7274 206f 6620 7468 6520 6461 7465 2074  rt of the date t
-0000a280: 6861 7420 7468 6973 2063 6f6c 756d 6e20  hat this column 
-0000a290: 7370 6563 6966 6965 732e 2043 616e 2062  specifies. Can b
-0000a2a0: 6520 6f6e 6520 6f66 2022 7965 6172 222c  e one of "year",
-0000a2b0: 2022 6d6f 6e74 6822 2c20 2264 6179 222c   "month", "day",
-0000a2c0: 2022 686f 7572 222c 206f 7220 7468 6520   "hour", or the 
-0000a2d0: 6675 6c6c 2022 6461 7465 222e 0a20 2020  full "date"..   
-0000a2e0: 2064 6174 6570 6172 743a 2073 7472 0a0a   datepart: str..
-0000a2f0: 2020 2020 233a 2057 6865 7468 6572 2074      #: Whether t
-0000a300: 6865 2060 6064 6174 6570 6172 7460 6020  he ``datepart`` 
-0000a310: 6861 7320 6120 6c65 6164 696e 6720 7a65  has a leading ze
-0000a320: 726f 2069 6620 6c65 7373 2074 6861 6e20  ro if less than 
-0000a330: 7477 6f20 6469 6769 7473 2e0a 2020 2020  two digits..    
-0000a340: 7a65 726f 5f70 6164 6465 643a 2062 6f6f  zero_padded: boo
-0000a350: 6c20 3d20 4661 6c73 650a 0a20 2020 2023  l = False..    #
-0000a360: 3a20 4120 6060 6461 7465 7469 6d65 2e73  : A ``datetime.s
-0000a370: 7472 6674 696d 6560 6020 666f 726d 6174  trftime`` format
-0000a380: 2073 7472 696e 6720 6f76 6572 7269 6465   string override
-0000a390: 2066 6f72 2022 6e6f 6e2d 6465 6661 756c   for "non-defaul
-0000a3a0: 7422 2070 6172 7469 7469 6f6e 2063 6f6c  t" partition col
-0000a3b0: 756d 6e73 2066 6f72 6d61 7473 2e0a 2020  umns formats..  
-0000a3c0: 2020 666f 726d 6174 5f73 7472 696e 673a    format_string:
-0000a3d0: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
-0000a3e0: 204e 6f6e 650a 0a0a 636c 6173 7320 5265   None...class Re
-0000a3f0: 7175 6573 7453 6f75 7263 6528 5374 7269  questSource(Stri
-0000a400: 6374 4d6f 6465 6c29 3a0a 2020 2020 2222  ctModel):.    ""
-0000a410: 2244 6563 6c61 7265 2061 2060 6052 6571  "Declare a ``Req
-0000a420: 7565 7374 536f 7572 6365 6060 2c20 666f  uestSource``, fo
-0000a430: 7220 7573 696e 6720 7265 7175 6573 742d  r using request-
-0000a440: 7469 6d65 2064 6174 6120 696e 2061 6e20  time data in an 
-0000a450: 6060 4f6e 4465 6d61 6e64 4665 6174 7572  ``OnDemandFeatur
-0000a460: 6556 6965 7760 602e 0a0a 2020 2020 4578  eView``...    Ex
-0000a470: 616d 706c 6520 6f66 2061 2052 6571 7565  ample of a Reque
-0000a480: 7374 536f 7572 6365 2064 6563 6c61 7261  stSource declara
-0000a490: 7469 6f6e 3a0a 0a20 2020 202e 2e20 636f  tion:..    .. co
-0000a4a0: 6465 2d62 6c6f 636b 3a3a 2070 7974 686f  de-block:: pytho
-0000a4b0: 6e0a 0a20 2020 2020 2020 2066 726f 6d20  n..        from 
-0000a4c0: 7465 6374 6f6e 2069 6d70 6f72 7420 5265  tecton import Re
-0000a4d0: 7175 6573 7453 6f75 7263 650a 2020 2020  questSource.    
-0000a4e0: 2020 2020 6672 6f6d 2074 6563 746f 6e2e      from tecton.
-0000a4f0: 7479 7065 7320 696d 706f 7274 2046 6965  types import Fie
-0000a500: 6c64 2c20 466c 6f61 7436 340a 0a20 2020  ld, Float64..   
-0000a510: 2020 2020 2073 6368 656d 6120 3d20 5b46       schema = [F
-0000a520: 6965 6c64 2827 616d 6f75 6e74 272c 2046  ield('amount', F
-0000a530: 6c6f 6174 3634 295d 0a20 2020 2020 2020  loat64)].       
-0000a540: 2074 7261 6e73 6163 7469 6f6e 5f72 6571   transaction_req
-0000a550: 7565 7374 203d 2052 6571 7565 7374 536f  uest = RequestSo
-0000a560: 7572 6365 2873 6368 656d 613d 7363 6865  urce(schema=sche
-0000a570: 6d61 290a 0a0a 2020 2020 4174 7472 6962  ma)...    Attrib
-0000a580: 7574 6573 3a0a 2020 2020 2020 2020 7363  utes:.        sc
-0000a590: 6865 6d61 3a20 5468 6520 7363 6865 6d61  hema: The schema
-0000a5a0: 206f 6620 7468 6973 2052 6571 7565 7374   of this Request
-0000a5b0: 2053 6f75 7263 652e 0a20 2020 2022 2222   Source..    """
-0000a5c0: 0a0a 2020 2020 2320 5573 6520 7363 6865  ..    # Use sche
-0000a5d0: 6d61 5f20 7769 7468 2061 6e20 616c 6961  ma_ with an alia
-0000a5e0: 7320 746f 2061 766f 6964 2063 6f6e 666c  s to avoid confl
-0000a5f0: 6963 7469 6e67 2077 6974 6820 6120 5079  icting with a Py
-0000a600: 6461 6e74 6963 2042 6173 654d 6f64 656c  dantic BaseModel
-0000a610: 206d 6574 686f 6420 7363 6865 6d61 2829   method schema()
-0000a620: 2e20 5368 6164 6f77 2074 6861 7420 6d65  . Shadow that me
-0000a630: 7468 6f64 2077 6974 680a 2020 2020 2320  thod with.    # 
-0000a640: 6120 7363 6865 6d61 2070 726f 7065 7274  a schema propert
-0000a650: 7920 736f 2074 6861 7420 6361 6c6c 6572  y so that caller
-0000a660: 7320 6361 6e20 6163 6365 7373 2074 6865  s can access the
-0000a670: 2066 6965 6c64 2069 6e74 7569 7469 7665   field intuitive
-0000a680: 6c79 2e0a 2020 2020 7363 6865 6d61 5f3a  ly..    schema_:
-0000a690: 2054 7570 6c65 5b46 6965 6c64 2c20 2e2e   Tuple[Field, ..
-0000a6a0: 2e5d 203d 2070 7964 616e 7469 635f 7631  .] = pydantic_v1
-0000a6b0: 2e46 6965 6c64 2861 6c69 6173 3d22 7363  .Field(alias="sc
-0000a6c0: 6865 6d61 2229 0a0a 2020 2020 6465 6620  hema")..    def 
-0000a6d0: 5f5f 696e 6974 5f5f 2873 656c 662c 2073  __init__(self, s
-0000a6e0: 6368 656d 613a 2053 6571 7565 6e63 655b  chema: Sequence[
-0000a6f0: 4669 656c 645d 293a 0a20 2020 2020 2020  Field]):.       
-0000a700: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
-0000a710: 5f28 7363 6865 6d61 3d74 7570 6c65 2873  _(schema=tuple(s
-0000a720: 6368 656d 6129 290a 0a20 2020 2040 7072  chema))..    @pr
-0000a730: 6f70 6572 7479 0a20 2020 2064 6566 2073  operty.    def s
-0000a740: 6368 656d 6128 7365 6c66 2920 2d3e 2054  chema(self) -> T
-0000a750: 7570 6c65 5b46 6965 6c64 2c20 2e2e 2e5d  uple[Field, ...]
-0000a760: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0000a770: 2073 656c 662e 7363 6865 6d61 5f0a 0a0a   self.schema_...
-0000a780: 2320 544f 444f 286a 616b 6529 3a20 5368  # TODO(jake): Sh
-0000a790: 6f75 6c64 2069 6e68 6572 6974 2066 726f  ould inherit fro
-0000a7a0: 6d20 5374 7269 6374 4d6f 6465 6c2e 0a63  m StrictModel..c
-0000a7b0: 6c61 7373 2042 6173 6553 7472 6561 6d43  lass BaseStreamC
-0000a7c0: 6f6e 6669 673a 0a20 2020 2064 6566 205f  onfig:.    def _
-0000a7d0: 6d65 7267 655f 7374 7265 616d 5f61 7267  merge_stream_arg
-0000a7e0: 7328 7365 6c66 2c20 6461 7461 5f73 6f75  s(self, data_sou
-0000a7f0: 7263 655f 6172 6773 3a20 7669 7274 7561  rce_args: virtua
-0000a800: 6c5f 6461 7461 5f73 6f75 7263 655f 7062  l_data_source_pb
-0000a810: 322e 5669 7274 7561 6c44 6174 6153 6f75  2.VirtualDataSou
-0000a820: 7263 6541 7267 7329 3a0a 2020 2020 2020  rceArgs):.      
-0000a830: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
-0000a840: 6d65 6e74 6564 4572 726f 720a 0a0a 2320  mentedError...# 
-0000a850: 544f 444f 286a 616b 6529 3a20 5368 6f75  TODO(jake): Shou
-0000a860: 6c64 2069 6e68 6572 6974 2066 726f 6d20  ld inherit from 
-0000a870: 5374 7269 6374 4d6f 6465 6c2e 0a63 6c61  StrictModel..cla
-0000a880: 7373 2042 6173 6542 6174 6368 436f 6e66  ss BaseBatchConf
-0000a890: 6967 3a0a 2020 2020 4070 726f 7065 7274  ig:.    @propert
-0000a8a0: 790a 2020 2020 6465 6620 6461 7461 5f64  y.    def data_d
-0000a8b0: 656c 6179 2873 656c 6629 202d 3e20 6461  elay(self) -> da
-0000a8c0: 7465 7469 6d65 2e74 696d 6564 656c 7461  tetime.timedelta
-0000a8d0: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
-0000a8e0: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-0000a8f0: 726f 720a 0a20 2020 2064 6566 205f 6d65  ror..    def _me
-0000a900: 7267 655f 6261 7463 685f 6172 6773 2873  rge_batch_args(s
-0000a910: 656c 662c 2064 6174 615f 736f 7572 6365  elf, data_source
-0000a920: 5f61 7267 733a 2076 6972 7475 616c 5f64  _args: virtual_d
-0000a930: 6174 615f 736f 7572 6365 5f70 6232 2e56  ata_source_pb2.V
-0000a940: 6972 7475 616c 4461 7461 536f 7572 6365  irtualDataSource
-0000a950: 4172 6773 293a 0a20 2020 2020 2020 2072  Args):.        r
-0000a960: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-0000a970: 7465 6445 7272 6f72 0a0a 0a63 6c61 7373  tedError...class
-0000a980: 2046 696c 6543 6f6e 6669 6728 4261 7365   FileConfig(Base
-0000a990: 4261 7463 6843 6f6e 6669 6729 3a0a 2020  BatchConfig):.  
-0000a9a0: 2020 2222 220a 2020 2020 436f 6e66 6967    """.    Config
-0000a9b0: 7572 6174 696f 6e20 7573 6564 2074 6f20  uration used to 
-0000a9c0: 7265 6665 7265 6e63 6520 6120 6669 6c65  reference a file
-0000a9d0: 206f 7220 6469 7265 6374 6f72 7920 2853   or directory (S
-0000a9e0: 332c 2065 7463 2e29 0a0a 2020 2020 5468  3, etc.)..    Th
-0000a9f0: 6520 4669 6c65 436f 6e66 6967 2063 6c61  e FileConfig cla
-0000aa00: 7373 2069 7320 7573 6564 2074 6f20 6372  ss is used to cr
-0000aa10: 6561 7465 2061 2072 6566 6572 656e 6365  eate a reference
-0000aa20: 2074 6f20 6120 6669 6c65 206f 7220 6469   to a file or di
-0000aa30: 7265 6374 6f72 7920 6f66 2066 696c 6573  rectory of files
-0000aa40: 2069 6e20 5333 2c0a 2020 2020 4844 4653   in S3,.    HDFS
-0000aa50: 2c20 6f72 2044 4246 532e 0a0a 2020 2020  , or DBFS...    
-0000aa60: 5468 6520 7363 6865 6d61 206f 6620 7468  The schema of th
-0000aa70: 6520 6461 7461 2073 6f75 7263 6520 6973  e data source is
-0000aa80: 2069 6e66 6572 7265 6420 6672 6f6d 2074   inferred from t
-0000aa90: 6865 2075 6e64 6572 6c79 696e 6720 6669  he underlying fi
-0000aaa0: 6c65 2873 292e 2049 7420 6361 6e20 616c  le(s). It can al
-0000aab0: 736f 2062 6520 6d6f 6469 6669 6564 2075  so be modified u
-0000aac0: 7369 6e67 2074 6865 0a20 2020 2060 6070  sing the.    ``p
-0000aad0: 6f73 745f 7072 6f63 6573 736f 7260 6020  ost_processor`` 
-0000aae0: 7061 7261 6d65 7465 722e 0a0a 2020 2020  parameter...    
-0000aaf0: 5468 6973 2063 6c61 7373 2069 7320 7573  This class is us
-0000ab00: 6564 2061 7320 616e 2069 6e70 7574 2074  ed as an input t
-0000ab10: 6f20 6120 3a63 6c61 7373 3a60 4261 7463  o a :class:`Batc
-0000ab20: 6853 6f75 7263 6560 2773 2070 6172 616d  hSource`'s param
-0000ab30: 6574 6572 2060 6062 6174 6368 5f63 6f6e  eter ``batch_con
-0000ab40: 6669 6760 602e 2044 6563 6c61 7269 6e67  fig``. Declaring
-0000ab50: 2074 6869 7320 636f 6e66 6967 7572 6174   this configurat
-0000ab60: 696f 6e20 636c 6173 7320 616c 6f6e 650a  ion class alone.
-0000ab70: 2020 2020 7769 6c6c 206e 6f74 2072 6567      will not reg
-0000ab80: 6973 7465 7220 6120 4461 7461 2053 6f75  ister a Data Sou
-0000ab90: 7263 652e 2049 6e73 7465 6164 2c20 6465  rce. Instead, de
-0000aba0: 636c 6172 6520 6173 2061 2070 6172 7420  clare as a part 
-0000abb0: 6f66 2060 6042 6174 6368 536f 7572 6365  of ``BatchSource
-0000abc0: 6060 2074 6861 7420 7461 6b65 7320 7468  `` that takes th
-0000abd0: 6973 2063 6f6e 6669 6775 7261 7469 6f6e  is configuration
-0000abe0: 2063 6c61 7373 0a20 2020 2069 6e73 7461   class.    insta
-0000abf0: 6e63 6520 6173 2061 2070 6172 616d 6574  nce as a paramet
-0000ac00: 6572 2e0a 2020 2020 2222 220a 0a20 2020  er..    """..   
-0000ac10: 2064 6566 205f 5f69 6e69 745f 5f28 0a20   def __init__(. 
-0000ac20: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-0000ac30: 2020 2020 2075 7269 3a20 7374 722c 0a20       uri: str,. 
-0000ac40: 2020 2020 2020 2066 696c 655f 666f 726d         file_form
-0000ac50: 6174 3a20 7374 722c 0a20 2020 2020 2020  at: str,.       
-0000ac60: 2074 696d 6573 7461 6d70 5f66 6965 6c64   timestamp_field
-0000ac70: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-0000ac80: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0000ac90: 7469 6d65 7374 616d 705f 666f 726d 6174  timestamp_format
-0000aca0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-0000acb0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0000acc0: 706f 7374 5f70 726f 6365 7373 6f72 3a20  post_processor: 
-0000acd0: 4f70 7469 6f6e 616c 5b43 616c 6c61 626c  Optional[Callabl
-0000ace0: 655d 203d 204e 6f6e 652c 0a20 2020 2020  e] = None,.     
-0000acf0: 2020 2073 6368 656d 615f 7572 693a 204f     schema_uri: O
-0000ad00: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
-0000ad10: 6f6e 652c 0a20 2020 2020 2020 2073 6368  one,.        sch
-0000ad20: 656d 615f 6f76 6572 7269 6465 3a20 4f70  ema_override: Op
-0000ad30: 7469 6f6e 616c 5b53 7472 7563 7454 7970  tional[StructTyp
-0000ad40: 655d 203d 204e 6f6e 652c 0a20 2020 2020  e] = None,.     
-0000ad50: 2020 2064 6174 615f 6465 6c61 793a 2064     data_delay: d
-0000ad60: 6174 6574 696d 652e 7469 6d65 6465 6c74  atetime.timedelt
-0000ad70: 6120 3d20 6461 7465 7469 6d65 2e74 696d  a = datetime.tim
-0000ad80: 6564 656c 7461 2873 6563 6f6e 6473 3d30  edelta(seconds=0
-0000ad90: 292c 0a20 2020 2029 3a0a 2020 2020 2020  ),.    ):.      
-0000ada0: 2020 2222 220a 2020 2020 2020 2020 496e    """.        In
-0000adb0: 7374 616e 7469 6174 6573 2061 206e 6577  stantiates a new
-0000adc0: 2046 696c 6543 6f6e 6669 672e 0a0a 2020   FileConfig...  
-0000add0: 2020 2020 2020 3a70 6172 616d 2075 7269        :param uri
-0000ade0: 3a20 5333 206f 7220 4844 4653 2070 6174  : S3 or HDFS pat
-0000adf0: 6820 746f 2066 696c 6528 7329 2e0a 2020  h to file(s)..  
-0000ae00: 2020 2020 2020 3a70 6172 616d 2066 696c        :param fil
-0000ae10: 655f 666f 726d 6174 3a20 4669 6c65 2066  e_format: File f
-0000ae20: 6f72 6d61 742e 2022 6a73 6f6e 222c 2022  ormat. "json", "
-0000ae30: 7061 7271 7565 7422 2c20 6f72 2022 6373  parquet", or "cs
-0000ae40: 7622 0a20 2020 2020 2020 203a 7061 7261  v".        :para
-0000ae50: 6d20 7469 6d65 7374 616d 705f 6669 656c  m timestamp_fiel
-0000ae60: 643a 2054 6865 2074 696d 6573 7461 6d70  d: The timestamp
-0000ae70: 2063 6f6c 756d 6e20 696e 2074 6869 7320   column in this 
-0000ae80: 6461 7461 2073 6f75 7263 6520 7468 6174  data source that
-0000ae90: 2073 686f 756c 6420 6265 2075 7365 6420   should be used 
-0000aea0: 6279 2060 4669 6c74 6572 6564 536f 7572  by `FilteredSour
-0000aeb0: 6365 600a 2020 2020 2020 2020 2020 2020  ce`.            
-0000aec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aed0: 2020 2020 746f 2066 696c 7465 7220 6461      to filter da
-0000aee0: 7461 2066 726f 6d20 7468 6973 2073 6f75  ta from this sou
-0000aef0: 7263 652c 2062 6566 6f72 6520 616e 7920  rce, before any 
-0000af00: 6665 6174 7572 6520 7669 6577 2074 7261  feature view tra
-0000af10: 6e73 666f 726d 6174 696f 6e73 2061 7265  nsformations are
-0000af20: 2061 7070 6c69 6564 2e0a 2020 2020 2020   applied..      
-0000af30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000af40: 2020 2020 2020 2020 2020 4f6e 6c79 2072            Only r
-0000af50: 6571 7569 7265 6420 6966 2074 6869 7320  equired if this 
-0000af60: 736f 7572 6365 2069 7320 7573 6564 2077  source is used w
-0000af70: 6974 6820 6046 696c 7465 7265 6453 6f75  ith `FilteredSou
-0000af80: 7263 6560 2e0a 2020 2020 2020 2020 3a70  rce`..        :p
-0000af90: 6172 616d 2074 696d 6573 7461 6d70 5f66  aram timestamp_f
-0000afa0: 6f72 6d61 743a 2046 6f72 6d61 7420 6f66  ormat: Format of
-0000afb0: 2073 7472 696e 672d 656e 636f 6465 6420   string-encoded 
-0000afc0: 7469 6d65 7374 616d 7020 636f 6c75 6d6e  timestamp column
-0000afd0: 2028 652e 672e 2022 7979 7979 2d4d 4d2d   (e.g. "yyyy-MM-
-0000afe0: 6464 2754 2768 683a 6d6d 3a73 732e 5353  dd'T'hh:mm:ss.SS
-0000aff0: 5327 5a27 2229 2e0a 2020 2020 2020 2020  S'Z'")..        
-0000b000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b010: 2020 2020 2020 2020 2049 6620 7468 6520           If the 
-0000b020: 7469 6d65 7374 616d 7020 7374 7269 6e67  timestamp string
-0000b030: 2063 616e 6e6f 7420 6265 2070 6172 7365   cannot be parse
-0000b040: 6420 7769 7468 2074 6869 7320 666f 726d  d with this form
-0000b050: 6174 2c20 5465 6374 6f6e 2077 696c 6c20  at, Tecton will 
-0000b060: 6661 6c6c 6261 636b 2061 6e64 2061 7474  fallback and att
-0000b070: 656d 7074 2074 6f0a 2020 2020 2020 2020  empt to.        
-0000b080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b090: 2020 2020 2020 2020 2075 7365 2074 6865           use the
-0000b0a0: 2064 6566 6175 6c74 2074 696d 6573 7461   default timesta
-0000b0b0: 6d70 2070 6172 7365 722e 0a20 2020 2020  mp parser..     
-0000b0c0: 2020 203a 7061 7261 6d20 706f 7374 5f70     :param post_p
-0000b0d0: 726f 6365 7373 6f72 3a20 5079 7468 6f6e  rocessor: Python
-0000b0e0: 2075 7365 7220 6465 6669 6e65 6420 6675   user defined fu
-0000b0f0: 6e63 7469 6f6e 2060 6066 2844 6174 6146  nction ``f(DataF
-0000b100: 7261 6d65 2920 2d3e 2044 6174 6146 7261  rame) -> DataFra
-0000b110: 6d65 6060 2074 6861 7420 7461 6b65 7320  me`` that takes 
-0000b120: 696e 2072 6177 0a20 2020 2020 2020 2020  in raw.         
+00000b40: 6361 6c61 322e 3132 220a 2020 2020 4462  cala2.12".    Db
+00000b50: 7231 345f 3320 3d20 2231 342e 332e 782d  r14_3 = "14.3.x-
+00000b60: 7363 616c 6132 2e31 3222 0a0a 0a44 4546  scala2.12"...DEF
+00000b70: 4155 4c54 5f53 5041 524b 5f56 4552 5349  AULT_SPARK_VERSI
+00000b80: 4f4e 5320 3d20 7b0a 2020 2020 2264 6174  ONS = {.    "dat
+00000b90: 6162 7269 636b 735f 7370 6172 6b5f 7665  abricks_spark_ve
+00000ba0: 7273 696f 6e22 3a20 5370 6172 6b56 6572  rsion": SparkVer
+00000bb0: 7369 6f6e 732e 4462 7231 315f 332c 0a20  sions.Dbr11_3,. 
+00000bc0: 2020 2022 656d 725f 7370 6172 6b5f 7665     "emr_spark_ve
+00000bd0: 7273 696f 6e22 3a20 5370 6172 6b56 6572  rsion": SparkVer
+00000be0: 7369 6f6e 732e 456d 7236 5f39 5f31 2c0a  sions.Emr6_9_1,.
+00000bf0: 7d0a 454d 525f 5355 5050 4f52 5445 445f  }.EMR_SUPPORTED_
+00000c00: 5350 4152 4b20 3d20 7b0a 2020 2020 5370  SPARK = {.    Sp
+00000c10: 6172 6b56 6572 7369 6f6e 732e 456d 7236  arkVersions.Emr6
+00000c20: 5f35 2c0a 2020 2020 5370 6172 6b56 6572  _5,.    SparkVer
+00000c30: 7369 6f6e 732e 456d 7236 5f37 2c0a 2020  sions.Emr6_7,.  
+00000c40: 2020 5370 6172 6b56 6572 7369 6f6e 732e    SparkVersions.
+00000c50: 456d 7236 5f39 2c0a 2020 2020 5370 6172  Emr6_9,.    Spar
+00000c60: 6b56 6572 7369 6f6e 732e 456d 7236 5f39  kVersions.Emr6_9
+00000c70: 5f31 2c0a 2020 2020 5370 6172 6b56 6572  _1,.    SparkVer
+00000c80: 7369 6f6e 732e 456d 7236 5f31 322c 0a20  sions.Emr6_12,. 
+00000c90: 2020 2053 7061 726b 5665 7273 696f 6e73     SparkVersions
+00000ca0: 2e45 6d72 375f 302c 0a7d 0a44 4154 4142  .Emr7_0,.}.DATAB
+00000cb0: 5249 434b 535f 5355 5050 4f52 5445 445f  RICKS_SUPPORTED_
+00000cc0: 5350 4152 4b20 3d20 7b0a 2020 2020 5370  SPARK = {.    Sp
+00000cd0: 6172 6b56 6572 7369 6f6e 732e 4462 7239  arkVersions.Dbr9
+00000ce0: 5f31 2c0a 2020 2020 5370 6172 6b56 6572  _1,.    SparkVer
+00000cf0: 7369 6f6e 732e 4462 7231 305f 342c 0a20  sions.Dbr10_4,. 
+00000d00: 2020 2053 7061 726b 5665 7273 696f 6e73     SparkVersions
+00000d10: 2e44 6272 3131 5f33 2c0a 2020 2020 5370  .Dbr11_3,.    Sp
+00000d20: 6172 6b56 6572 7369 6f6e 732e 4462 7231  arkVersions.Dbr1
+00000d30: 325f 322c 0a20 2020 2053 7061 726b 5665  2_2,.    SparkVe
+00000d40: 7273 696f 6e73 2e44 6272 3133 5f33 2c0a  rsions.Dbr13_3,.
+00000d50: 2020 2020 5370 6172 6b56 6572 7369 6f6e      SparkVersion
+00000d60: 732e 4462 7231 345f 332c 0a7d 0a0a 5445  s.Dbr14_3,.}..TE
+00000d70: 4354 4f4e 5f43 4f4d 5055 5445 5f44 4546  CTON_COMPUTE_DEF
+00000d80: 4155 4c54 5320 3d20 7b22 7465 6374 6f6e  AULTS = {"tecton
+00000d90: 5f63 6f6d 7075 7465 5f69 6e73 7461 6e63  _compute_instanc
+00000da0: 655f 7479 7065 223a 2022 6d36 612e 3278  e_type": "m6a.2x
+00000db0: 6c61 7267 6522 7d0a 0a0a 2320 4b65 6570  large"}...# Keep
+00000dc0: 2075 702d 746f 2d64 6174 6520 7769 7468   up-to-date with
+00000dd0: 2055 6e69 7479 4361 7461 6c6f 6741 6363   UnityCatalogAcc
+00000de0: 6573 734d 6f64 6520 6672 6f6d 2074 6563  essMode from tec
+00000df0: 746f 6e5f 7072 6f74 6f2f 6172 6773 2f64  ton_proto/args/d
+00000e00: 6174 615f 736f 7572 6365 2e70 726f 746f  ata_source.proto
+00000e10: 0a63 6c61 7373 2055 6e69 7479 4361 7461  .class UnityCata
+00000e20: 6c6f 6741 6363 6573 734d 6f64 6528 456e  logAccessMode(En
+00000e30: 756d 293a 0a20 2020 2053 494e 474c 455f  um):.    SINGLE_
+00000e40: 5553 4552 203d 2064 6174 615f 736f 7572  USER = data_sour
+00000e50: 6365 5f70 6232 2e55 6e69 7479 4361 7461  ce_pb2.UnityCata
+00000e60: 6c6f 6741 6363 6573 734d 6f64 652e 554e  logAccessMode.UN
+00000e70: 4954 595f 4341 5441 4c4f 475f 4143 4345  ITY_CATALOG_ACCE
+00000e80: 5353 5f4d 4f44 455f 5349 4e47 4c45 5f55  SS_MODE_SINGLE_U
+00000e90: 5345 520a 2020 2020 5349 4e47 4c45 5f55  SER.    SINGLE_U
+00000ea0: 5345 525f 5749 5448 5f46 4741 4320 3d20  SER_WITH_FGAC = 
+00000eb0: 6461 7461 5f73 6f75 7263 655f 7062 322e  data_source_pb2.
+00000ec0: 556e 6974 7943 6174 616c 6f67 4163 6365  UnityCatalogAcce
+00000ed0: 7373 4d6f 6465 2e55 4e49 5459 5f43 4154  ssMode.UNITY_CAT
+00000ee0: 414c 4f47 5f41 4343 4553 535f 4d4f 4445  ALOG_ACCESS_MODE
+00000ef0: 5f53 494e 474c 455f 5553 4552 5f57 4954  _SINGLE_USER_WIT
+00000f00: 485f 4647 4143 0a20 2020 2053 4841 5245  H_FGAC.    SHARE
+00000f10: 4420 3d20 6461 7461 5f73 6f75 7263 655f  D = data_source_
+00000f20: 7062 322e 556e 6974 7943 6174 616c 6f67  pb2.UnityCatalog
+00000f30: 4163 6365 7373 4d6f 6465 2e55 4e49 5459  AccessMode.UNITY
+00000f40: 5f43 4154 414c 4f47 5f41 4343 4553 535f  _CATALOG_ACCESS_
+00000f50: 4d4f 4445 5f53 4841 5245 440a 0a0a 6465  MODE_SHARED...de
+00000f60: 6620 5f73 7472 696e 675f 746f 5f74 696d  f _string_to_tim
+00000f70: 6564 656c 7461 2876 616c 7565 3a20 416e  edelta(value: An
+00000f80: 7929 202d 3e20 416e 793a 0a20 2020 2069  y) -> Any:.    i
+00000f90: 6620 6973 696e 7374 616e 6365 2876 616c  f isinstance(val
+00000fa0: 7565 2c20 7374 7229 3a0a 2020 2020 2020  ue, str):.      
+00000fb0: 2020 7265 7475 726e 2074 696d 655f 7574    return time_ut
+00000fc0: 696c 732e 7061 7273 655f 746f 5f74 696d  ils.parse_to_tim
+00000fd0: 6564 656c 7461 2876 616c 7565 290a 2020  edelta(value).  
+00000fe0: 2020 7265 7475 726e 2076 616c 7565 0a0a    return value..
+00000ff0: 0a64 6566 205f 6461 7465 5f74 6f5f 6461  .def _date_to_da
+00001000: 7465 7469 6d65 2876 616c 7565 3a20 416e  tetime(value: An
+00001010: 7929 202d 3e20 416e 793a 0a20 2020 2069  y) -> Any:.    i
+00001020: 6620 6973 696e 7374 616e 6365 2876 616c  f isinstance(val
+00001030: 7565 2c20 6461 7465 7469 6d65 2e64 6174  ue, datetime.dat
+00001040: 6529 3a0a 2020 2020 2020 2020 7265 7475  e):.        retu
+00001050: 726e 2064 6174 6574 696d 652e 6461 7465  rn datetime.date
+00001060: 7469 6d65 2879 6561 723d 7661 6c75 652e  time(year=value.
+00001070: 7965 6172 2c20 6d6f 6e74 683d 7661 6c75  year, month=valu
+00001080: 652e 6d6f 6e74 682c 2064 6179 3d76 616c  e.month, day=val
+00001090: 7565 2e64 6179 290a 2020 2020 7265 7475  ue.day).    retu
+000010a0: 726e 2076 616c 7565 0a0a 0a64 6566 205f  rn value...def _
+000010b0: 7374 725f 746f 5f6a 736f 6e5f 7374 7275  str_to_json_stru
+000010c0: 6374 2876 616c 7565 3a20 416e 7929 202d  ct(value: Any) -
+000010d0: 3e20 416e 793a 0a20 2020 2069 6620 6973  > Any:.    if is
+000010e0: 696e 7374 616e 6365 2876 616c 7565 2c20  instance(value, 
+000010f0: 7374 7229 3a0a 2020 2020 2020 2020 7265  str):.        re
+00001100: 7475 726e 206a 736f 6e2e 6c6f 6164 7328  turn json.loads(
+00001110: 7661 6c75 6529 0a20 2020 2072 6574 7572  value).    retur
+00001120: 6e20 7661 6c75 650a 0a0a 636c 6173 7320  n value...class 
+00001130: 5f44 6566 6175 6c74 436c 7573 7465 7243  _DefaultClusterC
+00001140: 6f6e 6669 6728 5374 7269 6374 4d6f 6465  onfig(StrictMode
+00001150: 6c29 3a0a 2020 2020 2222 2241 2064 6566  l):.    """A def
+00001160: 6175 6c74 2063 6c75 7374 6572 2063 6f6e  ault cluster con
+00001170: 6669 6775 7261 7469 6f6e 2e20 5368 6f75  figuration. Shou
+00001180: 6c64 206e 6f74 2062 6520 6578 706c 6963  ld not be explic
+00001190: 6974 6c79 2073 6574 2062 7920 7573 6572  itly set by user
+000011a0: 732e 0a0a 2020 2020 5573 6564 2074 6f20  s...    Used to 
+000011b0: 636f 7570 6c65 2063 6861 6e67 6573 2074  couple changes t
+000011c0: 6f20 6465 6661 756c 7420 636f 6d70 7574  o default comput
+000011d0: 6520 7365 7474 696e 6773 2074 6f20 5344  e settings to SD
+000011e0: 4b20 7265 6c65 6173 6573 2e0a 2020 2020  K releases..    
+000011f0: 2222 220a 0a20 2020 2023 2055 7365 6420  """..    # Used 
+00001200: 666f 7220 5941 4d4c 2070 6172 7369 6e67  for YAML parsing
+00001210: 2061 7320 6120 5079 6461 6e74 6963 2064   as a Pydantic d
+00001220: 6973 6372 696d 696e 6174 6f72 2e0a 2020  iscriminator..  
+00001230: 2020 6b69 6e64 3a20 4c69 7465 7261 6c5b    kind: Literal[
+00001240: 225f 4465 6661 756c 7443 6c75 7374 6572  "_DefaultCluster
+00001250: 436f 6e66 6967 225d 203d 2022 5f44 6566  Config"] = "_Def
+00001260: 6175 6c74 436c 7573 7465 7243 6f6e 6669  aultClusterConfi
+00001270: 6722 0a0a 2020 2020 6465 6620 5f74 6f5f  g"..    def _to_
+00001280: 636c 7573 7465 725f 7072 6f74 6f28 7365  cluster_proto(se
+00001290: 6c66 2920 2d3e 2066 6561 7475 7265 5f76  lf) -> feature_v
+000012a0: 6965 775f 7062 322e 436c 7573 7465 7243  iew_pb2.ClusterC
+000012b0: 6f6e 6669 673a 0a20 2020 2020 2020 2072  onfig:.        r
+000012c0: 6574 7572 6e20 6665 6174 7572 655f 7669  eturn feature_vi
+000012d0: 6577 5f70 6232 2e43 6c75 7374 6572 436f  ew_pb2.ClusterCo
+000012e0: 6e66 6967 280a 2020 2020 2020 2020 2020  nfig(.          
+000012f0: 2020 696d 706c 6963 6974 5f63 6f6e 6669    implicit_confi
+00001300: 673d 6665 6174 7572 655f 7669 6577 5f70  g=feature_view_p
+00001310: 6232 2e44 6566 6175 6c74 436c 7573 7465  b2.DefaultCluste
+00001320: 7243 6f6e 6669 6728 0a20 2020 2020 2020  rConfig(.       
+00001330: 2020 2020 2020 2020 202a 2a7b 0a20 2020           **{.   
+00001340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001350: 202a 2a44 4546 4155 4c54 5f53 5041 524b   **DEFAULT_SPARK
+00001360: 5f56 4552 5349 4f4e 532c 0a20 2020 2020  _VERSIONS,.     
+00001370: 2020 2020 2020 2020 2020 2020 2020 202a                 *
+00001380: 2a54 4543 544f 4e5f 434f 4d50 5554 455f  *TECTON_COMPUTE_
+00001390: 4445 4641 554c 5453 2c0a 2020 2020 2020  DEFAULTS,.      
+000013a0: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+000013b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000013c0: 2020 290a 0a0a 636c 6173 7320 4578 6973    )...class Exis
+000013d0: 7469 6e67 436c 7573 7465 7243 6f6e 6669  tingClusterConfi
+000013e0: 6728 5374 7269 6374 4d6f 6465 6c29 3a0a  g(StrictModel):.
+000013f0: 2020 2020 2222 2255 7365 2061 6e20 6578      """Use an ex
+00001400: 6973 7469 6e67 2044 6174 6162 7269 636b  isting Databrick
+00001410: 7320 636c 7573 7465 722e 0a0a 2020 2020  s cluster...    
+00001420: 3a70 6172 616d 2065 7869 7374 696e 675f  :param existing_
+00001430: 636c 7573 7465 725f 6964 3a20 4944 206f  cluster_id: ID o
+00001440: 6620 7468 6520 6578 6973 7469 6e67 2063  f the existing c
+00001450: 6c75 7374 6572 2e0a 2020 2020 2222 220a  luster..    """.
+00001460: 0a20 2020 2023 2055 7365 6420 666f 7220  .    # Used for 
+00001470: 5941 4d4c 2070 6172 7369 6e67 2061 7320  YAML parsing as 
+00001480: 6120 5079 6461 6e74 6963 2064 6973 6372  a Pydantic discr
+00001490: 696d 696e 6174 6f72 2e0a 2020 2020 6b69  iminator..    ki
+000014a0: 6e64 3a20 4c69 7465 7261 6c5b 2245 7869  nd: Literal["Exi
+000014b0: 7374 696e 6743 6c75 7374 6572 436f 6e66  stingClusterConf
+000014c0: 6967 225d 203d 2022 4578 6973 7469 6e67  ig"] = "Existing
+000014d0: 436c 7573 7465 7243 6f6e 6669 6722 0a20  ClusterConfig". 
+000014e0: 2020 2065 7869 7374 696e 675f 636c 7573     existing_clus
+000014f0: 7465 725f 6964 3a20 7374 720a 0a20 2020  ter_id: str..   
+00001500: 2064 6566 205f 746f 5f70 726f 746f 2873   def _to_proto(s
+00001510: 656c 6629 202d 3e20 6665 6174 7572 655f  elf) -> feature_
+00001520: 7669 6577 5f70 6232 2e45 7869 7374 696e  view_pb2.Existin
+00001530: 6743 6c75 7374 6572 436f 6e66 6967 3a0a  gClusterConfig:.
+00001540: 2020 2020 2020 2020 7072 6f74 6f20 3d20          proto = 
+00001550: 6665 6174 7572 655f 7669 6577 5f70 6232  feature_view_pb2
+00001560: 2e45 7869 7374 696e 6743 6c75 7374 6572  .ExistingCluster
+00001570: 436f 6e66 6967 2829 0a20 2020 2020 2020  Config().       
+00001580: 2070 726f 746f 2e65 7869 7374 696e 675f   proto.existing_
+00001590: 636c 7573 7465 725f 6964 203d 2073 656c  cluster_id = sel
+000015a0: 662e 6578 6973 7469 6e67 5f63 6c75 7374  f.existing_clust
+000015b0: 6572 5f69 640a 0a20 2020 2020 2020 2072  er_id..        r
+000015c0: 6574 7572 6e20 7072 6f74 6f0a 0a20 2020  eturn proto..   
+000015d0: 2064 6566 205f 746f 5f63 6c75 7374 6572   def _to_cluster
+000015e0: 5f70 726f 746f 2873 656c 6629 202d 3e20  _proto(self) -> 
+000015f0: 6665 6174 7572 655f 7669 6577 5f70 6232  feature_view_pb2
+00001600: 2e43 6c75 7374 6572 436f 6e66 6967 3a0a  .ClusterConfig:.
+00001610: 2020 2020 2020 2020 7265 7475 726e 2066          return f
+00001620: 6561 7475 7265 5f76 6965 775f 7062 322e  eature_view_pb2.
+00001630: 436c 7573 7465 7243 6f6e 6669 6728 6578  ClusterConfig(ex
+00001640: 6973 7469 6e67 5f63 6c75 7374 6572 3d73  isting_cluster=s
+00001650: 656c 662e 5f74 6f5f 7072 6f74 6f28 2929  elf._to_proto())
+00001660: 0a0a 0a64 6566 205f 746f 5f6a 736f 6e5f  ...def _to_json_
+00001670: 636c 7573 7465 725f 7072 6f74 6f28 7661  cluster_proto(va
+00001680: 6c75 653a 204d 6170 7069 6e67 5b73 7472  lue: Mapping[str
+00001690: 2c20 416e 795d 2920 2d3e 2066 6561 7475  , Any]) -> featu
+000016a0: 7265 5f76 6965 775f 7062 322e 4a73 6f6e  re_view_pb2.Json
+000016b0: 436c 7573 7465 7243 6f6e 6669 673a 0a20  ClusterConfig:. 
+000016c0: 2020 206a 736f 6e5f 7374 7275 6374 203d     json_struct =
+000016d0: 2073 7472 7563 745f 7062 322e 5374 7275   struct_pb2.Stru
+000016e0: 6374 2829 0a20 2020 206a 736f 6e5f 7374  ct().    json_st
+000016f0: 7275 6374 2e75 7064 6174 6528 7661 6c75  ruct.update(valu
+00001700: 6529 0a20 2020 2072 6574 7572 6e20 6665  e).    return fe
+00001710: 6174 7572 655f 7669 6577 5f70 6232 2e4a  ature_view_pb2.J
+00001720: 736f 6e43 6c75 7374 6572 436f 6e66 6967  sonClusterConfig
+00001730: 286a 736f 6e3d 6a73 6f6e 5f73 7472 7563  (json=json_struc
+00001740: 7429 0a0a 0a63 6c61 7373 2045 4d52 436c  t)...class EMRCl
+00001750: 7573 7465 7243 6f6e 6669 6728 5374 7269  usterConfig(Stri
+00001760: 6374 4d6f 6465 6c29 3a0a 2020 2020 2222  ctModel):.    ""
+00001770: 2243 6f6e 6669 6775 7261 7469 6f6e 2075  "Configuration u
+00001780: 7365 6420 746f 2073 7065 6369 6679 206d  sed to specify m
+00001790: 6174 6572 6961 6c69 7a61 7469 6f6e 2063  aterialization c
+000017a0: 6c75 7374 6572 206f 7074 696f 6e73 206f  luster options o
+000017b0: 6e20 454d 522e 0a0a 2020 2020 5468 6973  n EMR...    This
+000017c0: 2063 6c61 7373 2064 6573 6372 6962 6573   class describes
+000017d0: 2074 6865 2061 7474 7269 6275 7465 7320   the attributes 
+000017e0: 6f66 2074 6865 206e 6577 2063 6c75 7374  of the new clust
+000017f0: 6572 7320 7768 6963 6820 6172 6520 6372  ers which are cr
+00001800: 6561 7465 6420 696e 2045 4d52 2064 7572  eated in EMR dur
+00001810: 696e 670a 2020 2020 6d61 7465 7269 616c  ing.    material
+00001820: 697a 6174 696f 6e20 6a6f 6273 2e20 596f  ization jobs. Yo
+00001830: 7520 6361 6e20 636f 6e66 6967 7572 6520  u can configure 
+00001840: 6f70 7469 6f6e 7320 6f66 2074 6865 7365  options of these
+00001850: 2063 6c75 7374 6572 732c 206c 696b 6520   clusters, like 
+00001860: 636c 7573 7465 7220 7369 7a65 2061 6e64  cluster size and
+00001870: 2065 7874 7261 2070 6970 2064 6570 656e   extra pip depen
+00001880: 6465 6e63 6965 732e 0a0a 2020 2020 3a70  dencies...    :p
+00001890: 6172 616d 2069 6e73 7461 6e63 655f 7479  aram instance_ty
+000018a0: 7065 3a20 496e 7374 616e 6365 2074 7970  pe: Instance typ
+000018b0: 6520 666f 7220 7468 6520 636c 7573 7465  e for the cluste
+000018c0: 722e 204d 7573 7420 6265 2061 2076 616c  r. Must be a val
+000018d0: 6964 2074 7970 6520 6173 206c 6973 7465  id type as liste
+000018e0: 6420 696e 2068 7474 7073 3a2f 2f64 6f63  d in https://doc
+000018f0: 732e 6177 732e 616d 617a 6f6e 2e63 6f6d  s.aws.amazon.com
+00001900: 2f65 6d72 2f6c 6174 6573 742f 4d61 6e61  /emr/latest/Mana
+00001910: 6765 6d65 6e74 4775 6964 652f 656d 722d  gementGuide/emr-
+00001920: 7375 7070 6f72 7465 642d 696e 7374 616e  supported-instan
+00001930: 6365 2d74 7970 6573 2e68 746d 6c2e 0a20  ce-types.html.. 
+00001940: 2020 2020 2020 2041 6464 6974 696f 6e61         Additiona
+00001950: 6c6c 792c 2047 7261 7669 746f 6e20 696e  lly, Graviton in
+00001960: 7374 616e 6365 7320 7375 6368 2061 7320  stances such as 
+00001970: 7468 6520 6d36 6720 6661 6d69 6c79 2061  the m6g family a
+00001980: 7265 206e 6f74 2073 7570 706f 7274 6564  re not supported
+00001990: 2e20 4966 206e 6f74 2073 7065 6369 6669  . If not specifi
+000019a0: 6564 2c20 6120 7661 6c75 6520 6465 7465  ed, a value dete
+000019b0: 726d 696e 6564 2062 7920 7468 6520 5465  rmined by the Te
+000019c0: 6374 6f6e 2062 6163 6b65 6e64 2069 7320  cton backend is 
+000019d0: 7573 6564 2e0a 2020 2020 3a70 6172 616d  used..    :param
+000019e0: 2069 6e73 7461 6e63 655f 6176 6169 6c61   instance_availa
+000019f0: 6269 6c69 7479 3a20 496e 7374 616e 6365  bility: Instance
+00001a00: 2061 7661 696c 6162 696c 6974 7920 666f   availability fo
+00001a10: 7220 7468 6520 636c 7573 7465 7220 3a20  r the cluster : 
+00001a20: 2273 706f 7422 2c20 226f 6e5f 6465 6d61  "spot", "on_dema
+00001a30: 6e64 222c 206f 7220 2273 706f 745f 7769  nd", or "spot_wi
+00001a40: 7468 5f66 616c 6c62 6163 6b22 2e0a 2020  th_fallback"..  
+00001a50: 2020 2020 2020 4966 206e 6f74 2073 7065        If not spe
+00001a60: 6369 6669 6564 2c20 6465 6661 756c 7420  cified, default 
+00001a70: 6973 2073 706f 742e 0a20 2020 203a 7061  is spot..    :pa
+00001a80: 7261 6d20 6e75 6d62 6572 5f6f 665f 776f  ram number_of_wo
+00001a90: 726b 6572 733a 204e 756d 6265 7220 6f66  rkers: Number of
+00001aa0: 2069 6e73 7461 6e63 6573 2066 6f72 2074   instances for t
+00001ab0: 6865 206d 6174 6572 6961 6c69 7a61 7469  he materializati
+00001ac0: 6f6e 206a 6f62 2e20 4966 206e 6f74 2073  on job. If not s
+00001ad0: 7065 6369 6669 6564 2c20 6120 7661 6c75  pecified, a valu
+00001ae0: 6520 6465 7465 726d 696e 6564 2062 7920  e determined by 
+00001af0: 7468 6520 5465 6374 6f6e 2062 6163 6b65  the Tecton backe
+00001b00: 6e64 2069 7320 7573 6564 0a20 2020 203a  nd is used.    :
+00001b10: 7061 7261 6d20 6669 7273 745f 6f6e 5f64  param first_on_d
+00001b20: 656d 616e 643a 2054 6865 2066 6972 7374  emand: The first
+00001b30: 2060 6669 7273 745f 6f6e 5f64 656d 616e   `first_on_deman
+00001b40: 6460 206e 6f64 6573 206f 6620 7468 6520  d` nodes of the 
+00001b50: 636c 7573 7465 7220 7769 6c6c 2075 7365  cluster will use
+00001b60: 206f 6e5f 6465 6d61 6e64 2069 6e73 7461   on_demand insta
+00001b70: 6e63 6573 2e20 5468 6520 7265 7374 2077  nces. The rest w
+00001b80: 696c 6c20 7573 6520 7468 6520 7479 7065  ill use the type
+00001b90: 2073 7065 6369 6669 6564 2062 7920 696e   specified by in
+00001ba0: 7374 616e 6365 5f61 7661 696c 6162 696c  stance_availabil
+00001bb0: 6974 792e 0a20 2020 2020 2020 2049 6620  ity..        If 
+00001bc0: 6669 7273 745f 6f6e 5f64 656d 616e 6420  first_on_demand 
+00001bd0: 3e3d 2031 2c20 7468 6520 6d61 7374 6572  >= 1, the master
+00001be0: 206e 6f64 6520 7769 6c6c 2075 7365 206f   node will use o
+00001bf0: 6e5f 6465 6d61 6e64 2069 6e73 7461 6e63  n_demand instanc
+00001c00: 6520 7479 7065 2e20 6066 6972 7374 5f6f  e type. `first_o
+00001c10: 6e5f 6465 6d61 6e64 6020 6973 2072 6563  n_demand` is rec
+00001c20: 6f6d 6d65 6e64 6564 2074 6f20 6265 2073  ommended to be s
+00001c30: 6574 203e 3d20 3120 666f 7220 636c 7573  et >= 1 for clus
+00001c40: 7465 7220 636f 6e66 6967 7320 666f 7220  ter configs for 
+00001c50: 6372 6974 6963 616c 2073 7472 6561 6d69  critical streami
+00001c60: 6e67 2066 6561 7475 7265 732e 0a20 2020  ng features..   
+00001c70: 203a 7061 7261 6d20 726f 6f74 5f76 6f6c   :param root_vol
+00001c80: 756d 655f 7369 7a65 5f69 6e5f 6762 3a20  ume_size_in_gb: 
+00001c90: 5369 7a65 206f 6620 7468 6520 726f 6f74  Size of the root
+00001ca0: 2076 6f6c 756d 6520 696e 2047 4220 7065   volume in GB pe
+00001cb0: 7220 696e 7374 616e 6365 2066 6f72 2074  r instance for t
+00001cc0: 6865 206d 6174 6572 6961 6c69 7a61 7469  he materializati
+00001cd0: 6f6e 206a 6f62 2e0a 2020 2020 2020 2020  on job..        
+00001ce0: 4966 206e 6f74 2073 7065 6369 6669 6564  If not specified
+00001cf0: 2c20 6120 7661 6c75 6520 6465 7465 726d  , a value determ
+00001d00: 696e 6564 2062 7920 7468 6520 5465 6374  ined by the Tect
+00001d10: 6f6e 2062 6163 6b65 6e64 2069 7320 7573  on backend is us
+00001d20: 6564 2e0a 2020 2020 3a70 6172 616d 2065  ed..    :param e
+00001d30: 7874 7261 5f70 6970 5f64 6570 656e 6465  xtra_pip_depende
+00001d40: 6e63 6965 733a 2045 7874 7261 2070 6970  ncies: Extra pip
+00001d50: 2064 6570 656e 6465 6e63 6965 7320 746f   dependencies to
+00001d60: 2062 6520 696e 7374 616c 6c65 6420 6f6e   be installed on
+00001d70: 2074 6865 206d 6174 6572 6961 6c69 7a61   the materializa
+00001d80: 7469 6f6e 2063 6c75 7374 6572 2e20 4d75  tion cluster. Mu
+00001d90: 7374 2062 6520 5079 5049 2070 6163 6b61  st be PyPI packa
+00001da0: 6765 732c 206f 7220 7768 6565 6c73 2f65  ges, or wheels/e
+00001db0: 6767 7320 696e 2053 3320 6f72 2044 4246  ggs in S3 or DBF
+00001dc0: 532e 0a20 2020 203a 7061 7261 6d20 7370  S..    :param sp
+00001dd0: 6172 6b5f 636f 6e66 6967 3a20 4d61 7020  ark_config: Map 
+00001de0: 6f66 2053 7061 726b 2063 6f6e 6669 6775  of Spark configu
+00001df0: 7261 7469 6f6e 206f 7074 696f 6e73 2061  ration options a
+00001e00: 6e64 2074 6865 6972 2072 6573 7065 6374  nd their respect
+00001e10: 6976 6520 7661 6c75 6573 2074 6861 7420  ive values that 
+00001e20: 7769 6c6c 2062 6520 7061 7373 6564 2074  will be passed t
+00001e30: 6f20 7468 650a 2020 2020 2020 2020 4665  o the.        Fe
+00001e40: 6174 7572 6556 6965 7720 6d61 7465 7269  atureView materi
+00001e50: 616c 697a 6174 696f 6e20 5370 6172 6b20  alization Spark 
+00001e60: 636c 7573 7465 722e 0a20 2020 203a 7061  cluster..    :pa
+00001e70: 7261 6d20 656d 725f 7665 7273 696f 6e3a  ram emr_version:
+00001e80: 2045 4d52 2076 6572 7369 6f6e 206f 6620   EMR version of 
+00001e90: 7468 6520 636c 7573 7465 722e 2053 7570  the cluster. Sup
+00001ea0: 706f 7274 6564 2076 6572 7369 6f6e 7320  ported versions 
+00001eb0: 696e 636c 7564 6520 2265 6d72 2d36 2e39  include "emr-6.9
+00001ec0: 2e30 222c 2022 656d 722d 362e 372e 3022  .0", "emr-6.7.0"
+00001ed0: 2061 6e64 2022 656d 722d 362e 352e 3022   and "emr-6.5.0"
+00001ee0: 2e20 2844 6566 6175 6c74 3a20 656d 722d  . (Default: emr-
+00001ef0: 362e 372e 3029 0a0a 2020 2020 4e6f 7465  6.7.0)..    Note
+00001f00: 206f 6e20 6060 6578 7472 615f 7069 705f   on ``extra_pip_
+00001f10: 6465 7065 6e64 656e 6369 6573 6060 3a20  dependencies``: 
+00001f20: 5468 6973 2069 7320 6120 6c69 7374 206f  This is a list o
+00001f30: 6620 7061 636b 6167 6573 2074 6861 7420  f packages that 
+00001f40: 7769 6c6c 2062 6520 696e 7374 616c 6c65  will be installe
+00001f50: 6420 6475 7269 6e67 206d 6174 6572 6961  d during materia
+00001f60: 6c69 7a61 7469 6f6e 2e0a 2020 2020 546f  lization..    To
+00001f70: 2075 7365 2050 7950 4920 7061 636b 6167   use PyPI packag
+00001f80: 6573 2c20 7370 6563 6966 7920 7468 6520  es, specify the 
+00001f90: 7061 636b 6167 6520 6e61 6d65 2061 6e64  package name and
+00001fa0: 206f 7074 696f 6e61 6c6c 7920 7468 6520   optionally the 
+00001fb0: 7665 7273 696f 6e2c 2065 2e67 2e20 6060  version, e.g. ``
+00001fc0: 2274 656e 736f 7266 6c6f 7722 6060 206f  "tensorflow"`` o
+00001fd0: 7220 6060 2274 656e 736f 7266 6c6f 773d  r ``"tensorflow=
+00001fe0: 3d32 2e32 2e30 2260 602e 0a20 2020 2054  =2.2.0"``..    T
+00001ff0: 6f20 7573 6520 6375 7374 6f6d 2063 6f64  o use custom cod
+00002000: 652c 2070 6163 6b61 6765 2069 7420 6173  e, package it as
+00002010: 2061 2050 7974 686f 6e20 7768 6565 6c20   a Python wheel 
+00002020: 6f72 2065 6767 2066 696c 6520 696e 2053  or egg file in S
+00002030: 3320 6f72 2044 4246 532c 2074 6865 6e20  3 or DBFS, then 
+00002040: 7370 6563 6966 7920 7468 6520 7061 7468  specify the path
+00002050: 2074 6f20 7468 6520 6669 6c65 2c0a 2020   to the file,.  
+00002060: 2020 652e 672e 2060 6022 7333 3a2f 2f6d    e.g. ``"s3://m
+00002070: 792d 6275 636b 6574 2f70 6174 682f 6375  y-bucket/path/cu
+00002080: 7374 6f6d 2e77 686c 2260 602c 206f 7220  stom.whl"``, or 
+00002090: 6060 2264 6266 733a 2f70 6174 682f 746f  ``"dbfs:/path/to
+000020a0: 2f63 7573 746f 6d2e 7768 6c22 6060 2e0a  /custom.whl"``..
+000020b0: 0a20 2020 2054 6865 7365 206c 6962 7261  .    These libra
+000020c0: 7269 6573 2077 696c 6c20 6f6e 6c79 2062  ries will only b
+000020d0: 6520 6176 6169 6c61 626c 6520 746f 2075  e available to u
+000020e0: 7365 2069 6e73 6964 6520 5370 6172 6b20  se inside Spark 
+000020f0: 5544 4673 2e20 466f 7220 6578 616d 706c  UDFs. For exampl
+00002100: 652c 2069 6620 796f 7520 7365 740a 2020  e, if you set.  
+00002110: 2020 6060 6578 7472 615f 7069 705f 6465    ``extra_pip_de
+00002120: 7065 6e64 656e 6369 6573 3d5b 2274 656e  pendencies=["ten
+00002130: 736f 7266 6c6f 7722 5d60 602c 2079 6f75  sorflow"]``, you
+00002140: 2063 616e 2075 7365 2069 7420 696e 2079   can use it in y
+00002150: 6f75 7220 7472 616e 7366 6f72 6d61 7469  our transformati
+00002160: 6f6e 2061 7320 7368 6f77 6e20 6265 6c6f  on as shown belo
+00002170: 772e 0a0a 2020 2020 416e 2065 7861 6d70  w...    An examp
+00002180: 6c65 206f 6620 454d 5243 6c75 7374 6572  le of EMRCluster
+00002190: 436f 6e66 6967 2e0a 0a20 2020 202e 2e20  Config...    .. 
+000021a0: 636f 6465 2d62 6c6f 636b 3a3a 2070 7974  code-block:: pyt
+000021b0: 686f 6e0a 0a20 2020 2020 2020 2066 726f  hon..        fro
+000021c0: 6d20 7465 6374 6f6e 2069 6d70 6f72 7420  m tecton import 
+000021d0: 6261 7463 685f 6665 6174 7572 655f 7669  batch_feature_vi
+000021e0: 6577 2c20 496e 7075 742c 2045 4d52 436c  ew, Input, EMRCl
+000021f0: 7573 7465 7243 6f6e 6669 670a 0a20 2020  usterConfig..   
+00002200: 2020 2020 2040 6261 7463 685f 6665 6174       @batch_feat
+00002210: 7572 655f 7669 6577 280a 2020 2020 2020  ure_view(.      
+00002220: 2020 2020 2020 736f 7572 6365 733d 5b46        sources=[F
+00002230: 696c 7465 7265 6453 6f75 7263 6528 6372  ilteredSource(cr
+00002240: 6564 6974 5f73 636f 7265 735f 6261 7463  edit_scores_batc
+00002250: 6829 5d2c 0a20 2020 2020 2020 2020 2020  h)],.           
+00002260: 2023 2043 616e 2062 6520 616e 2061 7267   # Can be an arg
+00002270: 756d 656e 7420 696e 7374 616e 6365 2074  ument instance t
+00002280: 6f20 6120 6261 7463 6820 6665 6174 7572  o a batch featur
+00002290: 6520 7669 6577 2064 6563 6f72 6174 6f72  e view decorator
+000022a0: 0a20 2020 2020 2020 2020 2020 2062 6174  .            bat
+000022b0: 6368 5f63 6f6d 7075 7465 203d 2045 4d52  ch_compute = EMR
+000022c0: 436c 7573 7465 7243 6f6e 6669 6728 0a20  ClusterConfig(. 
+000022d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000022e0: 6e73 7461 6e63 655f 7479 7065 203d 2027  nstance_type = '
+000022f0: 6d35 2e32 786c 6172 6765 272c 0a20 2020  m5.2xlarge',.   
+00002300: 2020 2020 2020 2020 2020 2020 206e 756d               num
+00002310: 6265 725f 6f66 5f77 6f72 6b65 7273 3d34  ber_of_workers=4
+00002320: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00002330: 2020 6578 7472 615f 7069 705f 6465 7065    extra_pip_depe
+00002340: 6e64 656e 6369 6573 3d5b 2274 656e 736f  ndencies=["tenso
+00002350: 7266 6c6f 773d 3d32 2e32 2e30 225d 2c0a  rflow==2.2.0"],.
+00002360: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
+00002370: 2020 2020 2020 2020 2020 2023 204f 7468             # Oth
+00002380: 6572 206e 616d 6564 2061 7267 756d 656e  er named argumen
+00002390: 7473 2074 6f20 6261 7463 6820 6665 6174  ts to batch feat
+000023a0: 7572 6520 7669 6577 0a20 2020 2020 2020  ure view.       
+000023b0: 2020 2020 202e 2e2e 0a20 2020 2020 2020       ....       
+000023c0: 2029 0a0a 2020 2020 2020 2020 2320 5573   )..        # Us
+000023d0: 6520 7468 6520 7465 6e73 6f72 666c 6f77  e the tensorflow
+000023e0: 2070 6163 6b61 6765 2069 6e20 7468 6520   package in the 
+000023f0: 5544 4620 7369 6e63 6520 7465 6e73 6f72  UDF since tensor
+00002400: 666c 6f77 2077 696c 6c20 6265 2069 6e73  flow will be ins
+00002410: 7461 6c6c 6564 0a20 2020 2020 2020 2023  talled.        #
+00002420: 206f 6e20 7468 6520 454d 5220 5370 6172   on the EMR Spar
+00002430: 6b20 636c 7573 7465 722e 2054 6865 2069  k cluster. The i
+00002440: 6d70 6f72 7420 6861 7320 746f 2062 6520  mport has to be 
+00002450: 7769 7468 696e 2074 6865 2055 4446 2062  within the UDF b
+00002460: 6f64 792e 2050 7574 7469 6e67 2069 7420  ody. Putting it 
+00002470: 6174 2074 6865 0a20 2020 2020 2020 2023  at the.        #
+00002480: 2074 6f70 206f 6620 7468 6520 6669 6c65   top of the file
+00002490: 206f 7220 696e 7369 6465 2074 7261 6e73   or inside trans
+000024a0: 666f 726d 6174 696f 6e20 6675 6e63 7469  formation functi
+000024b0: 6f6e 2077 6f6e 2774 2077 6f72 6b2e 0a0a  on won't work...
+000024c0: 2020 2020 2020 2020 4074 7261 6e73 666f          @transfo
+000024d0: 726d 6174 696f 6e28 6d6f 6465 3d27 7079  rmation(mode='py
+000024e0: 7370 6172 6b27 290a 2020 2020 2020 2020  spark').        
+000024f0: 6465 6620 7465 7374 5f74 7261 6e73 666f  def test_transfo
+00002500: 726d 6174 696f 6e28 7472 616e 7366 6f72  rmation(transfor
+00002510: 6d61 7469 6f6e 5f69 6e70 7574 293a 0a20  mation_input):. 
+00002520: 2020 2020 2020 2020 2020 2066 726f 6d20             from 
+00002530: 7079 7370 6172 6b2e 7371 6c20 696d 706f  pyspark.sql impo
+00002540: 7274 2066 756e 6374 696f 6e73 2061 7320  rt functions as 
+00002550: 460a 2020 2020 2020 2020 2020 2020 6672  F.            fr
+00002560: 6f6d 2070 7973 7061 726b 2e73 716c 2e74  om pyspark.sql.t
+00002570: 7970 6573 2069 6d70 6f72 7420 496e 7465  ypes import Inte
+00002580: 6765 7254 7970 650a 0a20 2020 2020 2020  gerType..       
+00002590: 2020 2020 2064 6566 206d 795f 7465 6e73       def my_tens
+000025a0: 6f72 666c 6f77 2878 293a 0a20 2020 2020  orflow(x):.     
+000025b0: 2020 2020 2020 2020 2020 2069 6d70 6f72             impor
+000025c0: 7420 7465 6e73 6f72 666c 6f77 2061 7320  t tensorflow as 
+000025d0: 7466 0a20 2020 2020 2020 2020 2020 2020  tf.             
+000025e0: 2020 2072 6574 7572 6e20 696e 7428 7466     return int(tf
+000025f0: 2e6d 6174 682e 6c6f 6731 7028 666c 6f61  .math.log1p(floa
+00002600: 7428 7829 292e 6e75 6d70 7928 2929 0a0a  t(x)).numpy())..
+00002610: 2020 2020 2020 2020 2020 2020 6d79 5f74              my_t
+00002620: 656e 736f 7266 6c6f 775f 7564 6620 3d20  ensorflow_udf = 
+00002630: 462e 7564 6628 6d79 5f74 656e 736f 7266  F.udf(my_tensorf
+00002640: 6c6f 772c 2049 6e74 6567 6572 5479 7065  low, IntegerType
+00002650: 2829 290a 0a20 2020 2020 2020 2020 2020  ())..           
+00002660: 2072 6574 7572 6e20 7472 616e 7366 6f72   return transfor
+00002670: 6d61 7469 6f6e 5f69 6e70 7574 2e73 656c  mation_input.sel
+00002680: 6563 7428 0a20 2020 2020 2020 2020 2020  ect(.           
+00002690: 2020 2020 2027 656e 7469 7479 5f69 6427       'entity_id'
+000026a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000026b0: 2020 2774 696d 6573 7461 6d70 272c 0a20    'timestamp',. 
+000026c0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+000026d0: 795f 7465 6e73 6f72 666c 6f77 5f75 6466  y_tensorflow_udf
+000026e0: 2827 636c 6963 6b73 2729 2e61 6c69 6173  ('clicks').alias
+000026f0: 2827 6c6f 6731 705f 636c 6963 6b73 2729  ('log1p_clicks')
+00002700: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00002710: 2020 2022 2222 0a0a 2020 2020 6b69 6e64     """..    kind
+00002720: 3a20 4c69 7465 7261 6c5b 2245 4d52 436c  : Literal["EMRCl
+00002730: 7573 7465 7243 6f6e 6669 6722 5d20 3d20  usterConfig"] = 
+00002740: 2245 4d52 436c 7573 7465 7243 6f6e 6669  "EMRClusterConfi
+00002750: 6722 2020 2320 5573 6564 2066 6f72 2059  g"  # Used for Y
+00002760: 414d 4c20 7061 7273 696e 6720 6173 2061  AML parsing as a
+00002770: 2050 7964 616e 7469 6320 6469 7363 7269   Pydantic discri
+00002780: 6d69 6e61 746f 722e 0a20 2020 2069 6e73  minator..    ins
+00002790: 7461 6e63 655f 7479 7065 3a20 4f70 7469  tance_type: Opti
+000027a0: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
+000027b0: 0a20 2020 2069 6e73 7461 6e63 655f 6176  .    instance_av
+000027c0: 6169 6c61 6269 6c69 7479 3a20 4f70 7469  ailability: Opti
+000027d0: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
+000027e0: 0a20 2020 206e 756d 6265 725f 6f66 5f77  .    number_of_w
+000027f0: 6f72 6b65 7273 3a20 4f70 7469 6f6e 616c  orkers: Optional
+00002800: 5b69 6e74 5d20 3d20 4e6f 6e65 0a20 2020  [int] = None.   
+00002810: 2066 6972 7374 5f6f 6e5f 6465 6d61 6e64   first_on_demand
+00002820: 3a20 4f70 7469 6f6e 616c 5b69 6e74 5d20  : Optional[int] 
+00002830: 3d20 4e6f 6e65 0a20 2020 2072 6f6f 745f  = None.    root_
+00002840: 766f 6c75 6d65 5f73 697a 655f 696e 5f67  volume_size_in_g
+00002850: 623a 204f 7074 696f 6e61 6c5b 696e 745d  b: Optional[int]
+00002860: 203d 204e 6f6e 650a 2020 2020 6578 7472   = None.    extr
+00002870: 615f 7069 705f 6465 7065 6e64 656e 6369  a_pip_dependenci
+00002880: 6573 3a20 4f70 7469 6f6e 616c 5b4c 6973  es: Optional[Lis
+00002890: 745b 7374 725d 5d20 3d20 4e6f 6e65 0a20  t[str]] = None. 
+000028a0: 2020 2073 7061 726b 5f63 6f6e 6669 673a     spark_config:
+000028b0: 204f 7074 696f 6e61 6c5b 4469 6374 5b73   Optional[Dict[s
+000028c0: 7472 2c20 7374 725d 5d20 3d20 4e6f 6e65  tr, str]] = None
+000028d0: 0a20 2020 2065 6d72 5f76 6572 7369 6f6e  .    emr_version
+000028e0: 3a20 7374 7220 3d20 4445 4641 554c 545f  : str = DEFAULT_
+000028f0: 5350 4152 4b5f 5645 5253 494f 4e53 5b22  SPARK_VERSIONS["
+00002900: 656d 725f 7370 6172 6b5f 7665 7273 696f  emr_spark_versio
+00002910: 6e22 5d0a 0a20 2020 2064 6566 205f 746f  n"]..    def _to
+00002920: 5f70 726f 746f 2873 656c 6629 202d 3e20  _proto(self) -> 
+00002930: 6665 6174 7572 655f 7669 6577 5f70 6232  feature_view_pb2
+00002940: 2e4e 6577 436c 7573 7465 7243 6f6e 6669  .NewClusterConfi
+00002950: 673a 0a20 2020 2020 2020 2070 726f 746f  g:.        proto
+00002960: 203d 2066 6561 7475 7265 5f76 6965 775f   = feature_view_
+00002970: 7062 322e 4e65 7743 6c75 7374 6572 436f  pb2.NewClusterCo
+00002980: 6e66 6967 2829 0a20 2020 2020 2020 2069  nfig().        i
+00002990: 6620 7365 6c66 2e69 6e73 7461 6e63 655f  f self.instance_
+000029a0: 7479 7065 3a0a 2020 2020 2020 2020 2020  type:.          
+000029b0: 2020 7072 6f74 6f2e 696e 7374 616e 6365    proto.instance
+000029c0: 5f74 7970 6520 3d20 7365 6c66 2e69 6e73  _type = self.ins
+000029d0: 7461 6e63 655f 7479 7065 0a20 2020 2020  tance_type.     
+000029e0: 2020 2069 6620 7365 6c66 2e69 6e73 7461     if self.insta
+000029f0: 6e63 655f 6176 6169 6c61 6269 6c69 7479  nce_availability
+00002a00: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00002a10: 2073 656c 662e 696e 7374 616e 6365 5f61   self.instance_a
+00002a20: 7661 696c 6162 696c 6974 7920 6e6f 7420  vailability not 
+00002a30: 696e 2045 4d52 5f53 5550 504f 5254 4544  in EMR_SUPPORTED
+00002a40: 5f41 5641 494c 4142 494c 4954 593a 0a20  _AVAILABILITY:. 
+00002a50: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00002a60: 7367 203d 2066 2249 6e73 7461 6e63 6520  sg = f"Instance 
+00002a70: 6176 6169 6c61 6269 6c69 7479 207b 7365  availability {se
+00002a80: 6c66 2e69 6e73 7461 6e63 655f 6176 6169  lf.instance_avai
+00002a90: 6c61 6269 6c69 7479 7d20 6973 206e 6f74  lability} is not
+00002aa0: 2073 7570 706f 7274 6564 2e20 4368 6f6f   supported. Choo
+00002ab0: 7365 206f 6e65 206f 6620 7b45 4d52 5f53  se one of {EMR_S
+00002ac0: 5550 504f 5254 4544 5f41 5641 494c 4142  UPPORTED_AVAILAB
+00002ad0: 494c 4954 597d 220a 2020 2020 2020 2020  ILITY}".        
+00002ae0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00002af0: 6c75 6545 7272 6f72 286d 7367 290a 2020  lueError(msg).  
+00002b00: 2020 2020 2020 2020 2020 7072 6f74 6f2e            proto.
+00002b10: 696e 7374 616e 6365 5f61 7661 696c 6162  instance_availab
+00002b20: 696c 6974 7920 3d20 7365 6c66 2e69 6e73  ility = self.ins
+00002b30: 7461 6e63 655f 6176 6169 6c61 6269 6c69  tance_availabili
+00002b40: 7479 0a20 2020 2020 2020 2069 6620 7365  ty.        if se
+00002b50: 6c66 2e65 6d72 5f76 6572 7369 6f6e 206e  lf.emr_version n
+00002b60: 6f74 2069 6e20 454d 525f 5355 5050 4f52  ot in EMR_SUPPOR
+00002b70: 5445 445f 5350 4152 4b3a 0a20 2020 2020  TED_SPARK:.     
+00002b80: 2020 2020 2020 206d 7367 203d 2066 2245         msg = f"E
+00002b90: 4d52 2076 6572 7369 6f6e 207b 7365 6c66  MR version {self
+00002ba0: 2e65 6d72 5f76 6572 7369 6f6e 7d20 6973  .emr_version} is
+00002bb0: 206e 6f74 2073 7570 706f 7274 6564 2e20   not supported. 
+00002bc0: 5375 7070 6f72 7465 6420 7665 7273 696f  Supported versio
+00002bd0: 6e73 3a20 7b45 4d52 5f53 5550 504f 5254  ns: {EMR_SUPPORT
+00002be0: 4544 5f53 5041 524b 7d22 0a20 2020 2020  ED_SPARK}".     
+00002bf0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00002c00: 7565 4572 726f 7228 6d73 6729 0a20 2020  ueError(msg).   
+00002c10: 2020 2020 2069 6620 7365 6c66 2e6e 756d       if self.num
+00002c20: 6265 725f 6f66 5f77 6f72 6b65 7273 3a0a  ber_of_workers:.
+00002c30: 2020 2020 2020 2020 2020 2020 7072 6f74              prot
+00002c40: 6f2e 6e75 6d62 6572 5f6f 665f 776f 726b  o.number_of_work
+00002c50: 6572 7320 3d20 7365 6c66 2e6e 756d 6265  ers = self.numbe
+00002c60: 725f 6f66 5f77 6f72 6b65 7273 0a20 2020  r_of_workers.   
+00002c70: 2020 2020 2069 6620 7365 6c66 2e66 6972       if self.fir
+00002c80: 7374 5f6f 6e5f 6465 6d61 6e64 3a0a 2020  st_on_demand:.  
+00002c90: 2020 2020 2020 2020 2020 7072 6f74 6f2e            proto.
+00002ca0: 6669 7273 745f 6f6e 5f64 656d 616e 6420  first_on_demand 
+00002cb0: 3d20 7365 6c66 2e66 6972 7374 5f6f 6e5f  = self.first_on_
+00002cc0: 6465 6d61 6e64 0a20 2020 2020 2020 2069  demand.        i
+00002cd0: 6620 7365 6c66 2e72 6f6f 745f 766f 6c75  f self.root_volu
+00002ce0: 6d65 5f73 697a 655f 696e 5f67 623a 0a20  me_size_in_gb:. 
+00002cf0: 2020 2020 2020 2020 2020 2070 726f 746f             proto
+00002d00: 2e72 6f6f 745f 766f 6c75 6d65 5f73 697a  .root_volume_siz
+00002d10: 655f 696e 5f67 6220 3d20 7365 6c66 2e72  e_in_gb = self.r
+00002d20: 6f6f 745f 766f 6c75 6d65 5f73 697a 655f  oot_volume_size_
+00002d30: 696e 5f67 620a 2020 2020 2020 2020 6966  in_gb.        if
+00002d40: 2073 656c 662e 6578 7472 615f 7069 705f   self.extra_pip_
+00002d50: 6465 7065 6e64 656e 6369 6573 3a0a 2020  dependencies:.  
+00002d60: 2020 2020 2020 2020 2020 7072 6f74 6f2e            proto.
+00002d70: 6578 7472 615f 7069 705f 6465 7065 6e64  extra_pip_depend
+00002d80: 656e 6369 6573 2e65 7874 656e 6428 7365  encies.extend(se
+00002d90: 6c66 2e65 7874 7261 5f70 6970 5f64 6570  lf.extra_pip_dep
+00002da0: 656e 6465 6e63 6965 7329 0a20 2020 2020  endencies).     
+00002db0: 2020 2069 6620 7365 6c66 2e73 7061 726b     if self.spark
+00002dc0: 5f63 6f6e 6669 673a 0a20 2020 2020 2020  _config:.       
+00002dd0: 2020 2020 2073 7061 726b 5f63 6f6e 6669       spark_confi
+00002de0: 6720 3d20 5370 6172 6b43 6f6e 6669 6757  g = SparkConfigW
+00002df0: 7261 7070 6572 2873 7061 726b 5f63 6f6e  rapper(spark_con
+00002e00: 6669 675f 6d61 703d 7365 6c66 2e73 7061  fig_map=self.spa
+00002e10: 726b 5f63 6f6e 6669 6729 2e5f 746f 5f70  rk_config)._to_p
+00002e20: 726f 746f 2829 0a20 2020 2020 2020 2020  roto().         
+00002e30: 2020 2070 726f 746f 2e73 7061 726b 5f63     proto.spark_c
+00002e40: 6f6e 6669 672e 436f 7079 4672 6f6d 2873  onfig.CopyFrom(s
+00002e50: 7061 726b 5f63 6f6e 6669 6729 0a20 2020  park_config).   
+00002e60: 2020 2020 2070 726f 746f 2e70 696e 6e65       proto.pinne
+00002e70: 645f 7370 6172 6b5f 7665 7273 696f 6e20  d_spark_version 
+00002e80: 3d20 7365 6c66 2e65 6d72 5f76 6572 7369  = self.emr_versi
+00002e90: 6f6e 0a0a 2020 2020 2020 2020 7265 7475  on..        retu
+00002ea0: 726e 2070 726f 746f 0a0a 2020 2020 6465  rn proto..    de
+00002eb0: 6620 5f74 6f5f 636c 7573 7465 725f 7072  f _to_cluster_pr
+00002ec0: 6f74 6f28 7365 6c66 2920 2d3e 2066 6561  oto(self) -> fea
+00002ed0: 7475 7265 5f76 6965 775f 7062 322e 436c  ture_view_pb2.Cl
+00002ee0: 7573 7465 7243 6f6e 6669 673a 0a20 2020  usterConfig:.   
+00002ef0: 2020 2020 2072 6574 7572 6e20 6665 6174       return feat
+00002f00: 7572 655f 7669 6577 5f70 6232 2e43 6c75  ure_view_pb2.Clu
+00002f10: 7374 6572 436f 6e66 6967 286e 6577 5f65  sterConfig(new_e
+00002f20: 6d72 3d73 656c 662e 5f74 6f5f 7072 6f74  mr=self._to_prot
+00002f30: 6f28 2929 0a0a 0a63 6c61 7373 2045 4d52  o())...class EMR
+00002f40: 4a73 6f6e 436c 7573 7465 7243 6f6e 6669  JsonClusterConfi
+00002f50: 6728 5374 7269 6374 4d6f 6465 6c29 3a0a  g(StrictModel):.
+00002f60: 2020 2020 2222 2243 6f6e 6669 6775 7261      """Configura
+00002f70: 7469 6f6e 2075 7365 6420 746f 2073 7065  tion used to spe
+00002f80: 6369 6679 206d 6174 6572 6961 6c69 7a61  cify materializa
+00002f90: 7469 6f6e 2063 6c75 7374 6572 7320 7573  tion clusters us
+00002fa0: 696e 6720 6a73 6f6e 206f 6e20 454d 522e  ing json on EMR.
+00002fb0: 0a0a 2020 2020 5468 6973 2063 6c61 7373  ..    This class
+00002fc0: 2064 6573 6372 6962 6573 2074 6865 2061   describes the a
+00002fd0: 7474 7269 6275 7465 7320 6f66 2074 6865  ttributes of the
+00002fe0: 206e 6577 2063 6c75 7374 6572 7320 7768   new clusters wh
+00002ff0: 6963 6820 6172 6520 6372 6561 7465 6420  ich are created 
+00003000: 696e 2045 4d52 2064 7572 696e 670a 2020  in EMR during.  
+00003010: 2020 6d61 7465 7269 616c 697a 6174 696f    materializatio
+00003020: 6e20 6a6f 6273 2e20 506c 6561 7365 2066  n jobs. Please f
+00003030: 696e 6420 6d6f 7265 2064 6574 6169 6c73  ind more details
+00003040: 2069 6e20 6055 7365 7220 4775 6964 6560   in `User Guide`
+00003050: 5f2e 0a0a 2020 2020 3a70 6172 616d 206a  _...    :param j
+00003060: 736f 6e3a 2041 204a 534f 4e20 7374 7269  son: A JSON stri
+00003070: 6e67 2075 7365 6420 746f 2064 6972 6563  ng used to direc
+00003080: 746c 7920 636f 6e66 6967 7572 6520 7468  tly configure th
+00003090: 6520 636c 7573 7465 7220 7573 6564 2069  e cluster used i
+000030a0: 6e20 6d61 7465 7269 616c 697a 6174 696f  n materializatio
+000030b0: 6e2e 0a0a 2020 2020 2e2e 205f 5573 6572  n...    .. _User
+000030c0: 2047 7569 6465 3a20 6874 7470 733a 2f2f   Guide: https://
+000030d0: 646f 6373 2e74 6563 746f 6e2e 6169 2f64  docs.tecton.ai/d
+000030e0: 6f63 732f 6d61 7465 7269 616c 697a 696e  ocs/materializin
+000030f0: 672d 6665 6174 7572 6573 2f63 6f6e 6669  g-features/confi
+00003100: 6775 7269 6e67 2d6a 6f62 2d63 6c75 7374  guring-job-clust
+00003110: 6572 732d 7669 612d 6a73 6f6e 2363 6f6e  ers-via-json#con
+00003120: 6669 6775 7269 6e67 2d65 6d72 2d6a 6f62  figuring-emr-job
+00003130: 2d63 6c75 7374 6572 730a 2020 2020 2222  -clusters.    ""
+00003140: 220a 0a20 2020 2023 2055 7365 6420 666f  "..    # Used fo
+00003150: 7220 5941 4d4c 2070 6172 7369 6e67 2061  r YAML parsing a
+00003160: 7320 6120 5079 6461 6e74 6963 2064 6973  s a Pydantic dis
+00003170: 6372 696d 696e 6174 6f72 2e0a 2020 2020  criminator..    
+00003180: 6b69 6e64 3a20 4c69 7465 7261 6c5b 2245  kind: Literal["E
+00003190: 4d52 4a73 6f6e 436c 7573 7465 7243 6f6e  MRJsonClusterCon
+000031a0: 6669 6722 5d20 3d20 2245 4d52 4a73 6f6e  fig"] = "EMRJson
+000031b0: 436c 7573 7465 7243 6f6e 6669 6722 0a0a  ClusterConfig"..
+000031c0: 2020 2020 2320 5573 6520 6a73 6f6e 5f20      # Use json_ 
+000031d0: 7769 7468 2061 6e20 616c 6961 7320 746f  with an alias to
+000031e0: 2061 766f 6964 2063 6f6e 666c 6963 7469   avoid conflicti
+000031f0: 6e67 2077 6974 6820 6120 5079 6461 6e74  ng with a Pydant
+00003200: 6963 2042 6173 654d 6f64 656c 206d 6574  ic BaseModel met
+00003210: 686f 6420 6a73 6f6e 2829 2e20 5368 6164  hod json(). Shad
+00003220: 6f77 2074 6861 7420 6d65 7468 6f64 2077  ow that method w
+00003230: 6974 680a 2020 2020 2320 6120 6a73 6f6e  ith.    # a json
+00003240: 2070 726f 7065 7274 7920 736f 2074 6861   property so tha
+00003250: 7420 6361 6c6c 6572 7320 6361 6e20 6163  t callers can ac
+00003260: 6365 7373 2074 6865 2066 6965 6c64 2069  cess the field i
+00003270: 6e74 7569 7469 7665 6c79 2e0a 2020 2020  ntuitively..    
+00003280: 6a73 6f6e 5f3a 2044 6963 745b 7374 722c  json_: Dict[str,
+00003290: 2041 6e79 5d20 3d20 7079 6461 6e74 6963   Any] = pydantic
+000032a0: 5f76 312e 4669 656c 6428 616c 6961 733d  _v1.Field(alias=
+000032b0: 226a 736f 6e22 290a 0a20 2020 2023 2041  "json")..    # A
+000032c0: 2050 7964 616e 7469 6320 7072 652d 7661   Pydantic pre-va
+000032d0: 6c69 6461 746f 7220 746f 2063 6f6e 7665  lidator to conve
+000032e0: 7274 206a 736f 6e20 7374 7269 6e67 7320  rt json strings 
+000032f0: 746f 2061 206e 6174 6976 6520 7079 7468  to a native pyth
+00003300: 6f6e 206f 626a 6563 742e 0a20 2020 205f  on object..    _
+00003310: 6a73 6f6e 5f73 7472 5f74 6f5f 6469 6374  json_str_to_dict
+00003320: 203d 2070 7964 616e 7469 635f 7631 2e76   = pydantic_v1.v
+00003330: 616c 6964 6174 6f72 2822 6a73 6f6e 5f22  alidator("json_"
+00003340: 2c20 616c 6c6f 775f 7265 7573 653d 5472  , allow_reuse=Tr
+00003350: 7565 2c20 7072 653d 5472 7565 2928 5f73  ue, pre=True)(_s
+00003360: 7472 5f74 6f5f 6a73 6f6e 5f73 7472 7563  tr_to_json_struc
+00003370: 7429 0a0a 2020 2020 6465 6620 5f74 6f5f  t)..    def _to_
+00003380: 636c 7573 7465 725f 7072 6f74 6f28 7365  cluster_proto(se
+00003390: 6c66 2920 2d3e 2066 6561 7475 7265 5f76  lf) -> feature_v
+000033a0: 6965 775f 7062 322e 436c 7573 7465 7243  iew_pb2.ClusterC
+000033b0: 6f6e 6669 673a 0a20 2020 2020 2020 2072  onfig:.        r
+000033c0: 6574 7572 6e20 6665 6174 7572 655f 7669  eturn feature_vi
+000033d0: 6577 5f70 6232 2e43 6c75 7374 6572 436f  ew_pb2.ClusterCo
+000033e0: 6e66 6967 286a 736f 6e5f 656d 723d 5f74  nfig(json_emr=_t
+000033f0: 6f5f 6a73 6f6e 5f63 6c75 7374 6572 5f70  o_json_cluster_p
+00003400: 726f 746f 2873 656c 662e 6a73 6f6e 2929  roto(self.json))
+00003410: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00003420: 2020 2020 6465 6620 6a73 6f6e 2873 656c      def json(sel
+00003430: 6629 202d 3e20 4469 6374 5b73 7472 2c20  f) -> Dict[str, 
+00003440: 416e 795d 3a0a 2020 2020 2020 2020 7265  Any]:.        re
+00003450: 7475 726e 2073 656c 662e 6a73 6f6e 5f0a  turn self.json_.
+00003460: 0a0a 636c 6173 7320 4461 7461 7072 6f63  ..class Dataproc
+00003470: 4a73 6f6e 436c 7573 7465 7243 6f6e 6669  JsonClusterConfi
+00003480: 6728 5374 7269 6374 4d6f 6465 6c29 3a0a  g(StrictModel):.
+00003490: 2020 2020 2222 2243 6f6e 6669 6775 7261      """Configura
+000034a0: 7469 6f6e 2075 7365 6420 746f 2073 7065  tion used to spe
+000034b0: 6369 6679 206d 6174 6572 6961 6c69 7a61  cify materializa
+000034c0: 7469 6f6e 2063 6c75 7374 6572 7320 7573  tion clusters us
+000034d0: 696e 6720 6a73 6f6e 206f 6e20 4461 7461  ing json on Data
+000034e0: 7072 6f63 2e0a 0a20 2020 2054 6869 7320  proc...    This 
+000034f0: 636c 6173 7320 6465 7363 7269 6265 7320  class describes 
+00003500: 7468 6520 6174 7472 6962 7574 6573 206f  the attributes o
+00003510: 6620 7468 6520 6e65 7720 636c 7573 7465  f the new cluste
+00003520: 7273 2077 6869 6368 2061 7265 2063 7265  rs which are cre
+00003530: 6174 6564 2069 6e20 4461 7461 7072 6f63  ated in Dataproc
+00003540: 2064 7572 696e 670a 2020 2020 6d61 7465   during.    mate
+00003550: 7269 616c 697a 6174 696f 6e20 6a6f 6273  rialization jobs
+00003560: 2e20 5468 6973 2066 6561 7475 7265 2069  . This feature i
+00003570: 7320 6f6e 6c79 2061 7661 696c 6162 6c65  s only available
+00003580: 2066 6f72 2070 7269 7661 7465 2070 7265   for private pre
+00003590: 7669 6577 2e0a 0a20 2020 203a 7061 7261  view...    :para
+000035a0: 6d20 6a73 6f6e 3a20 4120 4a53 4f4e 2073  m json: A JSON s
+000035b0: 7472 696e 6720 7573 6564 2074 6f20 6469  tring used to di
+000035c0: 7265 6374 6c79 2063 6f6e 6669 6775 7265  rectly configure
+000035d0: 2074 6865 2063 6c75 7374 6572 2075 7365   the cluster use
+000035e0: 6420 696e 206d 6174 6572 6961 6c69 7a61  d in materializa
+000035f0: 7469 6f6e 2e0a 2020 2020 2222 220a 0a20  tion..    """.. 
+00003600: 2020 2023 2055 7365 6420 666f 7220 5941     # Used for YA
+00003610: 4d4c 2070 6172 7369 6e67 2061 7320 6120  ML parsing as a 
+00003620: 5079 6461 6e74 6963 2064 6973 6372 696d  Pydantic discrim
+00003630: 696e 6174 6f72 2e0a 2020 2020 6b69 6e64  inator..    kind
+00003640: 3a20 4c69 7465 7261 6c5b 2244 6174 6170  : Literal["Datap
+00003650: 726f 634a 736f 6e43 6c75 7374 6572 436f  rocJsonClusterCo
+00003660: 6e66 6967 225d 203d 2022 4461 7461 7072  nfig"] = "Datapr
+00003670: 6f63 4a73 6f6e 436c 7573 7465 7243 6f6e  ocJsonClusterCon
+00003680: 6669 6722 0a0a 2020 2020 2320 5573 6520  fig"..    # Use 
+00003690: 6a73 6f6e 5f20 7769 7468 2061 6e20 616c  json_ with an al
+000036a0: 6961 7320 746f 2061 766f 6964 2063 6f6e  ias to avoid con
+000036b0: 666c 6963 7469 6e67 2077 6974 6820 6120  flicting with a 
+000036c0: 5079 6461 6e74 6963 2042 6173 654d 6f64  Pydantic BaseMod
+000036d0: 656c 206d 6574 686f 6420 6a73 6f6e 2829  el method json()
+000036e0: 2e20 5368 6164 6f77 2074 6861 7420 6d65  . Shadow that me
+000036f0: 7468 6f64 2077 6974 680a 2020 2020 2320  thod with.    # 
+00003700: 6120 6a73 6f6e 2070 726f 7065 7274 7920  a json property 
+00003710: 736f 2074 6861 7420 6361 6c6c 6572 7320  so that callers 
+00003720: 6361 6e20 6163 6365 7373 2074 6865 2066  can access the f
+00003730: 6965 6c64 2069 6e74 7569 7469 7665 6c79  ield intuitively
+00003740: 2e0a 2020 2020 6a73 6f6e 5f3a 2044 6963  ..    json_: Dic
+00003750: 745b 7374 722c 2041 6e79 5d20 3d20 7079  t[str, Any] = py
+00003760: 6461 6e74 6963 5f76 312e 4669 656c 6428  dantic_v1.Field(
+00003770: 616c 6961 733d 226a 736f 6e22 290a 0a20  alias="json").. 
+00003780: 2020 2023 2041 2050 7964 616e 7469 6320     # A Pydantic 
+00003790: 7072 652d 7661 6c69 6461 746f 7220 746f  pre-validator to
+000037a0: 2063 6f6e 7665 7274 206a 736f 6e20 7374   convert json st
+000037b0: 7269 6e67 7320 746f 2061 206e 6174 6976  rings to a nativ
+000037c0: 6520 7079 7468 6f6e 206f 626a 6563 742e  e python object.
+000037d0: 0a20 2020 205f 6a73 6f6e 5f73 7472 5f74  .    _json_str_t
+000037e0: 6f5f 6469 6374 203d 2070 7964 616e 7469  o_dict = pydanti
+000037f0: 635f 7631 2e76 616c 6964 6174 6f72 2822  c_v1.validator("
+00003800: 6a73 6f6e 5f22 2c20 616c 6c6f 775f 7265  json_", allow_re
+00003810: 7573 653d 5472 7565 2c20 7072 653d 5472  use=True, pre=Tr
+00003820: 7565 2928 5f73 7472 5f74 6f5f 6a73 6f6e  ue)(_str_to_json
+00003830: 5f73 7472 7563 7429 0a0a 2020 2020 6465  _struct)..    de
+00003840: 6620 5f74 6f5f 636c 7573 7465 725f 7072  f _to_cluster_pr
+00003850: 6f74 6f28 7365 6c66 2920 2d3e 2066 6561  oto(self) -> fea
+00003860: 7475 7265 5f76 6965 775f 7062 322e 436c  ture_view_pb2.Cl
+00003870: 7573 7465 7243 6f6e 6669 673a 0a20 2020  usterConfig:.   
+00003880: 2020 2020 2072 6574 7572 6e20 6665 6174       return feat
+00003890: 7572 655f 7669 6577 5f70 6232 2e43 6c75  ure_view_pb2.Clu
+000038a0: 7374 6572 436f 6e66 6967 286a 736f 6e5f  sterConfig(json_
+000038b0: 6461 7461 7072 6f63 3d5f 746f 5f6a 736f  dataproc=_to_jso
+000038c0: 6e5f 636c 7573 7465 725f 7072 6f74 6f28  n_cluster_proto(
+000038d0: 7365 6c66 2e6a 736f 6e29 290a 0a20 2020  self.json))..   
+000038e0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+000038f0: 6566 206a 736f 6e28 7365 6c66 2920 2d3e  ef json(self) ->
+00003900: 2044 6963 745b 7374 722c 2041 6e79 5d3a   Dict[str, Any]:
+00003910: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00003920: 7365 6c66 2e6a 736f 6e5f 0a0a 0a63 6c61  self.json_...cla
+00003930: 7373 2044 6174 6162 7269 636b 734a 736f  ss DatabricksJso
+00003940: 6e43 6c75 7374 6572 436f 6e66 6967 2853  nClusterConfig(S
+00003950: 7472 6963 744d 6f64 656c 293a 0a20 2020  trictModel):.   
+00003960: 2022 2222 436f 6e66 6967 7572 6174 696f   """Configuratio
+00003970: 6e20 7573 6564 2074 6f20 7370 6563 6966  n used to specif
+00003980: 7920 6d61 7465 7269 616c 697a 6174 696f  y materializatio
+00003990: 6e20 636c 7573 7465 7273 2075 7369 6e67  n clusters using
+000039a0: 206a 736f 6e20 6f6e 2044 6174 6162 7269   json on Databri
+000039b0: 636b 732e 0a0a 2020 2020 5468 6973 2063  cks...    This c
+000039c0: 6c61 7373 2064 6573 6372 6962 6573 2074  lass describes t
+000039d0: 6865 2061 7474 7269 6275 7465 7320 6f66  he attributes of
+000039e0: 2074 6865 206e 6577 2063 6c75 7374 6572   the new cluster
+000039f0: 7320 7768 6963 6820 6172 6520 6372 6561  s which are crea
+00003a00: 7465 6420 696e 2044 6174 6162 7269 636b  ted in Databrick
+00003a10: 7320 6475 7269 6e67 0a20 2020 206d 6174  s during.    mat
+00003a20: 6572 6961 6c69 7a61 7469 6f6e 206a 6f62  erialization job
+00003a30: 732e 2050 6c65 6173 6520 6669 6e64 206d  s. Please find m
+00003a40: 6f72 6520 6465 7461 696c 7320 696e 2060  ore details in `
+00003a50: 5573 6572 2047 7569 6465 605f 2e0a 0a20  User Guide`_... 
+00003a60: 2020 203a 7061 7261 6d20 6a73 6f6e 3a20     :param json: 
+00003a70: 4120 4a53 4f4e 2073 7472 696e 6720 7573  A JSON string us
+00003a80: 6564 2074 6f20 6469 7265 6374 6c79 2063  ed to directly c
+00003a90: 6f6e 6669 6775 7265 2074 6865 2063 6c75  onfigure the clu
+00003aa0: 7374 6572 2075 7365 6420 696e 206d 6174  ster used in mat
+00003ab0: 6572 6961 6c69 7a61 7469 6f6e 2e0a 0a20  erialization... 
+00003ac0: 2020 202e 2e20 5f55 7365 7220 4775 6964     .. _User Guid
+00003ad0: 653a 2068 7474 7073 3a2f 2f64 6f63 732e  e: https://docs.
+00003ae0: 7465 6374 6f6e 2e61 692f 646f 6373 2f6d  tecton.ai/docs/m
+00003af0: 6174 6572 6961 6c69 7a69 6e67 2d66 6561  aterializing-fea
+00003b00: 7475 7265 732f 636f 6e66 6967 7572 696e  tures/configurin
+00003b10: 672d 6a6f 622d 636c 7573 7465 7273 2d76  g-job-clusters-v
+00003b20: 6961 2d6a 736f 6e23 636f 6e66 6967 7572  ia-json#configur
+00003b30: 696e 672d 6461 7461 6272 6963 6b73 2d6a  ing-databricks-j
+00003b40: 6f62 2d63 6c75 7374 6572 730a 2020 2020  ob-clusters.    
+00003b50: 2222 220a 0a20 2020 2023 2055 7365 6420  """..    # Used 
+00003b60: 666f 7220 5941 4d4c 2070 6172 7369 6e67  for YAML parsing
+00003b70: 2061 7320 6120 5079 6461 6e74 6963 2064   as a Pydantic d
+00003b80: 6973 6372 696d 696e 6174 6f72 2e0a 2020  iscriminator..  
+00003b90: 2020 6b69 6e64 3a20 4c69 7465 7261 6c5b    kind: Literal[
+00003ba0: 2244 6174 6162 7269 636b 734a 736f 6e43  "DatabricksJsonC
+00003bb0: 6c75 7374 6572 436f 6e66 6967 225d 203d  lusterConfig"] =
+00003bc0: 2022 4461 7461 6272 6963 6b73 4a73 6f6e   "DatabricksJson
+00003bd0: 436c 7573 7465 7243 6f6e 6669 6722 0a0a  ClusterConfig"..
+00003be0: 2020 2020 2320 5573 6520 6a73 6f6e 5f20      # Use json_ 
+00003bf0: 7769 7468 2061 6e20 616c 6961 7320 746f  with an alias to
+00003c00: 2061 766f 6964 2063 6f6e 666c 6963 7469   avoid conflicti
+00003c10: 6e67 2077 6974 6820 6120 5079 6461 6e74  ng with a Pydant
+00003c20: 6963 2042 6173 654d 6f64 656c 206d 6574  ic BaseModel met
+00003c30: 686f 6420 6a73 6f6e 2829 2e20 5368 6164  hod json(). Shad
+00003c40: 6f77 2074 6861 7420 6d65 7468 6f64 2077  ow that method w
+00003c50: 6974 680a 2020 2020 2320 6120 6a73 6f6e  ith.    # a json
+00003c60: 2070 726f 7065 7274 7920 736f 2074 6861   property so tha
+00003c70: 7420 6361 6c6c 6572 7320 6361 6e20 6163  t callers can ac
+00003c80: 6365 7373 2074 6865 2066 6965 6c64 2069  cess the field i
+00003c90: 6e74 7569 7469 7665 6c79 2e0a 2020 2020  ntuitively..    
+00003ca0: 6a73 6f6e 5f3a 2044 6963 745b 7374 722c  json_: Dict[str,
+00003cb0: 2041 6e79 5d20 3d20 7079 6461 6e74 6963   Any] = pydantic
+00003cc0: 5f76 312e 4669 656c 6428 616c 6961 733d  _v1.Field(alias=
+00003cd0: 226a 736f 6e22 290a 0a20 2020 2023 2041  "json")..    # A
+00003ce0: 2050 7964 616e 7469 6320 7072 652d 7661   Pydantic pre-va
+00003cf0: 6c69 6461 746f 7220 746f 2063 6f6e 7665  lidator to conve
+00003d00: 7274 206a 736f 6e20 7374 7269 6e67 7320  rt json strings 
+00003d10: 746f 2061 206e 6174 6976 6520 7079 7468  to a native pyth
+00003d20: 6f6e 206f 626a 6563 742e 0a20 2020 205f  on object..    _
+00003d30: 6a73 6f6e 5f73 7472 5f74 6f5f 6469 6374  json_str_to_dict
+00003d40: 203d 2070 7964 616e 7469 635f 7631 2e76   = pydantic_v1.v
+00003d50: 616c 6964 6174 6f72 2822 6a73 6f6e 5f22  alidator("json_"
+00003d60: 2c20 616c 6c6f 775f 7265 7573 653d 5472  , allow_reuse=Tr
+00003d70: 7565 2c20 7072 653d 5472 7565 2928 5f73  ue, pre=True)(_s
+00003d80: 7472 5f74 6f5f 6a73 6f6e 5f73 7472 7563  tr_to_json_struc
+00003d90: 7429 0a0a 2020 2020 6465 6620 5f74 6f5f  t)..    def _to_
+00003da0: 636c 7573 7465 725f 7072 6f74 6f28 7365  cluster_proto(se
+00003db0: 6c66 2920 2d3e 2066 6561 7475 7265 5f76  lf) -> feature_v
+00003dc0: 6965 775f 7062 322e 436c 7573 7465 7243  iew_pb2.ClusterC
+00003dd0: 6f6e 6669 673a 0a20 2020 2020 2020 2072  onfig:.        r
+00003de0: 6574 7572 6e20 6665 6174 7572 655f 7669  eturn feature_vi
+00003df0: 6577 5f70 6232 2e43 6c75 7374 6572 436f  ew_pb2.ClusterCo
+00003e00: 6e66 6967 286a 736f 6e5f 6461 7461 6272  nfig(json_databr
+00003e10: 6963 6b73 3d5f 746f 5f6a 736f 6e5f 636c  icks=_to_json_cl
+00003e20: 7573 7465 725f 7072 6f74 6f28 7365 6c66  uster_proto(self
+00003e30: 2e6a 736f 6e29 290a 0a20 2020 2040 7072  .json))..    @pr
+00003e40: 6f70 6572 7479 0a20 2020 2064 6566 206a  operty.    def j
+00003e50: 736f 6e28 7365 6c66 2920 2d3e 2044 6963  son(self) -> Dic
+00003e60: 745b 7374 722c 2041 6e79 5d3a 0a20 2020  t[str, Any]:.   
+00003e70: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00003e80: 2e6a 736f 6e5f 0a0a 0a63 6c61 7373 2044  .json_...class D
+00003e90: 6174 6162 7269 636b 7343 6c75 7374 6572  atabricksCluster
+00003ea0: 436f 6e66 6967 2853 7472 6963 744d 6f64  Config(StrictMod
+00003eb0: 656c 293a 0a20 2020 2022 2222 436f 6e66  el):.    """Conf
+00003ec0: 6967 7572 6174 696f 6e20 7573 6564 2074  iguration used t
+00003ed0: 6f20 7370 6563 6966 7920 6d61 7465 7269  o specify materi
+00003ee0: 616c 697a 6174 696f 6e20 636c 7573 7465  alization cluste
+00003ef0: 7220 6f70 7469 6f6e 7320 6f6e 2044 6174  r options on Dat
+00003f00: 6162 7269 636b 732e 0a0a 2020 2020 5468  abricks...    Th
+00003f10: 6973 2063 6c61 7373 2064 6573 6372 6962  is class describ
+00003f20: 6573 2074 6865 2061 7474 7269 6275 7465  es the attribute
+00003f30: 7320 6f66 2074 6865 206e 6577 2063 6c75  s of the new clu
+00003f40: 7374 6572 7320 7768 6963 6820 6172 6520  sters which are 
+00003f50: 6372 6561 7465 6420 696e 2044 6174 6162  created in Datab
+00003f60: 7269 636b 7320 6475 7269 6e67 0a20 2020  ricks during.   
+00003f70: 206d 6174 6572 6961 6c69 7a61 7469 6f6e   materialization
+00003f80: 206a 6f62 732e 2059 6f75 2063 616e 2063   jobs. You can c
+00003f90: 6f6e 6669 6775 7265 206f 7074 696f 6e73  onfigure options
+00003fa0: 206f 6620 7468 6573 6520 636c 7573 7465   of these cluste
+00003fb0: 7273 2c20 6c69 6b65 2063 6c75 7374 6572  rs, like cluster
+00003fc0: 2073 697a 6520 616e 6420 6578 7472 6120   size and extra 
+00003fd0: 7069 7020 6465 7065 6e64 656e 6369 6573  pip dependencies
+00003fe0: 2e0a 0a20 2020 203a 7061 7261 6d20 696e  ...    :param in
+00003ff0: 7374 616e 6365 5f74 7970 653a 2049 6e73  stance_type: Ins
+00004000: 7461 6e63 6520 7479 7065 2066 6f72 2074  tance type for t
+00004010: 6865 2063 6c75 7374 6572 2e20 4d75 7374  he cluster. Must
+00004020: 2062 6520 6120 7661 6c69 6420 7479 7065   be a valid type
+00004030: 2061 7320 6c69 7374 6564 2069 6e20 6874   as listed in ht
+00004040: 7470 733a 2f2f 6461 7461 6272 6963 6b73  tps://databricks
+00004050: 2e63 6f6d 2f70 726f 6475 6374 2f61 7773  .com/product/aws
+00004060: 2d70 7269 6369 6e67 2f69 6e73 7461 6e63  -pricing/instanc
+00004070: 652d 7479 7065 732e 0a20 2020 2020 2020  e-types..       
+00004080: 2041 6464 6974 696f 6e61 6c6c 792c 2047   Additionally, G
+00004090: 7261 7669 746f 6e20 696e 7374 616e 6365  raviton instance
+000040a0: 7320 7375 6368 2061 7320 7468 6520 6d36  s such as the m6
+000040b0: 6720 6661 6d69 6c79 2061 7265 206e 6f74  g family are not
+000040c0: 2073 7570 706f 7274 6564 2e20 4966 206e   supported. If n
+000040d0: 6f74 2073 7065 6369 6669 6564 2c20 6120  ot specified, a 
+000040e0: 7661 6c75 6520 6465 7465 726d 696e 6564  value determined
+000040f0: 2062 7920 7468 6520 5465 6374 6f6e 2062   by the Tecton b
+00004100: 6163 6b65 6e64 2069 7320 7573 6564 2e0a  ackend is used..
+00004110: 2020 2020 3a70 6172 616d 2069 6e73 7461      :param insta
+00004120: 6e63 655f 6176 6169 6c61 6269 6c69 7479  nce_availability
+00004130: 3a20 496e 7374 616e 6365 2061 7661 696c  : Instance avail
+00004140: 6162 696c 6974 7920 666f 7220 7468 6520  ability for the 
+00004150: 636c 7573 7465 7220 3a20 2273 706f 7422  cluster : "spot"
+00004160: 2c20 226f 6e5f 6465 6d61 6e64 222c 206f  , "on_demand", o
+00004170: 7220 2273 706f 745f 7769 7468 5f66 616c  r "spot_with_fal
+00004180: 6c62 6163 6b22 2e0a 2020 2020 2020 2020  lback"..        
+00004190: 4966 206e 6f74 2073 7065 6369 6669 6564  If not specified
+000041a0: 2c20 6465 6661 756c 7420 6973 2073 706f  , default is spo
+000041b0: 742e 0a20 2020 203a 7061 7261 6d20 6669  t..    :param fi
+000041c0: 7273 745f 6f6e 5f64 656d 616e 643a 2054  rst_on_demand: T
+000041d0: 6865 2066 6972 7374 2060 6669 7273 745f  he first `first_
+000041e0: 6f6e 5f64 656d 616e 6460 206e 6f64 6573  on_demand` nodes
+000041f0: 206f 6620 7468 6520 636c 7573 7465 7220   of the cluster 
+00004200: 7769 6c6c 2075 7365 206f 6e5f 6465 6d61  will use on_dema
+00004210: 6e64 2069 6e73 7461 6e63 6573 2e20 5468  nd instances. Th
+00004220: 6520 7265 7374 2077 696c 6c20 7573 6520  e rest will use 
+00004230: 7468 6520 7479 7065 2073 7065 6369 6669  the type specifi
+00004240: 6564 2062 7920 696e 7374 616e 6365 5f61  ed by instance_a
+00004250: 7661 696c 6162 696c 6974 792e 0a20 2020  vailability..   
+00004260: 2020 2020 2049 6620 6669 7273 745f 6f6e       If first_on
+00004270: 5f64 656d 616e 6420 3e3d 2031 2c20 7468  _demand >= 1, th
+00004280: 6520 6472 6976 6572 206e 6f64 6520 7573  e driver node us
+00004290: 6520 6f6e 5f64 656d 616e 6420 696e 7374  e on_demand inst
+000042a0: 616e 6365 2074 7970 652e 0a20 2020 203a  ance type..    :
+000042b0: 7061 7261 6d20 6e75 6d62 6572 5f6f 665f  param number_of_
+000042c0: 776f 726b 6572 733a 204e 756d 6265 7220  workers: Number 
+000042d0: 6f66 2069 6e73 7461 6e63 6573 2066 6f72  of instances for
+000042e0: 2074 6865 206d 6174 6572 6961 6c69 7a61   the materializa
+000042f0: 7469 6f6e 206a 6f62 2e20 4966 206e 6f74  tion job. If not
+00004300: 2073 7065 6369 6669 6564 2c20 6120 7661   specified, a va
+00004310: 6c75 6520 6465 7465 726d 696e 6564 2062  lue determined b
+00004320: 7920 7468 6520 5465 6374 6f6e 2062 6163  y the Tecton bac
+00004330: 6b65 6e64 2069 7320 7573 6564 2e0a 2020  kend is used..  
+00004340: 2020 2020 2020 4966 2073 6574 2074 6f20        If set to 
+00004350: 3020 7468 656e 206a 6f62 7320 7769 6c6c  0 then jobs will
+00004360: 2062 6520 7275 6e20 696e 2073 696e 676c   be run in singl
+00004370: 652d 6e6f 6465 2063 6c75 7374 6572 732e  e-node clusters.
+00004380: 0a20 2020 203a 7061 7261 6d20 6578 7472  .    :param extr
+00004390: 615f 7069 705f 6465 7065 6e64 656e 6369  a_pip_dependenci
+000043a0: 6573 3a20 4578 7472 6120 7069 7020 6465  es: Extra pip de
+000043b0: 7065 6e64 656e 6369 6573 2074 6f20 6265  pendencies to be
+000043c0: 2069 6e73 7461 6c6c 6564 206f 6e20 7468   installed on th
+000043d0: 6520 6d61 7465 7269 616c 697a 6174 696f  e materializatio
+000043e0: 6e20 636c 7573 7465 722e 204d 7573 7420  n cluster. Must 
+000043f0: 6265 2050 7950 4920 7061 636b 6167 6573  be PyPI packages
+00004400: 2c20 6f72 2077 6865 656c 732f 6567 6773  , or wheels/eggs
+00004410: 2069 6e20 5333 206f 7220 4442 4653 2e0a   in S3 or DBFS..
+00004420: 2020 2020 3a70 6172 616d 2073 7061 726b      :param spark
+00004430: 5f63 6f6e 6669 673a 204d 6170 206f 6620  _config: Map of 
+00004440: 5370 6172 6b20 636f 6e66 6967 7572 6174  Spark configurat
+00004450: 696f 6e20 6f70 7469 6f6e 7320 616e 6420  ion options and 
+00004460: 7468 6569 7220 7265 7370 6563 7469 7665  their respective
+00004470: 2076 616c 7565 7320 7468 6174 2077 696c   values that wil
+00004480: 6c20 6265 2070 6173 7365 6420 746f 2074  l be passed to t
+00004490: 6865 0a20 2020 2020 2020 2046 6561 7475  he.        Featu
+000044a0: 7265 5669 6577 206d 6174 6572 6961 6c69  reView materiali
+000044b0: 7a61 7469 6f6e 2053 7061 726b 2063 6c75  zation Spark clu
+000044c0: 7374 6572 2e0a 2020 2020 3a70 6172 616d  ster..    :param
+000044d0: 2064 6272 5f76 6572 7369 6f6e 3a20 4442   dbr_version: DB
+000044e0: 5220 7665 7273 696f 6e20 6f66 2074 6865  R version of the
+000044f0: 2063 6c75 7374 6572 2e20 5375 7070 6f72   cluster. Suppor
+00004500: 7465 6420 7665 7273 696f 6e73 2069 6e63  ted versions inc
+00004510: 6c75 6465 2039 2e31 2e78 2d73 6361 6c61  lude 9.1.x-scala
+00004520: 322e 3132 2c20 3130 2e34 2e78 2d73 6361  2.12, 10.4.x-sca
+00004530: 6c61 322e 3132 2c20 616e 6420 3131 2e33  la2.12, and 11.3
+00004540: 2e78 2d73 6361 6c61 322e 3132 2e20 2844  .x-scala2.12. (D
+00004550: 6566 6175 6c74 3a20 3130 2e34 2e78 2d73  efault: 10.4.x-s
+00004560: 6361 6c61 322e 3132 290a 0a20 2020 204e  cala2.12)..    N
+00004570: 6f74 6520 6f6e 2060 6065 7874 7261 5f70  ote on ``extra_p
+00004580: 6970 5f64 6570 656e 6465 6e63 6965 7360  ip_dependencies`
+00004590: 603a 2054 6869 7320 6973 2061 206c 6973  `: This is a lis
+000045a0: 7420 6f66 2070 6163 6b61 6765 7320 7468  t of packages th
+000045b0: 6174 2077 696c 6c20 6265 2069 6e73 7461  at will be insta
+000045c0: 6c6c 6564 2064 7572 696e 6720 6d61 7465  lled during mate
+000045d0: 7269 616c 697a 6174 696f 6e2e 0a20 2020  rialization..   
+000045e0: 2054 6f20 7573 6520 5079 5049 2070 6163   To use PyPI pac
+000045f0: 6b61 6765 732c 2073 7065 6369 6679 2074  kages, specify t
+00004600: 6865 2070 6163 6b61 6765 206e 616d 6520  he package name 
+00004610: 616e 6420 6f70 7469 6f6e 616c 6c79 2074  and optionally t
+00004620: 6865 2076 6572 7369 6f6e 2c20 652e 672e  he version, e.g.
+00004630: 2060 6022 7465 6e73 6f72 666c 6f77 2260   ``"tensorflow"`
+00004640: 6020 6f72 2060 6022 7465 6e73 6f72 666c  ` or ``"tensorfl
+00004650: 6f77 3d3d 322e 322e 3022 6060 2e0a 2020  ow==2.2.0"``..  
+00004660: 2020 546f 2075 7365 2063 7573 746f 6d20    To use custom 
+00004670: 636f 6465 2c20 7061 636b 6167 6520 6974  code, package it
+00004680: 2061 7320 6120 5079 7468 6f6e 2077 6865   as a Python whe
+00004690: 656c 206f 7220 6567 6720 6669 6c65 2069  el or egg file i
+000046a0: 6e20 5333 206f 7220 4442 4653 2c20 7468  n S3 or DBFS, th
+000046b0: 656e 2073 7065 6369 6679 2074 6865 2070  en specify the p
+000046c0: 6174 6820 746f 2074 6865 2066 696c 652c  ath to the file,
+000046d0: 0a20 2020 2065 2e67 2e20 6060 2273 333a  .    e.g. ``"s3:
+000046e0: 2f2f 6d79 2d62 7563 6b65 742f 7061 7468  //my-bucket/path
+000046f0: 2f63 7573 746f 6d2e 7768 6c22 6060 2c20  /custom.whl"``, 
+00004700: 6f72 2060 6022 6462 6673 3a2f 7061 7468  or ``"dbfs:/path
+00004710: 2f74 6f2f 6375 7374 6f6d 2e77 686c 2260  /to/custom.whl"`
+00004720: 602e 0a0a 2020 2020 5468 6573 6520 6c69  `...    These li
+00004730: 6272 6172 6965 7320 7769 6c6c 206f 6e6c  braries will onl
+00004740: 7920 6265 2061 7661 696c 6162 6c65 2074  y be available t
+00004750: 6f20 7573 6520 696e 7369 6465 2053 7061  o use inside Spa
+00004760: 726b 2055 4446 732e 2046 6f72 2065 7861  rk UDFs. For exa
+00004770: 6d70 6c65 2c20 6966 2079 6f75 2073 6574  mple, if you set
+00004780: 0a20 2020 2060 6065 7874 7261 5f70 6970  .    ``extra_pip
+00004790: 5f64 6570 656e 6465 6e63 6965 733d 5b22  _dependencies=["
+000047a0: 7465 6e73 6f72 666c 6f77 225d 6060 2c20  tensorflow"]``, 
+000047b0: 796f 7520 6361 6e20 7573 6520 6974 2069  you can use it i
+000047c0: 6e20 796f 7572 2074 7261 6e73 666f 726d  n your transform
+000047d0: 6174 696f 6e20 6173 2073 686f 776e 2062  ation as shown b
+000047e0: 656c 6f77 2e0a 0a20 2020 2041 6e20 6578  elow...    An ex
+000047f0: 616d 706c 6520 6f66 2044 6174 6162 7269  ample of Databri
+00004800: 636b 7343 6c75 7374 6572 436f 6e66 6967  cksClusterConfig
+00004810: 2e0a 0a20 2020 202e 2e20 636f 6465 2d62  ...    .. code-b
+00004820: 6c6f 636b 3a3a 2070 7974 686f 6e0a 0a20  lock:: python.. 
+00004830: 2020 2020 2020 2066 726f 6d20 7465 6374         from tect
+00004840: 6f6e 2069 6d70 6f72 7420 6261 7463 685f  on import batch_
+00004850: 6665 6174 7572 655f 7669 6577 2c20 496e  feature_view, In
+00004860: 7075 742c 2044 6174 6162 7269 636b 7343  put, DatabricksC
+00004870: 6c75 7374 6572 436f 6e66 6967 0a0a 2020  lusterConfig..  
+00004880: 2020 2020 2020 4062 6174 6368 5f66 6561        @batch_fea
+00004890: 7475 7265 5f76 6965 7728 0a20 2020 2020  ture_view(.     
+000048a0: 2020 2020 2020 2073 6f75 7263 6573 3d5b         sources=[
+000048b0: 4669 6c74 6572 6564 536f 7572 6365 2863  FilteredSource(c
+000048c0: 7265 6469 745f 7363 6f72 6573 5f62 6174  redit_scores_bat
+000048d0: 6368 295d 2c0a 2020 2020 2020 2020 2020  ch)],.          
+000048e0: 2020 2320 4361 6e20 6265 2061 6e20 6172    # Can be an ar
+000048f0: 6775 6d65 6e74 2069 6e73 7461 6e63 6520  gument instance 
+00004900: 746f 2061 2062 6174 6368 2066 6561 7475  to a batch featu
+00004910: 7265 2076 6965 7720 6465 636f 7261 746f  re view decorato
+00004920: 720a 2020 2020 2020 2020 2020 2020 6261  r.            ba
+00004930: 7463 685f 636f 6d70 7574 6520 3d20 4461  tch_compute = Da
+00004940: 7461 6272 6963 6b73 436c 7573 7465 7243  tabricksClusterC
+00004950: 6f6e 6669 6728 0a20 2020 2020 2020 2020  onfig(.         
+00004960: 2020 2020 2020 2069 6e73 7461 6e63 655f         instance_
+00004970: 7479 7065 203d 2027 6d35 2e32 786c 6172  type = 'm5.2xlar
+00004980: 6765 272c 0a20 2020 2020 2020 2020 2020  ge',.           
+00004990: 2020 2020 2073 7061 726b 5f63 6f6e 6669       spark_confi
+000049a0: 6720 3d20 7b22 7370 6172 6b2e 6578 6563  g = {"spark.exec
+000049b0: 7574 6f72 2e6d 656d 6f72 7922 203a 2022  utor.memory" : "
+000049c0: 3132 6722 7d0a 2020 2020 2020 2020 2020  12g"}.          
+000049d0: 2020 2020 2020 6578 7472 615f 7069 705f        extra_pip_
+000049e0: 6465 7065 6e64 656e 6369 6573 3d5b 2274  dependencies=["t
+000049f0: 656e 736f 7266 6c6f 7722 5d2c 0a20 2020  ensorflow"],.   
+00004a00: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
+00004a10: 2020 2020 2020 2020 2320 4f74 6865 7220          # Other 
+00004a20: 6e61 6d65 6420 6172 6775 6d65 6e74 7320  named arguments 
+00004a30: 746f 2062 6174 6368 2066 6561 7475 7265  to batch feature
+00004a40: 2076 6965 770a 2020 2020 2020 2020 2020   view.          
+00004a50: 2020 2e2e 2e0a 2020 2020 2020 2020 290a    ....        ).
+00004a60: 0a20 2020 2020 2020 2023 2055 7365 2074  .        # Use t
+00004a70: 6865 2074 656e 736f 7266 6c6f 7720 7061  he tensorflow pa
+00004a80: 636b 6167 6520 696e 2074 6865 2055 4446  ckage in the UDF
+00004a90: 2073 696e 6365 2074 656e 736f 7266 6c6f   since tensorflo
+00004aa0: 7720 7769 6c6c 2062 6520 696e 7374 616c  w will be instal
+00004ab0: 6c65 640a 2020 2020 2020 2020 2320 6f6e  led.        # on
+00004ac0: 2074 6865 2044 6174 6162 7269 636b 7320   the Databricks 
+00004ad0: 5370 6172 6b20 636c 7573 7465 722e 2054  Spark cluster. T
+00004ae0: 6865 2069 6d70 6f72 7420 6861 7320 746f  he import has to
+00004af0: 2062 6520 7769 7468 696e 2074 6865 2055   be within the U
+00004b00: 4446 2062 6f64 792e 2050 7574 7469 6e67  DF body. Putting
+00004b10: 2069 7420 6174 2074 6865 0a20 2020 2020   it at the.     
+00004b20: 2020 2023 2074 6f70 206f 6620 7468 6520     # top of the 
+00004b30: 6669 6c65 206f 7220 696e 7369 6465 2074  file or inside t
+00004b40: 7261 6e73 666f 726d 6174 696f 6e20 6675  ransformation fu
+00004b50: 6e63 7469 6f6e 2077 6f6e 2774 2077 6f72  nction won't wor
+00004b60: 6b2e 0a0a 2020 2020 2020 2020 4074 7261  k...        @tra
+00004b70: 6e73 666f 726d 6174 696f 6e28 6d6f 6465  nsformation(mode
+00004b80: 3d27 7079 7370 6172 6b27 290a 2020 2020  ='pyspark').    
+00004b90: 2020 2020 6465 6620 7465 7374 5f74 7261      def test_tra
+00004ba0: 6e73 666f 726d 6174 696f 6e28 7472 616e  nsformation(tran
+00004bb0: 7366 6f72 6d61 7469 6f6e 5f69 6e70 7574  sformation_input
+00004bc0: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
+00004bd0: 726f 6d20 7079 7370 6172 6b2e 7371 6c20  rom pyspark.sql 
+00004be0: 696d 706f 7274 2066 756e 6374 696f 6e73  import functions
+00004bf0: 2061 7320 460a 2020 2020 2020 2020 2020   as F.          
+00004c00: 2020 6672 6f6d 2070 7973 7061 726b 2e73    from pyspark.s
+00004c10: 716c 2e74 7970 6573 2069 6d70 6f72 7420  ql.types import 
+00004c20: 496e 7465 6765 7254 7970 650a 0a20 2020  IntegerType..   
+00004c30: 2020 2020 2020 2020 2064 6566 206d 795f           def my_
+00004c40: 7465 6e73 6f72 666c 6f77 2878 293a 0a20  tensorflow(x):. 
+00004c50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00004c60: 6d70 6f72 7420 7465 6e73 6f72 666c 6f77  mport tensorflow
+00004c70: 2061 7320 7466 0a20 2020 2020 2020 2020   as tf.         
+00004c80: 2020 2020 2020 2072 6574 7572 6e20 696e         return in
+00004c90: 7428 7466 2e6d 6174 682e 6c6f 6731 7028  t(tf.math.log1p(
+00004ca0: 666c 6f61 7428 7829 292e 6e75 6d70 7928  float(x)).numpy(
+00004cb0: 2929 0a0a 2020 2020 2020 2020 2020 2020  ))..            
+00004cc0: 6d79 5f74 656e 736f 7266 6c6f 775f 7564  my_tensorflow_ud
+00004cd0: 6620 3d20 462e 7564 6628 6d79 5f74 656e  f = F.udf(my_ten
+00004ce0: 736f 7266 6c6f 772c 2049 6e74 6567 6572  sorflow, Integer
+00004cf0: 5479 7065 2829 290a 0a20 2020 2020 2020  Type())..       
+00004d00: 2020 2020 2072 6574 7572 6e20 7472 616e       return tran
+00004d10: 7366 6f72 6d61 7469 6f6e 5f69 6e70 7574  sformation_input
+00004d20: 2e73 656c 6563 7428 0a20 2020 2020 2020  .select(.       
+00004d30: 2020 2020 2020 2020 2027 656e 7469 7479           'entity
+00004d40: 5f69 6427 2c0a 2020 2020 2020 2020 2020  _id',.          
+00004d50: 2020 2020 2020 2774 696d 6573 7461 6d70        'timestamp
+00004d60: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+00004d70: 2020 206d 795f 7465 6e73 6f72 666c 6f77     my_tensorflow
+00004d80: 5f75 6466 2827 636c 6963 6b73 2729 2e61  _udf('clicks').a
+00004d90: 6c69 6173 2827 6c6f 6731 705f 636c 6963  lias('log1p_clic
+00004da0: 6b73 2729 0a20 2020 2020 2020 2020 2020  ks').           
+00004db0: 2029 0a0a 2020 2020 2222 220a 0a20 2020   )..    """..   
+00004dc0: 2023 2055 7365 6420 666f 7220 5941 4d4c   # Used for YAML
+00004dd0: 2070 6172 7369 6e67 2061 7320 6120 5079   parsing as a Py
+00004de0: 6461 6e74 6963 2064 6973 6372 696d 696e  dantic discrimin
+00004df0: 6174 6f72 2e0a 2020 2020 6b69 6e64 3a20  ator..    kind: 
+00004e00: 4c69 7465 7261 6c5b 2244 6174 6162 7269  Literal["Databri
+00004e10: 636b 7343 6c75 7374 6572 436f 6e66 6967  cksClusterConfig
+00004e20: 225d 203d 2022 4461 7461 6272 6963 6b73  "] = "Databricks
+00004e30: 436c 7573 7465 7243 6f6e 6669 6722 0a20  ClusterConfig". 
+00004e40: 2020 2069 6e73 7461 6e63 655f 7479 7065     instance_type
+00004e50: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+00004e60: 3d20 4e6f 6e65 0a20 2020 2069 6e73 7461  = None.    insta
+00004e70: 6e63 655f 6176 6169 6c61 6269 6c69 7479  nce_availability
+00004e80: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+00004e90: 3d20 4e6f 6e65 0a20 2020 206e 756d 6265  = None.    numbe
+00004ea0: 725f 6f66 5f77 6f72 6b65 7273 3a20 4f70  r_of_workers: Op
+00004eb0: 7469 6f6e 616c 5b69 6e74 5d20 3d20 4e6f  tional[int] = No
+00004ec0: 6e65 0a20 2020 2066 6972 7374 5f6f 6e5f  ne.    first_on_
+00004ed0: 6465 6d61 6e64 3a20 4f70 7469 6f6e 616c  demand: Optional
+00004ee0: 5b69 6e74 5d20 3d20 4e6f 6e65 0a20 2020  [int] = None.   
+00004ef0: 2065 7874 7261 5f70 6970 5f64 6570 656e   extra_pip_depen
+00004f00: 6465 6e63 6965 733a 204f 7074 696f 6e61  dencies: Optiona
+00004f10: 6c5b 4c69 7374 5b73 7472 5d5d 203d 204e  l[List[str]] = N
+00004f20: 6f6e 650a 2020 2020 7370 6172 6b5f 636f  one.    spark_co
+00004f30: 6e66 6967 3a20 4f70 7469 6f6e 616c 5b44  nfig: Optional[D
+00004f40: 6963 745b 7374 722c 2073 7472 5d5d 203d  ict[str, str]] =
+00004f50: 204e 6f6e 650a 2020 2020 6462 725f 7665   None.    dbr_ve
+00004f60: 7273 696f 6e3a 2073 7472 203d 2044 4546  rsion: str = DEF
+00004f70: 4155 4c54 5f53 5041 524b 5f56 4552 5349  AULT_SPARK_VERSI
+00004f80: 4f4e 535b 2264 6174 6162 7269 636b 735f  ONS["databricks_
+00004f90: 7370 6172 6b5f 7665 7273 696f 6e22 5d0a  spark_version"].
+00004fa0: 0a20 2020 2064 6566 205f 746f 5f70 726f  .    def _to_pro
+00004fb0: 746f 2873 656c 6629 202d 3e20 6665 6174  to(self) -> feat
+00004fc0: 7572 655f 7669 6577 5f70 6232 2e4e 6577  ure_view_pb2.New
+00004fd0: 436c 7573 7465 7243 6f6e 6669 673a 0a20  ClusterConfig:. 
+00004fe0: 2020 2020 2020 2070 726f 746f 203d 2066         proto = f
+00004ff0: 6561 7475 7265 5f76 6965 775f 7062 322e  eature_view_pb2.
+00005000: 4e65 7743 6c75 7374 6572 436f 6e66 6967  NewClusterConfig
+00005010: 2829 0a20 2020 2020 2020 2069 6620 7365  ().        if se
+00005020: 6c66 2e69 6e73 7461 6e63 655f 7479 7065  lf.instance_type
+00005030: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
+00005040: 6f74 6f2e 696e 7374 616e 6365 5f74 7970  oto.instance_typ
+00005050: 6520 3d20 7365 6c66 2e69 6e73 7461 6e63  e = self.instanc
+00005060: 655f 7479 7065 0a20 2020 2020 2020 2069  e_type.        i
+00005070: 6620 7365 6c66 2e69 6e73 7461 6e63 655f  f self.instance_
+00005080: 6176 6169 6c61 6269 6c69 7479 3a0a 2020  availability:.  
+00005090: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+000050a0: 662e 696e 7374 616e 6365 5f61 7661 696c  f.instance_avail
+000050b0: 6162 696c 6974 7920 6e6f 7420 696e 2044  ability not in D
+000050c0: 4154 4142 5249 434b 535f 5355 5050 4f52  ATABRICKS_SUPPOR
+000050d0: 5445 445f 4156 4149 4c41 4249 4c49 5459  TED_AVAILABILITY
+000050e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000050f0: 2020 6d73 6720 3d20 6622 496e 7374 616e    msg = f"Instan
+00005100: 6365 2061 7661 696c 6162 696c 6974 7920  ce availability 
+00005110: 7b73 656c 662e 696e 7374 616e 6365 5f61  {self.instance_a
+00005120: 7661 696c 6162 696c 6974 797d 2069 7320  vailability} is 
+00005130: 6e6f 7420 7375 7070 6f72 7465 642e 2043  not supported. C
+00005140: 686f 6f73 6520 7b41 5641 494c 4142 494c  hoose {AVAILABIL
+00005150: 4954 595f 5350 4f54 7d2c 207b 4156 4149  ITY_SPOT}, {AVAI
+00005160: 4c41 4249 4c49 5459 5f4f 4e5f 4445 4d41  LABILITY_ON_DEMA
+00005170: 4e44 7d20 6f72 207b 4156 4149 4c41 4249  ND} or {AVAILABI
+00005180: 4c49 5459 5f53 504f 545f 4641 4c4c 4241  LITY_SPOT_FALLBA
+00005190: 434b 7d22 0a20 2020 2020 2020 2020 2020  CK}".           
+000051a0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+000051b0: 4572 726f 7228 6d73 6729 0a20 2020 2020  Error(msg).     
+000051c0: 2020 2020 2020 2070 726f 746f 2e69 6e73         proto.ins
+000051d0: 7461 6e63 655f 6176 6169 6c61 6269 6c69  tance_availabili
+000051e0: 7479 203d 2073 656c 662e 696e 7374 616e  ty = self.instan
+000051f0: 6365 5f61 7661 696c 6162 696c 6974 790a  ce_availability.
+00005200: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00005210: 6462 725f 7665 7273 696f 6e20 6e6f 7420  dbr_version not 
+00005220: 696e 2044 4154 4142 5249 434b 535f 5355  in DATABRICKS_SU
+00005230: 5050 4f52 5445 445f 5350 4152 4b3a 0a20  PPORTED_SPARK:. 
+00005240: 2020 2020 2020 2020 2020 206d 7367 203d             msg =
+00005250: 2066 2244 6174 6162 7269 636b 7320 7665   f"Databricks ve
+00005260: 7273 696f 6e20 7b73 656c 662e 6462 725f  rsion {self.dbr_
+00005270: 7665 7273 696f 6e7d 2069 7320 6e6f 7420  version} is not 
+00005280: 7375 7070 6f72 7465 642e 2053 7570 706f  supported. Suppo
+00005290: 7274 6564 2076 6572 7369 6f6e 733a 207b  rted versions: {
+000052a0: 4441 5441 4252 4943 4b53 5f53 5550 504f  DATABRICKS_SUPPO
+000052b0: 5254 4544 5f53 5041 524b 7d22 0a20 2020  RTED_SPARK}".   
+000052c0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+000052d0: 616c 7565 4572 726f 7228 6d73 6729 0a0a  alueError(msg)..
+000052e0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+000052f0: 6e75 6d62 6572 5f6f 665f 776f 726b 6572  number_of_worker
+00005300: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
+00005310: 2020 2020 2020 2020 2020 2070 726f 746f             proto
+00005320: 2e6e 756d 6265 725f 6f66 5f77 6f72 6b65  .number_of_worke
+00005330: 7273 203d 2073 656c 662e 6e75 6d62 6572  rs = self.number
+00005340: 5f6f 665f 776f 726b 6572 730a 2020 2020  _of_workers.    
+00005350: 2020 2020 6966 2073 656c 662e 6669 7273      if self.firs
+00005360: 745f 6f6e 5f64 656d 616e 643a 0a20 2020  t_on_demand:.   
+00005370: 2020 2020 2020 2020 2070 726f 746f 2e66           proto.f
+00005380: 6972 7374 5f6f 6e5f 6465 6d61 6e64 203d  irst_on_demand =
+00005390: 2073 656c 662e 6669 7273 745f 6f6e 5f64   self.first_on_d
+000053a0: 656d 616e 640a 2020 2020 2020 2020 6966  emand.        if
+000053b0: 2073 656c 662e 6578 7472 615f 7069 705f   self.extra_pip_
+000053c0: 6465 7065 6e64 656e 6369 6573 3a0a 2020  dependencies:.  
+000053d0: 2020 2020 2020 2020 2020 2320 5072 6574            # Pret
+000053e0: 7479 2065 6173 7920 746f 2064 6f20 652e  ty easy to do e.
+000053f0: 672e 2065 7874 7261 5f70 6970 5f64 6570  g. extra_pip_dep
+00005400: 656e 6465 6e63 6965 733d 2274 656e 736f  endencies="tenso
+00005410: 7266 6c6f 7722 2062 7920 6d69 7374 616b  rflow" by mistak
+00005420: 6520 616e 6420 656e 6420 7570 2077 6974  e and end up wit
+00005430: 680a 2020 2020 2020 2020 2020 2020 2320  h.            # 
+00005440: 5b74 2c20 652c 206e 2c20 732c 206f 2c20  [t, e, n, s, o, 
+00005450: 722c 2066 2c20 6c2c 206f 2c20 775d 2061  r, f, l, o, w] a
+00005460: 7320 6120 6c69 7374 206f 6620 6465 7065  s a list of depe
+00005470: 6e64 656e 6369 6573 2070 6173 7365 6420  ndencies passed 
+00005480: 746f 2074 6865 2053 7061 726b 206a 6f62  to the Spark job
+00005490: 2e0a 2020 2020 2020 2020 2020 2020 230a  ..            #.
+000054a0: 2020 2020 2020 2020 2020 2020 2320 5369              # Si
+000054b0: 6e63 6520 7468 6973 2069 7320 616e 6e6f  nce this is anno
+000054c0: 7969 6e67 2074 6f20 6465 6275 672c 2077  ying to debug, w
+000054d0: 6520 6368 6563 6b20 666f 7220 7468 6174  e check for that
+000054e0: 2068 6572 652e 0a20 2020 2020 2020 2020   here..         
+000054f0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00005500: 2873 656c 662e 6578 7472 615f 7069 705f  (self.extra_pip_
+00005510: 6465 7065 6e64 656e 6369 6573 2c20 7374  dependencies, st
+00005520: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+00005530: 2020 2020 6d73 6720 3d20 2265 7874 7261      msg = "extra
+00005540: 5f70 6970 5f64 6570 656e 6465 6e63 6965  _pip_dependencie
+00005550: 7320 6d75 7374 2062 6520 6120 6c69 7374  s must be a list
+00005560: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00005570: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00005580: 6f72 286d 7367 290a 2020 2020 2020 2020  or(msg).        
+00005590: 2020 2020 7072 6f74 6f2e 6578 7472 615f      proto.extra_
+000055a0: 7069 705f 6465 7065 6e64 656e 6369 6573  pip_dependencies
+000055b0: 2e65 7874 656e 6428 7365 6c66 2e65 7874  .extend(self.ext
+000055c0: 7261 5f70 6970 5f64 6570 656e 6465 6e63  ra_pip_dependenc
+000055d0: 6965 7329 0a20 2020 2020 2020 2069 6620  ies).        if 
+000055e0: 7365 6c66 2e73 7061 726b 5f63 6f6e 6669  self.spark_confi
+000055f0: 673a 0a20 2020 2020 2020 2020 2020 2073  g:.            s
+00005600: 7061 726b 5f63 6f6e 6669 6720 3d20 5370  park_config = Sp
+00005610: 6172 6b43 6f6e 6669 6757 7261 7070 6572  arkConfigWrapper
+00005620: 2873 7061 726b 5f63 6f6e 6669 675f 6d61  (spark_config_ma
+00005630: 703d 7365 6c66 2e73 7061 726b 5f63 6f6e  p=self.spark_con
+00005640: 6669 6729 2e5f 746f 5f70 726f 746f 2829  fig)._to_proto()
+00005650: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
+00005660: 746f 2e73 7061 726b 5f63 6f6e 6669 672e  to.spark_config.
+00005670: 436f 7079 4672 6f6d 2873 7061 726b 5f63  CopyFrom(spark_c
+00005680: 6f6e 6669 6729 0a20 2020 2020 2020 2070  onfig).        p
+00005690: 726f 746f 2e70 696e 6e65 645f 7370 6172  roto.pinned_spar
+000056a0: 6b5f 7665 7273 696f 6e20 3d20 7365 6c66  k_version = self
+000056b0: 2e64 6272 5f76 6572 7369 6f6e 0a0a 2020  .dbr_version..  
+000056c0: 2020 2020 2020 7265 7475 726e 2070 726f        return pro
+000056d0: 746f 0a0a 2020 2020 6465 6620 5f74 6f5f  to..    def _to_
+000056e0: 636c 7573 7465 725f 7072 6f74 6f28 7365  cluster_proto(se
+000056f0: 6c66 2920 2d3e 2066 6561 7475 7265 5f76  lf) -> feature_v
+00005700: 6965 775f 7062 322e 436c 7573 7465 7243  iew_pb2.ClusterC
+00005710: 6f6e 6669 673a 0a20 2020 2020 2020 2072  onfig:.        r
+00005720: 6574 7572 6e20 6665 6174 7572 655f 7669  eturn feature_vi
+00005730: 6577 5f70 6232 2e43 6c75 7374 6572 436f  ew_pb2.ClusterCo
+00005740: 6e66 6967 286e 6577 5f64 6174 6162 7269  nfig(new_databri
+00005750: 636b 733d 7365 6c66 2e5f 746f 5f70 726f  cks=self._to_pro
+00005760: 746f 2829 290a 0a0a 636c 6173 7320 5269  to())...class Ri
+00005770: 6674 4261 7463 6843 6f6e 6669 6728 5374  ftBatchConfig(St
+00005780: 7269 6374 4d6f 6465 6c29 3a0a 2020 2020  rictModel):.    
+00005790: 2222 2243 6f6e 6669 6775 7261 7469 6f6e  """Configuration
+000057a0: 2075 7365 6420 746f 2073 7065 6369 6679   used to specify
+000057b0: 206d 6174 6572 6961 6c69 7a61 7469 6f6e   materialization
+000057c0: 2063 6f6d 7075 7465 206f 7074 696f 6e73   compute options
+000057d0: 206f 6e20 5269 6674 2e0a 0a20 2020 203a   on Rift...    :
+000057e0: 7061 7261 6d20 696e 7374 616e 6365 5f74  param instance_t
+000057f0: 7970 653a 2049 6e73 7461 6e63 6520 7479  ype: Instance ty
+00005800: 7065 2066 6f72 2074 6865 206d 6174 6572  pe for the mater
+00005810: 6961 6c69 7a61 7469 6f6e 206a 6f62 2e20  ialization job. 
+00005820: 4d75 7374 2062 6520 6120 7661 6c69 6420  Must be a valid 
+00005830: 4543 3220 696e 7374 616e 6365 2074 7970  EC2 instance typ
+00005840: 6520 6173 206c 6973 7465 6420 696e 0a20  e as listed in. 
+00005850: 2020 2020 2020 2068 7474 7073 3a2f 2f61         https://a
+00005860: 7773 2e61 6d61 7a6f 6e2e 636f 6d2f 6563  ws.amazon.com/ec
+00005870: 322f 696e 7374 616e 6365 2d74 7970 6573  2/instance-types
+00005880: 2f2e 2049 6620 6e6f 7420 7370 6563 6966  /. If not specif
+00005890: 6965 642c 2061 2076 616c 7565 2064 6574  ied, a value det
+000058a0: 6572 6d69 6e65 6420 6279 2074 6865 2054  ermined by the T
+000058b0: 6563 746f 6e20 6261 636b 656e 6420 6973  ecton backend is
+000058c0: 2075 7365 642e 0a20 2020 2022 2222 0a0a   used..    """..
+000058d0: 2020 2020 2320 5573 6564 2066 6f72 2059      # Used for Y
+000058e0: 414d 4c20 7061 7273 696e 6720 6173 2061  AML parsing as a
+000058f0: 2050 7964 616e 7469 6320 6469 7363 7269   Pydantic discri
+00005900: 6d69 6e61 746f 722e 0a20 2020 206b 696e  minator..    kin
+00005910: 643a 204c 6974 6572 616c 5b22 5269 6674  d: Literal["Rift
+00005920: 4261 7463 6843 6f6e 6669 6722 5d20 3d20  BatchConfig"] = 
+00005930: 2252 6966 7442 6174 6368 436f 6e66 6967  "RiftBatchConfig
+00005940: 220a 2020 2020 696e 7374 616e 6365 5f74  ".    instance_t
+00005950: 7970 653a 204f 7074 696f 6e61 6c5b 7374  ype: Optional[st
+00005960: 725d 203d 204e 6f6e 650a 0a20 2020 2064  r] = None..    d
+00005970: 6566 205f 746f 5f70 726f 746f 2873 656c  ef _to_proto(sel
+00005980: 6629 202d 3e20 6665 6174 7572 655f 7669  f) -> feature_vi
+00005990: 6577 5f70 6232 2e52 6966 7443 6c75 7374  ew_pb2.RiftClust
+000059a0: 6572 436f 6e66 6967 3a0a 2020 2020 2020  erConfig:.      
+000059b0: 2020 7072 6f74 6f20 3d20 6665 6174 7572    proto = featur
+000059c0: 655f 7669 6577 5f70 6232 2e52 6966 7443  e_view_pb2.RiftC
+000059d0: 6c75 7374 6572 436f 6e66 6967 2829 0a20  lusterConfig(). 
+000059e0: 2020 2020 2020 2069 6620 7365 6c66 2e69         if self.i
+000059f0: 6e73 7461 6e63 655f 7479 7065 3a0a 2020  nstance_type:.  
+00005a00: 2020 2020 2020 2020 2020 7072 6f74 6f2e            proto.
+00005a10: 696e 7374 616e 6365 5f74 7970 6520 3d20  instance_type = 
+00005a20: 7365 6c66 2e69 6e73 7461 6e63 655f 7479  self.instance_ty
+00005a30: 7065 0a0a 2020 2020 2020 2020 7265 7475  pe..        retu
+00005a40: 726e 2070 726f 746f 0a0a 2020 2020 6465  rn proto..    de
+00005a50: 6620 5f74 6f5f 636c 7573 7465 725f 7072  f _to_cluster_pr
+00005a60: 6f74 6f28 7365 6c66 2920 2d3e 2066 6561  oto(self) -> fea
+00005a70: 7475 7265 5f76 6965 775f 7062 322e 436c  ture_view_pb2.Cl
+00005a80: 7573 7465 7243 6f6e 6669 673a 0a20 2020  usterConfig:.   
+00005a90: 2020 2020 2072 6574 7572 6e20 6665 6174       return feat
+00005aa0: 7572 655f 7669 6577 5f70 6232 2e43 6c75  ure_view_pb2.Clu
+00005ab0: 7374 6572 436f 6e66 6967 2872 6966 743d  sterConfig(rift=
+00005ac0: 7365 6c66 2e5f 746f 5f70 726f 746f 2829  self._to_proto()
+00005ad0: 290a 0a0a 636c 6173 7320 5370 6172 6b43  )...class SparkC
+00005ae0: 6f6e 6669 6757 7261 7070 6572 2853 7472  onfigWrapper(Str
+00005af0: 6963 744d 6f64 656c 293a 0a20 2020 2073  ictModel):.    s
+00005b00: 7061 726b 5f63 6f6e 6669 675f 6d61 703a  park_config_map:
+00005b10: 2044 6963 745b 7374 722c 2073 7472 5d0a   Dict[str, str].
+00005b20: 0a20 2020 2048 4152 4443 4f44 4544 5f4f  .    HARDCODED_O
+00005b30: 5054 533a 2043 6c61 7373 5661 725b 4469  PTS: ClassVar[Di
+00005b40: 6374 5b73 7472 2c20 7374 725d 5d20 3d20  ct[str, str]] = 
+00005b50: 7b0a 2020 2020 2020 2020 2273 7061 726b  {.        "spark
+00005b60: 2e64 7269 7665 722e 6d65 6d6f 7279 223a  .driver.memory":
+00005b70: 2022 7370 6172 6b5f 6472 6976 6572 5f6d   "spark_driver_m
+00005b80: 656d 6f72 7922 2c0a 2020 2020 2020 2020  emory",.        
+00005b90: 2273 7061 726b 2e65 7865 6375 746f 722e  "spark.executor.
+00005ba0: 6d65 6d6f 7279 223a 2022 7370 6172 6b5f  memory": "spark_
+00005bb0: 6578 6563 7574 6f72 5f6d 656d 6f72 7922  executor_memory"
+00005bc0: 2c0a 2020 2020 2020 2020 2273 7061 726b  ,.        "spark
+00005bd0: 2e64 7269 7665 722e 6d65 6d6f 7279 4f76  .driver.memoryOv
+00005be0: 6572 6865 6164 223a 2022 7370 6172 6b5f  erhead": "spark_
+00005bf0: 6472 6976 6572 5f6d 656d 6f72 795f 6f76  driver_memory_ov
+00005c00: 6572 6865 6164 222c 0a20 2020 2020 2020  erhead",.       
+00005c10: 2022 7370 6172 6b2e 6578 6563 7574 6f72   "spark.executor
+00005c20: 2e6d 656d 6f72 794f 7665 7268 6561 6422  .memoryOverhead"
+00005c30: 3a20 2273 7061 726b 5f65 7865 6375 746f  : "spark_executo
+00005c40: 725f 6d65 6d6f 7279 5f6f 7665 7268 6561  r_memory_overhea
+00005c50: 6422 2c0a 2020 2020 7d0a 0a20 2020 2064  d",.    }..    d
+00005c60: 6566 205f 746f 5f70 726f 746f 2873 656c  ef _to_proto(sel
+00005c70: 6629 3a0a 2020 2020 2020 2020 7072 6f74  f):.        prot
+00005c80: 6f20 3d20 6665 6174 7572 655f 7669 6577  o = feature_view
+00005c90: 5f70 6232 2e53 7061 726b 436f 6e66 6967  _pb2.SparkConfig
+00005ca0: 2829 0a20 2020 2020 2020 2066 6f72 206f  ().        for o
+00005cb0: 7074 2c20 7661 6c20 696e 2073 656c 662e  pt, val in self.
+00005cc0: 7370 6172 6b5f 636f 6e66 6967 5f6d 6170  spark_config_map
+00005cd0: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
+00005ce0: 2020 2020 2020 6966 206f 7074 2069 6e20        if opt in 
+00005cf0: 7365 6c66 2e48 4152 4443 4f44 4544 5f4f  self.HARDCODED_O
+00005d00: 5054 533a 0a20 2020 2020 2020 2020 2020  PTS:.           
+00005d10: 2020 2020 2073 6574 6174 7472 2870 726f       setattr(pro
+00005d20: 746f 2c20 7365 6c66 2e48 4152 4443 4f44  to, self.HARDCOD
+00005d30: 4544 5f4f 5054 535b 6f70 745d 2c20 7661  ED_OPTS[opt], va
+00005d40: 6c29 0a20 2020 2020 2020 2020 2020 2065  l).            e
+00005d50: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00005d60: 2020 2020 2070 726f 746f 2e73 7061 726b       proto.spark
+00005d70: 5f63 6f6e 665b 6f70 745d 203d 2076 616c  _conf[opt] = val
+00005d80: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00005d90: 2070 726f 746f 0a0a 0a63 6c61 7373 2053   proto...class S
+00005da0: 6563 7265 7428 5374 7269 6374 4d6f 6465  ecret(StrictMode
+00005db0: 6c29 3a0a 2020 2020 2222 2241 2072 6566  l):.    """A ref
+00005dc0: 6572 656e 6365 2074 6f20 6120 7365 6372  erence to a secr
+00005dd0: 6574 2066 6f72 2075 7365 2069 6e20 5465  et for use in Te
+00005de0: 6374 6f6e 206f 626a 6563 7420 6465 6669  cton object defi
+00005df0: 6e69 7469 6f6e 732e 0a0a 2020 2020 3a70  nitions...    :p
+00005e00: 6172 616d 2073 636f 7065 3a20 5468 6520  aram scope: The 
+00005e10: 7363 6f70 6520 6f66 2074 6865 2073 6563  scope of the sec
+00005e20: 7265 742c 2073 7065 6369 6679 696e 6720  ret, specifying 
+00005e30: 6974 7320 646f 6d61 696e 206f 7220 6361  its domain or ca
+00005e40: 7465 676f 7279 2e0a 2020 2020 3a70 6172  tegory..    :par
+00005e50: 616d 206b 6579 3a20 5468 6520 6b65 7920  am key: The key 
+00005e60: 6f66 2074 6865 2073 6563 7265 742c 2075  of the secret, u
+00005e70: 6e69 7175 656c 7920 6964 656e 7469 6679  niquely identify
+00005e80: 696e 6720 7769 7468 696e 2069 7473 2073  ing within its s
+00005e90: 636f 7065 2e0a 2020 2020 2222 220a 0a20  cope..    """.. 
+00005ea0: 2020 2073 636f 7065 3a20 7374 720a 2020     scope: str.  
+00005eb0: 2020 6b65 793a 2073 7472 0a0a 2020 2020    key: str..    
+00005ec0: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+00005ed0: 662c 2073 636f 7065 3a20 7374 722c 206b  f, scope: str, k
+00005ee0: 6579 3a20 7374 722c 202a 2a6b 7761 7267  ey: str, **kwarg
+00005ef0: 7329 3a0a 2020 2020 2020 2020 7375 7065  s):.        supe
+00005f00: 7228 292e 5f5f 696e 6974 5f5f 2873 636f  r().__init__(sco
+00005f10: 7065 3d73 636f 7065 2c20 6b65 793d 6b65  pe=scope, key=ke
+00005f20: 792c 202a 2a6b 7761 7267 7329 0a0a 2020  y, **kwargs)..  
+00005f30: 2020 6465 6620 746f 5f70 726f 746f 2873    def to_proto(s
+00005f40: 656c 6629 202d 3e20 5365 6372 6574 5265  elf) -> SecretRe
+00005f50: 6665 7265 6e63 653a 0a20 2020 2020 2020  ference:.       
+00005f60: 2072 6574 7572 6e20 5365 6372 6574 5265   return SecretRe
+00005f70: 6665 7265 6e63 6528 7363 6f70 653d 7365  ference(scope=se
+00005f80: 6c66 2e73 636f 7065 2c20 6b65 793d 7365  lf.scope, key=se
+00005f90: 6c66 2e6b 6579 290a 0a0a 6465 6620 5f63  lf.key)...def _c
+00005fa0: 6f6e 7665 7274 5f73 6563 7265 745f 746f  onvert_secret_to
+00005fb0: 5f73 616e 6974 697a 6564 5f72 6566 6572  _sanitized_refer
+00005fc0: 656e 6365 2873 6563 7265 743a 2055 6e69  ence(secret: Uni
+00005fd0: 6f6e 5b73 7472 2c20 5365 6372 6574 5d29  on[str, Secret])
+00005fe0: 202d 3e20 5365 6372 6574 5265 6665 7265   -> SecretRefere
+00005ff0: 6e63 653a 0a20 2020 2022 2222 436f 6e76  nce:.    """Conv
+00006000: 6572 7420 6120 7365 6372 6574 2063 6f6e  ert a secret con
+00006010: 6669 6720 746f 2061 2073 6563 7265 7420  fig to a secret 
+00006020: 7265 6665 7265 6e63 6520 7072 6f74 6f2e  reference proto.
+00006030: 2053 746f 7265 206c 6f63 616c 2073 6563   Store local sec
+00006040: 7265 7473 2069 6e20 7468 6520 6c6f 6361  rets in the loca
+00006050: 6c20 7365 6372 6574 2073 746f 7265 2e22  l secret store."
+00006060: 2222 0a20 2020 2069 6620 6973 696e 7374  "".    if isinst
+00006070: 616e 6365 2873 6563 7265 742c 2073 7472  ance(secret, str
+00006080: 293a 0a20 2020 2020 2020 2067 656e 6572  ):.        gener
+00006090: 6174 6564 5f6b 6579 203d 2049 6448 656c  ated_key = IdHel
+000060a0: 7065 722e 6765 6e65 7261 7465 5f73 7472  per.generate_str
+000060b0: 696e 675f 6964 2829 0a20 2020 2020 2020  ing_id().       
+000060c0: 2073 6574 5f6c 6f63 616c 5f73 6563 7265   set_local_secre
+000060d0: 7428 7363 6f70 653d 224c 4f43 414c 5f53  t(scope="LOCAL_S
+000060e0: 4543 5245 5422 2c20 6b65 793d 6765 6e65  ECRET", key=gene
+000060f0: 7261 7465 645f 6b65 792c 2076 616c 7565  rated_key, value
+00006100: 3d73 6563 7265 7429 0a20 2020 2020 2020  =secret).       
+00006110: 2072 6574 7572 6e20 5365 6372 6574 5265   return SecretRe
+00006120: 6665 7265 6e63 6528 7363 6f70 653d 224c  ference(scope="L
+00006130: 4f43 414c 5f53 4543 5245 5422 2c20 6b65  OCAL_SECRET", ke
+00006140: 793d 6765 6e65 7261 7465 645f 6b65 792c  y=generated_key,
+00006150: 2069 735f 6c6f 6361 6c3d 5472 7565 290a   is_local=True).
+00006160: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+00006170: 6e63 6528 7365 6372 6574 2c20 5365 6372  nce(secret, Secr
+00006180: 6574 293a 0a20 2020 2020 2020 2072 6574  et):.        ret
+00006190: 7572 6e20 5365 6372 6574 5265 6665 7265  urn SecretRefere
+000061a0: 6e63 6528 7363 6f70 653d 7365 6372 6574  nce(scope=secret
+000061b0: 2e73 636f 7065 2c20 6b65 793d 7365 6372  .scope, key=secr
+000061c0: 6574 2e6b 6579 2c20 6973 5f6c 6f63 616c  et.key, is_local
+000061d0: 3d46 616c 7365 290a 2020 2020 656c 7365  =False).    else
+000061e0: 3a0a 2020 2020 2020 2020 6d73 6720 3d20  :.        msg = 
+000061f0: 6622 496e 7661 6c69 6420 7365 6372 6574  f"Invalid secret
+00006200: 2074 7970 653a 207b 7479 7065 2873 6563   type: {type(sec
+00006210: 7265 7429 7d22 0a20 2020 2020 2020 2072  ret)}".        r
+00006220: 6169 7365 2054 7970 6545 7272 6f72 286d  aise TypeError(m
+00006230: 7367 290a 0a0a 636c 6173 7320 5061 7271  sg)...class Parq
+00006240: 7565 7443 6f6e 6669 6728 5374 7269 6374  uetConfig(Strict
+00006250: 4d6f 6465 6c29 3a0a 2020 2020 2222 2228  Model):.    """(
+00006260: 436f 6e66 6967 2043 6c61 7373 2920 5061  Config Class) Pa
+00006270: 7271 7565 7443 6f6e 6669 6720 436c 6173  rquetConfig Clas
+00006280: 732e 0a0a 2020 2020 5468 6973 2063 6c61  s...    This cla
+00006290: 7373 2064 6573 6372 6962 6573 2074 6865  ss describes the
+000062a0: 2061 7474 7269 6275 7465 7320 6f66 2050   attributes of P
+000062b0: 6172 7175 6574 2d62 6173 6564 206f 6666  arquet-based off
+000062c0: 6c69 6e65 2066 6561 7475 7265 2073 746f  line feature sto
+000062d0: 7265 2073 746f 7261 6765 2066 6f72 2074  re storage for t
+000062e0: 6865 2066 6561 7475 7265 2064 6566 696e  he feature defin
+000062f0: 6974 696f 6e2e 0a0a 2020 2020 3a70 6172  ition...    :par
+00006300: 616d 2073 7562 6469 7265 6374 6f72 795f  am subdirectory_
+00006310: 6f76 6572 7269 6465 3a20 5468 6973 2069  override: This i
+00006320: 7320 666f 7220 7468 6520 6c6f 6361 7469  s for the locati
+00006330: 6f6e 206f 6620 7468 6520 6665 6174 7572  on of the featur
+00006340: 6520 6461 7461 2069 6e20 7468 6520 6f66  e data in the of
+00006350: 666c 696e 6520 7374 6f72 652e 2042 7920  fline store. By 
+00006360: 6465 6661 756c 742c 2061 6c6c 2066 6561  default, all fea
+00006370: 7475 7265 2076 6965 7773 2077 696c 6c20  ture views will 
+00006380: 6265 2075 6e64 6572 2074 6865 2073 7562  be under the sub
+00006390: 6469 7265 6374 6f72 7920 3c77 6f72 6b73  directory <works
+000063a0: 7061 6365 5f6e 616d 653e 2069 6620 7468  pace_name> if th
+000063b0: 6973 2070 6172 616d 2069 7320 6e6f 7420  is param is not 
+000063c0: 7370 6563 6966 6965 642e 0a20 2020 2022  specified..    "
+000063d0: 2222 0a0a 2020 2020 6b69 6e64 3a20 4c69  ""..    kind: Li
+000063e0: 7465 7261 6c5b 2250 6172 7175 6574 436f  teral["ParquetCo
+000063f0: 6e66 6967 225d 203d 2022 5061 7271 7565  nfig"] = "Parque
+00006400: 7443 6f6e 6669 6722 2020 2320 5573 6564  tConfig"  # Used
+00006410: 2066 6f72 2059 414d 4c20 7061 7273 696e   for YAML parsin
+00006420: 6720 6173 2061 2050 7964 616e 7469 6320  g as a Pydantic 
+00006430: 6469 7363 7269 6d69 6e61 746f 722e 0a20  discriminator.. 
+00006440: 2020 2073 7562 6469 7265 6374 6f72 795f     subdirectory_
+00006450: 6f76 6572 7269 6465 3a20 4f70 7469 6f6e  override: Option
+00006460: 616c 5b73 7472 5d20 3d20 4e6f 6e65 0a0a  al[str] = None..
+00006470: 2020 2020 6465 6620 5f74 6f5f 7072 6f74      def _to_prot
+00006480: 6f28 7365 6c66 293a 0a20 2020 2020 2020  o(self):.       
+00006490: 2073 746f 7265 5f63 6f6e 6669 6720 3d20   store_config = 
+000064a0: 6665 6174 7572 655f 7669 6577 5f70 6232  feature_view_pb2
+000064b0: 2e4f 6666 6c69 6e65 4665 6174 7572 6553  .OfflineFeatureS
+000064c0: 746f 7265 436f 6e66 6967 2829 0a20 2020  toreConfig().   
+000064d0: 2020 2020 2073 746f 7265 5f63 6f6e 6669       store_confi
+000064e0: 672e 7061 7271 7565 742e 5365 7449 6e50  g.parquet.SetInP
+000064f0: 6172 656e 7428 290a 2020 2020 2020 2020  arent().        
+00006500: 6966 2073 656c 662e 7375 6264 6972 6563  if self.subdirec
+00006510: 746f 7279 5f6f 7665 7272 6964 653a 0a20  tory_override:. 
+00006520: 2020 2020 2020 2020 2020 2073 746f 7265             store
+00006530: 5f63 6f6e 6669 672e 7375 6264 6972 6563  _config.subdirec
+00006540: 746f 7279 5f6f 7665 7272 6964 6520 3d20  tory_override = 
+00006550: 7365 6c66 2e73 7562 6469 7265 6374 6f72  self.subdirector
+00006560: 795f 6f76 6572 7269 6465 0a20 2020 2020  y_override.     
+00006570: 2020 2072 6574 7572 6e20 7374 6f72 655f     return store_
+00006580: 636f 6e66 6967 0a0a 0a63 6c61 7373 2044  config...class D
+00006590: 656c 7461 436f 6e66 6967 2853 7472 6963  eltaConfig(Stric
+000065a0: 744d 6f64 656c 293a 0a20 2020 2022 2222  tModel):.    """
+000065b0: 2843 6f6e 6669 6720 436c 6173 7329 2044  (Config Class) D
+000065c0: 656c 7461 436f 6e66 6967 2043 6c61 7373  eltaConfig Class
+000065d0: 2e0a 0a20 2020 2054 6869 7320 636c 6173  ...    This clas
+000065e0: 7320 6465 7363 7269 6265 7320 7468 6520  s describes the 
+000065f0: 6174 7472 6962 7574 6573 206f 6620 4465  attributes of De
+00006600: 6c74 614c 616b 652d 6261 7365 6420 6f66  ltaLake-based of
+00006610: 666c 696e 6520 6665 6174 7572 6520 7374  fline feature st
+00006620: 6f72 6520 7374 6f72 6167 6520 666f 7220  ore storage for 
+00006630: 7468 6520 6665 6174 7572 6520 6465 6669  the feature defi
+00006640: 6e69 7469 6f6e 2e0a 0a20 2020 203a 7061  nition...    :pa
+00006650: 7261 6d20 7469 6d65 5f70 6172 7469 7469  ram time_partiti
+00006660: 6f6e 5f73 697a 653a 2054 6865 2073 697a  on_size: The siz
+00006670: 6520 6f66 2061 2074 696d 6520 7061 7274  e of a time part
+00006680: 6974 696f 6e20 696e 2074 6865 2044 656c  ition in the Del
+00006690: 7461 4c61 6b65 2074 6162 6c65 2c20 7370  taLake table, sp
+000066a0: 6563 6966 6965 6420 6173 2061 2064 6174  ecified as a dat
+000066b0: 6574 696d 652e 7469 6d65 6465 6c74 612e  etime.timedelta.
+000066c0: 2044 6566 6175 6c74 7320 746f 2032 3420   Defaults to 24 
+000066d0: 686f 7572 732e 0a20 2020 203a 7061 7261  hours..    :para
+000066e0: 6d20 7375 6264 6972 6563 746f 7279 5f6f  m subdirectory_o
+000066f0: 7665 7272 6964 653a 2054 6869 7320 6973  verride: This is
+00006700: 2066 6f72 2074 6865 206c 6f63 6174 696f   for the locatio
+00006710: 6e20 6f66 2074 6865 2066 6561 7475 7265  n of the feature
+00006720: 2064 6174 6120 696e 2074 6865 206f 6666   data in the off
+00006730: 6c69 6e65 2073 746f 7265 2e20 4279 2064  line store. By d
+00006740: 6566 6175 6c74 2c20 616c 6c20 6665 6174  efault, all feat
+00006750: 7572 6520 7669 6577 7320 7769 6c6c 2062  ure views will b
+00006760: 6520 756e 6465 7220 7468 6520 7375 6264  e under the subd
+00006770: 6972 6563 746f 7279 203c 776f 726b 7370  irectory <worksp
+00006780: 6163 655f 6e61 6d65 3e20 6966 2074 6869  ace_name> if thi
+00006790: 7320 7061 7261 6d20 6973 206e 6f74 2073  s param is not s
+000067a0: 7065 6369 6669 6564 2e0a 2020 2020 2222  pecified..    ""
+000067b0: 220a 0a20 2020 206b 696e 643a 204c 6974  "..    kind: Lit
+000067c0: 6572 616c 5b22 4465 6c74 6143 6f6e 6669  eral["DeltaConfi
+000067d0: 6722 5d20 3d20 2244 656c 7461 436f 6e66  g"] = "DeltaConf
+000067e0: 6967 2220 2023 2055 7365 6420 666f 7220  ig"  # Used for 
+000067f0: 5941 4d4c 2070 6172 7369 6e67 2061 7320  YAML parsing as 
+00006800: 6120 5079 6461 6e74 6963 2064 6973 6372  a Pydantic discr
+00006810: 696d 696e 6174 6f72 2e0a 2020 2020 7469  iminator..    ti
+00006820: 6d65 5f70 6172 7469 7469 6f6e 5f73 697a  me_partition_siz
+00006830: 653a 204f 7074 696f 6e61 6c5b 6461 7465  e: Optional[date
+00006840: 7469 6d65 2e74 696d 6564 656c 7461 5d20  time.timedelta] 
+00006850: 3d20 6461 7465 7469 6d65 2e74 696d 6564  = datetime.timed
+00006860: 656c 7461 2868 6f75 7273 3d32 3429 0a20  elta(hours=24). 
+00006870: 2020 2073 7562 6469 7265 6374 6f72 795f     subdirectory_
+00006880: 6f76 6572 7269 6465 3a20 4f70 7469 6f6e  override: Option
+00006890: 616c 5b73 7472 5d20 3d20 4e6f 6e65 0a0a  al[str] = None..
+000068a0: 2020 2020 4070 7964 616e 7469 635f 7631      @pydantic_v1
+000068b0: 2e76 616c 6964 6174 6f72 2822 7469 6d65  .validator("time
+000068c0: 5f70 6172 7469 7469 6f6e 5f73 697a 6522  _partition_size"
+000068d0: 2c20 7072 653d 5472 7565 290a 2020 2020  , pre=True).    
+000068e0: 6465 6620 5f73 7472 696e 675f 746f 5f74  def _string_to_t
+000068f0: 696d 6564 656c 7461 2863 6c73 2c20 7661  imedelta(cls, va
+00006900: 6c75 6529 3a0a 2020 2020 2020 2020 6966  lue):.        if
+00006910: 2069 7369 6e73 7461 6e63 6528 7661 6c75   isinstance(valu
+00006920: 652c 2073 7472 293a 0a20 2020 2020 2020  e, str):.       
+00006930: 2020 2020 2072 6574 7572 6e20 7469 6d65       return time
+00006940: 5f75 7469 6c73 2e70 6172 7365 5f74 6f5f  _utils.parse_to_
+00006950: 7469 6d65 6465 6c74 6128 7661 6c75 6529  timedelta(value)
+00006960: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00006970: 7661 6c75 650a 0a20 2020 2064 6566 205f  value..    def _
+00006980: 746f 5f70 726f 746f 2873 656c 6629 3a0a  to_proto(self):.
+00006990: 2020 2020 2020 2020 7374 6f72 655f 636f          store_co
+000069a0: 6e66 6967 203d 2066 6561 7475 7265 5f76  nfig = feature_v
+000069b0: 6965 775f 7062 322e 4f66 666c 696e 6546  iew_pb2.OfflineF
+000069c0: 6561 7475 7265 5374 6f72 6543 6f6e 6669  eatureStoreConfi
+000069d0: 6728 290a 2020 2020 2020 2020 7374 6f72  g().        stor
+000069e0: 655f 636f 6e66 6967 2e64 656c 7461 2e74  e_config.delta.t
+000069f0: 696d 655f 7061 7274 6974 696f 6e5f 7369  ime_partition_si
+00006a00: 7a65 2e46 726f 6d54 696d 6564 656c 7461  ze.FromTimedelta
+00006a10: 2873 656c 662e 7469 6d65 5f70 6172 7469  (self.time_parti
+00006a20: 7469 6f6e 5f73 697a 6529 0a20 2020 2020  tion_size).     
+00006a30: 2020 2069 6620 7365 6c66 2e73 7562 6469     if self.subdi
+00006a40: 7265 6374 6f72 795f 6f76 6572 7269 6465  rectory_override
+00006a50: 3a0a 2020 2020 2020 2020 2020 2020 7374  :.            st
+00006a60: 6f72 655f 636f 6e66 6967 2e73 7562 6469  ore_config.subdi
+00006a70: 7265 6374 6f72 795f 6f76 6572 7269 6465  rectory_override
+00006a80: 203d 2073 656c 662e 7375 6264 6972 6563   = self.subdirec
+00006a90: 746f 7279 5f6f 7665 7272 6964 650a 2020  tory_override.  
+00006aa0: 2020 2020 2020 7265 7475 726e 2073 746f        return sto
+00006ab0: 7265 5f63 6f6e 6669 670a 0a0a 636c 6173  re_config...clas
+00006ac0: 7320 4f66 666c 696e 6553 746f 7265 436f  s OfflineStoreCo
+00006ad0: 6e66 6967 2853 7472 6963 744d 6f64 656c  nfig(StrictModel
+00006ae0: 293a 0a20 2020 2022 2222 436f 6e66 6967  ):.    """Config
+00006af0: 7572 6174 696f 6e20 6f70 7469 6f6e 7320  uration options 
+00006b00: 746f 2073 7065 6369 6679 2068 6f77 2061  to specify how a
+00006b10: 2046 6561 7475 7265 2056 6965 7720 7368   Feature View sh
+00006b20: 6f75 6c64 206d 6174 6572 6961 6c69 7a65  ould materialize
+00006b30: 2074 6f20 7468 6520 4f66 666c 696e 6520   to the Offline 
+00006b40: 5374 6f72 652e 0a0a 2020 2020 3a70 6172  Store...    :par
+00006b50: 616d 2073 7461 6769 6e67 5f74 6162 6c65  am staging_table
+00006b60: 5f66 6f72 6d61 743a 2054 6865 2074 6162  _format: The tab
+00006b70: 6c65 2066 6f72 6d61 7420 666f 7220 7468  le format for th
+00006b80: 6520 7374 6167 696e 6720 7461 626c 652e  e staging table.
+00006b90: 2054 6865 2073 7461 6769 6e67 2074 6162   The staging tab
+00006ba0: 6c65 2063 6f6e 7461 696e 7320 7061 7274  le contains part
+00006bb0: 6961 6c6c 790a 2020 2020 2020 2020 7472  ially.        tr
+00006bc0: 616e 7366 6f72 6d65 6420 6665 6174 7572  ansformed featur
+00006bd0: 6520 7661 6c75 6573 2074 6861 7420 6861  e values that ha
+00006be0: 7665 206e 6f74 2062 6565 6e20 6675 6c6c  ve not been full
+00006bf0: 7920 6167 6772 6567 6174 6564 2e0a 2020  y aggregated..  
+00006c00: 2020 3a70 6172 616d 2070 7562 6c69 7368    :param publish
+00006c10: 5f66 756c 6c5f 6665 6174 7572 6573 3a20  _full_features: 
+00006c20: 4966 2054 7275 652c 2054 6563 746f 6e20  If True, Tecton 
+00006c30: 7769 6c6c 2070 7562 6c69 7368 2061 2066  will publish a f
+00006c40: 756c 6c20 6665 6174 7572 6520 7661 6c75  ull feature valu
+00006c50: 6573 2074 6f20 6120 7365 7061 7261 7465  es to a separate
+00006c60: 2074 6162 6c65 2061 6674 6572 0a20 2020   table after.   
+00006c70: 2020 2020 206d 6174 6572 6961 6c69 7a61       materializa
+00006c80: 7469 6f6e 206a 6f62 7320 746f 2074 6865  tion jobs to the
+00006c90: 2073 7461 6769 6e67 2074 6162 6c65 2068   staging table h
+00006ca0: 6176 6520 636f 6d70 6c65 7465 642e 2055  ave completed. U
+00006cb0: 7365 7273 2063 616e 2071 7565 7279 2074  sers can query t
+00006cc0: 6865 7365 2066 6561 7475 7265 2076 616c  hese feature val
+00006cd0: 7565 7320 6469 7265 6374 6c79 0a20 2020  ues directly.   
+00006ce0: 2020 2020 2077 6974 686f 7574 2066 7572       without fur
+00006cf0: 7468 6572 2074 7261 6e73 666f 726d 6174  ther transformat
+00006d00: 696f 6e73 206f 7220 6167 6772 6567 6174  ions or aggregat
+00006d10: 696f 6e73 2e0a 2020 2020 3a70 6172 616d  ions..    :param
+00006d20: 2070 7562 6c69 7368 5f73 7461 7274 5f74   publish_start_t
+00006d30: 696d 653a 2049 6620 7365 742c 2054 6563  ime: If set, Tec
+00006d40: 746f 6e20 7769 6c6c 2070 7562 6c69 7368  ton will publish
+00006d50: 2066 6561 7475 7265 7320 7374 6172 7469   features starti
+00006d60: 6e67 2066 726f 6d20 7468 6520 6665 6174  ng from the feat
+00006d70: 7572 6520 7469 6d65 2e20 4966 206e 6f74  ure time. If not
+00006d80: 2073 6574 2c0a 2020 2020 2020 2020 5465   set,.        Te
+00006d90: 6374 6f6e 2077 696c 6c20 6465 6661 756c  cton will defaul
+00006da0: 7420 746f 2074 6865 2046 6561 7475 7265  t to the Feature
+00006db0: 2056 6965 7727 7320 6665 6174 7572 655f   View's feature_
+00006dc0: 7374 6172 745f 7469 6d65 2e0a 2020 2020  start_time..    
+00006dd0: 2222 220a 0a20 2020 206b 696e 643a 204c  """..    kind: L
+00006de0: 6974 6572 616c 5b22 4f66 666c 696e 6553  iteral["OfflineS
+00006df0: 746f 7265 436f 6e66 6967 225d 203d 2022  toreConfig"] = "
+00006e00: 4f66 666c 696e 6553 746f 7265 436f 6e66  OfflineStoreConf
+00006e10: 6967 2220 2023 2055 7365 6420 666f 7220  ig"  # Used for 
+00006e20: 5941 4d4c 2070 6172 7369 6e67 2061 7320  YAML parsing as 
+00006e30: 6120 5079 6461 6e74 6963 2064 6973 6372  a Pydantic discr
+00006e40: 696d 696e 6174 6f72 2e0a 2020 2020 7374  iminator..    st
+00006e50: 6167 696e 675f 7461 626c 655f 666f 726d  aging_table_form
+00006e60: 6174 3a20 556e 696f 6e5b 4465 6c74 6143  at: Union[DeltaC
+00006e70: 6f6e 6669 672c 2050 6172 7175 6574 436f  onfig, ParquetCo
+00006e80: 6e66 6967 5d20 3d20 7079 6461 6e74 6963  nfig] = pydantic
+00006e90: 5f76 312e 4669 656c 6428 0a20 2020 2020  _v1.Field(.     
+00006ea0: 2020 2064 6566 6175 6c74 5f66 6163 746f     default_facto
+00006eb0: 7279 3d44 656c 7461 436f 6e66 6967 2c20  ry=DeltaConfig, 
+00006ec0: 6469 7363 7269 6d69 6e61 746f 723d 226b  discriminator="k
+00006ed0: 696e 6422 0a20 2020 2029 0a20 2020 2070  ind".    ).    p
+00006ee0: 7562 6c69 7368 5f66 756c 6c5f 6665 6174  ublish_full_feat
+00006ef0: 7572 6573 3a20 626f 6f6c 203d 2046 616c  ures: bool = Fal
+00006f00: 7365 0a20 2020 2070 7562 6c69 7368 5f73  se.    publish_s
+00006f10: 7461 7274 5f74 696d 653a 204f 7074 696f  tart_time: Optio
+00006f20: 6e61 6c5b 6461 7465 7469 6d65 2e64 6174  nal[datetime.dat
+00006f30: 6574 696d 655d 203d 204e 6f6e 650a 0a20  etime] = None.. 
+00006f40: 2020 2040 7079 6461 6e74 6963 5f76 312e     @pydantic_v1.
+00006f50: 7661 6c69 6461 746f 7228 2270 7562 6c69  validator("publi
+00006f60: 7368 5f73 7461 7274 5f74 696d 6522 2c20  sh_start_time", 
+00006f70: 7072 653d 5472 7565 290a 2020 2020 6465  pre=True).    de
+00006f80: 6620 5f64 6174 655f 746f 5f64 6174 6574  f _date_to_datet
+00006f90: 696d 6528 636c 732c 2076 616c 7565 293a  ime(cls, value):
+00006fa0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+00006fb0: 7374 616e 6365 2876 616c 7565 2c20 6461  stance(value, da
+00006fc0: 7465 7469 6d65 2e64 6174 6529 3a0a 2020  tetime.date):.  
+00006fd0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00006fe0: 2064 6174 6574 696d 652e 6461 7465 7469   datetime.dateti
+00006ff0: 6d65 2879 6561 723d 7661 6c75 652e 7965  me(year=value.ye
+00007000: 6172 2c20 6d6f 6e74 683d 7661 6c75 652e  ar, month=value.
+00007010: 6d6f 6e74 682c 2064 6179 3d76 616c 7565  month, day=value
+00007020: 2e64 6179 290a 2020 2020 2020 2020 7265  .day).        re
+00007030: 7475 726e 2076 616c 7565 0a0a 2020 2020  turn value..    
+00007040: 6465 6620 5f74 6f5f 7072 6f74 6f28 7365  def _to_proto(se
+00007050: 6c66 2920 2d3e 2066 6561 7475 7265 5f76  lf) -> feature_v
+00007060: 6965 775f 7062 322e 4f66 666c 696e 6553  iew_pb2.OfflineS
+00007070: 746f 7265 436f 6e66 6967 3a0a 2020 2020  toreConfig:.    
+00007080: 2020 2020 7265 7475 726e 2066 6561 7475      return featu
+00007090: 7265 5f76 6965 775f 7062 322e 4f66 666c  re_view_pb2.Offl
+000070a0: 696e 6553 746f 7265 436f 6e66 6967 280a  ineStoreConfig(.
+000070b0: 2020 2020 2020 2020 2020 2020 7374 6167              stag
+000070c0: 696e 675f 7461 626c 655f 666f 726d 6174  ing_table_format
+000070d0: 3d73 656c 662e 7374 6167 696e 675f 7461  =self.staging_ta
+000070e0: 626c 655f 666f 726d 6174 2e5f 746f 5f70  ble_format._to_p
+000070f0: 726f 746f 2829 2c0a 2020 2020 2020 2020  roto(),.        
+00007100: 2020 2020 7075 626c 6973 685f 6675 6c6c      publish_full
+00007110: 5f66 6561 7475 7265 733d 7365 6c66 2e70  _features=self.p
+00007120: 7562 6c69 7368 5f66 756c 6c5f 6665 6174  ublish_full_feat
+00007130: 7572 6573 2c0a 2020 2020 2020 2020 2020  ures,.          
+00007140: 2020 7075 626c 6973 685f 7374 6172 745f    publish_start_
+00007150: 7469 6d65 3d74 696d 655f 7574 696c 732e  time=time_utils.
+00007160: 6461 7465 7469 6d65 5f74 6f5f 7072 6f74  datetime_to_prot
+00007170: 6f28 7365 6c66 2e70 7562 6c69 7368 5f73  o(self.publish_s
+00007180: 7461 7274 5f74 696d 6529 2c0a 2020 2020  tart_time),.    
+00007190: 2020 2020 290a 0a0a 636c 6173 7320 4479      )...class Dy
+000071a0: 6e61 6d6f 436f 6e66 6967 2853 7472 6963  namoConfig(Stric
+000071b0: 744d 6f64 656c 293a 0a20 2020 2022 2222  tModel):.    """
+000071c0: 2843 6f6e 6669 6720 436c 6173 7329 2044  (Config Class) D
+000071d0: 796e 616d 6f43 6f6e 6669 6720 436c 6173  ynamoConfig Clas
+000071e0: 732e 0a0a 2020 2020 5468 6973 2063 6c61  s...    This cla
+000071f0: 7373 2064 6573 6372 6962 6573 2074 6865  ss describes the
+00007200: 2061 7474 7269 6275 7465 7320 6f66 2044   attributes of D
+00007210: 796e 616d 6f44 4220 6261 7365 6420 6f6e  ynamoDB based on
+00007220: 6c69 6e65 2066 6561 7475 7265 2073 746f  line feature sto
+00007230: 7265 2066 6f72 2074 6865 2066 6561 7475  re for the featu
+00007240: 7265 2064 6566 696e 6974 696f 6e2e 0a20  re definition.. 
+00007250: 2020 2043 7572 7265 6e74 6c79 2074 6865     Currently the
+00007260: 7265 2061 7265 206e 6f20 6174 7472 6962  re are no attrib
+00007270: 7574 6573 2066 6f72 2074 6869 7320 636c  utes for this cl
+00007280: 6173 732e 0a20 2020 2055 7365 7273 2063  ass..    Users c
+00007290: 616e 2073 7065 6369 6679 206f 6e6c 696e  an specify onlin
+000072a0: 655f 7374 6f72 6520 3d20 4479 6e61 6d6f  e_store = Dynamo
+000072b0: 436f 6e66 6967 2829 0a20 2020 2022 2222  Config().    """
+000072c0: 0a0a 2020 2020 6b69 6e64 3a20 4c69 7465  ..    kind: Lite
+000072d0: 7261 6c5b 2244 796e 616d 6f43 6f6e 6669  ral["DynamoConfi
+000072e0: 6722 5d20 3d20 2244 796e 616d 6f43 6f6e  g"] = "DynamoCon
+000072f0: 6669 6722 2020 2320 5573 6564 2066 6f72  fig"  # Used for
+00007300: 2059 414d 4c20 7061 7273 696e 6720 6173   YAML parsing as
+00007310: 2061 2050 7964 616e 7469 6320 6469 7363   a Pydantic disc
+00007320: 7269 6d69 6e61 746f 722e 0a0a 2020 2020  riminator...    
+00007330: 6465 6620 5f74 6f5f 7072 6f74 6f28 7365  def _to_proto(se
+00007340: 6c66 293a 0a20 2020 2020 2020 2073 746f  lf):.        sto
+00007350: 7265 5f63 6f6e 6669 6720 3d20 6665 6174  re_config = feat
+00007360: 7572 655f 7669 6577 5f70 6232 2e4f 6e6c  ure_view_pb2.Onl
+00007370: 696e 6553 746f 7265 436f 6e66 6967 2829  ineStoreConfig()
+00007380: 0a20 2020 2020 2020 2073 746f 7265 5f63  .        store_c
+00007390: 6f6e 6669 672e 6479 6e61 6d6f 2e65 6e61  onfig.dynamo.ena
+000073a0: 626c 6564 203d 2054 7275 650a 2020 2020  bled = True.    
+000073b0: 2020 2020 7374 6f72 655f 636f 6e66 6967      store_config
+000073c0: 2e64 796e 616d 6f2e 5365 7449 6e50 6172  .dynamo.SetInPar
+000073d0: 656e 7428 290a 2020 2020 2020 2020 7265  ent().        re
+000073e0: 7475 726e 2073 746f 7265 5f63 6f6e 6669  turn store_confi
+000073f0: 670a 0a0a 636c 6173 7320 5265 6469 7343  g...class RedisC
+00007400: 6f6e 6669 6728 5374 7269 6374 4d6f 6465  onfig(StrictMode
+00007410: 6c29 3a0a 2020 2020 2222 2228 436f 6e66  l):.    """(Conf
+00007420: 6967 2043 6c61 7373 2920 5265 6469 7343  ig Class) RedisC
+00007430: 6f6e 6669 6720 436c 6173 732e 0a0a 2020  onfig Class...  
+00007440: 2020 5468 6973 2063 6c61 7373 2064 6573    This class des
+00007450: 6372 6962 6573 2074 6865 2061 7474 7269  cribes the attri
+00007460: 6275 7465 7320 6f66 2052 6564 6973 2d62  butes of Redis-b
+00007470: 6173 6564 206f 6e6c 696e 6520 6665 6174  ased online feat
+00007480: 7572 6520 7374 6f72 6520 666f 7220 7468  ure store for th
+00007490: 6520 6665 6174 7572 6520 6465 6669 6e69  e feature defini
+000074a0: 7469 6f6e 2e0a 2020 2020 4e6f 7465 203a  tion..    Note :
+000074b0: 2059 6f75 7220 5465 6374 6f6e 2064 6570   Your Tecton dep
+000074c0: 6c6f 796d 656e 7420 6e65 6564 7320 746f  loyment needs to
+000074d0: 2062 6520 636f 6e6e 6563 7465 6420 746f   be connected to
+000074e0: 2052 6564 6973 2062 6566 6f72 6520 796f   Redis before yo
+000074f0: 7520 6361 6e20 7573 6520 7468 6973 2063  u can use this c
+00007500: 6f6e 6669 6775 7261 7469 6f6e 206f 7074  onfiguration opt
+00007510: 696f 6e2e 2053 6565 2068 7474 7073 3a2f  ion. See https:/
+00007520: 2f64 6f63 732e 7465 6374 6f6e 2e61 692f  /docs.tecton.ai/
+00007530: 646f 6373 2f73 6574 7469 6e67 2d75 702d  docs/setting-up-
+00007540: 7465 6374 6f6e 2f73 6574 7469 6e67 2d75  tecton/setting-u
+00007550: 702d 6f74 6865 722d 636f 6d70 6f6e 656e  p-other-componen
+00007560: 7473 2f63 6f6e 6e65 6374 696e 672d 7265  ts/connecting-re
+00007570: 6469 732d 6173 2d61 6e2d 6f6e 6c69 6e65  dis-as-an-online
+00007580: 2d73 746f 7265 2066 6f72 2064 6574 6169  -store for detai
+00007590: 6c73 2061 6e64 2070 6c65 6173 6520 636f  ls and please co
+000075a0: 6e74 6163 7420 5465 6374 6f6e 2053 7570  ntact Tecton Sup
+000075b0: 706f 7274 2069 6620 796f 7520 6e65 6564  port if you need
+000075c0: 2061 7373 6973 7461 6e63 652e 0a0a 2020   assistance...  
+000075d0: 2020 3a70 6172 616d 2070 7269 6d61 7279    :param primary
+000075e0: 5f65 6e64 706f 696e 743a 2050 7269 6d61  _endpoint: Prima
+000075f0: 7279 2065 6e64 706f 696e 7420 666f 7220  ry endpoint for 
+00007600: 7468 6520 5265 6469 7320 436c 7573 7465  the Redis Cluste
+00007610: 722e 2054 6869 7320 6973 206f 7074 696f  r. This is optio
+00007620: 6e61 6c20 616e 6420 6966 2061 6273 656e  nal and if absen
+00007630: 742c 2054 6563 746f 6e20 7769 6c6c 2075  t, Tecton will u
+00007640: 7365 2074 6865 2064 6566 6175 6c74 2052  se the default R
+00007650: 6564 6973 2043 6c75 7374 6572 2063 6f6e  edis Cluster con
+00007660: 6669 6775 7265 6420 666f 7220 796f 7572  figured for your
+00007670: 2064 6570 6c6f 796d 656e 742e 0a20 2020   deployment..   
+00007680: 203a 7061 7261 6d20 6175 7468 656e 7469   :param authenti
+00007690: 6361 7469 6f6e 5f74 6f6b 656e 3a20 4175  cation_token: Au
+000076a0: 7468 656e 7469 6361 7469 6f6e 2074 6f6b  thentication tok
+000076b0: 656e 2066 6f72 2074 6865 2052 6564 6973  en for the Redis
+000076c0: 2043 6c75 7374 6572 2c20 6d75 7374 2062   Cluster, must b
+000076d0: 6520 7072 6f76 6964 6564 2069 6620 7072  e provided if pr
+000076e0: 696d 6172 795f 656e 6470 6f69 6e74 2069  imary_endpoint i
+000076f0: 7320 7072 6573 656e 742e 0a20 2020 2022  s present..    "
+00007700: 2222 0a0a 2020 2020 6b69 6e64 3a20 4c69  ""..    kind: Li
+00007710: 7465 7261 6c5b 2252 6564 6973 436f 6e66  teral["RedisConf
+00007720: 6967 225d 203d 2022 5265 6469 7343 6f6e  ig"] = "RedisCon
+00007730: 6669 6722 2020 2320 5573 6564 2066 6f72  fig"  # Used for
+00007740: 2059 414d 4c20 7061 7273 696e 6720 6173   YAML parsing as
+00007750: 2061 2050 7964 616e 7469 6320 6469 7363   a Pydantic disc
+00007760: 7269 6d69 6e61 746f 722e 0a20 2020 2070  riminator..    p
+00007770: 7269 6d61 7279 5f65 6e64 706f 696e 743a  rimary_endpoint:
+00007780: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
+00007790: 204e 6f6e 650a 2020 2020 6175 7468 656e   None.    authen
+000077a0: 7469 6361 7469 6f6e 5f74 6f6b 656e 3a20  tication_token: 
+000077b0: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+000077c0: 4e6f 6e65 0a0a 2020 2020 6465 6620 5f74  None..    def _t
+000077d0: 6f5f 7072 6f74 6f28 7365 6c66 293a 0a20  o_proto(self):. 
+000077e0: 2020 2020 2020 2023 2054 4f44 4f28 5445         # TODO(TE
+000077f0: 432d 3133 3838 3929 3a20 5265 6d6f 7665  C-13889): Remove
+00007800: 2074 6865 2074 6c73 5f65 6e61 626c 6564   the tls_enabled
+00007810: 2066 6965 6c64 2066 726f 6d20 7072 6f74   field from prot
+00007820: 6f20 616e 6420 6261 636b 656e 6420 6173  o and backend as
+00007830: 2074 6869 7320 7368 6f75 6c64 2061 6c77   this should alw
+00007840: 6179 7320 6265 2073 6574 2074 6f20 7472  ays be set to tr
+00007850: 7565 0a20 2020 2020 2020 2072 6574 7572  ue.        retur
+00007860: 6e20 6665 6174 7572 655f 7669 6577 5f70  n feature_view_p
+00007870: 6232 2e4f 6e6c 696e 6553 746f 7265 436f  b2.OnlineStoreCo
+00007880: 6e66 6967 280a 2020 2020 2020 2020 2020  nfig(.          
+00007890: 2020 7265 6469 733d 6665 6174 7572 655f    redis=feature_
+000078a0: 7669 6577 5f70 6232 2e52 6564 6973 4f6e  view_pb2.RedisOn
+000078b0: 6c69 6e65 5374 6f72 6528 0a20 2020 2020  lineStore(.     
+000078c0: 2020 2020 2020 2020 2020 2065 6e61 626c             enabl
+000078d0: 6564 3d54 7275 652c 0a20 2020 2020 2020  ed=True,.       
+000078e0: 2020 2020 2020 2020 2070 7269 6d61 7279           primary
+000078f0: 5f65 6e64 706f 696e 743d 7365 6c66 2e70  _endpoint=self.p
+00007900: 7269 6d61 7279 5f65 6e64 706f 696e 742c  rimary_endpoint,
+00007910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007920: 2061 7574 6865 6e74 6963 6174 696f 6e5f   authentication_
+00007930: 746f 6b65 6e3d 7365 6c66 2e61 7574 6865  token=self.authe
+00007940: 6e74 6963 6174 696f 6e5f 746f 6b65 6e2c  ntication_token,
+00007950: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00007960: 2020 2020 2020 2029 0a0a 0a63 6c61 7373         )...class
+00007970: 2042 6967 7461 626c 6543 6f6e 6669 6728   BigtableConfig(
+00007980: 5374 7269 6374 4d6f 6465 6c29 3a0a 2020  StrictModel):.  
+00007990: 2020 2222 2228 436f 6e66 6967 2043 6c61    """(Config Cla
+000079a0: 7373 2920 4269 6774 6162 6c65 436f 6e66  ss) BigtableConf
+000079b0: 6967 2043 6c61 7373 2e0a 0a20 2020 2054  ig Class...    T
+000079c0: 6869 7320 636c 6173 7320 6465 7363 7269  his class descri
+000079d0: 6265 7320 7468 6520 6174 7472 6962 7574  bes the attribut
+000079e0: 6573 206f 6620 4269 6774 6162 6c65 2062  es of Bigtable b
+000079f0: 6173 6564 206f 6e6c 696e 6520 6665 6174  ased online feat
+00007a00: 7572 6520 7374 6f72 6520 666f 7220 7468  ure store for th
+00007a10: 6520 6665 6174 7572 6520 6465 6669 6e69  e feature defini
+00007a20: 7469 6f6e 2e0a 2020 2020 4375 7272 656e  tion..    Curren
+00007a30: 746c 7920 7468 6572 6520 6172 6520 6e6f  tly there are no
+00007a40: 2061 7474 7269 6275 7465 7320 666f 7220   attributes for 
+00007a50: 7468 6973 2063 6c61 7373 2e0a 2020 2020  this class..    
+00007a60: 5573 6572 7320 6361 6e20 7370 6563 6966  Users can specif
+00007a70: 7920 6f6e 6c69 6e65 5f73 746f 7265 203d  y online_store =
+00007a80: 2042 6967 7461 626c 6543 6f6e 6669 6728   BigtableConfig(
+00007a90: 290a 0a20 2020 2022 2222 0a0a 2020 2020  )..    """..    
+00007aa0: 6b69 6e64 3a20 4c69 7465 7261 6c5b 2242  kind: Literal["B
+00007ab0: 6967 7461 626c 6543 6f6e 6669 6722 5d20  igtableConfig"] 
+00007ac0: 3d20 2242 6967 7461 626c 6543 6f6e 6669  = "BigtableConfi
+00007ad0: 6722 2020 2320 5573 6564 2066 6f72 2059  g"  # Used for Y
+00007ae0: 414d 4c20 7061 7273 696e 6720 6173 2061  AML parsing as a
+00007af0: 2050 7964 616e 7469 6320 6469 7363 7269   Pydantic discri
+00007b00: 6d69 6e61 746f 722e 0a0a 2020 2020 6465  minator...    de
+00007b10: 6620 5f74 6f5f 7072 6f74 6f28 7365 6c66  f _to_proto(self
+00007b20: 293a 0a20 2020 2020 2020 2073 746f 7265  ):.        store
+00007b30: 5f63 6f6e 6669 6720 3d20 6665 6174 7572  _config = featur
+00007b40: 655f 7669 6577 5f70 6232 2e4f 6e6c 696e  e_view_pb2.Onlin
+00007b50: 6553 746f 7265 436f 6e66 6967 2829 0a20  eStoreConfig(). 
+00007b60: 2020 2020 2020 2073 746f 7265 5f63 6f6e         store_con
+00007b70: 6669 672e 6269 6774 6162 6c65 2e65 6e61  fig.bigtable.ena
+00007b80: 626c 6564 203d 2054 7275 650a 2020 2020  bled = True.    
+00007b90: 2020 2020 7374 6f72 655f 636f 6e66 6967      store_config
+00007ba0: 2e62 6967 7461 626c 652e 5365 7449 6e50  .bigtable.SetInP
+00007bb0: 6172 656e 7428 290a 2020 2020 2020 2020  arent().        
+00007bc0: 7265 7475 726e 2073 746f 7265 5f63 6f6e  return store_con
+00007bd0: 6669 670a 0a0a 636c 6173 7320 4d6f 6e69  fig...class Moni
+00007be0: 746f 7269 6e67 436f 6e66 6967 2853 7472  toringConfig(Str
+00007bf0: 6963 744d 6f64 656c 293a 0a20 2020 2022  ictModel):.    "
+00007c00: 2222 436f 6e66 6967 7572 6174 696f 6e20  ""Configuration 
+00007c10: 7573 6564 2074 6f20 7370 6563 6966 7920  used to specify 
+00007c20: 6d6f 6e69 746f 7269 6e67 206f 7074 696f  monitoring optio
+00007c30: 6e73 2e0a 0a20 2020 2054 6869 7320 636c  ns...    This cl
+00007c40: 6173 7320 6465 7363 7269 6265 7320 7468  ass describes th
+00007c50: 6520 4665 6174 7572 6556 6965 7720 6d61  e FeatureView ma
+00007c60: 7465 7269 616c 697a 6174 696f 6e20 6672  terialization fr
+00007c70: 6573 686e 6573 7320 616e 6420 616c 6572  eshness and aler
+00007c80: 7469 6e67 2063 6f6e 6669 6775 7261 7469  ting configurati
+00007c90: 6f6e 732e 2052 6571 7569 7265 730a 2020  ons. Requires.  
+00007ca0: 2020 6d61 7465 7269 616c 697a 6174 696f    materializatio
+00007cb0: 6e20 746f 2062 6520 656e 6162 6c65 642e  n to be enabled.
+00007cc0: 2046 7265 7368 6e65 7373 206d 6f6e 6974   Freshness monit
+00007cd0: 6f72 696e 6720 7265 7175 6972 6573 206f  oring requires o
+00007ce0: 6e6c 696e 6520 6d61 7465 7269 616c 697a  nline materializ
+00007cf0: 6174 696f 6e20 746f 2062 6520 656e 6162  ation to be enab
+00007d00: 6c65 642e 0a20 2020 2053 6565 2060 4d6f  led..    See `Mo
+00007d10: 6e69 746f 7269 6e67 204d 6174 6572 6961  nitoring Materia
+00007d20: 6c69 7a61 7469 6f6e 605f 2066 6f72 206d  lization`_ for m
+00007d30: 6f72 6520 6465 7461 696c 732e 0a0a 2020  ore details...  
+00007d40: 2020 3a70 6172 616d 206d 6f6e 6974 6f72    :param monitor
+00007d50: 5f66 7265 7368 6e65 7373 3a20 4465 6669  _freshness: Defi
+00007d60: 6e65 7320 7468 6520 656e 6162 6c65 642f  nes the enabled/
+00007d70: 6469 7361 626c 6564 2073 7461 7465 206f  disabled state o
+00007d80: 6620 6d6f 6e69 746f 7269 6e67 2077 6865  f monitoring whe
+00007d90: 6e20 6665 6174 7572 6520 6461 7461 2069  n feature data i
+00007da0: 7320 6d61 7465 7269 616c 697a 6564 2074  s materialized t
+00007db0: 6f20 7468 6520 6f6e 6c69 6e65 2066 6561  o the online fea
+00007dc0: 7475 7265 2073 746f 7265 2e0a 2020 2020  ture store..    
+00007dd0: 3a74 7970 6520 6d6f 6e69 746f 725f 6672  :type monitor_fr
+00007de0: 6573 686e 6573 733a 2062 6f6f 6c0a 2020  eshness: bool.  
+00007df0: 2020 3a70 6172 616d 2065 7870 6563 7465    :param expecte
+00007e00: 645f 6672 6573 686e 6573 733a 2054 6872  d_freshness: Thr
+00007e10: 6573 686f 6c64 2075 7365 6420 746f 2064  eshold used to d
+00007e20: 6574 6572 6d69 6e65 2069 6620 7265 6365  etermine if rece
+00007e30: 6e74 6c79 206d 6174 6572 6961 6c69 7a65  ntly materialize
+00007e40: 6420 6665 6174 7572 6520 6461 7461 2069  d feature data i
+00007e50: 7320 7374 616c 652e 0a20 2020 2020 2020  s stale..       
+00007e60: 2044 6174 6120 6973 2073 7461 6c65 2069   Data is stale i
+00007e70: 6620 6060 6e6f 7720 2d20 616e 6368 6f72  f ``now - anchor
+00007e80: 5f74 696d 6528 6d6f 7374 5f72 6563 656e  _time(most_recen
+00007e90: 745f 6665 6174 7572 655f 7661 6c75 6529  t_feature_value)
+00007ea0: 203e 2065 7870 6563 7465 645f 6672 6573   > expected_fres
+00007eb0: 686e 6573 7360 602e 0a20 2020 2020 2020  hness``..       
+00007ec0: 2056 616c 7565 206d 7573 7420 6265 2061   Value must be a
+00007ed0: 7420 6c65 6173 7420 3220 7469 6d65 7320  t least 2 times 
+00007ee0: 7468 6520 6665 6174 7572 6520 7469 6c65  the feature tile
+00007ef0: 206c 656e 6774 682e 0a20 2020 2020 2020   length..       
+00007f00: 2049 6620 6e6f 7420 7370 6563 6966 6965   If not specifie
+00007f10: 642c 2061 2076 616c 7565 2064 6574 6572  d, a value deter
+00007f20: 6d69 6e65 6420 6279 2074 6865 2054 6563  mined by the Tec
+00007f30: 746f 6e20 6261 636b 656e 6420 6973 2075  ton backend is u
+00007f40: 7365 640a 2020 2020 3a74 7970 6520 6578  sed.    :type ex
+00007f50: 7065 6374 6564 5f66 7265 7368 6e65 7373  pected_freshness
+00007f60: 3a20 7469 6d65 6465 6c74 612c 206f 7074  : timedelta, opt
+00007f70: 696f 6e61 6c0a 2020 2020 3a70 6172 616d  ional.    :param
+00007f80: 2061 6c65 7274 5f65 6d61 696c 3a20 456d   alert_email: Em
+00007f90: 6169 6c20 7468 6174 2061 6c65 7274 7320  ail that alerts 
+00007fa0: 666f 7220 7468 6973 2046 6561 7475 7265  for this Feature
+00007fb0: 5669 6577 2077 696c 6c20 6265 2073 656e  View will be sen
+00007fc0: 7420 746f 2e0a 2020 2020 3a74 7970 6520  t to..    :type 
+00007fd0: 616c 6572 745f 656d 6169 6c3a 2073 7472  alert_email: str
+00007fe0: 2c20 6f70 7469 6f6e 616c 0a0a 2020 2020  , optional..    
+00007ff0: 416e 2065 7861 6d70 6c65 2064 6563 6c61  An example decla
+00008000: 7261 7469 6f6e 206f 6620 6120 4d6f 6e69  ration of a Moni
+00008010: 746f 7243 6f6e 6669 670a 0a20 2020 2020  torConfig..     
+00008020: 2020 202e 2e20 636f 6465 2d62 6c6f 636b     .. code-block
+00008030: 3a3a 2070 7974 686f 6e0a 0a20 2020 2020  :: python..     
+00008040: 2020 2020 2020 2066 726f 6d20 6461 7465         from date
+00008050: 7469 6d65 2069 6d70 6f72 7420 7469 6d65  time import time
+00008060: 6465 6c74 610a 2020 2020 2020 2020 2020  delta.          
+00008070: 2020 6672 6f6d 2074 6563 746f 6e20 696d    from tecton im
+00008080: 706f 7274 2062 6174 6368 5f66 6561 7475  port batch_featu
+00008090: 7265 5f76 6965 772c 2049 6e70 7574 2c20  re_view, Input, 
+000080a0: 4d6f 6e69 746f 7269 6e67 436f 6e66 6967  MonitoringConfig
+000080b0: 0a20 2020 2020 2020 2020 2020 2023 2046  .            # F
+000080c0: 6f72 2061 6c6c 206e 616d 6564 2061 7267  or all named arg
+000080d0: 756d 656e 7473 2074 6f20 7468 6520 6261  uments to the ba
+000080e0: 7463 6820 6665 6174 7572 6520 7669 6577  tch feature view
+000080f0: 2c20 7365 6520 646f 6373 2066 6f72 2064  , see docs for d
+00008100: 6574 6169 6c73 2061 6e64 2074 7970 6573  etails and types
+00008110: 2e0a 2020 2020 2020 2020 2020 2020 4062  ..            @b
+00008120: 6174 6368 5f66 6561 7475 7265 5f76 6965  atch_feature_vie
+00008130: 7728 0a20 2020 2020 2020 2020 2020 2020  w(.             
+00008140: 2020 2073 6f75 7263 6573 3d5b 4669 6c74     sources=[Filt
+00008150: 6572 6564 536f 7572 6365 2863 7265 6469  eredSource(credi
+00008160: 745f 7363 6f72 6573 5f62 6174 6368 295d  t_scores_batch)]
+00008170: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00008180: 2020 2320 4361 6e20 6265 2061 6e20 6172    # Can be an ar
+00008190: 6775 6d65 6e74 2069 6e73 7461 6e63 6520  gument instance 
+000081a0: 746f 2061 2062 6174 6368 2066 6561 7475  to a batch featu
+000081b0: 7265 2076 6965 7720 6465 636f 7261 746f  re view decorato
+000081c0: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+000081d0: 2020 6d6f 6e69 746f 7269 6e67 203d 204d    monitoring = M
+000081e0: 6f6e 6974 6f72 696e 6743 6f6e 6669 6728  onitoringConfig(
+000081f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008200: 2020 2020 206d 6f6e 6974 6f72 5f66 7265       monitor_fre
+00008210: 7368 6e65 7373 3d54 7275 652c 0a20 2020  shness=True,.   
+00008220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008230: 2065 7870 6563 7465 645f 6672 6573 686e   expected_freshn
+00008240: 6573 733d 7469 6d65 6465 6c74 6128 7765  ess=timedelta(we
+00008250: 656b 733d 3129 2c0a 2020 2020 2020 2020  eks=1),.        
+00008260: 2020 2020 2020 2020 2020 2020 616c 6572              aler
+00008270: 745f 656d 6169 6c3d 2262 7269 616e 4074  t_email="brian@t
+00008280: 6563 746f 6e2e 6169 220a 2020 2020 2020  ecton.ai".      
+00008290: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+000082a0: 2020 2020 2020 2020 2020 2020 2023 204f               # O
+000082b0: 7468 6572 206e 616d 6564 2061 7267 756d  ther named argum
+000082c0: 656e 7473 0a20 2020 2020 2020 2020 2020  ents.           
+000082d0: 2020 2020 202e 2e2e 0a20 2020 2020 2020       ....       
+000082e0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+000082f0: 2020 2020 2320 596f 7572 2062 6174 6368      # Your batch
+00008300: 2066 6561 7475 7265 2076 6965 7720 6675   feature view fu
+00008310: 6e63 7469 6f6e 0a20 2020 2020 2020 2020  nction.         
+00008320: 2020 2064 6566 2063 7265 6469 745f 6261     def credit_ba
+00008330: 7463 685f 6665 6174 7572 655f 7669 6577  tch_feature_view
+00008340: 2863 7265 6469 745f 7363 6f72 6573 293a  (credit_scores):
+00008350: 0a20 2020 2020 2020 2020 2020 2020 202e  .              .
+00008360: 2e2e 0a0a 2020 2020 2e2e 205f 4d6f 6e69  ....    .. _Moni
+00008370: 746f 7269 6e67 204d 6174 6572 6961 6c69  toring Materiali
+00008380: 7a61 7469 6f6e 3a20 6874 7470 733a 2f2f  zation: https://
+00008390: 646f 6373 2e74 6563 746f 6e2e 6169 2f64  docs.tecton.ai/d
+000083a0: 6f63 732f 6d6f 6e69 746f 7269 6e67 2f6d  ocs/monitoring/m
+000083b0: 6f6e 6974 6f72 696e 672d 6d61 7465 7269  onitoring-materi
+000083c0: 616c 697a 6174 696f 6e0a 2020 2020 2222  alization.    ""
+000083d0: 220a 0a20 2020 206d 6f6e 6974 6f72 5f66  "..    monitor_f
+000083e0: 7265 7368 6e65 7373 3a20 626f 6f6c 0a20  reshness: bool. 
+000083f0: 2020 2065 7870 6563 7465 645f 6672 6573     expected_fres
+00008400: 686e 6573 733a 204f 7074 696f 6e61 6c5b  hness: Optional[
+00008410: 6461 7465 7469 6d65 2e74 696d 6564 656c  datetime.timedel
+00008420: 7461 5d20 3d20 4e6f 6e65 0a20 2020 2061  ta] = None.    a
+00008430: 6c65 7274 5f65 6d61 696c 3a20 4f70 7469  lert_email: Opti
+00008440: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
+00008450: 0a0a 2020 2020 6465 6620 5f74 6f5f 7072  ..    def _to_pr
+00008460: 6f74 6f28 7365 6c66 2920 2d3e 2066 6561  oto(self) -> fea
+00008470: 7475 7265 5f76 6965 775f 7062 322e 4d6f  ture_view_pb2.Mo
+00008480: 6e69 746f 7269 6e67 436f 6e66 6967 3a0a  nitoringConfig:.
+00008490: 2020 2020 2020 2020 7072 6f74 6f20 3d20          proto = 
+000084a0: 6665 6174 7572 655f 7669 6577 5f70 6232  feature_view_pb2
+000084b0: 2e4d 6f6e 6974 6f72 696e 6743 6f6e 6669  .MonitoringConfi
+000084c0: 6728 290a 0a20 2020 2020 2020 2069 6620  g()..        if 
+000084d0: 7365 6c66 2e65 7870 6563 7465 645f 6672  self.expected_fr
+000084e0: 6573 686e 6573 733a 0a20 2020 2020 2020  eshness:.       
+000084f0: 2020 2020 2070 726f 746f 2e65 7870 6563       proto.expec
+00008500: 7465 645f 6672 6573 686e 6573 732e 4672  ted_freshness.Fr
+00008510: 6f6d 5469 6d65 6465 6c74 6128 7365 6c66  omTimedelta(self
+00008520: 2e65 7870 6563 7465 645f 6672 6573 686e  .expected_freshn
+00008530: 6573 7329 0a0a 2020 2020 2020 2020 7072  ess)..        pr
+00008540: 6f74 6f2e 616c 6572 745f 656d 6169 6c20  oto.alert_email 
+00008550: 3d20 7365 6c66 2e61 6c65 7274 5f65 6d61  = self.alert_ema
+00008560: 696c 206f 7220 2222 0a20 2020 2020 2020  il or "".       
+00008570: 2070 726f 746f 2e6d 6f6e 6974 6f72 5f66   proto.monitor_f
+00008580: 7265 7368 6e65 7373 203d 2073 656c 662e  reshness = self.
+00008590: 6d6f 6e69 746f 725f 6672 6573 686e 6573  monitor_freshnes
+000085a0: 730a 2020 2020 2020 2020 7265 7475 726e  s.        return
+000085b0: 2070 726f 746f 0a0a 0a63 6c61 7373 204c   proto...class L
+000085c0: 6f67 6769 6e67 436f 6e66 6967 2853 7472  oggingConfig(Str
+000085d0: 6963 744d 6f64 656c 293a 0a20 2020 2022  ictModel):.    "
+000085e0: 2222 0a20 2020 2043 6f6e 6669 6775 7261  "".    Configura
+000085f0: 7469 6f6e 2075 7365 6420 746f 2064 6573  tion used to des
+00008600: 6372 6962 6520 6665 6174 7572 6520 616e  cribe feature an
+00008610: 6420 7265 7175 6573 7420 6c6f 6767 696e  d request loggin
+00008620: 6720 666f 7220 4665 6174 7572 6520 5365  g for Feature Se
+00008630: 7276 6963 6573 2e0a 0a20 2020 203a 7061  rvices...    :pa
+00008640: 7261 6d20 7361 6d70 6c65 5f72 6174 653a  ram sample_rate:
+00008650: 2054 6865 2072 6174 6520 6f66 206c 6f67   The rate of log
+00008660: 6769 6e67 2066 6561 7475 7265 732e 204d  ging features. M
+00008670: 7573 7420 6265 2062 6574 7765 656e 2028  ust be between (
+00008680: 302c 2031 5d2e 2044 6566 6175 6c74 7320  0, 1]. Defaults 
+00008690: 746f 2031 2e0a 2020 2020 3a70 6172 616d  to 1..    :param
+000086a0: 206c 6f67 5f65 6666 6563 7469 7665 5f74   log_effective_t
+000086b0: 696d 6573 3a20 5768 6574 6865 7220 746f  imes: Whether to
+000086c0: 206c 6f67 2074 6865 2074 696d 6573 7461   log the timesta
+000086d0: 6d70 7320 6f66 2074 6865 206c 6173 7420  mps of the last 
+000086e0: 7570 6461 7465 206f 6620 7468 6520 6c6f  update of the lo
+000086f0: 6767 6564 2066 6561 7475 7265 2076 616c  gged feature val
+00008700: 7565 732e 2044 6566 6175 6c74 7320 746f  ues. Defaults to
+00008710: 2046 616c 7365 2e0a 0a20 2020 2041 6e20   False...    An 
+00008720: 6578 616d 706c 6520 6f66 204c 6f67 6769  example of Loggi
+00008730: 6e67 436f 6e66 6967 2064 6563 6c61 7261  ngConfig declara
+00008740: 7469 6f6e 2061 7320 7061 7274 206f 6620  tion as part of 
+00008750: 4665 6174 7572 6553 6572 7669 6365 0a0a  FeatureService..
+00008760: 2020 2020 2e2e 2063 6f64 652d 626c 6f63      .. code-bloc
+00008770: 6b3a 3a20 5079 7468 6f6e 0a0a 2020 2020  k:: Python..    
+00008780: 2020 2020 6672 6f6d 2074 6563 746f 6e20      from tecton 
+00008790: 696d 706f 7274 2046 6561 7475 7265 5365  import FeatureSe
+000087a0: 7276 6963 652c 204c 6f67 6769 6e67 436f  rvice, LoggingCo
+000087b0: 6e66 6967 0a0a 2020 2020 2020 2020 2320  nfig..        # 
+000087c0: 4c6f 6767 696e 6743 6f6e 6669 6720 6973  LoggingConfig is
+000087d0: 206e 6f72 6d61 6c79 2075 7365 6420 6173   normaly used as
+000087e0: 2061 206e 616d 6564 2061 7267 756d 656e   a named argumen
+000087f0: 7420 7061 7261 6d65 7465 7220 746f 2061  t parameter to a
+00008800: 2046 6561 7475 7265 5365 7276 6963 6520   FeatureService 
+00008810: 696e 7374 616e 6365 2064 6566 696e 6974  instance definit
+00008820: 696f 6e2e 0a20 2020 2020 2020 206d 795f  ion..        my_
+00008830: 6665 6174 7572 655f 7365 7276 6963 6520  feature_service 
+00008840: 3d20 4665 6174 7572 6553 6572 7669 6365  = FeatureService
+00008850: 280a 2020 2020 2020 2020 2020 2020 6e61  (.            na
+00008860: 6d65 3d22 416e 2065 7861 6d70 6c65 206f  me="An example o
+00008870: 6620 4665 6174 7572 6520 5365 7276 6963  f Feature Servic
+00008880: 6522 0a20 2020 2020 2020 2020 2020 2023  e".            #
+00008890: 204f 7468 6572 206e 616d 6564 2061 7267   Other named arg
+000088a0: 756d 656e 7473 0a20 2020 2020 2020 2020  uments.         
+000088b0: 2020 202e 2e2e 0a20 2020 2020 2020 2020     ....         
+000088c0: 2020 2023 2041 204c 6f67 6769 6e67 436f     # A LoggingCo
+000088d0: 6e66 6967 2069 6e73 7461 6e63 650a 2020  nfig instance.  
+000088e0: 2020 2020 2020 2020 2020 6c6f 6767 696e            loggin
+000088f0: 673d 4c6f 6767 696e 6743 6f6e 6669 6728  g=LoggingConfig(
+00008900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008910: 2020 2020 2073 616d 706c 655f 7261 7465       sample_rate
+00008920: 3d30 2e35 2c0a 2020 2020 2020 2020 2020  =0.5,.          
+00008930: 2020 2020 2020 2020 2020 6c6f 675f 6566            log_ef
+00008940: 6665 6374 6976 655f 7469 6d65 733d 4661  fective_times=Fa
+00008950: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+00008960: 2029 0a20 2020 2020 2020 2020 2020 202e   ).            .
+00008970: 2e2e 0a20 2020 2020 2020 2029 0a20 2020  ...        ).   
+00008980: 2022 2222 0a0a 2020 2020 7361 6d70 6c65   """..    sample
+00008990: 5f72 6174 653a 2066 6c6f 6174 203d 2031  _rate: float = 1
+000089a0: 2e30 0a20 2020 206c 6f67 5f65 6666 6563  .0.    log_effec
+000089b0: 7469 7665 5f74 696d 6573 3a20 626f 6f6c  tive_times: bool
+000089c0: 203d 2046 616c 7365 0a0a 2020 2020 6465   = False..    de
+000089d0: 6620 5f74 6f5f 7072 6f74 6f28 7365 6c66  f _to_proto(self
+000089e0: 2920 2d3e 2066 6561 7475 7265 5f73 6572  ) -> feature_ser
+000089f0: 7669 6365 5f70 6232 2e4c 6f67 6769 6e67  vice_pb2.Logging
+00008a00: 436f 6e66 6967 4172 6773 3a0a 2020 2020  ConfigArgs:.    
+00008a10: 2020 2020 7265 7475 726e 2066 6561 7475      return featu
+00008a20: 7265 5f73 6572 7669 6365 5f70 6232 2e4c  re_service_pb2.L
+00008a30: 6f67 6769 6e67 436f 6e66 6967 4172 6773  oggingConfigArgs
+00008a40: 280a 2020 2020 2020 2020 2020 2020 7361  (.            sa
+00008a50: 6d70 6c65 5f72 6174 653d 7365 6c66 2e73  mple_rate=self.s
+00008a60: 616d 706c 655f 7261 7465 2c20 6c6f 675f  ample_rate, log_
+00008a70: 6566 6665 6374 6976 655f 7469 6d65 733d  effective_times=
+00008a80: 7365 6c66 2e6c 6f67 5f65 6666 6563 7469  self.log_effecti
+00008a90: 7665 5f74 696d 6573 0a20 2020 2020 2020  ve_times.       
+00008aa0: 2029 0a0a 2020 2020 4063 6c61 7373 6d65   )..    @classme
+00008ab0: 7468 6f64 0a20 2020 2064 6566 205f 6672  thod.    def _fr
+00008ac0: 6f6d 5f70 726f 746f 2863 6c73 2c20 6c6f  om_proto(cls, lo
+00008ad0: 6767 696e 675f 636f 6e66 6967 5f70 726f  gging_config_pro
+00008ae0: 746f 3a20 6665 6174 7572 655f 7365 7276  to: feature_serv
+00008af0: 6963 655f 7062 322e 4c6f 6767 696e 6743  ice_pb2.LoggingC
+00008b00: 6f6e 6669 6741 7267 7329 202d 3e20 224c  onfigArgs) -> "L
+00008b10: 6f67 6769 6e67 436f 6e66 6967 223a 0a20  oggingConfig":. 
+00008b20: 2020 2020 2020 2072 6574 7572 6e20 4c6f         return Lo
+00008b30: 6767 696e 6743 6f6e 6669 6728 6c6f 6767  ggingConfig(logg
+00008b40: 696e 675f 636f 6e66 6967 5f70 726f 746f  ing_config_proto
+00008b50: 2e73 616d 706c 655f 7261 7465 2c20 6c6f  .sample_rate, lo
+00008b60: 6767 696e 675f 636f 6e66 6967 5f70 726f  gging_config_pro
+00008b70: 746f 2e6c 6f67 5f65 6666 6563 7469 7665  to.log_effective
+00008b80: 5f74 696d 6573 290a 0a0a 636c 6173 7320  _times)...class 
+00008b90: 4f75 7470 7574 5374 7265 616d 2853 7472  OutputStream(Str
+00008ba0: 6963 744d 6f64 656c 293a 0a20 2020 2022  ictModel):.    "
+00008bb0: 2222 4261 7365 2063 6c61 7373 2066 6f72  ""Base class for
+00008bc0: 206f 7574 7075 7420 7374 7265 616d 2063   output stream c
+00008bd0: 6f6e 6669 6773 2e22 2222 0a0a 2020 2020  onfigs."""..    
+00008be0: 6465 6620 5f74 6f5f 7072 6f74 6f28 2920  def _to_proto() 
+00008bf0: 2d3e 2066 6561 7475 7265 5f76 6965 775f  -> feature_view_
+00008c00: 7062 322e 4f75 7470 7574 5374 7265 616d  pb2.OutputStream
+00008c10: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
+00008c20: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
+00008c30: 726f 720a 0a0a 636c 6173 7320 4b69 6e65  ror...class Kine
+00008c40: 7369 734f 7574 7075 7453 7472 6561 6d28  sisOutputStream(
+00008c50: 4f75 7470 7574 5374 7265 616d 293a 0a20  OutputStream):. 
+00008c60: 2020 2022 2222 436f 6e66 6967 7572 6174     """Configurat
+00008c70: 696f 6e20 7573 6564 2066 6f72 2061 204b  ion used for a K
+00008c80: 696e 6573 6973 206f 7574 7075 7420 7374  inesis output st
+00008c90: 7265 616d 2e0a 0a20 2020 203a 7061 7261  ream...    :para
+00008ca0: 6d20 7374 7265 616d 5f6e 616d 653a 204e  m stream_name: N
+00008cb0: 616d 6520 6f66 2074 6865 204b 696e 6573  ame of the Kines
+00008cc0: 6973 2073 7472 6561 6d2e 0a20 2020 203a  is stream..    :
+00008cd0: 7061 7261 6d20 7265 6769 6f6e 3a20 4157  param region: AW
+00008ce0: 5320 7265 6769 6f6e 206f 6620 7468 6520  S region of the 
+00008cf0: 7374 7265 616d 2c20 652e 673a 2022 7573  stream, e.g: "us
+00008d00: 2d77 6573 742d 3222 2e0a 2020 2020 3a70  -west-2"..    :p
+00008d10: 6172 616d 206f 7074 696f 6e73 3a20 4120  aram options: A 
+00008d20: 6d61 7020 6f66 2061 6464 6974 696f 6e61  map of additiona
+00008d30: 6c20 5370 6172 6b20 7265 6164 5374 7265  l Spark readStre
+00008d40: 616d 206f 7074 696f 6e73 2e20 4f6e 6c79  am options. Only
+00008d50: 2060 726f 6c65 4172 6e60 2069 7320 7375   `roleArn` is su
+00008d60: 7070 6f72 7465 642e 0a20 2020 203a 7061  pported..    :pa
+00008d70: 7261 6d20 696e 636c 7564 655f 6665 6174  ram include_feat
+00008d80: 7572 6573 3a20 5265 7475 726e 2066 6561  ures: Return fea
+00008d90: 7475 7265 2076 616c 7565 7320 696e 2061  ture values in a
+00008da0: 6464 6974 696f 6e20 746f 2065 6e74 6974  ddition to entit
+00008db0: 7920 6b65 7973 2e20 4e6f 7420 7375 7070  y keys. Not supp
+00008dc0: 6f72 7465 6420 666f 7220 7769 6e64 6f77  orted for window
+00008dd0: 2061 6767 7265 6761 7465 2046 6561 7475   aggregate Featu
+00008de0: 7265 2056 6965 7773 2e0a 2020 2020 2222  re Views..    ""
+00008df0: 220a 0a20 2020 2073 7472 6561 6d5f 6e61  "..    stream_na
+00008e00: 6d65 3a20 7374 720a 2020 2020 7265 6769  me: str.    regi
+00008e10: 6f6e 3a20 7374 720a 2020 2020 6f70 7469  on: str.    opti
+00008e20: 6f6e 733a 204f 7074 696f 6e61 6c5b 4469  ons: Optional[Di
+00008e30: 6374 5b73 7472 2c20 7374 725d 5d20 3d20  ct[str, str]] = 
+00008e40: 4e6f 6e65 0a20 2020 2069 6e63 6c75 6465  None.    include
+00008e50: 5f66 6561 7475 7265 733a 2062 6f6f 6c20  _features: bool 
+00008e60: 3d20 4661 6c73 650a 0a20 2020 2064 6566  = False..    def
+00008e70: 205f 746f 5f70 726f 746f 2873 656c 6629   _to_proto(self)
+00008e80: 202d 3e20 6665 6174 7572 655f 7669 6577   -> feature_view
+00008e90: 5f70 6232 2e4f 7574 7075 7453 7472 6561  _pb2.OutputStrea
+00008ea0: 6d3a 0a20 2020 2020 2020 2061 7267 7320  m:.        args 
+00008eb0: 3d20 6461 7461 5f73 6f75 7263 655f 7062  = data_source_pb
+00008ec0: 322e 4b69 6e65 7369 7344 6174 6153 6f75  2.KinesisDataSou
+00008ed0: 7263 6541 7267 7328 0a20 2020 2020 2020  rceArgs(.       
+00008ee0: 2020 2020 2073 7472 6561 6d5f 6e61 6d65       stream_name
+00008ef0: 3d73 656c 662e 7374 7265 616d 5f6e 616d  =self.stream_nam
+00008f00: 652c 0a20 2020 2020 2020 2020 2020 2072  e,.            r
+00008f10: 6567 696f 6e3d 7365 6c66 2e72 6567 696f  egion=self.regio
+00008f20: 6e2c 0a20 2020 2020 2020 2029 0a20 2020  n,.        ).   
+00008f30: 2020 2020 206f 7074 696f 6e73 203d 2073       options = s
+00008f40: 656c 662e 6f70 7469 6f6e 7320 6f72 207b  elf.options or {
+00008f50: 7d0a 2020 2020 2020 2020 666f 7220 6b65  }.        for ke
+00008f60: 7920 696e 2073 6f72 7465 6428 6f70 7469  y in sorted(opti
+00008f70: 6f6e 732e 6b65 7973 2829 293a 0a20 2020  ons.keys()):.   
+00008f80: 2020 2020 2020 2020 206f 7074 696f 6e20           option 
+00008f90: 3d20 6461 7461 5f73 6f75 7263 655f 7062  = data_source_pb
+00008fa0: 322e 4f70 7469 6f6e 280a 2020 2020 2020  2.Option(.      
+00008fb0: 2020 2020 2020 2020 2020 6b65 793d 6b65            key=ke
+00008fc0: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+00008fd0: 2020 2076 616c 7565 3d6f 7074 696f 6e73     value=options
+00008fe0: 5b6b 6579 5d2c 0a20 2020 2020 2020 2020  [key],.         
+00008ff0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00009000: 2061 7267 732e 6f70 7469 6f6e 732e 6170   args.options.ap
+00009010: 7065 6e64 286f 7074 696f 6e29 0a0a 2020  pend(option)..  
+00009020: 2020 2020 2020 7265 7475 726e 2066 6561        return fea
+00009030: 7475 7265 5f76 6965 775f 7062 322e 4f75  ture_view_pb2.Ou
+00009040: 7470 7574 5374 7265 616d 280a 2020 2020  tputStream(.    
+00009050: 2020 2020 2020 2020 696e 636c 7564 655f          include_
+00009060: 6665 6174 7572 6573 3d73 656c 662e 696e  features=self.in
+00009070: 636c 7564 655f 6665 6174 7572 6573 2c0a  clude_features,.
+00009080: 2020 2020 2020 2020 2020 2020 6b69 6e65              kine
+00009090: 7369 733d 6172 6773 2c0a 2020 2020 2020  sis=args,.      
+000090a0: 2020 290a 0a0a 636c 6173 7320 4b61 666b    )...class Kafk
+000090b0: 614f 7574 7075 7453 7472 6561 6d28 4f75  aOutputStream(Ou
+000090c0: 7470 7574 5374 7265 616d 293a 0a20 2020  tputStream):.   
+000090d0: 2022 2222 436f 6e66 6967 7572 6174 696f   """Configuratio
+000090e0: 6e20 7573 6564 2066 6f72 2061 204b 6166  n used for a Kaf
+000090f0: 6b61 206f 7574 7075 7420 7374 7265 616d  ka output stream
+00009100: 2e0a 0a20 2020 203a 7061 7261 6d20 6b61  ...    :param ka
+00009110: 666b 615f 626f 6f74 7374 7261 705f 7365  fka_bootstrap_se
+00009120: 7276 6572 733a 2054 6865 206c 6973 7420  rvers: The list 
+00009130: 6f66 2062 6f6f 7473 7472 6170 2073 6572  of bootstrap ser
+00009140: 7665 7273 2066 6f72 2079 6f75 7220 4b61  vers for your Ka
+00009150: 666b 6120 6272 6f6b 6572 732c 2065 2e67  fka brokers, e.g
+00009160: 3a20 2261 6263 2e78 797a 2e63 6f6d 3a78  : "abc.xyz.com:x
+00009170: 7878 782c 6162 6332 2e78 797a 2e63 6f6d  xxx,abc2.xyz.com
+00009180: 3a78 7878 7822 2e0a 2020 2020 3a70 6172  :xxxx"..    :par
+00009190: 616d 2074 6f70 6963 733a 2041 2063 6f6d  am topics: A com
+000091a0: 6d61 2d73 6570 6172 6174 6564 206c 6973  ma-separated lis
+000091b0: 7420 6f66 204b 6166 6b61 2074 6f70 6963  t of Kafka topic
+000091c0: 7320 7468 6520 7265 636f 7264 2077 696c  s the record wil
+000091d0: 6c20 6265 2061 7070 656e 6465 6420 746f  l be appended to
+000091e0: 2e20 4375 7272 656e 746c 7920 6f6e 6c79  . Currently only
+000091f0: 2073 7570 706f 7274 7320 6f6e 6520 746f   supports one to
+00009200: 7069 632e 0a20 2020 203a 7061 7261 6d20  pic..    :param 
+00009210: 6f70 7469 6f6e 733a 2041 206d 6170 206f  options: A map o
+00009220: 6620 6164 6469 7469 6f6e 616c 2053 7061  f additional Spa
+00009230: 726b 2072 6561 6453 7472 6561 6d20 6f70  rk readStream op
+00009240: 7469 6f6e 732e 204f 6e6c 7920 6072 6f6c  tions. Only `rol
+00009250: 6541 726e 6020 6973 2073 7570 706f 7274  eArn` is support
+00009260: 6564 2061 7420 7468 6520 6d6f 6d65 6e74  ed at the moment
+00009270: 2e0a 2020 2020 3a70 6172 616d 2069 6e63  ..    :param inc
+00009280: 6c75 6465 5f66 6561 7475 7265 733a 2052  lude_features: R
+00009290: 6574 7572 6e20 6665 6174 7572 6520 7661  eturn feature va
+000092a0: 6c75 6573 2069 6e20 6164 6469 7469 6f6e  lues in addition
+000092b0: 2074 6f20 656e 7469 7479 206b 6579 732e   to entity keys.
+000092c0: 204e 6f74 2073 7570 706f 7274 6564 2066   Not supported f
+000092d0: 6f72 2077 696e 646f 7720 6167 6772 6567  or window aggreg
+000092e0: 6174 6520 4665 6174 7572 6520 5669 6577  ate Feature View
+000092f0: 732e 0a20 2020 2022 2222 0a0a 2020 2020  s..    """..    
+00009300: 6b61 666b 615f 626f 6f74 7374 7261 705f  kafka_bootstrap_
+00009310: 7365 7276 6572 733a 2073 7472 0a20 2020  servers: str.   
+00009320: 2074 6f70 6963 733a 2073 7472 0a20 2020   topics: str.   
+00009330: 206f 7074 696f 6e73 3a20 4f70 7469 6f6e   options: Option
+00009340: 616c 5b44 6963 745b 7374 722c 2073 7472  al[Dict[str, str
+00009350: 5d5d 203d 204e 6f6e 650a 2020 2020 696e  ]] = None.    in
+00009360: 636c 7564 655f 6665 6174 7572 6573 3a20  clude_features: 
+00009370: 626f 6f6c 203d 2046 616c 7365 0a0a 2020  bool = False..  
+00009380: 2020 6465 6620 5f74 6f5f 7072 6f74 6f28    def _to_proto(
+00009390: 7365 6c66 2920 2d3e 2066 6561 7475 7265  self) -> feature
+000093a0: 5f76 6965 775f 7062 322e 4f75 7470 7574  _view_pb2.Output
+000093b0: 5374 7265 616d 3a0a 2020 2020 2020 2020  Stream:.        
+000093c0: 6172 6773 203d 2064 6174 615f 736f 7572  args = data_sour
+000093d0: 6365 5f70 6232 2e4b 6166 6b61 4461 7461  ce_pb2.KafkaData
+000093e0: 536f 7572 6365 4172 6773 280a 2020 2020  SourceArgs(.    
+000093f0: 2020 2020 2020 2020 6b61 666b 615f 626f          kafka_bo
+00009400: 6f74 7374 7261 705f 7365 7276 6572 733d  otstrap_servers=
+00009410: 7365 6c66 2e6b 6166 6b61 5f62 6f6f 7473  self.kafka_boots
+00009420: 7472 6170 5f73 6572 7665 7273 2c0a 2020  trap_servers,.  
+00009430: 2020 2020 2020 2020 2020 746f 7069 6373            topics
+00009440: 3d73 656c 662e 746f 7069 6373 2c0a 2020  =self.topics,.  
+00009450: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00009460: 6f70 7469 6f6e 7320 3d20 7365 6c66 2e6f  options = self.o
+00009470: 7074 696f 6e73 206f 7220 7b7d 0a20 2020  ptions or {}.   
+00009480: 2020 2020 2066 6f72 206b 6579 2069 6e20       for key in 
+00009490: 736f 7274 6564 286f 7074 696f 6e73 2e6b  sorted(options.k
+000094a0: 6579 7328 2929 3a0a 2020 2020 2020 2020  eys()):.        
+000094b0: 2020 2020 6f70 7469 6f6e 203d 2064 6174      option = dat
+000094c0: 615f 736f 7572 6365 5f70 6232 2e4f 7074  a_source_pb2.Opt
+000094d0: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+000094e0: 2020 2020 206b 6579 3d6b 6579 2c0a 2020       key=key,.  
+000094f0: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00009500: 6c75 653d 6f70 7469 6f6e 735b 6b65 795d  lue=options[key]
+00009510: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00009520: 2020 2020 2020 2020 2020 2020 6172 6773              args
+00009530: 2e6f 7074 696f 6e73 2e61 7070 656e 6428  .options.append(
+00009540: 6f70 7469 6f6e 290a 0a20 2020 2020 2020  option)..       
+00009550: 2072 6574 7572 6e20 6665 6174 7572 655f   return feature_
+00009560: 7669 6577 5f70 6232 2e4f 7574 7075 7453  view_pb2.OutputS
+00009570: 7472 6561 6d28 0a20 2020 2020 2020 2020  tream(.         
+00009580: 2020 2069 6e63 6c75 6465 5f66 6561 7475     include_featu
+00009590: 7265 733d 7365 6c66 2e69 6e63 6c75 6465  res=self.include
+000095a0: 5f66 6561 7475 7265 732c 0a20 2020 2020  _features,.     
+000095b0: 2020 2020 2020 206b 6166 6b61 3d61 7267         kafka=arg
+000095c0: 732c 0a20 2020 2020 2020 2029 0a0a 0a63  s,.        )...c
+000095d0: 6c61 7373 2044 6174 6574 696d 6550 6172  lass DatetimePar
+000095e0: 7469 7469 6f6e 436f 6c75 6d6e 2853 7472  titionColumn(Str
+000095f0: 6963 744d 6f64 656c 293a 0a20 2020 2022  ictModel):.    "
+00009600: 2222 4865 6c70 6572 2063 6c61 7373 2074  ""Helper class t
+00009610: 6f20 7465 6c6c 2054 6563 746f 6e20 686f  o tell Tecton ho
+00009620: 7720 756e 6465 726c 7969 6e67 2066 6c61  w underlying fla
+00009630: 7420 6669 6c65 7320 6172 6520 6461 7465  t files are date
+00009640: 2f74 696d 6520 7061 7274 6974 696f 6e65  /time partitione
+00009650: 6420 666f 7220 4869 7665 2f47 6c75 6520  d for Hive/Glue 
+00009660: 6461 7461 2073 6f75 7263 6573 2e20 5468  data sources. Th
+00009670: 6973 2063 616e 2074 7261 6e73 6c61 7465  is can translate
+00009680: 2069 6e74 6f20 6120 7369 676e 6966 6963   into a signific
+00009690: 616e 7420 7065 7266 6f72 6d61 6e63 6520  ant performance 
+000096a0: 696e 6372 6561 7365 2e0a 0a20 2020 2059  increase...    Y
+000096b0: 6f75 2077 696c 6c20 6765 6e65 7261 6c6c  ou will generall
+000096c0: 7920 696e 636c 7564 6520 616e 206f 626a  y include an obj
+000096d0: 6563 7420 6f66 2074 6869 7320 636c 6173  ect of this clas
+000096e0: 7320 696e 2074 6865 2060 6064 6174 6574  s in the ``datet
+000096f0: 696d 655f 7061 7274 6974 696f 6e5f 636f  ime_partition_co
+00009700: 6c75 6d6e 7360 6020 6f70 7469 6f6e 2069  lumns`` option i
+00009710: 6e20 6120 3a63 6c61 7373 3a60 4869 7665  n a :class:`Hive
+00009720: 436f 6e66 6967 6020 6f62 6a65 6374 2e0a  Config` object..
+00009730: 0a20 2020 203a 7061 7261 6d20 636f 6c75  .    :param colu
+00009740: 6d6e 5f6e 616d 653a 2054 6865 206e 616d  mn_name: The nam
+00009750: 6520 6f66 2074 6865 2063 6f6c 756d 6e20  e of the column 
+00009760: 696e 2074 6865 2047 6c75 652f 4869 7665  in the Glue/Hive
+00009770: 2073 6368 656d 6120 7468 6174 2063 6f72   schema that cor
+00009780: 7265 7370 6f6e 6473 2074 6f20 7468 6520  responds to the 
+00009790: 756e 6465 726c 7969 6e67 2064 6174 652f  underlying date/
+000097a0: 7469 6d65 2070 6172 7469 7469 6f6e 2066  time partition f
+000097b0: 6f6c 6465 722e 204e 6f74 6520 7468 6174  older. Note that
+000097c0: 2069 6620 796f 7520 646f 206e 6f74 2065   if you do not e
+000097d0: 7870 6c69 6369 746c 7920 7370 6563 6966  xplicitly specif
+000097e0: 7920 6120 6e61 6d65 2069 6e20 796f 7572  y a name in your
+000097f0: 2070 6172 7469 7469 6f6e 2066 6f6c 6465   partition folde
+00009800: 7273 2c20 476c 7565 2077 696c 6c20 6e61  rs, Glue will na
+00009810: 6d65 2074 6865 2063 6f6c 756d 6e20 6f66  me the column of
+00009820: 2074 6865 2066 6f72 6d20 6060 7061 7274   the form ``part
+00009830: 6974 696f 6e5f 3060 602e 0a20 2020 203a  ition_0``..    :
+00009840: 7061 7261 6d20 6461 7465 7061 7274 3a20  param datepart: 
+00009850: 5468 6520 7061 7274 206f 6620 7468 6520  The part of the 
+00009860: 6461 7465 2074 6861 7420 7468 6973 2063  date that this c
+00009870: 6f6c 756d 6e20 7370 6563 6966 6965 732e  olumn specifies.
+00009880: 2043 616e 2062 6520 6f6e 6520 6f66 2022   Can be one of "
+00009890: 7965 6172 222c 2022 6d6f 6e74 6822 2c20  year", "month", 
+000098a0: 2264 6179 222c 2022 686f 7572 222c 206f  "day", "hour", o
+000098b0: 7220 7468 6520 6675 6c6c 2022 6461 7465  r the full "date
+000098c0: 222e 2049 6620 7573 6564 2077 6974 6820  ". If used with 
+000098d0: 6060 666f 726d 6174 5f73 7472 696e 6760  ``format_string`
+000098e0: 602c 2074 6869 7320 7368 6f75 6c64 2062  `, this should b
+000098f0: 6520 7468 6520 7369 7a65 206f 6620 7061  e the size of pa
+00009900: 7274 6974 696f 6e20 6265 696e 6720 7265  rtition being re
+00009910: 7072 6573 656e 7465 642c 2065 2e67 2e20  presented, e.g. 
+00009920: 6060 6461 7465 7061 7274 3d22 6d6f 6e74  ``datepart="mont
+00009930: 6822 6060 2066 6f72 2060 6066 6f72 6d61  h"`` for ``forma
+00009940: 745f 7374 7269 6e67 3d22 2559 2d25 6d22  t_string="%Y-%m"
+00009950: 6060 2e0a 2020 2020 3a70 6172 616d 207a  ``..    :param z
+00009960: 6572 6f5f 7061 6464 6564 3a20 5768 6574  ero_padded: Whet
+00009970: 6865 7220 7468 6520 6060 6461 7465 7061  her the ``datepa
+00009980: 7274 6060 2068 6173 2061 206c 6561 6469  rt`` has a leadi
+00009990: 6e67 207a 6572 6f20 6966 206c 6573 7320  ng zero if less 
+000099a0: 7468 616e 2074 776f 2064 6967 6974 732e  than two digits.
+000099b0: 2054 6869 7320 6d75 7374 2062 6520 7365   This must be se
+000099c0: 7420 746f 2054 7275 6520 6966 2060 6064  t to True if ``d
+000099d0: 6174 6570 6172 743d 2264 6174 6522 6060  atepart="date"``
+000099e0: 2e20 2853 686f 756c 6420 6e6f 7420 6265  . (Should not be
+000099f0: 2073 6574 2069 6620 6060 666f 726d 6174   set if ``format
+00009a00: 5f73 7472 696e 6760 6020 6973 2073 6574  _string`` is set
+00009a10: 2e29 0a20 2020 203a 7061 7261 6d20 666f  .).    :param fo
+00009a20: 726d 6174 5f73 7472 696e 673a 0a20 2020  rmat_string:.   
+00009a30: 2020 2020 2041 2060 6064 6174 6574 696d       A ``datetim
+00009a40: 652e 7374 7266 7469 6d65 6060 2066 6f72  e.strftime`` for
+00009a50: 6d61 7420 7374 7269 6e67 206f 7665 7272  mat string overr
+00009a60: 6964 6520 666f 7220 226e 6f6e 2d64 6566  ide for "non-def
+00009a70: 6175 6c74 2220 7061 7274 6974 696f 6e20  ault" partition 
+00009a80: 636f 6c75 6d6e 7320 666f 726d 6174 732e  columns formats.
+00009a90: 2045 2e67 2e20 6060 2225 5925 6d25 6422   E.g. ``"%Y%m%d"
+00009aa0: 6060 2066 6f72 2060 6064 6174 6570 6172  `` for ``datepar
+00009ab0: 743d 2264 6174 6522 6060 2069 6e73 7465  t="date"`` inste
+00009ac0: 6164 206f 6620 7468 6520 5465 6374 6f6e  ad of the Tecton
+00009ad0: 2064 6566 6175 6c74 2060 6022 2559 2d25   default ``"%Y-%
+00009ae0: 6d2d 2564 2260 602c 206f 7220 6060 2225  m-%d"``, or ``"%
+00009af0: 592d 256d 2260 6020 666f 7220 6060 6461  Y-%m"`` for ``da
+00009b00: 7465 7061 7274 3d22 6d6f 6e74 6822 6060  tepart="month"``
+00009b10: 2069 6e73 7465 6164 206f 6620 7468 6520   instead of the 
+00009b20: 5465 6374 6f6e 2064 6566 6175 6c74 2060  Tecton default `
+00009b30: 6022 256d 2260 602e 0a0a 2020 2020 2020  `"%m"``...      
+00009b40: 2020 494d 504f 5254 414e 543a 2054 6869    IMPORTANT: Thi
+00009b50: 7320 666f 726d 6174 2073 7472 696e 6720  s format string 
+00009b60: 6d75 7374 2063 6f6e 7665 7274 2070 7974  must convert pyt
+00009b70: 686f 6e20 6461 7465 7469 6d65 7320 2876  hon datetimes (v
+00009b80: 6961 2060 6064 6174 6574 696d 652e 7374  ia ``datetime.st
+00009b90: 7266 7469 6d65 2866 6f72 6d61 7429 6060  rftime(format)``
+00009ba0: 2920 746f 2073 7472 696e 6773 2074 6861  ) to strings tha
+00009bb0: 7420 6172 6520 736f 7274 6162 6c65 2069  t are sortable i
+00009bc0: 6e20 7469 6d65 206f 7264 6572 2e20 466f  n time order. Fo
+00009bd0: 7220 6578 616d 706c 652c 2060 6022 256d  r example, ``"%m
+00009be0: 2d25 5922 6060 2077 6f75 6c64 2062 6520  -%Y"`` would be 
+00009bf0: 616e 2069 6e76 616c 6964 2066 6f72 6d61  an invalid forma
+00009c00: 7420 7374 7269 6e67 2062 6563 6175 7365  t string because
+00009c10: 2060 6022 3039 2d32 3031 3922 203e 2022   ``"09-2019" > "
+00009c20: 3035 2d32 3032 3022 6060 2e0a 0a20 2020  05-2020"``...   
+00009c30: 2020 2020 2053 6565 2068 7474 7073 3a2f       See https:/
+00009c40: 2f64 6f63 732e 7079 7468 6f6e 2e6f 7267  /docs.python.org
+00009c50: 2f33 2f6c 6962 7261 7279 2f64 6174 6574  /3/library/datet
+00009c60: 696d 652e 6874 6d6c 2373 7472 6674 696d  ime.html#strftim
+00009c70: 652d 616e 642d 7374 7270 7469 6d65 2d66  e-and-strptime-f
+00009c80: 6f72 6d61 742d 636f 6465 7320 666f 7220  ormat-codes for 
+00009c90: 666f 726d 6174 2063 6f64 6573 2e0a 0a20  format codes... 
+00009ca0: 2020 2045 7861 6d70 6c65 2064 6566 696e     Example defin
+00009cb0: 6974 696f 6e73 3a0a 0a20 2020 2020 2020  itions:..       
+00009cc0: 2041 7373 756d 6520 796f 7520 6861 7665   Assume you have
+00009cd0: 2061 6e20 5333 2062 7563 6b65 7420 7769   an S3 bucket wi
+00009ce0: 7468 2070 6172 7175 6574 2066 696c 6573  th parquet files
+00009cf0: 2073 746f 7265 6420 696e 2074 6865 2066   stored in the f
+00009d00: 6f6c 6c6f 7769 6e67 2073 7472 7563 7475  ollowing structu
+00009d10: 7265 3a20 6060 7333 3a2f 2f6d 7962 7563  re: ``s3://mybuc
+00009d20: 6b65 742f 3230 3232 2f30 352f 3034 2f3c  ket/2022/05/04/<
+00009d30: 6d75 6c74 6970 6c65 2070 6172 7175 6574  multiple parquet
+00009d40: 2066 696c 6573 3e60 6020 2c20 7768 6572   files>`` , wher
+00009d50: 6520 6060 3230 3232 6060 2069 7320 7468  e ``2022`` is th
+00009d60: 6520 7965 6172 2c20 6060 3035 6060 2069  e year, ``05`` i
+00009d70: 7320 7468 6520 6d6f 6e74 682c 2061 6e64  s the month, and
+00009d80: 2060 6030 3460 6020 6973 2074 6865 2064   ``04`` is the d
+00009d90: 6179 206f 6620 7468 6520 6d6f 6e74 682e  ay of the month.
+00009da0: 2049 6e20 7468 6973 2073 6365 6e61 7269   In this scenari
+00009db0: 6f2c 2079 6f75 2063 6f75 6c64 2075 7365  o, you could use
+00009dc0: 2074 6865 2066 6f6c 6c6f 7769 6e67 2064   the following d
+00009dd0: 6566 696e 6974 696f 6e3a 0a0a 2020 2020  efinition:..    
+00009de0: 2020 2020 2e2e 2063 6f64 652d 626c 6f63      .. code-bloc
+00009df0: 6b3a 3a20 7079 7468 6f6e 0a0a 2020 2020  k:: python..    
+00009e00: 2020 2020 2020 2020 6461 7465 7469 6d65          datetime
+00009e10: 5f70 6172 7469 7469 6f6e 5f63 6f6c 756d  _partition_colum
+00009e20: 6e73 203d 205b 0a20 2020 2020 2020 2020  ns = [.         
+00009e30: 2020 2020 2020 2044 6174 6574 696d 6550         DatetimeP
+00009e40: 6172 7469 7469 6f6e 436f 6c75 6d6e 2863  artitionColumn(c
+00009e50: 6f6c 756d 6e5f 6e61 6d65 3d22 7061 7274  olumn_name="part
+00009e60: 6974 696f 6e5f 3022 2c20 6461 7465 7061  ition_0", datepa
+00009e70: 7274 3d22 7965 6172 222c 207a 6572 6f5f  rt="year", zero_
+00009e80: 7061 6464 6564 3d54 7275 6529 2c0a 2020  padded=True),.  
+00009e90: 2020 2020 2020 2020 2020 2020 2020 4461                Da
+00009ea0: 7465 7469 6d65 5061 7274 6974 696f 6e43  tetimePartitionC
+00009eb0: 6f6c 756d 6e28 636f 6c75 6d6e 5f6e 616d  olumn(column_nam
+00009ec0: 653d 2270 6172 7469 7469 6f6e 5f31 222c  e="partition_1",
+00009ed0: 2064 6174 6570 6172 743d 226d 6f6e 7468   datepart="month
+00009ee0: 222c 207a 6572 6f5f 7061 6464 6564 3d54  ", zero_padded=T
+00009ef0: 7275 6529 2c0a 2020 2020 2020 2020 2020  rue),.          
+00009f00: 2020 2020 2020 4461 7465 7469 6d65 5061        DatetimePa
+00009f10: 7274 6974 696f 6e43 6f6c 756d 6e28 636f  rtitionColumn(co
+00009f20: 6c75 6d6e 5f6e 616d 653d 2270 6172 7469  lumn_name="parti
+00009f30: 7469 6f6e 5f32 222c 2064 6174 6570 6172  tion_2", datepar
+00009f40: 743d 2264 6179 222c 207a 6572 6f5f 7061  t="day", zero_pa
+00009f50: 6464 6564 3d54 7275 6529 2c0a 2020 2020  dded=True),.    
+00009f60: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
+00009f70: 2020 2020 2020 6261 7463 685f 636f 6e66        batch_conf
+00009f80: 6967 203d 2048 6976 6543 6f6e 6669 6728  ig = HiveConfig(
+00009f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009fa0: 2064 6174 6162 6173 653d 276d 795f 6462   database='my_db
+00009fb0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+00009fc0: 2020 2074 6162 6c65 3d27 6d79 5f74 6162     table='my_tab
+00009fd0: 6c65 272c 0a20 2020 2020 2020 2020 2020  le',.           
+00009fe0: 2020 2020 2074 696d 6573 7461 6d70 5f66       timestamp_f
+00009ff0: 6965 6c64 3d27 7469 6d65 7374 616d 7027  ield='timestamp'
+0000a000: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000a010: 2020 6461 7465 7469 6d65 5f70 6172 7469    datetime_parti
+0000a020: 7469 6f6e 5f63 6f6c 756d 6e73 3d64 6174  tion_columns=dat
+0000a030: 6574 696d 655f 7061 7274 6974 696f 6e5f  etime_partition_
+0000a040: 636f 6c75 6d6e 732c 0a20 2020 2020 2020  columns,.       
+0000a050: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0000a060: 4578 616d 706c 6520 7573 696e 6720 7468  Example using th
+0000a070: 6520 6060 666f 726d 6174 5f73 7472 696e  e ``format_strin
+0000a080: 6760 6020 7061 7261 6d65 7465 722e 2041  g`` parameter. A
+0000a090: 7373 756d 6520 796f 7572 2064 6174 6120  ssume your data 
+0000a0a0: 6973 2070 6172 7469 7469 6f6e 6564 2062  is partitioned b
+0000a0b0: 7920 6060 2259 5959 592d 4d4d 2260 602c  y ``"YYYY-MM"``,
+0000a0c0: 2065 2e67 2e20 6060 7333 3a2f 2f6d 7962   e.g. ``s3://myb
+0000a0d0: 7563 6b65 742f 3230 3232 2d30 352f 3c6d  ucket/2022-05/<m
+0000a0e0: 756c 7469 706c 6520 7061 7271 7565 7420  ultiple parquet 
+0000a0f0: 6669 6c65 733e 6060 2e20 5465 6374 6f6e  files>``. Tecton
+0000a100: 2773 2064 6566 6175 6c74 206d 6f6e 7468  's default month
+0000a110: 2066 6f72 6d61 7420 6973 2060 6022 256d   format is ``"%m
+0000a120: 2260 602c 2077 6869 6368 2077 6f75 6c64  "``, which would
+0000a130: 2066 6169 6c20 746f 2066 6f72 6d61 7420   fail to format 
+0000a140: 6461 7465 7469 6d65 2073 7472 696e 6773  datetime strings
+0000a150: 2074 6861 7420 6172 6520 636f 6d70 6172   that are compar
+0000a160: 6162 6c65 2074 6f20 796f 7572 2074 6162  able to your tab
+0000a170: 6c65 2773 2070 6172 7469 7469 6f6e 2063  le's partition c
+0000a180: 6f6c 756d 6e2c 2073 6f20 7468 6520 6465  olumn, so the de
+0000a190: 6669 6e69 7469 6f6e 206e 6565 6473 2074  finition needs t
+0000a1a0: 6f20 7370 6563 6966 7920 616e 206f 7665  o specify an ove
+0000a1b0: 7272 6964 652e 0a0a 2020 2020 2020 2020  rride...        
+0000a1c0: 2e2e 2063 6f64 652d 626c 6f63 6b3a 3a20  .. code-block:: 
+0000a1d0: 7079 7468 6f6e 0a0a 2020 2020 2020 2020  python..        
+0000a1e0: 2020 2020 6461 7465 7469 6d65 5f70 6172      datetime_par
+0000a1f0: 7469 7469 6f6e 5f63 6f6c 756d 6e73 203d  tition_columns =
+0000a200: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+0000a210: 2020 2044 6174 6574 696d 6550 6172 7469     DatetimeParti
+0000a220: 7469 6f6e 436f 6c75 6d6e 2863 6f6c 756d  tionColumn(colum
+0000a230: 6e5f 6e61 6d65 3d22 7061 7274 6974 696f  n_name="partitio
+0000a240: 6e5f 3122 2c20 6461 7465 7061 7274 3d22  n_1", datepart="
+0000a250: 6d6f 6e74 6822 2c20 666f 726d 6174 5f73  month", format_s
+0000a260: 7472 696e 673d 2225 592d 256d 2229 2c0a  tring="%Y-%m"),.
+0000a270: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+0000a280: 2020 2222 220a 0a20 2020 2023 3a20 5468    """..    #: Th
+0000a290: 6520 6e61 6d65 206f 6620 7468 6520 636f  e name of the co
+0000a2a0: 6c75 6d6e 2069 6e20 7468 6520 476c 7565  lumn in the Glue
+0000a2b0: 2f48 6976 6520 7363 6865 6d61 2074 6861  /Hive schema tha
+0000a2c0: 7420 636f 7272 6573 706f 6e64 7320 746f  t corresponds to
+0000a2d0: 2074 6865 2075 6e64 6572 6c79 696e 6720   the underlying 
+0000a2e0: 6461 7465 2f74 696d 6520 7061 7274 6974  date/time partit
+0000a2f0: 696f 6e20 666f 6c64 6572 2e0a 2020 2020  ion folder..    
+0000a300: 636f 6c75 6d6e 5f6e 616d 653a 2073 7472  column_name: str
+0000a310: 0a0a 2020 2020 233a 2054 6865 2070 6172  ..    #: The par
+0000a320: 7420 6f66 2074 6865 2064 6174 6520 7468  t of the date th
+0000a330: 6174 2074 6869 7320 636f 6c75 6d6e 2073  at this column s
+0000a340: 7065 6369 6669 6573 2e20 4361 6e20 6265  pecifies. Can be
+0000a350: 206f 6e65 206f 6620 2279 6561 7222 2c20   one of "year", 
+0000a360: 226d 6f6e 7468 222c 2022 6461 7922 2c20  "month", "day", 
+0000a370: 2268 6f75 7222 2c20 6f72 2074 6865 2066  "hour", or the f
+0000a380: 756c 6c20 2264 6174 6522 2e0a 2020 2020  ull "date"..    
+0000a390: 6461 7465 7061 7274 3a20 7374 720a 0a20  datepart: str.. 
+0000a3a0: 2020 2023 3a20 5768 6574 6865 7220 7468     #: Whether th
+0000a3b0: 6520 6060 6461 7465 7061 7274 6060 2068  e ``datepart`` h
+0000a3c0: 6173 2061 206c 6561 6469 6e67 207a 6572  as a leading zer
+0000a3d0: 6f20 6966 206c 6573 7320 7468 616e 2074  o if less than t
+0000a3e0: 776f 2064 6967 6974 732e 0a20 2020 207a  wo digits..    z
+0000a3f0: 6572 6f5f 7061 6464 6564 3a20 626f 6f6c  ero_padded: bool
+0000a400: 203d 2046 616c 7365 0a0a 2020 2020 233a   = False..    #:
+0000a410: 2041 2060 6064 6174 6574 696d 652e 7374   A ``datetime.st
+0000a420: 7266 7469 6d65 6060 2066 6f72 6d61 7420  rftime`` format 
+0000a430: 7374 7269 6e67 206f 7665 7272 6964 6520  string override 
+0000a440: 666f 7220 226e 6f6e 2d64 6566 6175 6c74  for "non-default
+0000a450: 2220 7061 7274 6974 696f 6e20 636f 6c75  " partition colu
+0000a460: 6d6e 7320 666f 726d 6174 732e 0a20 2020  mns formats..   
+0000a470: 2066 6f72 6d61 745f 7374 7269 6e67 3a20   format_string: 
+0000a480: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+0000a490: 4e6f 6e65 0a0a 0a63 6c61 7373 2052 6571  None...class Req
+0000a4a0: 7565 7374 536f 7572 6365 2853 7472 6963  uestSource(Stric
+0000a4b0: 744d 6f64 656c 293a 0a20 2020 2022 2222  tModel):.    """
+0000a4c0: 4465 636c 6172 6520 6120 6060 5265 7175  Declare a ``Requ
+0000a4d0: 6573 7453 6f75 7263 6560 602c 2066 6f72  estSource``, for
+0000a4e0: 2075 7369 6e67 2072 6571 7565 7374 2d74   using request-t
+0000a4f0: 696d 6520 6461 7461 2069 6e20 616e 2060  ime data in an `
+0000a500: 604f 6e44 656d 616e 6446 6561 7475 7265  `OnDemandFeature
+0000a510: 5669 6577 6060 2e0a 0a20 2020 2045 7861  View``...    Exa
+0000a520: 6d70 6c65 206f 6620 6120 5265 7175 6573  mple of a Reques
+0000a530: 7453 6f75 7263 6520 6465 636c 6172 6174  tSource declarat
+0000a540: 696f 6e3a 0a0a 2020 2020 2e2e 2063 6f64  ion:..    .. cod
+0000a550: 652d 626c 6f63 6b3a 3a20 7079 7468 6f6e  e-block:: python
+0000a560: 0a0a 2020 2020 2020 2020 6672 6f6d 2074  ..        from t
+0000a570: 6563 746f 6e20 696d 706f 7274 2052 6571  ecton import Req
+0000a580: 7565 7374 536f 7572 6365 0a20 2020 2020  uestSource.     
+0000a590: 2020 2066 726f 6d20 7465 6374 6f6e 2e74     from tecton.t
+0000a5a0: 7970 6573 2069 6d70 6f72 7420 4669 656c  ypes import Fiel
+0000a5b0: 642c 2046 6c6f 6174 3634 0a0a 2020 2020  d, Float64..    
+0000a5c0: 2020 2020 7363 6865 6d61 203d 205b 4669      schema = [Fi
+0000a5d0: 656c 6428 2761 6d6f 756e 7427 2c20 466c  eld('amount', Fl
+0000a5e0: 6f61 7436 3429 5d0a 2020 2020 2020 2020  oat64)].        
+0000a5f0: 7472 616e 7361 6374 696f 6e5f 7265 7175  transaction_requ
+0000a600: 6573 7420 3d20 5265 7175 6573 7453 6f75  est = RequestSou
+0000a610: 7263 6528 7363 6865 6d61 3d73 6368 656d  rce(schema=schem
+0000a620: 6129 0a0a 0a20 2020 2041 7474 7269 6275  a)...    Attribu
+0000a630: 7465 733a 0a20 2020 2020 2020 2073 6368  tes:.        sch
+0000a640: 656d 613a 2054 6865 2073 6368 656d 6120  ema: The schema 
+0000a650: 6f66 2074 6869 7320 5265 7175 6573 7420  of this Request 
+0000a660: 536f 7572 6365 2e0a 2020 2020 2222 220a  Source..    """.
+0000a670: 0a20 2020 2023 2055 7365 2073 6368 656d  .    # Use schem
+0000a680: 615f 2077 6974 6820 616e 2061 6c69 6173  a_ with an alias
+0000a690: 2074 6f20 6176 6f69 6420 636f 6e66 6c69   to avoid confli
+0000a6a0: 6374 696e 6720 7769 7468 2061 2050 7964  cting with a Pyd
+0000a6b0: 616e 7469 6320 4261 7365 4d6f 6465 6c20  antic BaseModel 
+0000a6c0: 6d65 7468 6f64 2073 6368 656d 6128 292e  method schema().
+0000a6d0: 2053 6861 646f 7720 7468 6174 206d 6574   Shadow that met
+0000a6e0: 686f 6420 7769 7468 0a20 2020 2023 2061  hod with.    # a
+0000a6f0: 2073 6368 656d 6120 7072 6f70 6572 7479   schema property
+0000a700: 2073 6f20 7468 6174 2063 616c 6c65 7273   so that callers
+0000a710: 2063 616e 2061 6363 6573 7320 7468 6520   can access the 
+0000a720: 6669 656c 6420 696e 7475 6974 6976 656c  field intuitivel
+0000a730: 792e 0a20 2020 2073 6368 656d 615f 3a20  y..    schema_: 
+0000a740: 5475 706c 655b 4669 656c 642c 202e 2e2e  Tuple[Field, ...
+0000a750: 5d20 3d20 7079 6461 6e74 6963 5f76 312e  ] = pydantic_v1.
+0000a760: 4669 656c 6428 616c 6961 733d 2273 6368  Field(alias="sch
+0000a770: 656d 6122 290a 0a20 2020 2064 6566 205f  ema")..    def _
+0000a780: 5f69 6e69 745f 5f28 7365 6c66 2c20 7363  _init__(self, sc
+0000a790: 6865 6d61 3a20 5365 7175 656e 6365 5b46  hema: Sequence[F
+0000a7a0: 6965 6c64 5d29 3a0a 2020 2020 2020 2020  ield]):.        
+0000a7b0: 7375 7065 7228 292e 5f5f 696e 6974 5f5f  super().__init__
+0000a7c0: 2873 6368 656d 613d 7475 706c 6528 7363  (schema=tuple(sc
+0000a7d0: 6865 6d61 2929 0a0a 2020 2020 4070 726f  hema))..    @pro
+0000a7e0: 7065 7274 790a 2020 2020 6465 6620 7363  perty.    def sc
+0000a7f0: 6865 6d61 2873 656c 6629 202d 3e20 5475  hema(self) -> Tu
+0000a800: 706c 655b 4669 656c 642c 202e 2e2e 5d3a  ple[Field, ...]:
+0000a810: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000a820: 7365 6c66 2e73 6368 656d 615f 0a0a 0a23  self.schema_...#
+0000a830: 2054 4f44 4f28 6a61 6b65 293a 2053 686f   TODO(jake): Sho
+0000a840: 756c 6420 696e 6865 7269 7420 6672 6f6d  uld inherit from
+0000a850: 2053 7472 6963 744d 6f64 656c 2e0a 636c   StrictModel..cl
+0000a860: 6173 7320 4261 7365 5374 7265 616d 436f  ass BaseStreamCo
+0000a870: 6e66 6967 3a0a 2020 2020 6465 6620 5f6d  nfig:.    def _m
+0000a880: 6572 6765 5f73 7472 6561 6d5f 6172 6773  erge_stream_args
+0000a890: 2873 656c 662c 2064 6174 615f 736f 7572  (self, data_sour
+0000a8a0: 6365 5f61 7267 733a 2076 6972 7475 616c  ce_args: virtual
+0000a8b0: 5f64 6174 615f 736f 7572 6365 5f70 6232  _data_source_pb2
+0000a8c0: 2e56 6972 7475 616c 4461 7461 536f 7572  .VirtualDataSour
+0000a8d0: 6365 4172 6773 293a 0a20 2020 2020 2020  ceArgs):.       
+0000a8e0: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
+0000a8f0: 656e 7465 6445 7272 6f72 0a0a 0a23 2054  entedError...# T
+0000a900: 4f44 4f28 6a61 6b65 293a 2053 686f 756c  ODO(jake): Shoul
+0000a910: 6420 696e 6865 7269 7420 6672 6f6d 2053  d inherit from S
+0000a920: 7472 6963 744d 6f64 656c 2e0a 636c 6173  trictModel..clas
+0000a930: 7320 4261 7365 4261 7463 6843 6f6e 6669  s BaseBatchConfi
+0000a940: 673a 0a20 2020 2040 7072 6f70 6572 7479  g:.    @property
+0000a950: 0a20 2020 2064 6566 2064 6174 615f 6465  .    def data_de
+0000a960: 6c61 7928 7365 6c66 2920 2d3e 2064 6174  lay(self) -> dat
+0000a970: 6574 696d 652e 7469 6d65 6465 6c74 613a  etime.timedelta:
+0000a980: 0a20 2020 2020 2020 2072 6169 7365 204e  .        raise N
+0000a990: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+0000a9a0: 6f72 0a0a 2020 2020 6465 6620 5f6d 6572  or..    def _mer
+0000a9b0: 6765 5f62 6174 6368 5f61 7267 7328 7365  ge_batch_args(se
+0000a9c0: 6c66 2c20 6461 7461 5f73 6f75 7263 655f  lf, data_source_
+0000a9d0: 6172 6773 3a20 7669 7274 7561 6c5f 6461  args: virtual_da
+0000a9e0: 7461 5f73 6f75 7263 655f 7062 322e 5669  ta_source_pb2.Vi
+0000a9f0: 7274 7561 6c44 6174 6153 6f75 7263 6541  rtualDataSourceA
+0000aa00: 7267 7329 3a0a 2020 2020 2020 2020 7261  rgs):.        ra
+0000aa10: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
+0000aa20: 6564 4572 726f 720a 0a0a 636c 6173 7320  edError...class 
+0000aa30: 4669 6c65 436f 6e66 6967 2842 6173 6542  FileConfig(BaseB
+0000aa40: 6174 6368 436f 6e66 6967 293a 0a20 2020  atchConfig):.   
+0000aa50: 2022 2222 0a20 2020 2043 6f6e 6669 6775   """.    Configu
+0000aa60: 7261 7469 6f6e 2075 7365 6420 746f 2072  ration used to r
+0000aa70: 6566 6572 656e 6365 2061 2066 696c 6520  eference a file 
+0000aa80: 6f72 2064 6972 6563 746f 7279 2028 5333  or directory (S3
+0000aa90: 2c20 6574 632e 290a 0a20 2020 2054 6865  , etc.)..    The
+0000aaa0: 2046 696c 6543 6f6e 6669 6720 636c 6173   FileConfig clas
+0000aab0: 7320 6973 2075 7365 6420 746f 2063 7265  s is used to cre
+0000aac0: 6174 6520 6120 7265 6665 7265 6e63 6520  ate a reference 
+0000aad0: 746f 2061 2066 696c 6520 6f72 2064 6972  to a file or dir
+0000aae0: 6563 746f 7279 206f 6620 6669 6c65 7320  ectory of files 
+0000aaf0: 696e 2053 332c 0a20 2020 2048 4446 532c  in S3,.    HDFS,
+0000ab00: 206f 7220 4442 4653 2e0a 0a20 2020 2054   or DBFS...    T
+0000ab10: 6865 2073 6368 656d 6120 6f66 2074 6865  he schema of the
+0000ab20: 2064 6174 6120 736f 7572 6365 2069 7320   data source is 
+0000ab30: 696e 6665 7272 6564 2066 726f 6d20 7468  inferred from th
+0000ab40: 6520 756e 6465 726c 7969 6e67 2066 696c  e underlying fil
+0000ab50: 6528 7329 2e20 4974 2063 616e 2061 6c73  e(s). It can als
+0000ab60: 6f20 6265 206d 6f64 6966 6965 6420 7573  o be modified us
+0000ab70: 696e 6720 7468 650a 2020 2020 6060 706f  ing the.    ``po
+0000ab80: 7374 5f70 726f 6365 7373 6f72 6060 2070  st_processor`` p
+0000ab90: 6172 616d 6574 6572 2e0a 0a20 2020 2054  arameter...    T
+0000aba0: 6869 7320 636c 6173 7320 6973 2075 7365  his class is use
+0000abb0: 6420 6173 2061 6e20 696e 7075 7420 746f  d as an input to
+0000abc0: 2061 203a 636c 6173 733a 6042 6174 6368   a :class:`Batch
+0000abd0: 536f 7572 6365 6027 7320 7061 7261 6d65  Source`'s parame
+0000abe0: 7465 7220 6060 6261 7463 685f 636f 6e66  ter ``batch_conf
+0000abf0: 6967 6060 2e20 4465 636c 6172 696e 6720  ig``. Declaring 
+0000ac00: 7468 6973 2063 6f6e 6669 6775 7261 7469  this configurati
+0000ac10: 6f6e 2063 6c61 7373 2061 6c6f 6e65 0a20  on class alone. 
+0000ac20: 2020 2077 696c 6c20 6e6f 7420 7265 6769     will not regi
+0000ac30: 7374 6572 2061 2044 6174 6120 536f 7572  ster a Data Sour
+0000ac40: 6365 2e20 496e 7374 6561 642c 2064 6563  ce. Instead, dec
+0000ac50: 6c61 7265 2061 7320 6120 7061 7274 206f  lare as a part o
+0000ac60: 6620 6060 4261 7463 6853 6f75 7263 6560  f ``BatchSource`
+0000ac70: 6020 7468 6174 2074 616b 6573 2074 6869  ` that takes thi
+0000ac80: 7320 636f 6e66 6967 7572 6174 696f 6e20  s configuration 
+0000ac90: 636c 6173 730a 2020 2020 696e 7374 616e  class.    instan
+0000aca0: 6365 2061 7320 6120 7061 7261 6d65 7465  ce as a paramete
+0000acb0: 722e 0a20 2020 2022 2222 0a0a 2020 2020  r..    """..    
+0000acc0: 6465 6620 5f5f 696e 6974 5f5f 280a 2020  def __init__(.  
+0000acd0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0000ace0: 2020 2020 7572 693a 2073 7472 2c0a 2020      uri: str,.  
+0000acf0: 2020 2020 2020 6669 6c65 5f66 6f72 6d61        file_forma
+0000ad00: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
+0000ad10: 7469 6d65 7374 616d 705f 6669 656c 643a  timestamp_field:
+0000ad20: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
+0000ad30: 204e 6f6e 652c 0a20 2020 2020 2020 2074   None,.        t
+0000ad40: 696d 6573 7461 6d70 5f66 6f72 6d61 743a  imestamp_format:
+0000ad50: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
+0000ad60: 204e 6f6e 652c 0a20 2020 2020 2020 2070   None,.        p
+0000ad70: 6f73 745f 7072 6f63 6573 736f 723a 204f  ost_processor: O
+0000ad80: 7074 696f 6e61 6c5b 4361 6c6c 6162 6c65  ptional[Callable
+0000ad90: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+0000ada0: 2020 7363 6865 6d61 5f75 7269 3a20 4f70    schema_uri: Op
+0000adb0: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
+0000adc0: 6e65 2c0a 2020 2020 2020 2020 7363 6865  ne,.        sche
+0000add0: 6d61 5f6f 7665 7272 6964 653a 204f 7074  ma_override: Opt
+0000ade0: 696f 6e61 6c5b 5374 7275 6374 5479 7065  ional[StructType
+0000adf0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+0000ae00: 2020 6461 7461 5f64 656c 6179 3a20 6461    data_delay: da
+0000ae10: 7465 7469 6d65 2e74 696d 6564 656c 7461  tetime.timedelta
+0000ae20: 203d 2064 6174 6574 696d 652e 7469 6d65   = datetime.time
+0000ae30: 6465 6c74 6128 7365 636f 6e64 733d 3029  delta(seconds=0)
+0000ae40: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+0000ae50: 2022 2222 0a20 2020 2020 2020 2049 6e73   """.        Ins
+0000ae60: 7461 6e74 6961 7465 7320 6120 6e65 7720  tantiates a new 
+0000ae70: 4669 6c65 436f 6e66 6967 2e0a 0a20 2020  FileConfig...   
+0000ae80: 2020 2020 203a 7061 7261 6d20 7572 693a       :param uri:
+0000ae90: 2053 3320 6f72 2048 4446 5320 7061 7468   S3 or HDFS path
+0000aea0: 2074 6f20 6669 6c65 2873 292e 0a20 2020   to file(s)..   
+0000aeb0: 2020 2020 203a 7061 7261 6d20 6669 6c65       :param file
+0000aec0: 5f66 6f72 6d61 743a 2046 696c 6520 666f  _format: File fo
+0000aed0: 726d 6174 2e20 226a 736f 6e22 2c20 2270  rmat. "json", "p
+0000aee0: 6172 7175 6574 222c 206f 7220 2263 7376  arquet", or "csv
+0000aef0: 220a 2020 2020 2020 2020 3a70 6172 616d  ".        :param
+0000af00: 2074 696d 6573 7461 6d70 5f66 6965 6c64   timestamp_field
+0000af10: 3a20 5468 6520 7469 6d65 7374 616d 7020  : The timestamp 
+0000af20: 636f 6c75 6d6e 2069 6e20 7468 6973 2064  column in this d
+0000af30: 6174 6120 736f 7572 6365 2074 6861 7420  ata source that 
+0000af40: 7368 6f75 6c64 2062 6520 7573 6564 2062  should be used b
+0000af50: 7920 6046 696c 7465 7265 6453 6f75 7263  y `FilteredSourc
+0000af60: 6560 0a20 2020 2020 2020 2020 2020 2020  e`.             
+0000af70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000af80: 2020 2074 6f20 6669 6c74 6572 2064 6174     to filter dat
+0000af90: 6120 6672 6f6d 2074 6869 7320 736f 7572  a from this sour
+0000afa0: 6365 2c20 6265 666f 7265 2061 6e79 2066  ce, before any f
+0000afb0: 6561 7475 7265 2076 6965 7720 7472 616e  eature view tran
+0000afc0: 7366 6f72 6d61 7469 6f6e 7320 6172 6520  sformations are 
+0000afd0: 6170 706c 6965 642e 0a20 2020 2020 2020  applied..       
+0000afe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aff0: 2020 2020 2020 2020 204f 6e6c 7920 7265           Only re
+0000b000: 7175 6972 6564 2069 6620 7468 6973 2073  quired if this s
+0000b010: 6f75 7263 6520 6973 2075 7365 6420 7769  ource is used wi
+0000b020: 7468 2060 4669 6c74 6572 6564 536f 7572  th `FilteredSour
+0000b030: 6365 602e 0a20 2020 2020 2020 203a 7061  ce`..        :pa
+0000b040: 7261 6d20 7469 6d65 7374 616d 705f 666f  ram timestamp_fo
+0000b050: 726d 6174 3a20 466f 726d 6174 206f 6620  rmat: Format of 
+0000b060: 7374 7269 6e67 2d65 6e63 6f64 6564 2074  string-encoded t
+0000b070: 696d 6573 7461 6d70 2063 6f6c 756d 6e20  imestamp column 
+0000b080: 2865 2e67 2e20 2279 7979 792d 4d4d 2d64  (e.g. "yyyy-MM-d
+0000b090: 6427 5427 6868 3a6d 6d3a 7373 2e53 5353  d'T'hh:mm:ss.SSS
+0000b0a0: 275a 2722 292e 0a20 2020 2020 2020 2020  'Z'")..         
+0000b0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b0c0: 2020 2020 2020 2020 4966 2074 6865 2074          If the t
+0000b0d0: 696d 6573 7461 6d70 2073 7472 696e 6720  imestamp string 
+0000b0e0: 6361 6e6e 6f74 2062 6520 7061 7273 6564  cannot be parsed
+0000b0f0: 2077 6974 6820 7468 6973 2066 6f72 6d61   with this forma
+0000b100: 742c 2054 6563 746f 6e20 7769 6c6c 2066  t, Tecton will f
+0000b110: 616c 6c62 6163 6b20 616e 6420 6174 7465  allback and atte
+0000b120: 6d70 7420 746f 0a20 2020 2020 2020 2020  mpt to.         
 0000b130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b140: 2020 2020 2020 2020 2020 2020 5079 7370              Pysp
-0000b150: 6172 6b20 6461 7461 2073 6f75 7263 6520  ark data source 
-0000b160: 4461 7461 4672 616d 6520 616e 6420 7472  DataFrame and tr
-0000b170: 616e 736c 6174 6573 2069 7420 746f 2074  anslates it to t
-0000b180: 6865 2044 6174 6146 7261 6d65 2074 6f20  he DataFrame to 
-0000b190: 6265 0a20 2020 2020 2020 2020 2020 2020  be.             
-0000b1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b1b0: 2020 2020 2020 2020 636f 6e73 756d 6564          consumed
-0000b1c0: 2062 7920 7468 6520 4665 6174 7572 6520   by the Feature 
-0000b1d0: 5669 6577 2e0a 2020 2020 2020 2020 3a70  View..        :p
-0000b1e0: 6172 616d 2073 6368 656d 615f 7572 693a  aram schema_uri:
-0000b1f0: 2041 2066 696c 6520 6f72 2073 7562 7061   A file or subpa
-0000b200: 7468 206f 6620 2275 7269 2220 7468 6174  th of "uri" that
-0000b210: 2063 616e 2062 6520 7573 6564 2066 6f72   can be used for
-0000b220: 2066 6173 7420 7363 6865 6d61 2069 6e66   fast schema inf
-0000b230: 6572 656e 6365 2e0a 2020 2020 2020 2020  erence..        
-0000b240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b250: 2020 2054 6869 7320 6973 2075 7365 6675     This is usefu
-0000b260: 6c20 666f 7220 7370 6565 6469 6e67 2075  l for speeding u
-0000b270: 7020 706c 616e 2063 6f6d 7075 7461 7469  p plan computati
-0000b280: 6f6e 2066 6f72 2068 6967 686c 7920 7061  on for highly pa
-0000b290: 7274 6974 696f 6e65 6420 6461 7461 2073  rtitioned data s
-0000b2a0: 6f75 7263 6573 2063 6f6e 7461 696e 696e  ources containin
-0000b2b0: 6720 6d61 6e79 2066 696c 6573 2e0a 2020  g many files..  
-0000b2c0: 2020 2020 2020 3a70 6172 616d 2073 6368        :param sch
-0000b2d0: 656d 615f 6f76 6572 7269 6465 3a20 4120  ema_override: A 
-0000b2e0: 7079 7370 6172 6b2e 7371 6c2e 7479 7065  pyspark.sql.type
-0000b2f0: 732e 5374 7275 6374 5479 7065 206f 626a  s.StructType obj
-0000b300: 6563 7420 7468 6174 2077 696c 6c20 6265  ect that will be
-0000b310: 2075 7365 6420 6173 2074 6865 2073 6368   used as the sch
-0000b320: 656d 6120 7768 656e 0a20 2020 2020 2020  ema when.       
-0000b330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b340: 2020 2020 2020 2020 2072 6561 6469 6e67           reading
-0000b350: 2066 726f 6d20 7468 6520 6669 6c65 2e20   from the file. 
-0000b360: 4966 206f 6d69 7474 6564 2c20 7468 6520  If omitted, the 
-0000b370: 7363 6865 6d61 2077 696c 6c20 6265 2069  schema will be i
-0000b380: 6e66 6572 7265 6420 6175 746f 6d61 7469  nferred automati
-0000b390: 6361 6c6c 792e 0a20 2020 2020 2020 203a  cally..        :
-0000b3a0: 7061 7261 6d20 6461 7461 5f64 656c 6179  param data_delay
-0000b3b0: 3a20 4279 2064 6566 6175 6c74 2c20 696e  : By default, in
-0000b3c0: 6372 656d 656e 7461 6c20 6d61 7465 7269  cremental materi
-0000b3d0: 616c 697a 6174 696f 6e20 6a6f 6273 2072  alization jobs r
-0000b3e0: 756e 2069 6d6d 6564 6961 7465 6c79 2061  un immediately a
-0000b3f0: 7420 7468 6520 656e 6420 6f66 2074 6865  t the end of the
-0000b400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b420: 2062 6174 6368 2073 6368 6564 756c 6520   batch schedule 
-0000b430: 7065 7269 6f64 2e20 5468 6973 2070 6172  period. This par
-0000b440: 616d 6574 6572 2063 6f6e 6669 6775 7265  ameter configure
-0000b450: 7320 686f 7720 6c6f 6e67 2074 6865 7920  s how long they 
-0000b460: 7761 6974 2061 6674 6572 2074 6865 2065  wait after the e
-0000b470: 6e64 0a20 2020 2020 2020 2020 2020 2020  nd.             
-0000b480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b490: 2020 206f 6620 7468 6520 7065 7269 6f64     of the period
-0000b4a0: 2062 6566 6f72 6520 7374 6172 7469 6e67   before starting
-0000b4b0: 2c20 7479 7069 6361 6c6c 7920 746f 2065  , typically to e
-0000b4c0: 6e73 7572 6520 7468 6174 2061 6c6c 2064  nsure that all d
-0000b4d0: 6174 6120 6861 7320 6c61 6e64 6564 2e0a  ata has landed..
-0000b4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b500: 466f 7220 6578 616d 706c 652c 2069 6620  For example, if 
-0000b510: 6120 6665 6174 7572 6520 7669 6577 2068  a feature view h
-0000b520: 6173 2061 2060 6261 7463 685f 7363 6865  as a `batch_sche
-0000b530: 6475 6c65 6020 6f66 2031 2064 6179 2061  dule` of 1 day a
-0000b540: 6e64 206f 6e65 206f 660a 2020 2020 2020  nd one of.      
-0000b550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b560: 2020 2020 2020 2020 2020 7468 6520 6461            the da
-0000b570: 7461 2073 6f75 7263 6520 696e 7075 7473  ta source inputs
-0000b580: 2068 6173 2060 6461 7461 5f64 656c 6179   has `data_delay
-0000b590: 3d74 696d 6564 656c 7461 2868 6f75 7273  =timedelta(hours
-0000b5a0: 3d31 2960 2073 6574 2c20 7468 656e 0a20  =1)` set, then. 
-0000b5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b5c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000b5d0: 6e63 7265 6d65 6e74 616c 206d 6174 6572  ncremental mater
-0000b5e0: 6961 6c69 7a61 7469 6f6e 206a 6f62 7320  ialization jobs 
-0000b5f0: 7769 6c6c 2072 756e 2061 7420 6030 313a  will run at `01:
-0000b600: 3030 6020 5554 432e 0a20 2020 2020 2020  00` UTC..       
-0000b610: 203a 7265 7475 726e 3a20 4120 4669 6c65   :return: A File
-0000b620: 436f 6e66 6967 2063 6c61 7373 2069 6e73  Config class ins
-0000b630: 7461 6e63 652e 0a0a 2020 2020 2020 2020  tance...        
-0000b640: 4578 616d 706c 6520 6f66 2061 2046 696c  Example of a Fil
-0000b650: 6543 6f6e 6669 6720 6465 636c 6172 6174  eConfig declarat
-0000b660: 696f 6e3a 0a0a 2020 2020 2020 2020 2e2e  ion:..        ..
-0000b670: 2063 6f64 652d 626c 6f63 6b3a 3a20 7079   code-block:: py
-0000b680: 7468 6f6e 0a0a 2020 2020 2020 2020 2020  thon..          
-0000b690: 2020 6672 6f6d 2074 6563 746f 6e20 696d    from tecton im
-0000b6a0: 706f 7274 2046 696c 6543 6f6e 6669 672c  port FileConfig,
-0000b6b0: 2042 6174 6368 536f 7572 6365 0a0a 2020   BatchSource..  
-0000b6c0: 2020 2020 2020 2020 2020 6465 6620 636f            def co
-0000b6d0: 6e76 6572 745f 7465 6d70 6572 6174 7572  nvert_temperatur
-0000b6e0: 6528 6466 293a 0a20 2020 2020 2020 2020  e(df):.         
-0000b6f0: 2020 2020 2020 2066 726f 6d20 7079 7370         from pysp
-0000b700: 6172 6b2e 7371 6c2e 6675 6e63 7469 6f6e  ark.sql.function
-0000b710: 7320 696d 706f 7274 2075 6466 2c63 6f6c  s import udf,col
-0000b720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b730: 2066 726f 6d20 7079 7370 6172 6b2e 7371   from pyspark.sq
-0000b740: 6c2e 7479 7065 7320 696d 706f 7274 2044  l.types import D
-0000b750: 6f75 626c 6554 7970 650a 0a20 2020 2020  oubleType..     
-0000b760: 2020 2020 2020 2020 2020 2023 2043 6f6e             # Con
-0000b770: 7665 7274 2074 6865 2069 6e63 6f6d 696e  vert the incomin
-0000b780: 6720 5079 5370 6172 6b20 4461 7461 4672  g PySpark DataFr
-0000b790: 616d 6520 7465 6d70 6572 6174 7572 6520  ame temperature 
-0000b7a0: 4365 6c73 6975 7320 746f 2046 6168 7265  Celsius to Fahre
-0000b7b0: 6e68 6569 740a 2020 2020 2020 2020 2020  nheit.          
-0000b7c0: 2020 2020 2020 7564 665f 636f 6e76 6572        udf_conver
-0000b7d0: 7420 3d20 7564 6628 6c61 6d62 6461 2078  t = udf(lambda x
-0000b7e0: 3a20 7820 2a20 312e 3820 2b20 3332 2e30  : x * 1.8 + 32.0
-0000b7f0: 2c20 446f 7562 6c65 5479 7065 2829 290a  , DoubleType()).
-0000b800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b810: 636f 6e76 6572 7465 645f 6466 203d 2064  converted_df = d
-0000b820: 662e 7769 7468 436f 6c75 6d6e 2822 4661  f.withColumn("Fa
-0000b830: 6872 656e 6865 6974 222c 2075 6466 5f63  hrenheit", udf_c
-0000b840: 6f6e 7665 7274 2863 6f6c 2822 5465 6d70  onvert(col("Temp
-0000b850: 6572 6174 7572 6522 2929 292e 6472 6f70  erature"))).drop
-0000b860: 2822 5465 6d70 6572 6174 7572 6522 290a  ("Temperature").
-0000b870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b880: 7265 7475 726e 2063 6f6e 7665 7274 6564  return converted
-0000b890: 5f64 660a 0a20 2020 2020 2020 2020 2020  _df..           
-0000b8a0: 2023 2064 6563 6c61 7265 2061 2046 696c   # declare a Fil
-0000b8b0: 6543 6f6e 6669 672c 2077 6869 6368 2063  eConfig, which c
-0000b8c0: 616e 2062 6520 7573 6564 2061 7320 6120  an be used as a 
-0000b8d0: 7061 7261 6d65 7465 7220 746f 2061 2060  parameter to a `
-0000b8e0: 4261 7463 6853 6f75 7263 6560 0a20 2020  BatchSource`.   
-0000b8f0: 2020 2020 2020 2020 2061 645f 696d 7072           ad_impr
-0000b900: 6573 7369 6f6e 735f 6669 6c65 5f64 7320  essions_file_ds 
-0000b910: 3d20 4669 6c65 436f 6e66 6967 2875 7269  = FileConfig(uri
-0000b920: 3d22 7333 3a2f 2f74 6563 746f 6e2e 6169  ="s3://tecton.ai
-0000b930: 2e70 7562 6c69 632f 6461 7461 2f61 645f  .public/data/ad_
-0000b940: 696d 7072 6573 7369 6f6e 735f 7361 6d70  impressions_samp
-0000b950: 6c65 2e70 6172 7175 6574 222c 0a20 2020  le.parquet",.   
-0000b960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b980: 2020 2020 2020 2020 2020 2020 2066 696c               fil
-0000b990: 655f 666f 726d 6174 3d22 7061 7271 7565  e_format="parque
-0000b9a0: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
-0000b9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b9d0: 2020 2020 7469 6d65 7374 616d 705f 6669      timestamp_fi
-0000b9e0: 656c 643d 2274 696d 6573 7461 6d70 222c  eld="timestamp",
-0000b9f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ba00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b140: 2020 2020 2020 2020 7573 6520 7468 6520          use the 
+0000b150: 6465 6661 756c 7420 7469 6d65 7374 616d  default timestam
+0000b160: 7020 7061 7273 6572 2e0a 2020 2020 2020  p parser..      
+0000b170: 2020 3a70 6172 616d 2070 6f73 745f 7072    :param post_pr
+0000b180: 6f63 6573 736f 723a 2050 7974 686f 6e20  ocessor: Python 
+0000b190: 7573 6572 2064 6566 696e 6564 2066 756e  user defined fun
+0000b1a0: 6374 696f 6e20 6060 6628 4461 7461 4672  ction ``f(DataFr
+0000b1b0: 616d 6529 202d 3e20 4461 7461 4672 616d  ame) -> DataFram
+0000b1c0: 6560 6020 7468 6174 2074 616b 6573 2069  e`` that takes i
+0000b1d0: 6e20 7261 770a 2020 2020 2020 2020 2020  n raw.          
+0000b1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b1f0: 2020 2020 2020 2020 2020 2050 7973 7061             Pyspa
+0000b200: 726b 2064 6174 6120 736f 7572 6365 2044  rk data source D
+0000b210: 6174 6146 7261 6d65 2061 6e64 2074 7261  ataFrame and tra
+0000b220: 6e73 6c61 7465 7320 6974 2074 6f20 7468  nslates it to th
+0000b230: 6520 4461 7461 4672 616d 6520 746f 2062  e DataFrame to b
+0000b240: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+0000b250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b260: 2020 2020 2020 2063 6f6e 7375 6d65 6420         consumed 
+0000b270: 6279 2074 6865 2046 6561 7475 7265 2056  by the Feature V
+0000b280: 6965 772e 0a20 2020 2020 2020 203a 7061  iew..        :pa
+0000b290: 7261 6d20 7363 6865 6d61 5f75 7269 3a20  ram schema_uri: 
+0000b2a0: 4120 6669 6c65 206f 7220 7375 6270 6174  A file or subpat
+0000b2b0: 6820 6f66 2022 7572 6922 2074 6861 7420  h of "uri" that 
+0000b2c0: 6361 6e20 6265 2075 7365 6420 666f 7220  can be used for 
+0000b2d0: 6661 7374 2073 6368 656d 6120 696e 6665  fast schema infe
+0000b2e0: 7265 6e63 652e 0a20 2020 2020 2020 2020  rence..         
+0000b2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b300: 2020 5468 6973 2069 7320 7573 6566 756c    This is useful
+0000b310: 2066 6f72 2073 7065 6564 696e 6720 7570   for speeding up
+0000b320: 2070 6c61 6e20 636f 6d70 7574 6174 696f   plan computatio
+0000b330: 6e20 666f 7220 6869 6768 6c79 2070 6172  n for highly par
+0000b340: 7469 7469 6f6e 6564 2064 6174 6120 736f  titioned data so
+0000b350: 7572 6365 7320 636f 6e74 6169 6e69 6e67  urces containing
+0000b360: 206d 616e 7920 6669 6c65 732e 0a20 2020   many files..   
+0000b370: 2020 2020 203a 7061 7261 6d20 7363 6865       :param sche
+0000b380: 6d61 5f6f 7665 7272 6964 653a 2041 2070  ma_override: A p
+0000b390: 7973 7061 726b 2e73 716c 2e74 7970 6573  yspark.sql.types
+0000b3a0: 2e53 7472 7563 7454 7970 6520 6f62 6a65  .StructType obje
+0000b3b0: 6374 2074 6861 7420 7769 6c6c 2062 6520  ct that will be 
+0000b3c0: 7573 6564 2061 7320 7468 6520 7363 6865  used as the sche
+0000b3d0: 6d61 2077 6865 6e0a 2020 2020 2020 2020  ma when.        
+0000b3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b3f0: 2020 2020 2020 2020 7265 6164 696e 6720          reading 
+0000b400: 6672 6f6d 2074 6865 2066 696c 652e 2049  from the file. I
+0000b410: 6620 6f6d 6974 7465 642c 2074 6865 2073  f omitted, the s
+0000b420: 6368 656d 6120 7769 6c6c 2062 6520 696e  chema will be in
+0000b430: 6665 7272 6564 2061 7574 6f6d 6174 6963  ferred automatic
+0000b440: 616c 6c79 2e0a 2020 2020 2020 2020 3a70  ally..        :p
+0000b450: 6172 616d 2064 6174 615f 6465 6c61 793a  aram data_delay:
+0000b460: 2042 7920 6465 6661 756c 742c 2069 6e63   By default, inc
+0000b470: 7265 6d65 6e74 616c 206d 6174 6572 6961  remental materia
+0000b480: 6c69 7a61 7469 6f6e 206a 6f62 7320 7275  lization jobs ru
+0000b490: 6e20 696d 6d65 6469 6174 656c 7920 6174  n immediately at
+0000b4a0: 2074 6865 2065 6e64 206f 6620 7468 650a   the end of the.
+0000b4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b4d0: 6261 7463 6820 7363 6865 6475 6c65 2070  batch schedule p
+0000b4e0: 6572 696f 642e 2054 6869 7320 7061 7261  eriod. This para
+0000b4f0: 6d65 7465 7220 636f 6e66 6967 7572 6573  meter configures
+0000b500: 2068 6f77 206c 6f6e 6720 7468 6579 2077   how long they w
+0000b510: 6169 7420 6166 7465 7220 7468 6520 656e  ait after the en
+0000b520: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+0000b530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b540: 2020 6f66 2074 6865 2070 6572 696f 6420    of the period 
+0000b550: 6265 666f 7265 2073 7461 7274 696e 672c  before starting,
+0000b560: 2074 7970 6963 616c 6c79 2074 6f20 656e   typically to en
+0000b570: 7375 7265 2074 6861 7420 616c 6c20 6461  sure that all da
+0000b580: 7461 2068 6173 206c 616e 6465 642e 0a20  ta has landed.. 
+0000b590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b5a0: 2020 2020 2020 2020 2020 2020 2020 2046                 F
+0000b5b0: 6f72 2065 7861 6d70 6c65 2c20 6966 2061  or example, if a
+0000b5c0: 2066 6561 7475 7265 2076 6965 7720 6861   feature view ha
+0000b5d0: 7320 6120 6062 6174 6368 5f73 6368 6564  s a `batch_sched
+0000b5e0: 756c 6560 206f 6620 3120 6461 7920 616e  ule` of 1 day an
+0000b5f0: 6420 6f6e 6520 6f66 0a20 2020 2020 2020  d one of.       
+0000b600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b610: 2020 2020 2020 2020 2074 6865 2064 6174           the dat
+0000b620: 6120 736f 7572 6365 2069 6e70 7574 7320  a source inputs 
+0000b630: 6861 7320 6064 6174 615f 6465 6c61 793d  has `data_delay=
+0000b640: 7469 6d65 6465 6c74 6128 686f 7572 733d  timedelta(hours=
+0000b650: 3129 6020 7365 742c 2074 6865 6e0a 2020  1)` set, then.  
+0000b660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b670: 2020 2020 2020 2020 2020 2020 2020 696e                in
+0000b680: 6372 656d 656e 7461 6c20 6d61 7465 7269  cremental materi
+0000b690: 616c 697a 6174 696f 6e20 6a6f 6273 2077  alization jobs w
+0000b6a0: 696c 6c20 7275 6e20 6174 2060 3031 3a30  ill run at `01:0
+0000b6b0: 3060 2055 5443 2e0a 2020 2020 2020 2020  0` UTC..        
+0000b6c0: 3a72 6574 7572 6e3a 2041 2046 696c 6543  :return: A FileC
+0000b6d0: 6f6e 6669 6720 636c 6173 7320 696e 7374  onfig class inst
+0000b6e0: 616e 6365 2e0a 0a20 2020 2020 2020 2045  ance...        E
+0000b6f0: 7861 6d70 6c65 206f 6620 6120 4669 6c65  xample of a File
+0000b700: 436f 6e66 6967 2064 6563 6c61 7261 7469  Config declarati
+0000b710: 6f6e 3a0a 0a20 2020 2020 2020 202e 2e20  on:..        .. 
+0000b720: 636f 6465 2d62 6c6f 636b 3a3a 2070 7974  code-block:: pyt
+0000b730: 686f 6e0a 0a20 2020 2020 2020 2020 2020  hon..           
+0000b740: 2066 726f 6d20 7465 6374 6f6e 2069 6d70   from tecton imp
+0000b750: 6f72 7420 4669 6c65 436f 6e66 6967 2c20  ort FileConfig, 
+0000b760: 4261 7463 6853 6f75 7263 650a 0a20 2020  BatchSource..   
+0000b770: 2020 2020 2020 2020 2064 6566 2063 6f6e           def con
+0000b780: 7665 7274 5f74 656d 7065 7261 7475 7265  vert_temperature
+0000b790: 2864 6629 3a0a 2020 2020 2020 2020 2020  (df):.          
+0000b7a0: 2020 2020 2020 6672 6f6d 2070 7973 7061        from pyspa
+0000b7b0: 726b 2e73 716c 2e66 756e 6374 696f 6e73  rk.sql.functions
+0000b7c0: 2069 6d70 6f72 7420 7564 662c 636f 6c0a   import udf,col.
+0000b7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b7e0: 6672 6f6d 2070 7973 7061 726b 2e73 716c  from pyspark.sql
+0000b7f0: 2e74 7970 6573 2069 6d70 6f72 7420 446f  .types import Do
+0000b800: 7562 6c65 5479 7065 0a0a 2020 2020 2020  ubleType..      
+0000b810: 2020 2020 2020 2020 2020 2320 436f 6e76            # Conv
+0000b820: 6572 7420 7468 6520 696e 636f 6d69 6e67  ert the incoming
+0000b830: 2050 7953 7061 726b 2044 6174 6146 7261   PySpark DataFra
+0000b840: 6d65 2074 656d 7065 7261 7475 7265 2043  me temperature C
+0000b850: 656c 7369 7573 2074 6f20 4661 6872 656e  elsius to Fahren
+0000b860: 6865 6974 0a20 2020 2020 2020 2020 2020  heit.           
+0000b870: 2020 2020 2075 6466 5f63 6f6e 7665 7274       udf_convert
+0000b880: 203d 2075 6466 286c 616d 6264 6120 783a   = udf(lambda x:
+0000b890: 2078 202a 2031 2e38 202b 2033 322e 302c   x * 1.8 + 32.0,
+0000b8a0: 2044 6f75 626c 6554 7970 6528 2929 0a20   DoubleType()). 
+0000b8b0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000b8c0: 6f6e 7665 7274 6564 5f64 6620 3d20 6466  onverted_df = df
+0000b8d0: 2e77 6974 6843 6f6c 756d 6e28 2246 6168  .withColumn("Fah
+0000b8e0: 7265 6e68 6569 7422 2c20 7564 665f 636f  renheit", udf_co
+0000b8f0: 6e76 6572 7428 636f 6c28 2254 656d 7065  nvert(col("Tempe
+0000b900: 7261 7475 7265 2229 2929 2e64 726f 7028  rature"))).drop(
+0000b910: 2254 656d 7065 7261 7475 7265 2229 0a20  "Temperature"). 
+0000b920: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000b930: 6574 7572 6e20 636f 6e76 6572 7465 645f  eturn converted_
+0000b940: 6466 0a0a 2020 2020 2020 2020 2020 2020  df..            
+0000b950: 2320 6465 636c 6172 6520 6120 4669 6c65  # declare a File
+0000b960: 436f 6e66 6967 2c20 7768 6963 6820 6361  Config, which ca
+0000b970: 6e20 6265 2075 7365 6420 6173 2061 2070  n be used as a p
+0000b980: 6172 616d 6574 6572 2074 6f20 6120 6042  arameter to a `B
+0000b990: 6174 6368 536f 7572 6365 600a 2020 2020  atchSource`.    
+0000b9a0: 2020 2020 2020 2020 6164 5f69 6d70 7265          ad_impre
+0000b9b0: 7373 696f 6e73 5f66 696c 655f 6473 203d  ssions_file_ds =
+0000b9c0: 2046 696c 6543 6f6e 6669 6728 7572 693d   FileConfig(uri=
+0000b9d0: 2273 333a 2f2f 7465 6374 6f6e 2e61 692e  "s3://tecton.ai.
+0000b9e0: 7075 626c 6963 2f64 6174 612f 6164 5f69  public/data/ad_i
+0000b9f0: 6d70 7265 7373 696f 6e73 5f73 616d 706c  mpressions_sampl
+0000ba00: 652e 7061 7271 7565 7422 2c0a 2020 2020  e.parquet",.    
 0000ba10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ba20: 2070 6f73 745f 7072 6f63 6573 736f 723d   post_processor=
-0000ba30: 636f 6e76 6572 745f 7465 6d70 6572 6174  convert_temperat
-0000ba40: 7572 6529 0a0a 2020 2020 2020 2020 2020  ure)..          
-0000ba50: 2020 2320 5468 6973 2046 696c 6543 6f6e    # This FileCon
-0000ba60: 6669 6720 6361 6e20 7468 656e 2062 6520  fig can then be 
-0000ba70: 696e 636c 7564 6564 2061 7320 616e 2070  included as an p
-0000ba80: 6172 616d 6574 6572 2061 2042 6174 6368  arameter a Batch
-0000ba90: 536f 7572 6365 2064 6563 6c61 7261 7469  Source declarati
-0000baa0: 6f6e 2e0a 2020 2020 2020 2020 2020 2020  on..            
-0000bab0: 2320 466f 7220 6578 616d 706c 652c 0a20  # For example,. 
-0000bac0: 2020 2020 2020 2020 2020 2061 645f 696d             ad_im
-0000bad0: 7072 6573 7369 6f6e 735f 6261 7463 6820  pressions_batch 
-0000bae0: 3d20 4261 7463 6853 6f75 7263 6528 6e61  = BatchSource(na
-0000baf0: 6d65 3d22 6164 5f69 6d70 7265 7373 696f  me="ad_impressio
-0000bb00: 6e73 5f62 6174 6368 222c 0a20 2020 2020  ns_batch",.     
-0000bb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bb30: 2020 2020 2020 2020 2020 6261 7463 685f            batch_
-0000bb40: 636f 6e66 6967 3d61 645f 696d 7072 6573  config=ad_impres
-0000bb50: 7369 6f6e 735f 6669 6c65 5f64 7329 0a0a  sions_file_ds)..
-0000bb60: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000bb70: 2020 2020 7365 6c66 2e5f 6172 6773 203d      self._args =
-0000bb80: 2064 6174 615f 736f 7572 6365 5f70 6232   data_source_pb2
-0000bb90: 2e46 696c 6544 6174 6153 6f75 7263 6541  .FileDataSourceA
-0000bba0: 7267 7328 290a 2020 2020 2020 2020 7365  rgs().        se
-0000bbb0: 6c66 2e5f 6172 6773 2e75 7269 203d 2075  lf._args.uri = u
-0000bbc0: 7269 0a20 2020 2020 2020 2073 656c 662e  ri.        self.
-0000bbd0: 5f61 7267 732e 6669 6c65 5f66 6f72 6d61  _args.file_forma
-0000bbe0: 7420 3d20 6669 6c65 5f66 6f72 6d61 740a  t = file_format.
-0000bbf0: 2020 2020 2020 2020 6966 2073 6368 656d          if schem
-0000bc00: 615f 7572 6920 6973 206e 6f74 204e 6f6e  a_uri is not Non
-0000bc10: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-0000bc20: 656c 662e 5f61 7267 732e 7363 6865 6d61  elf._args.schema
-0000bc30: 5f75 7269 203d 2073 6368 656d 615f 7572  _uri = schema_ur
-0000bc40: 690a 2020 2020 2020 2020 6966 2070 6f73  i.        if pos
-0000bc50: 745f 7072 6f63 6573 736f 7220 6973 206e  t_processor is n
-0000bc60: 6f74 204e 6f6e 6520 616e 6420 6675 6e63  ot None and func
-0000bc70: 7469 6f6e 5f73 6572 6961 6c69 7a61 7469  tion_serializati
-0000bc80: 6f6e 2e73 686f 756c 645f 7365 7269 616c  on.should_serial
-0000bc90: 697a 655f 6675 6e63 7469 6f6e 2870 6f73  ize_function(pos
-0000bca0: 745f 7072 6f63 6573 736f 7229 3a0a 2020  t_processor):.  
-0000bcb0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0000bcc0: 6172 6773 2e63 6f6d 6d6f 6e5f 6172 6773  args.common_args
-0000bcd0: 2e70 6f73 745f 7072 6f63 6573 736f 722e  .post_processor.
-0000bce0: 436f 7079 4672 6f6d 2866 756e 6374 696f  CopyFrom(functio
-0000bcf0: 6e5f 7365 7269 616c 697a 6174 696f 6e2e  n_serialization.
-0000bd00: 746f 5f70 726f 746f 2870 6f73 745f 7072  to_proto(post_pr
-0000bd10: 6f63 6573 736f 7229 290a 2020 2020 2020  ocessor)).      
-0000bd20: 2020 6966 2074 696d 6573 7461 6d70 5f66    if timestamp_f
-0000bd30: 6965 6c64 3a0a 2020 2020 2020 2020 2020  ield:.          
-0000bd40: 2020 7365 6c66 2e5f 6172 6773 2e63 6f6d    self._args.com
-0000bd50: 6d6f 6e5f 6172 6773 2e74 696d 6573 7461  mon_args.timesta
-0000bd60: 6d70 5f66 6965 6c64 203d 2074 696d 6573  mp_field = times
-0000bd70: 7461 6d70 5f66 6965 6c64 0a20 2020 2020  tamp_field.     
-0000bd80: 2020 2069 6620 7469 6d65 7374 616d 705f     if timestamp_
-0000bd90: 666f 726d 6174 3a0a 2020 2020 2020 2020  format:.        
-0000bda0: 2020 2020 7365 6c66 2e5f 6172 6773 2e74      self._args.t
-0000bdb0: 696d 6573 7461 6d70 5f66 6f72 6d61 7420  imestamp_format 
-0000bdc0: 3d20 7469 6d65 7374 616d 705f 666f 726d  = timestamp_form
-0000bdd0: 6174 0a20 2020 2020 2020 2069 6620 7363  at.        if sc
-0000bde0: 6865 6d61 5f6f 7665 7272 6964 653a 0a20  hema_override:. 
-0000bdf0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000be00: 5f61 7267 732e 7363 6865 6d61 5f6f 7665  _args.schema_ove
-0000be10: 7272 6964 652e 436f 7079 4672 6f6d 2873  rride.CopyFrom(s
-0000be20: 7061 726b 5f73 6368 656d 615f 7772 6170  park_schema_wrap
-0000be30: 7065 722e 5370 6172 6b53 6368 656d 6157  per.SparkSchemaW
-0000be40: 7261 7070 6572 2873 6368 656d 615f 6f76  rapper(schema_ov
-0000be50: 6572 7269 6465 292e 746f 5f70 726f 746f  erride).to_proto
-0000be60: 2829 290a 0a20 2020 2020 2020 2073 656c  ())..        sel
-0000be70: 662e 5f61 7267 732e 636f 6d6d 6f6e 5f61  f._args.common_a
-0000be80: 7267 732e 6461 7461 5f64 656c 6179 2e46  rgs.data_delay.F
-0000be90: 726f 6d54 696d 6564 656c 7461 2864 6174  romTimedelta(dat
-0000bea0: 615f 6465 6c61 7929 0a20 2020 2020 2020  a_delay).       
-0000beb0: 2073 656c 662e 5f64 6174 615f 6465 6c61   self._data_dela
-0000bec0: 7920 3d20 6461 7461 5f64 656c 6179 0a20  y = data_delay. 
-0000bed0: 2020 2020 2020 2073 656c 662e 706f 7374         self.post
-0000bee0: 5f70 726f 6365 7373 6f72 203d 2070 6f73  _processor = pos
-0000bef0: 745f 7072 6f63 6573 736f 720a 0a20 2020  t_processor..   
-0000bf00: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-0000bf10: 6566 2064 6174 615f 6465 6c61 7928 7365  ef data_delay(se
-0000bf20: 6c66 2920 2d3e 2064 6174 6574 696d 652e  lf) -> datetime.
-0000bf30: 7469 6d65 6465 6c74 613a 0a20 2020 2020  timedelta:.     
-0000bf40: 2020 2022 2222 5265 7475 726e 7320 7468     """Returns th
-0000bf50: 6520 6475 7261 7469 6f6e 2074 6861 7420  e duration that 
-0000bf60: 6d61 7465 7269 616c 697a 6174 696f 6e20  materialization 
-0000bf70: 6a6f 6273 2077 6169 7420 6166 7465 7220  jobs wait after 
-0000bf80: 7468 6520 6261 7463 685f 7363 6865 6475  the batch_schedu
-0000bf90: 6c65 2062 6566 6f72 6520 7374 6172 7469  le before starti
-0000bfa0: 6e67 2c20 7479 7069 6361 6c6c 7920 746f  ng, typically to
-0000bfb0: 2065 6e73 7572 6520 7468 6174 2061 6c6c   ensure that all
-0000bfc0: 2064 6174 6120 6861 7320 6c61 6e64 6564   data has landed
-0000bfd0: 2e22 2222 0a20 2020 2020 2020 2072 6574  .""".        ret
-0000bfe0: 7572 6e20 7365 6c66 2e5f 6461 7461 5f64  urn self._data_d
-0000bff0: 656c 6179 0a0a 2020 2020 6465 6620 5f6d  elay..    def _m
-0000c000: 6572 6765 5f62 6174 6368 5f61 7267 7328  erge_batch_args(
-0000c010: 7365 6c66 2c20 6461 7461 5f73 6f75 7263  self, data_sourc
-0000c020: 655f 6172 6773 3a20 7669 7274 7561 6c5f  e_args: virtual_
-0000c030: 6461 7461 5f73 6f75 7263 655f 7062 322e  data_source_pb2.
-0000c040: 5669 7274 7561 6c44 6174 6153 6f75 7263  VirtualDataSourc
-0000c050: 6541 7267 7329 3a0a 2020 2020 2020 2020  eArgs):.        
-0000c060: 6461 7461 5f73 6f75 7263 655f 6172 6773  data_source_args
-0000c070: 2e66 696c 655f 6473 5f63 6f6e 6669 672e  .file_ds_config.
-0000c080: 436f 7079 4672 6f6d 2873 656c 662e 5f61  CopyFrom(self._a
-0000c090: 7267 7329 0a0a 0a63 6c61 7373 204b 6166  rgs)...class Kaf
-0000c0a0: 6b61 436f 6e66 6967 2842 6173 6553 7472  kaConfig(BaseStr
-0000c0b0: 6561 6d43 6f6e 6669 6729 3a0a 2020 2020  eamConfig):.    
-0000c0c0: 2222 220a 2020 2020 436f 6e66 6967 7572  """.    Configur
-0000c0d0: 6174 696f 6e20 7573 6564 2074 6f20 7265  ation used to re
-0000c0e0: 6665 7265 6e63 6520 6120 4b61 666b 6120  ference a Kafka 
-0000c0f0: 7374 7265 616d 2e0a 0a20 2020 2054 6865  stream...    The
-0000c100: 204b 6166 6b61 436f 6e66 6967 2063 6c61   KafkaConfig cla
-0000c110: 7373 2069 7320 7573 6564 2074 6f20 6372  ss is used to cr
-0000c120: 6561 7465 2061 2072 6566 6572 656e 6365  eate a reference
-0000c130: 2074 6f20 6120 4b61 666b 6120 7374 7265   to a Kafka stre
-0000c140: 616d 2e0a 0a20 2020 2054 6869 7320 636c  am...    This cl
-0000c150: 6173 7320 6973 2075 7365 6420 6173 2061  ass is used as a
-0000c160: 6e20 696e 7075 7420 746f 2061 203a 636c  n input to a :cl
-0000c170: 6173 733a 6053 7472 6561 6d53 6f75 7263  ass:`StreamSourc
-0000c180: 6560 2773 2070 6172 616d 6574 6572 2060  e`'s parameter `
-0000c190: 6073 7472 6561 6d5f 636f 6e66 6967 6060  `stream_config``
-0000c1a0: 2e20 4465 636c 6172 696e 6720 7468 6973  . Declaring this
-0000c1b0: 2063 6f6e 6669 6775 7261 7469 6f6e 0a20   configuration. 
-0000c1c0: 2020 2063 6c61 7373 2061 6c6f 6e65 2077     class alone w
-0000c1d0: 696c 6c20 6e6f 7420 7265 6769 7374 6572  ill not register
-0000c1e0: 2061 2044 6174 6120 536f 7572 6365 2e20   a Data Source. 
-0000c1f0: 496e 7374 6561 642c 2064 6563 6c61 7265  Instead, declare
-0000c200: 2061 7320 6120 7061 7274 206f 6620 6060   as a part of ``
-0000c210: 5374 7265 616d 536f 7572 6365 6060 2074  StreamSource`` t
-0000c220: 6861 7420 7461 6b65 7320 7468 6973 2063  hat takes this c
-0000c230: 6f6e 6669 6775 7261 7469 6f6e 0a20 2020  onfiguration.   
-0000c240: 2063 6c61 7373 2069 6e73 7461 6e63 6520   class instance 
-0000c250: 6173 2061 2070 6172 616d 6574 6572 2e0a  as a parameter..
-0000c260: 0a20 2020 2022 2222 0a0a 2020 2020 6465  .    """..    de
-0000c270: 6620 5f5f 696e 6974 5f5f 280a 2020 2020  f __init__(.    
-0000c280: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-0000c290: 2020 6b61 666b 615f 626f 6f74 7374 7261    kafka_bootstra
-0000c2a0: 705f 7365 7276 6572 733a 2073 7472 2c0a  p_servers: str,.
-0000c2b0: 2020 2020 2020 2020 746f 7069 6373 3a20          topics: 
-0000c2c0: 7374 722c 0a20 2020 2020 2020 2070 6f73  str,.        pos
-0000c2d0: 745f 7072 6f63 6573 736f 722c 0a20 2020  t_processor,.   
-0000c2e0: 2020 2020 2074 696d 6573 7461 6d70 5f66       timestamp_f
-0000c2f0: 6965 6c64 3a20 7374 722c 0a20 2020 2020  ield: str,.     
-0000c300: 2020 2077 6174 6572 6d61 726b 5f64 656c     watermark_del
-0000c310: 6179 5f74 6872 6573 686f 6c64 3a20 6461  ay_threshold: da
-0000c320: 7465 7469 6d65 2e74 696d 6564 656c 7461  tetime.timedelta
-0000c330: 203d 2064 6174 6574 696d 652e 7469 6d65   = datetime.time
-0000c340: 6465 6c74 6128 686f 7572 733d 3234 292c  delta(hours=24),
-0000c350: 0a20 2020 2020 2020 206f 7074 696f 6e73  .        options
-0000c360: 3a20 4f70 7469 6f6e 616c 5b44 6963 745b  : Optional[Dict[
-0000c370: 7374 722c 2073 7472 5d5d 203d 204e 6f6e  str, str]] = Non
-0000c380: 652c 0a20 2020 2020 2020 2073 736c 5f6b  e,.        ssl_k
-0000c390: 6579 7374 6f72 655f 6c6f 6361 7469 6f6e  eystore_location
-0000c3a0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-0000c3b0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0000c3c0: 7373 6c5f 6b65 7973 746f 7265 5f70 6173  ssl_keystore_pas
-0000c3d0: 7377 6f72 645f 7365 6372 6574 5f69 643a  sword_secret_id:
-0000c3e0: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
-0000c3f0: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
-0000c400: 736c 5f74 7275 7374 7374 6f72 655f 6c6f  sl_truststore_lo
-0000c410: 6361 7469 6f6e 3a20 4f70 7469 6f6e 616c  cation: Optional
-0000c420: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
-0000c430: 2020 2020 2020 7373 6c5f 7472 7573 7473        ssl_trusts
-0000c440: 746f 7265 5f70 6173 7377 6f72 645f 7365  tore_password_se
-0000c450: 6372 6574 5f69 643a 204f 7074 696f 6e61  cret_id: Optiona
-0000c460: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
-0000c470: 2020 2020 2020 2073 6563 7572 6974 795f         security_
-0000c480: 7072 6f74 6f63 6f6c 3a20 4f70 7469 6f6e  protocol: Option
-0000c490: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
-0000c4a0: 2020 2020 2020 2020 6465 6475 706c 6963          deduplic
-0000c4b0: 6174 696f 6e5f 636f 6c75 6d6e 733a 204f  ation_columns: O
-0000c4c0: 7074 696f 6e61 6c5b 4c69 7374 5b73 7472  ptional[List[str
-0000c4d0: 5d5d 203d 204e 6f6e 652c 0a20 2020 2029  ]] = None,.    )
-0000c4e0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0000c4f0: 2020 2020 2020 496e 7374 616e 7469 6174        Instantiat
-0000c500: 6573 2061 206e 6577 204b 6166 6b61 436f  es a new KafkaCo
-0000c510: 6e66 6967 2e0a 0a20 2020 2020 2020 203a  nfig...        :
-0000c520: 7061 7261 6d20 6b61 666b 615f 626f 6f74  param kafka_boot
-0000c530: 7374 7261 705f 7365 7276 6572 733a 2041  strap_servers: A
-0000c540: 2063 6f6d 6d61 2d73 6570 6172 6174 6564   comma-separated
-0000c550: 206c 6973 7420 6f66 2074 6865 204b 6166   list of the Kaf
-0000c560: 6b61 2062 6f6f 7473 7472 6170 2073 6572  ka bootstrap ser
-0000c570: 7665 7220 6164 6472 6573 7365 732e 2050  ver addresses. P
-0000c580: 6173 7365 6420 6469 7265 6374 6c79 0a20  assed directly. 
-0000c590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c5b0: 2020 2020 2020 2074 6f20 7468 6520 5370         to the Sp
-0000c5c0: 6172 6b20 6060 6b61 666b 612e 626f 6f74  ark ``kafka.boot
-0000c5d0: 7374 7261 702e 7365 7276 6572 7360 6020  strap.servers`` 
-0000c5e0: 6f70 7469 6f6e 2e0a 2020 2020 2020 2020  option..        
-0000c5f0: 3a70 6172 616d 2074 6f70 6963 733a 2041  :param topics: A
-0000c600: 2063 6f6d 6d61 2d73 6570 6172 6174 6564   comma-separated
-0000c610: 206c 6973 7420 6f66 204b 6166 6b61 2074   list of Kafka t
-0000c620: 6f70 6963 7320 746f 2073 7562 7363 7269  opics to subscri
-0000c630: 6265 2074 6f2e 2050 6173 7365 6420 6469  be to. Passed di
-0000c640: 7265 6374 6c79 2074 6f20 7468 6520 5370  rectly to the Sp
-0000c650: 6172 6b20 6060 7375 6273 6372 6962 6560  ark ``subscribe`
-0000c660: 600a 2020 2020 2020 2020 2020 2020 2020  `.              
-0000c670: 2020 2020 2020 2020 206f 7074 696f 6e2e           option.
-0000c680: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000c690: 706f 7374 5f70 726f 6365 7373 6f72 3a20  post_processor: 
-0000c6a0: 5079 7468 6f6e 2075 7365 7220 6465 6669  Python user defi
-0000c6b0: 6e65 6420 6675 6e63 7469 6f6e 2060 6066  ned function ``f
-0000c6c0: 2844 6174 6146 7261 6d65 2920 2d3e 2044  (DataFrame) -> D
-0000c6d0: 6174 6146 7261 6d65 6060 2074 6861 7420  ataFrame`` that 
-0000c6e0: 7461 6b65 7320 696e 2072 6177 0a20 2020  takes in raw.   
-0000c6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c710: 2020 2050 7973 7061 726b 2064 6174 6120     Pyspark data 
-0000c720: 736f 7572 6365 2044 6174 6146 7261 6d65  source DataFrame
-0000c730: 2061 6e64 2074 7261 6e73 6c61 7465 7320   and translates 
-0000c740: 6974 2074 6f20 7468 6520 4461 7461 4672  it to the DataFr
-0000c750: 616d 6520 746f 2062 650a 2020 2020 2020  ame to be.      
-0000c760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c780: 636f 6e73 756d 6564 2062 7920 7468 6520  consumed by the 
-0000c790: 4665 6174 7572 6520 5669 6577 2e20 5365  Feature View. Se
-0000c7a0: 6520 616e 2065 7861 6d70 6c65 206f 660a  e an example of.
+0000ba20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ba30: 2020 2020 2020 2020 2020 2020 6669 6c65              file
+0000ba40: 5f66 6f72 6d61 743d 2270 6172 7175 6574  _format="parquet
+0000ba50: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0000ba60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ba70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ba80: 2020 2074 696d 6573 7461 6d70 5f66 6965     timestamp_fie
+0000ba90: 6c64 3d22 7469 6d65 7374 616d 7022 2c0a  ld="timestamp",.
+0000baa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bad0: 706f 7374 5f70 726f 6365 7373 6f72 3d63  post_processor=c
+0000bae0: 6f6e 7665 7274 5f74 656d 7065 7261 7475  onvert_temperatu
+0000baf0: 7265 290a 0a20 2020 2020 2020 2020 2020  re)..           
+0000bb00: 2023 2054 6869 7320 4669 6c65 436f 6e66   # This FileConf
+0000bb10: 6967 2063 616e 2074 6865 6e20 6265 2069  ig can then be i
+0000bb20: 6e63 6c75 6465 6420 6173 2061 6e20 7061  ncluded as an pa
+0000bb30: 7261 6d65 7465 7220 6120 4261 7463 6853  rameter a BatchS
+0000bb40: 6f75 7263 6520 6465 636c 6172 6174 696f  ource declaratio
+0000bb50: 6e2e 0a20 2020 2020 2020 2020 2020 2023  n..            #
+0000bb60: 2046 6f72 2065 7861 6d70 6c65 2c0a 2020   For example,.  
+0000bb70: 2020 2020 2020 2020 2020 6164 5f69 6d70            ad_imp
+0000bb80: 7265 7373 696f 6e73 5f62 6174 6368 203d  ressions_batch =
+0000bb90: 2042 6174 6368 536f 7572 6365 286e 616d   BatchSource(nam
+0000bba0: 653d 2261 645f 696d 7072 6573 7369 6f6e  e="ad_impression
+0000bbb0: 735f 6261 7463 6822 2c0a 2020 2020 2020  s_batch",.      
+0000bbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bbe0: 2020 2020 2020 2020 2062 6174 6368 5f63           batch_c
+0000bbf0: 6f6e 6669 673d 6164 5f69 6d70 7265 7373  onfig=ad_impress
+0000bc00: 696f 6e73 5f66 696c 655f 6473 290a 0a20  ions_file_ds).. 
+0000bc10: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000bc20: 2020 2073 656c 662e 5f61 7267 7320 3d20     self._args = 
+0000bc30: 6461 7461 5f73 6f75 7263 655f 7062 322e  data_source_pb2.
+0000bc40: 4669 6c65 4461 7461 536f 7572 6365 4172  FileDataSourceAr
+0000bc50: 6773 2829 0a20 2020 2020 2020 2073 656c  gs().        sel
+0000bc60: 662e 5f61 7267 732e 7572 6920 3d20 7572  f._args.uri = ur
+0000bc70: 690a 2020 2020 2020 2020 7365 6c66 2e5f  i.        self._
+0000bc80: 6172 6773 2e66 696c 655f 666f 726d 6174  args.file_format
+0000bc90: 203d 2066 696c 655f 666f 726d 6174 0a20   = file_format. 
+0000bca0: 2020 2020 2020 2069 6620 7363 6865 6d61         if schema
+0000bcb0: 5f75 7269 2069 7320 6e6f 7420 4e6f 6e65  _uri is not None
+0000bcc0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0000bcd0: 6c66 2e5f 6172 6773 2e73 6368 656d 615f  lf._args.schema_
+0000bce0: 7572 6920 3d20 7363 6865 6d61 5f75 7269  uri = schema_uri
+0000bcf0: 0a20 2020 2020 2020 2069 6620 706f 7374  .        if post
+0000bd00: 5f70 726f 6365 7373 6f72 2069 7320 6e6f  _processor is no
+0000bd10: 7420 4e6f 6e65 2061 6e64 2066 756e 6374  t None and funct
+0000bd20: 696f 6e5f 7365 7269 616c 697a 6174 696f  ion_serializatio
+0000bd30: 6e2e 7368 6f75 6c64 5f73 6572 6961 6c69  n.should_seriali
+0000bd40: 7a65 5f66 756e 6374 696f 6e28 706f 7374  ze_function(post
+0000bd50: 5f70 726f 6365 7373 6f72 293a 0a20 2020  _processor):.   
+0000bd60: 2020 2020 2020 2020 2073 656c 662e 5f61           self._a
+0000bd70: 7267 732e 636f 6d6d 6f6e 5f61 7267 732e  rgs.common_args.
+0000bd80: 706f 7374 5f70 726f 6365 7373 6f72 2e43  post_processor.C
+0000bd90: 6f70 7946 726f 6d28 6675 6e63 7469 6f6e  opyFrom(function
+0000bda0: 5f73 6572 6961 6c69 7a61 7469 6f6e 2e74  _serialization.t
+0000bdb0: 6f5f 7072 6f74 6f28 706f 7374 5f70 726f  o_proto(post_pro
+0000bdc0: 6365 7373 6f72 2929 0a20 2020 2020 2020  cessor)).       
+0000bdd0: 2069 6620 7469 6d65 7374 616d 705f 6669   if timestamp_fi
+0000bde0: 656c 643a 0a20 2020 2020 2020 2020 2020  eld:.           
+0000bdf0: 2073 656c 662e 5f61 7267 732e 636f 6d6d   self._args.comm
+0000be00: 6f6e 5f61 7267 732e 7469 6d65 7374 616d  on_args.timestam
+0000be10: 705f 6669 656c 6420 3d20 7469 6d65 7374  p_field = timest
+0000be20: 616d 705f 6669 656c 640a 2020 2020 2020  amp_field.      
+0000be30: 2020 6966 2074 696d 6573 7461 6d70 5f66    if timestamp_f
+0000be40: 6f72 6d61 743a 0a20 2020 2020 2020 2020  ormat:.         
+0000be50: 2020 2073 656c 662e 5f61 7267 732e 7469     self._args.ti
+0000be60: 6d65 7374 616d 705f 666f 726d 6174 203d  mestamp_format =
+0000be70: 2074 696d 6573 7461 6d70 5f66 6f72 6d61   timestamp_forma
+0000be80: 740a 2020 2020 2020 2020 6966 2073 6368  t.        if sch
+0000be90: 656d 615f 6f76 6572 7269 6465 3a0a 2020  ema_override:.  
+0000bea0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0000beb0: 6172 6773 2e73 6368 656d 615f 6f76 6572  args.schema_over
+0000bec0: 7269 6465 2e43 6f70 7946 726f 6d28 7370  ride.CopyFrom(sp
+0000bed0: 6172 6b5f 7363 6865 6d61 5f77 7261 7070  ark_schema_wrapp
+0000bee0: 6572 2e53 7061 726b 5363 6865 6d61 5772  er.SparkSchemaWr
+0000bef0: 6170 7065 7228 7363 6865 6d61 5f6f 7665  apper(schema_ove
+0000bf00: 7272 6964 6529 2e74 6f5f 7072 6f74 6f28  rride).to_proto(
+0000bf10: 2929 0a0a 2020 2020 2020 2020 7365 6c66  ))..        self
+0000bf20: 2e5f 6172 6773 2e63 6f6d 6d6f 6e5f 6172  ._args.common_ar
+0000bf30: 6773 2e64 6174 615f 6465 6c61 792e 4672  gs.data_delay.Fr
+0000bf40: 6f6d 5469 6d65 6465 6c74 6128 6461 7461  omTimedelta(data
+0000bf50: 5f64 656c 6179 290a 2020 2020 2020 2020  _delay).        
+0000bf60: 7365 6c66 2e5f 6461 7461 5f64 656c 6179  self._data_delay
+0000bf70: 203d 2064 6174 615f 6465 6c61 790a 2020   = data_delay.  
+0000bf80: 2020 2020 2020 7365 6c66 2e70 6f73 745f        self.post_
+0000bf90: 7072 6f63 6573 736f 7220 3d20 706f 7374  processor = post
+0000bfa0: 5f70 726f 6365 7373 6f72 0a0a 2020 2020  _processor..    
+0000bfb0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0000bfc0: 6620 6461 7461 5f64 656c 6179 2873 656c  f data_delay(sel
+0000bfd0: 6629 202d 3e20 6461 7465 7469 6d65 2e74  f) -> datetime.t
+0000bfe0: 696d 6564 656c 7461 3a0a 2020 2020 2020  imedelta:.      
+0000bff0: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
+0000c000: 2064 7572 6174 696f 6e20 7468 6174 206d   duration that m
+0000c010: 6174 6572 6961 6c69 7a61 7469 6f6e 206a  aterialization j
+0000c020: 6f62 7320 7761 6974 2061 6674 6572 2074  obs wait after t
+0000c030: 6865 2062 6174 6368 5f73 6368 6564 756c  he batch_schedul
+0000c040: 6520 6265 666f 7265 2073 7461 7274 696e  e before startin
+0000c050: 672c 2074 7970 6963 616c 6c79 2074 6f20  g, typically to 
+0000c060: 656e 7375 7265 2074 6861 7420 616c 6c20  ensure that all 
+0000c070: 6461 7461 2068 6173 206c 616e 6465 642e  data has landed.
+0000c080: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+0000c090: 726e 2073 656c 662e 5f64 6174 615f 6465  rn self._data_de
+0000c0a0: 6c61 790a 0a20 2020 2064 6566 205f 6d65  lay..    def _me
+0000c0b0: 7267 655f 6261 7463 685f 6172 6773 2873  rge_batch_args(s
+0000c0c0: 656c 662c 2064 6174 615f 736f 7572 6365  elf, data_source
+0000c0d0: 5f61 7267 733a 2076 6972 7475 616c 5f64  _args: virtual_d
+0000c0e0: 6174 615f 736f 7572 6365 5f70 6232 2e56  ata_source_pb2.V
+0000c0f0: 6972 7475 616c 4461 7461 536f 7572 6365  irtualDataSource
+0000c100: 4172 6773 293a 0a20 2020 2020 2020 2064  Args):.        d
+0000c110: 6174 615f 736f 7572 6365 5f61 7267 732e  ata_source_args.
+0000c120: 6669 6c65 5f64 735f 636f 6e66 6967 2e43  file_ds_config.C
+0000c130: 6f70 7946 726f 6d28 7365 6c66 2e5f 6172  opyFrom(self._ar
+0000c140: 6773 290a 0a0a 636c 6173 7320 4b61 666b  gs)...class Kafk
+0000c150: 6143 6f6e 6669 6728 4261 7365 5374 7265  aConfig(BaseStre
+0000c160: 616d 436f 6e66 6967 293a 0a20 2020 2022  amConfig):.    "
+0000c170: 2222 0a20 2020 2043 6f6e 6669 6775 7261  "".    Configura
+0000c180: 7469 6f6e 2075 7365 6420 746f 2072 6566  tion used to ref
+0000c190: 6572 656e 6365 2061 204b 6166 6b61 2073  erence a Kafka s
+0000c1a0: 7472 6561 6d2e 0a0a 2020 2020 5468 6520  tream...    The 
+0000c1b0: 4b61 666b 6143 6f6e 6669 6720 636c 6173  KafkaConfig clas
+0000c1c0: 7320 6973 2075 7365 6420 746f 2063 7265  s is used to cre
+0000c1d0: 6174 6520 6120 7265 6665 7265 6e63 6520  ate a reference 
+0000c1e0: 746f 2061 204b 6166 6b61 2073 7472 6561  to a Kafka strea
+0000c1f0: 6d2e 0a0a 2020 2020 5468 6973 2063 6c61  m...    This cla
+0000c200: 7373 2069 7320 7573 6564 2061 7320 616e  ss is used as an
+0000c210: 2069 6e70 7574 2074 6f20 6120 3a63 6c61   input to a :cla
+0000c220: 7373 3a60 5374 7265 616d 536f 7572 6365  ss:`StreamSource
+0000c230: 6027 7320 7061 7261 6d65 7465 7220 6060  `'s parameter ``
+0000c240: 7374 7265 616d 5f63 6f6e 6669 6760 602e  stream_config``.
+0000c250: 2044 6563 6c61 7269 6e67 2074 6869 7320   Declaring this 
+0000c260: 636f 6e66 6967 7572 6174 696f 6e0a 2020  configuration.  
+0000c270: 2020 636c 6173 7320 616c 6f6e 6520 7769    class alone wi
+0000c280: 6c6c 206e 6f74 2072 6567 6973 7465 7220  ll not register 
+0000c290: 6120 4461 7461 2053 6f75 7263 652e 2049  a Data Source. I
+0000c2a0: 6e73 7465 6164 2c20 6465 636c 6172 6520  nstead, declare 
+0000c2b0: 6173 2061 2070 6172 7420 6f66 2060 6053  as a part of ``S
+0000c2c0: 7472 6561 6d53 6f75 7263 6560 6020 7468  treamSource`` th
+0000c2d0: 6174 2074 616b 6573 2074 6869 7320 636f  at takes this co
+0000c2e0: 6e66 6967 7572 6174 696f 6e0a 2020 2020  nfiguration.    
+0000c2f0: 636c 6173 7320 696e 7374 616e 6365 2061  class instance a
+0000c300: 7320 6120 7061 7261 6d65 7465 722e 0a0a  s a parameter...
+0000c310: 2020 2020 2222 220a 0a20 2020 2064 6566      """..    def
+0000c320: 205f 5f69 6e69 745f 5f28 0a20 2020 2020   __init__(.     
+0000c330: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0000c340: 206b 6166 6b61 5f62 6f6f 7473 7472 6170   kafka_bootstrap
+0000c350: 5f73 6572 7665 7273 3a20 7374 722c 0a20  _servers: str,. 
+0000c360: 2020 2020 2020 2074 6f70 6963 733a 2073         topics: s
+0000c370: 7472 2c0a 2020 2020 2020 2020 706f 7374  tr,.        post
+0000c380: 5f70 726f 6365 7373 6f72 2c0a 2020 2020  _processor,.    
+0000c390: 2020 2020 7469 6d65 7374 616d 705f 6669      timestamp_fi
+0000c3a0: 656c 643a 2073 7472 2c0a 2020 2020 2020  eld: str,.      
+0000c3b0: 2020 7761 7465 726d 6172 6b5f 6465 6c61    watermark_dela
+0000c3c0: 795f 7468 7265 7368 6f6c 643a 2064 6174  y_threshold: dat
+0000c3d0: 6574 696d 652e 7469 6d65 6465 6c74 6120  etime.timedelta 
+0000c3e0: 3d20 6461 7465 7469 6d65 2e74 696d 6564  = datetime.timed
+0000c3f0: 656c 7461 2868 6f75 7273 3d32 3429 2c0a  elta(hours=24),.
+0000c400: 2020 2020 2020 2020 6f70 7469 6f6e 733a          options:
+0000c410: 204f 7074 696f 6e61 6c5b 4469 6374 5b73   Optional[Dict[s
+0000c420: 7472 2c20 7374 725d 5d20 3d20 4e6f 6e65  tr, str]] = None
+0000c430: 2c0a 2020 2020 2020 2020 7373 6c5f 6b65  ,.        ssl_ke
+0000c440: 7973 746f 7265 5f6c 6f63 6174 696f 6e3a  ystore_location:
+0000c450: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
+0000c460: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
+0000c470: 736c 5f6b 6579 7374 6f72 655f 7061 7373  sl_keystore_pass
+0000c480: 776f 7264 5f73 6563 7265 745f 6964 3a20  word_secret_id: 
+0000c490: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+0000c4a0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7373  None,.        ss
+0000c4b0: 6c5f 7472 7573 7473 746f 7265 5f6c 6f63  l_truststore_loc
+0000c4c0: 6174 696f 6e3a 204f 7074 696f 6e61 6c5b  ation: Optional[
+0000c4d0: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+0000c4e0: 2020 2020 2073 736c 5f74 7275 7374 7374       ssl_trustst
+0000c4f0: 6f72 655f 7061 7373 776f 7264 5f73 6563  ore_password_sec
+0000c500: 7265 745f 6964 3a20 4f70 7469 6f6e 616c  ret_id: Optional
+0000c510: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
+0000c520: 2020 2020 2020 7365 6375 7269 7479 5f70        security_p
+0000c530: 726f 746f 636f 6c3a 204f 7074 696f 6e61  rotocol: Optiona
+0000c540: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
+0000c550: 2020 2020 2020 2064 6564 7570 6c69 6361         deduplica
+0000c560: 7469 6f6e 5f63 6f6c 756d 6e73 3a20 4f70  tion_columns: Op
+0000c570: 7469 6f6e 616c 5b4c 6973 745b 7374 725d  tional[List[str]
+0000c580: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 293a  ] = None,.    ):
+0000c590: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000c5a0: 2020 2020 2049 6e73 7461 6e74 6961 7465       Instantiate
+0000c5b0: 7320 6120 6e65 7720 4b61 666b 6143 6f6e  s a new KafkaCon
+0000c5c0: 6669 672e 0a0a 2020 2020 2020 2020 3a70  fig...        :p
+0000c5d0: 6172 616d 206b 6166 6b61 5f62 6f6f 7473  aram kafka_boots
+0000c5e0: 7472 6170 5f73 6572 7665 7273 3a20 4120  trap_servers: A 
+0000c5f0: 636f 6d6d 612d 7365 7061 7261 7465 6420  comma-separated 
+0000c600: 6c69 7374 206f 6620 7468 6520 4b61 666b  list of the Kafk
+0000c610: 6120 626f 6f74 7374 7261 7020 7365 7276  a bootstrap serv
+0000c620: 6572 2061 6464 7265 7373 6573 2e20 5061  er addresses. Pa
+0000c630: 7373 6564 2064 6972 6563 746c 790a 2020  ssed directly.  
+0000c640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c660: 2020 2020 2020 746f 2074 6865 2053 7061        to the Spa
+0000c670: 726b 2060 606b 6166 6b61 2e62 6f6f 7473  rk ``kafka.boots
+0000c680: 7472 6170 2e73 6572 7665 7273 6060 206f  trap.servers`` o
+0000c690: 7074 696f 6e2e 0a20 2020 2020 2020 203a  ption..        :
+0000c6a0: 7061 7261 6d20 746f 7069 6373 3a20 4120  param topics: A 
+0000c6b0: 636f 6d6d 612d 7365 7061 7261 7465 6420  comma-separated 
+0000c6c0: 6c69 7374 206f 6620 4b61 666b 6120 746f  list of Kafka to
+0000c6d0: 7069 6373 2074 6f20 7375 6273 6372 6962  pics to subscrib
+0000c6e0: 6520 746f 2e20 5061 7373 6564 2064 6972  e to. Passed dir
+0000c6f0: 6563 746c 7920 746f 2074 6865 2053 7061  ectly to the Spa
+0000c700: 726b 2060 6073 7562 7363 7269 6265 6060  rk ``subscribe``
+0000c710: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c720: 2020 2020 2020 2020 6f70 7469 6f6e 2e0a          option..
+0000c730: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
+0000c740: 6f73 745f 7072 6f63 6573 736f 723a 2050  ost_processor: P
+0000c750: 7974 686f 6e20 7573 6572 2064 6566 696e  ython user defin
+0000c760: 6564 2066 756e 6374 696f 6e20 6060 6628  ed function ``f(
+0000c770: 4461 7461 4672 616d 6529 202d 3e20 4461  DataFrame) -> Da
+0000c780: 7461 4672 616d 6560 6020 7468 6174 2074  taFrame`` that t
+0000c790: 616b 6573 2069 6e20 7261 770a 2020 2020  akes in raw.    
+0000c7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000c7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c7d0: 2020 2020 2020 706f 7374 5f70 726f 6365        post_proce
-0000c7e0: 7373 6f72 2069 6e20 7468 6520 6055 7365  ssor in the `Use
-0000c7f0: 7220 4775 6964 6560 5f2e 0a20 2020 2020  r Guide`_..     
-0000c800: 2020 203a 7061 7261 6d20 7469 6d65 7374     :param timest
-0000c810: 616d 705f 6669 656c 643a 204e 616d 6520  amp_field: Name 
-0000c820: 6f66 2074 6865 2063 6f6c 756d 6e20 636f  of the column co
-0000c830: 6e74 6169 6e69 6e67 2074 696d 6573 7461  ntaining timesta
-0000c840: 6d70 2066 6f72 2077 6174 6572 6d61 726b  mp for watermark
-0000c850: 696e 672e 0a20 2020 2020 2020 203a 7061  ing..        :pa
-0000c860: 7261 6d20 7761 7465 726d 6172 6b5f 6465  ram watermark_de
-0000c870: 6c61 795f 7468 7265 7368 6f6c 643a 2028  lay_threshold: (
-0000c880: 4465 6661 756c 743a 2032 3468 2920 5761  Default: 24h) Wa
-0000c890: 7465 726d 6172 6b20 7469 6d65 2069 6e74  termark time int
-0000c8a0: 6572 7661 6c2c 2065 2e67 3a20 7469 6d65  erval, e.g: time
-0000c8b0: 6465 6c74 6128 686f 7572 733d 3336 292c  delta(hours=36),
-0000c8c0: 2075 7365 6420 6279 2053 7061 726b 2053   used by Spark S
-0000c8d0: 7472 7563 7475 7265 6420 5374 7265 616d  tructured Stream
-0000c8e0: 696e 6720 746f 2061 6363 6f75 6e74 2066  ing to account f
-0000c8f0: 6f72 206c 6174 652d 6172 7269 7669 6e67  or late-arriving
-0000c900: 2064 6174 612e 2053 6565 3a20 6050 726f   data. See: `Pro
-0000c910: 6475 6374 696f 6e69 7a69 6e67 2061 2053  ductionizing a S
-0000c920: 7472 6561 6d60 5f2e 0a20 2020 2020 2020  tream`_..       
-0000c930: 203a 7061 7261 6d20 6f70 7469 6f6e 733a   :param options:
-0000c940: 2041 206d 6170 206f 6620 6164 6469 7469   A map of additi
-0000c950: 6f6e 616c 2053 7061 726b 2072 6561 6453  onal Spark readS
-0000c960: 7472 6561 6d20 6f70 7469 6f6e 730a 2020  tream options.  
-0000c970: 2020 2020 2020 3a70 6172 616d 2073 736c        :param ssl
-0000c980: 5f6b 6579 7374 6f72 655f 6c6f 6361 7469  _keystore_locati
-0000c990: 6f6e 3a20 416e 2044 4246 5320 2844 6174  on: An DBFS (Dat
-0000c9a0: 6162 7269 636b 7320 6f6e 6c79 2920 6f72  abricks only) or
-0000c9b0: 2053 3320 5552 4920 7468 6174 2070 6f69   S3 URI that poi
-0000c9c0: 6e74 7320 746f 2074 6865 206b 6579 7374  nts to the keyst
-0000c9d0: 6f72 6520 6669 6c65 2074 6861 7420 7368  ore file that sh
-0000c9e0: 6f75 6c64 2062 6520 7573 6564 2066 6f72  ould be used for
-0000c9f0: 2053 534c 2062 726f 6b65 7273 2e20 4e6f   SSL brokers. No
-0000ca00: 7465 2066 6f72 2053 3320 5552 4973 2c20  te for S3 URIs, 
-0000ca10: 7468 6973 206d 7573 7420 6265 2063 6f6e  this must be con
-0000ca20: 6669 6775 7265 6420 6279 2079 6f75 7220  figured by your 
-0000ca30: 5465 6374 6f6e 2072 6570 7265 7365 6e74  Tecton represent
-0000ca40: 6174 6976 652e 0a20 2020 2020 2020 2020  ative..         
-0000ca50: 2020 2045 7861 6d70 6c65 3a20 6060 7333     Example: ``s3
-0000ca60: 3a2f 2f74 6563 746f 6e2d 3c64 6570 6c6f  ://tecton-<deplo
-0000ca70: 796d 656e 7420 6e61 6d65 3e2f 6b61 666b  yment name>/kafk
-0000ca80: 612d 6372 6564 656e 7469 616c 732f 6b61  a-credentials/ka
-0000ca90: 666b 615f 636c 6965 6e74 5f6b 6579 7374  fka_client_keyst
-0000caa0: 6f72 652e 6a6b 7360 600a 2020 2020 2020  ore.jks``.      
-0000cab0: 2020 2020 2020 4578 616d 706c 653a 2060        Example: `
-0000cac0: 6064 6266 733a 2f6b 6166 6b61 2d63 7265  `dbfs:/kafka-cre
-0000cad0: 6465 6e74 6961 6c73 2f6b 6166 6b61 5f63  dentials/kafka_c
-0000cae0: 6c69 656e 745f 6b65 7973 746f 7265 2e6a  lient_keystore.j
-0000caf0: 6b73 6060 0a20 2020 2020 2020 203a 7061  ks``.        :pa
-0000cb00: 7261 6d20 7373 6c5f 6b65 7973 746f 7265  ram ssl_keystore
-0000cb10: 5f70 6173 7377 6f72 645f 7365 6372 6574  _password_secret
-0000cb20: 5f69 643a 2054 6865 2063 6f6e 6669 6720  _id: The config 
-0000cb30: 6b65 7920 666f 7220 7468 6520 7061 7373  key for the pass
-0000cb40: 776f 7264 2066 6f72 2074 6865 204b 6579  word for the Key
-0000cb50: 7374 6f72 652e 0a20 2020 2020 2020 2020  store..         
-0000cb60: 2020 2053 686f 756c 6420 7374 6172 7420     Should start 
-0000cb70: 7769 7468 2060 6053 4543 5245 545f 6060  with ``SECRET_``
-0000cb80: 2c20 6578 616d 706c 653a 2060 6053 4543  , example: ``SEC
-0000cb90: 5245 545f 4b41 464b 415f 5052 4f44 5543  RET_KAFKA_PRODUC
-0000cba0: 5449 4f4e 6060 2e0a 2020 2020 2020 2020  TION``..        
-0000cbb0: 3a70 6172 616d 2073 736c 5f74 7275 7374  :param ssl_trust
-0000cbc0: 7374 6f72 655f 6c6f 6361 7469 6f6e 3a20  store_location: 
-0000cbd0: 416e 2044 4246 5320 2844 6174 6162 7269  An DBFS (Databri
-0000cbe0: 636b 7320 6f6e 6c79 2920 6f72 2053 3320  cks only) or S3 
-0000cbf0: 5552 4920 7468 6174 2070 6f69 6e74 7320  URI that points 
-0000cc00: 746f 2074 6865 2074 7275 7374 7374 6f72  to the truststor
-0000cc10: 6520 6669 6c65 2074 6861 7420 7368 6f75  e file that shou
-0000cc20: 6c64 2062 6520 7573 6564 2066 6f72 2053  ld be used for S
-0000cc30: 534c 2062 726f 6b65 7273 2e20 4e6f 7465  SL brokers. Note
-0000cc40: 2066 6f72 2053 3320 5552 4973 2c20 7468   for S3 URIs, th
-0000cc50: 6973 206d 7573 7420 6265 2063 6f6e 6669  is must be confi
-0000cc60: 6775 7265 6420 6279 2079 6f75 7220 5465  gured by your Te
-0000cc70: 6374 6f6e 2072 6570 7265 7365 6e74 6174  cton representat
-0000cc80: 6976 652e 2049 6620 6e6f 7420 7072 6f76  ive. If not prov
-0000cc90: 6964 6564 2c20 7468 6520 6465 6661 756c  ided, the defaul
-0000cca0: 7420 7472 7573 7473 746f 7265 2066 6f72  t truststore for
-0000ccb0: 2079 6f75 7220 636f 6d70 7574 6520 7072   your compute pr
-0000ccc0: 6f76 6964 6572 2077 696c 6c20 6265 2075  ovider will be u
-0000ccd0: 7365 642e 204e 6f74 6520 7468 6174 2074  sed. Note that t
-0000cce0: 6869 7320 6973 2072 6571 7569 7265 6420  his is required 
-0000ccf0: 666f 7220 4157 532d 7369 676e 6564 206b  for AWS-signed k
-0000cd00: 6579 7374 6f72 6573 206f 6e20 4461 7461  eystores on Data
-0000cd10: 6272 6963 6b73 2e0a 2020 2020 2020 2020  bricks..        
-0000cd20: 2020 2020 4578 616d 706c 653a 2060 6073      Example: ``s
-0000cd30: 333a 2f2f 7465 6374 6f6e 2d3c 6465 706c  3://tecton-<depl
-0000cd40: 6f79 6d65 6e74 206e 616d 653e 2f6b 6166  oyment name>/kaf
-0000cd50: 6b61 2d63 7265 6465 6e74 6961 6c73 2f6b  ka-credentials/k
-0000cd60: 6166 6b61 5f63 6c69 656e 745f 7472 7573  afka_client_trus
-0000cd70: 7473 746f 7265 2e6a 6b73 6060 0a20 2020  tstore.jks``.   
-0000cd80: 2020 2020 2020 2020 2045 7861 6d70 6c65           Example
-0000cd90: 3a20 6060 6462 6673 3a2f 6b61 666b 612d  : ``dbfs:/kafka-
-0000cda0: 6372 6564 656e 7469 616c 732f 6b61 666b  credentials/kafk
-0000cdb0: 615f 636c 6965 6e74 5f74 7275 7374 7374  a_client_trustst
-0000cdc0: 6f72 652e 6a6b 7360 600a 2020 2020 2020  ore.jks``.      
-0000cdd0: 2020 3a70 6172 616d 2073 736c 5f74 7275    :param ssl_tru
-0000cde0: 7374 7374 6f72 655f 7061 7373 776f 7264  ststore_password
-0000cdf0: 5f73 6563 7265 745f 6964 2028 4f70 7469  _secret_id (Opti
-0000ce00: 6f6e 616c 293a 2054 6865 2063 6f6e 6669  onal): The confi
-0000ce10: 6720 6b65 7920 666f 7220 7468 6520 7061  g key for the pa
-0000ce20: 7373 776f 7264 2066 6f72 2074 6865 2054  ssword for the T
-0000ce30: 7275 7374 7374 6f72 652e 0a20 2020 2020  ruststore..     
-0000ce40: 2020 2020 2020 2053 686f 756c 6420 7374         Should st
-0000ce50: 6172 7420 7769 7468 2060 6053 4543 5245  art with ``SECRE
-0000ce60: 545f 6060 2c20 6578 616d 706c 653a 2060  T_``, example: `
-0000ce70: 6053 4543 5245 545f 4b41 464b 415f 5052  `SECRET_KAFKA_PR
-0000ce80: 4f44 5543 5449 4f4e 6060 2e0a 2020 2020  ODUCTION``..    
-0000ce90: 2020 2020 3a70 6172 616d 2073 6563 7572      :param secur
-0000cea0: 6974 795f 7072 6f74 6f63 6f6c 3a20 5365  ity_protocol: Se
-0000ceb0: 6375 7269 7479 2070 726f 746f 636f 6c20  curity protocol 
-0000cec0: 7061 7373 6564 2074 6f20 6b61 666b 612e  passed to kafka.
-0000ced0: 7365 6375 7269 7479 2e70 726f 746f 636f  security.protoco
-0000cee0: 6c2e 2053 6565 204b 6166 6b61 2064 6f63  l. See Kafka doc
-0000cef0: 756d 656e 7461 7469 6f6e 2066 6f72 2076  umentation for v
-0000cf00: 616c 6964 2076 616c 7565 732e 0a20 2020  alid values..   
-0000cf10: 2020 2020 203a 7061 7261 6d20 6465 6475       :param dedu
-0000cf20: 706c 6963 6174 696f 6e5f 636f 6c75 6d6e  plication_column
-0000cf30: 733a 2043 6f6c 756d 6e73 2069 6e20 7468  s: Columns in th
-0000cf40: 6520 7374 7265 616d 2064 6174 6120 7468  e stream data th
-0000cf50: 6174 2075 6e69 7175 656c 7920 6964 656e  at uniquely iden
-0000cf60: 7469 6679 2064 6174 6120 7265 636f 7264  tify data record
-0000cf70: 732e 0a20 2020 2020 2020 2020 2020 2020  s..             
-0000cf80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cf90: 2020 2020 2020 2020 2020 2055 7365 6420             Used 
-0000cfa0: 666f 7220 6465 2d64 7570 6c69 6361 7469  for de-duplicati
-0000cfb0: 6e67 2e20 5370 6172 6b20 7769 6c6c 2064  ng. Spark will d
-0000cfc0: 726f 7020 726f 7773 2069 6620 7468 6572  rop rows if ther
-0000cfd0: 6520 6172 6520 6475 706c 6963 6174 6573  e are duplicates
-0000cfe0: 2069 6e20 7468 6520 6465 6475 706c 6963   in the deduplic
-0000cff0: 6174 696f 6e5f 636f 6c75 6d6e 732c 2062  ation_columns, b
-0000d000: 7574 206f 6e6c 7920 7769 7468 696e 2074  ut only within t
-0000d010: 6865 2077 6174 6572 6d61 726b 2064 656c  he watermark del
-0000d020: 6179 2077 696e 646f 772e 0a0a 2020 2020  ay window...    
-0000d030: 2020 2020 3a72 6574 7572 6e3a 2041 204b      :return: A K
-0000d040: 6166 6b61 436f 6e66 6967 2063 6c61 7373  afkaConfig class
-0000d050: 2069 6e73 7461 6e63 652e 0a0a 2020 2020   instance...    
-0000d060: 2020 2020 2e2e 205f 5573 6572 2047 7569      .. _User Gui
-0000d070: 6465 3a20 6874 7470 733a 2f2f 646f 6373  de: https://docs
-0000d080: 2e74 6563 746f 6e2e 6169 2f64 6f63 732f  .tecton.ai/docs/
-0000d090: 6465 6669 6e69 6e67 2d66 6561 7475 7265  defining-feature
-0000d0a0: 732f 6461 7461 2d73 6f75 7263 6573 2f63  s/data-sources/c
-0000d0b0: 7265 6174 696e 672d 616e 642d 7465 7374  reating-and-test
-0000d0c0: 696e 672d 612d 7374 7265 616d 696e 672d  ing-a-streaming-
-0000d0d0: 6461 7461 2d73 6f75 7263 6523 7772 6974  data-source#writ
-0000d0e0: 652d 7468 652d 7374 7265 616d 2d6d 6573  e-the-stream-mes
-0000d0f0: 7361 6765 2d70 6f73 742d 7072 6f63 6573  sage-post-proces
-0000d100: 736f 722d 6675 6e63 7469 6f6e 0a20 2020  sor-function.   
-0000d110: 2020 2020 202e 2e20 5f50 726f 6475 6374       .. _Product
-0000d120: 696f 6e69 7a69 6e67 2061 2053 7472 6561  ionizing a Strea
-0000d130: 6d3a 2068 7474 7073 3a2f 2f64 6f63 732e  m: https://docs.
-0000d140: 7465 6374 6f6e 2e61 692f 646f 6373 2f64  tecton.ai/docs/d
-0000d150: 6566 696e 696e 672d 6665 6174 7572 6573  efining-features
-0000d160: 2f66 6561 7475 7265 2d76 6965 7773 2f73  /feature-views/s
-0000d170: 7472 6561 6d2d 6665 6174 7572 652d 7669  tream-feature-vi
-0000d180: 6577 2370 726f 6475 6374 696f 6e69 7a69  ew#productionizi
-0000d190: 6e67 2d61 2d73 7472 6561 6d0a 0a20 2020  ng-a-stream..   
-0000d1a0: 2020 2020 2045 7861 6d70 6c65 206f 6620       Example of 
-0000d1b0: 6120 4b61 666b 6143 6f6e 6669 6720 6465  a KafkaConfig de
-0000d1c0: 636c 6172 6174 696f 6e3a 0a0a 2020 2020  claration:..    
-0000d1d0: 2020 2020 2e2e 2063 6f64 652d 626c 6f63      .. code-bloc
-0000d1e0: 6b3a 3a20 7079 7468 6f6e 0a0a 2020 2020  k:: python..    
-0000d1f0: 2020 2020 2020 2020 696d 706f 7274 2064          import d
-0000d200: 6174 6574 696d 650a 2020 2020 2020 2020  atetime.        
-0000d210: 2020 2020 696d 706f 7274 2070 7973 7061      import pyspa
-0000d220: 726b 0a20 2020 2020 2020 2020 2020 2066  rk.            f
-0000d230: 726f 6d20 7465 6374 6f6e 2069 6d70 6f72  rom tecton impor
-0000d240: 7420 4b61 666b 6143 6f6e 6669 670a 0a0a  t KafkaConfig...
-0000d250: 2020 2020 2020 2020 2020 2020 6465 6620              def 
-0000d260: 7261 775f 6461 7461 5f64 6573 6572 6961  raw_data_deseria
-0000d270: 6c69 7a61 7469 6f6e 2864 663a 7079 7370  lization(df:pysp
-0000d280: 6172 6b2e 7371 6c2e 4461 7461 4672 616d  ark.sql.DataFram
-0000d290: 6529 202d 3e20 7079 7370 6172 6b2e 7371  e) -> pyspark.sq
-0000d2a0: 6c2e 4461 7461 4672 616d 653a 0a20 2020  l.DataFrame:.   
-0000d2b0: 2020 2020 2020 2020 2020 2020 2066 726f               fro
-0000d2c0: 6d20 7079 7370 6172 6b2e 7371 6c2e 6675  m pyspark.sql.fu
-0000d2d0: 6e63 7469 6f6e 7320 696d 706f 7274 2066  nctions import f
-0000d2e0: 726f 6d5f 6a73 6f6e 2c20 636f 6c0a 2020  rom_json, col.  
-0000d2f0: 2020 2020 2020 2020 2020 2020 2020 6672                fr
-0000d300: 6f6d 2070 7973 7061 726b 2e73 716c 2e74  om pyspark.sql.t
-0000d310: 7970 6573 2069 6d70 6f72 7420 5374 7269  ypes import Stri
-0000d320: 6e67 5479 7065 2c20 5469 6d65 7374 616d  ngType, Timestam
-0000d330: 7054 7970 650a 0a20 2020 2020 2020 2020  pType..         
-0000d340: 2020 2020 2020 2050 4159 4c4f 4144 5f53         PAYLOAD_S
-0000d350: 4348 454d 4120 3d20 280a 2020 2020 2020  CHEMA = (.      
-0000d360: 2020 2020 2020 2020 2020 2020 5374 7275              Stru
-0000d370: 6374 5479 7065 2829 0a20 2020 2020 2020  ctType().       
-0000d380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d390: 202e 6164 6428 2261 6363 6f75 6e74 4964   .add("accountId
-0000d3a0: 222c 2053 7472 696e 6754 7970 6528 292c  ", StringType(),
-0000d3b0: 2046 616c 7365 290a 2020 2020 2020 2020   False).        
-0000d3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d3d0: 2e61 6464 2822 7472 616e 7361 6374 696f  .add("transactio
-0000d3e0: 6e5f 6964 222c 2053 7472 696e 6754 7970  n_id", StringTyp
-0000d3f0: 6528 292c 2046 616c 7365 290a 2020 2020  e(), False).    
-0000d400: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0000d410: 2020 2020 2020 2020 2020 2020 2020 2045                 E
-0000d420: 5645 4e54 5f45 4e56 454c 4f50 455f 5343  VENT_ENVELOPE_SC
-0000d430: 4845 4d41 203d 2028 0a20 2020 2020 2020  HEMA = (.       
-0000d440: 2020 2020 2020 2020 2020 2053 7472 7563             Struc
-0000d450: 7454 7970 6528 290a 2020 2020 2020 2020  tType().        
-0000d460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d470: 2e61 6464 2822 7469 6d65 7374 616d 7022  .add("timestamp"
-0000d480: 2c20 5469 6d65 7374 616d 7054 7970 6528  , TimestampType(
-0000d490: 292c 2046 616c 7365 290a 2020 2020 2020  ), False).      
-0000d4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d4b0: 2020 2e61 6464 2822 7061 796c 6f61 6422    .add("payload"
-0000d4c0: 2c20 5041 594c 4f41 445f 5343 4845 4d41  , PAYLOAD_SCHEMA
-0000d4d0: 2c20 4661 6c73 6529 0a20 2020 2020 2020  , False).       
-0000d4e0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0000d4f0: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
-0000d500: 6520 3d20 636f 6c28 2276 616c 7565 2229  e = col("value")
-0000d510: 2e63 6173 7428 2273 7472 696e 6722 290a  .cast("string").
-0000d520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d530: 6466 203d 2064 662e 7769 7468 436f 6c75  df = df.withColu
-0000d540: 6d6e 2822 6576 656e 7422 2c20 6672 6f6d  mn("event", from
-0000d550: 5f6a 736f 6e28 7661 6c75 652c 2045 5645  _json(value, EVE
-0000d560: 4e54 5f45 4e56 454c 4f50 455f 5343 4845  NT_ENVELOPE_SCHE
-0000d570: 4d41 2929 0a20 2020 2020 2020 2020 2020  MA)).           
-0000d580: 2020 2020 2064 6620 3d20 6466 2e77 6974       df = df.wit
-0000d590: 6843 6f6c 756d 6e28 2261 6363 6f75 6e74  hColumn("account
-0000d5a0: 4964 222c 2063 6f6c 2822 6576 656e 742e  Id", col("event.
-0000d5b0: 7061 796c 6f61 642e 6163 636f 756e 7449  payload.accountI
-0000d5c0: 6422 2929 0a20 2020 2020 2020 2020 2020  d")).           
-0000d5d0: 2020 2020 2064 6620 3d20 6466 2e77 6974       df = df.wit
-0000d5e0: 6843 6f6c 756d 6e28 2274 7261 6e73 6163  hColumn("transac
-0000d5f0: 7469 6f6e 5f69 6422 2c20 636f 6c28 2265  tion_id", col("e
-0000d600: 7665 6e74 2e70 6179 6c6f 6164 2e74 7261  vent.payload.tra
-0000d610: 6e73 6163 7469 6f6e 5f69 6422 2929 0a20  nsaction_id")). 
-0000d620: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0000d630: 6620 3d20 6466 2e77 6974 6843 6f6c 756d  f = df.withColum
-0000d640: 6e28 2274 696d 6573 7461 6d70 222c 2063  n("timestamp", c
-0000d650: 6f6c 2822 6576 656e 742e 7469 6d65 7374  ol("event.timest
-0000d660: 616d 7022 2929 0a0a 2020 2020 2020 2020  amp"))..        
-0000d670: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-0000d680: 660a 0a20 2020 2020 2020 2020 2020 2023  f..            #
-0000d690: 2044 6563 6c61 7265 204b 6166 6b61 2043   Declare Kafka C
-0000d6a0: 6f6e 6669 6720 696e 7374 616e 6365 206f  onfig instance o
-0000d6b0: 626a 6563 7420 7468 6174 2063 616e 2062  bject that can b
-0000d6c0: 6520 7573 6564 2061 7320 616e 2061 7267  e used as an arg
-0000d6d0: 756d 656e 7420 696e 2053 7472 6561 6d53  ument in StreamS
-0000d6e0: 6f75 7263 650a 2020 2020 2020 2020 2020  ource.          
-0000d6f0: 2020 636c 6963 6b5f 7374 7265 616d 5f6b    click_stream_k
-0000d700: 6166 6b61 5f64 7320 3d20 4b61 666b 6143  afka_ds = KafkaC
-0000d710: 6f6e 6669 6728 0a20 2020 2020 2020 2020  onfig(.         
-0000d720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d730: 2020 2020 2020 2020 2020 2020 2020 206b                 k
-0000d740: 6166 6b61 5f62 6f6f 7473 7472 6170 5f73  afka_bootstrap_s
-0000d750: 6572 7665 7273 3d22 3132 372e 302e 302e  ervers="127.0.0.
-0000d760: 313a 3132 3334 3522 2c0a 2020 2020 2020  1:12345",.      
-0000d770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d790: 2020 746f 7069 6373 3d22 636c 6963 6b2d    topics="click-
-0000d7a0: 6576 656e 7473 2d6a 736f 6e22 2c0a 2020  events-json",.  
-0000d7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d7d0: 2020 2020 2020 7469 6d65 7374 616d 705f        timestamp_
-0000d7e0: 6669 656c 643d 2263 6c69 636b 5f65 7665  field="click_eve
-0000d7f0: 6e74 5f74 696d 6573 7461 6d70 222c 0a20  nt_timestamp",. 
-0000d800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d820: 2020 2020 2020 2070 6f73 745f 7072 6f63         post_proc
-0000d830: 6573 736f 723d 7261 775f 6461 7461 5f64  essor=raw_data_d
-0000d840: 6573 6572 6961 6c69 7a61 7469 6f6e 290a  eserialization).
-0000d850: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000d860: 2020 2020 7365 6c66 2e5f 6172 6773 203d      self._args =
-0000d870: 2061 7267 7320 3d20 6461 7461 5f73 6f75   args = data_sou
-0000d880: 7263 655f 7062 322e 4b61 666b 6144 6174  rce_pb2.KafkaDat
-0000d890: 6153 6f75 7263 6541 7267 7328 290a 2020  aSourceArgs().  
-0000d8a0: 2020 2020 2020 6172 6773 2e6b 6166 6b61        args.kafka
-0000d8b0: 5f62 6f6f 7473 7472 6170 5f73 6572 7665  _bootstrap_serve
-0000d8c0: 7273 203d 206b 6166 6b61 5f62 6f6f 7473  rs = kafka_boots
-0000d8d0: 7472 6170 5f73 6572 7665 7273 0a20 2020  trap_servers.   
-0000d8e0: 2020 2020 2061 7267 732e 746f 7069 6373       args.topics
-0000d8f0: 203d 2074 6f70 6963 730a 2020 2020 2020   = topics.      
-0000d900: 2020 6966 2066 756e 6374 696f 6e5f 7365    if function_se
-0000d910: 7269 616c 697a 6174 696f 6e2e 7368 6f75  rialization.shou
-0000d920: 6c64 5f73 6572 6961 6c69 7a65 5f66 756e  ld_serialize_fun
-0000d930: 6374 696f 6e28 706f 7374 5f70 726f 6365  ction(post_proce
-0000d940: 7373 6f72 293a 0a20 2020 2020 2020 2020  ssor):.         
-0000d950: 2020 2061 7267 732e 636f 6d6d 6f6e 5f61     args.common_a
-0000d960: 7267 732e 706f 7374 5f70 726f 6365 7373  rgs.post_process
-0000d970: 6f72 2e43 6f70 7946 726f 6d28 6675 6e63  or.CopyFrom(func
-0000d980: 7469 6f6e 5f73 6572 6961 6c69 7a61 7469  tion_serializati
-0000d990: 6f6e 2e74 6f5f 7072 6f74 6f28 706f 7374  on.to_proto(post
-0000d9a0: 5f70 726f 6365 7373 6f72 2929 0a20 2020  _processor)).   
-0000d9b0: 2020 2020 2061 7267 732e 636f 6d6d 6f6e       args.common
-0000d9c0: 5f61 7267 732e 7469 6d65 7374 616d 705f  _args.timestamp_
-0000d9d0: 6669 656c 6420 3d20 7469 6d65 7374 616d  field = timestam
-0000d9e0: 705f 6669 656c 640a 2020 2020 2020 2020  p_field.        
-0000d9f0: 6966 2077 6174 6572 6d61 726b 5f64 656c  if watermark_del
-0000da00: 6179 5f74 6872 6573 686f 6c64 3a0a 2020  ay_threshold:.  
-0000da10: 2020 2020 2020 2020 2020 6172 6773 2e63            args.c
-0000da20: 6f6d 6d6f 6e5f 6172 6773 2e77 6174 6572  ommon_args.water
-0000da30: 6d61 726b 5f64 656c 6179 5f74 6872 6573  mark_delay_thres
-0000da40: 686f 6c64 2e46 726f 6d54 696d 6564 656c  hold.FromTimedel
-0000da50: 7461 2877 6174 6572 6d61 726b 5f64 656c  ta(watermark_del
-0000da60: 6179 5f74 6872 6573 686f 6c64 290a 2020  ay_threshold).  
-0000da70: 2020 2020 2020 666f 7220 6b65 7920 696e        for key in
-0000da80: 2073 6f72 7465 6428 286f 7074 696f 6e73   sorted((options
-0000da90: 206f 7220 7b7d 292e 6b65 7973 2829 293a   or {}).keys()):
-0000daa0: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
-0000dab0: 696f 6e20 3d20 6461 7461 5f73 6f75 7263  ion = data_sourc
-0000dac0: 655f 7062 322e 4f70 7469 6f6e 2829 0a20  e_pb2.Option(). 
-0000dad0: 2020 2020 2020 2020 2020 206f 7074 696f             optio
-0000dae0: 6e2e 6b65 7920 3d20 6b65 790a 2020 2020  n.key = key.    
-0000daf0: 2020 2020 2020 2020 6f70 7469 6f6e 2e76          option.v
-0000db00: 616c 7565 203d 206f 7074 696f 6e73 5b6b  alue = options[k
-0000db10: 6579 5d0a 2020 2020 2020 2020 2020 2020  ey].            
-0000db20: 6172 6773 2e6f 7074 696f 6e73 2e61 7070  args.options.app
-0000db30: 656e 6428 6f70 7469 6f6e 290a 2020 2020  end(option).    
-0000db40: 2020 2020 6966 2073 736c 5f6b 6579 7374      if ssl_keyst
-0000db50: 6f72 655f 6c6f 6361 7469 6f6e 3a0a 2020  ore_location:.  
-0000db60: 2020 2020 2020 2020 2020 6172 6773 2e73            args.s
-0000db70: 736c 5f6b 6579 7374 6f72 655f 6c6f 6361  sl_keystore_loca
-0000db80: 7469 6f6e 203d 2073 736c 5f6b 6579 7374  tion = ssl_keyst
-0000db90: 6f72 655f 6c6f 6361 7469 6f6e 0a20 2020  ore_location.   
-0000dba0: 2020 2020 2069 6620 7373 6c5f 6b65 7973       if ssl_keys
-0000dbb0: 746f 7265 5f70 6173 7377 6f72 645f 7365  tore_password_se
-0000dbc0: 6372 6574 5f69 643a 0a20 2020 2020 2020  cret_id:.       
-0000dbd0: 2020 2020 2061 7267 732e 7373 6c5f 6b65       args.ssl_ke
-0000dbe0: 7973 746f 7265 5f70 6173 7377 6f72 645f  ystore_password_
-0000dbf0: 7365 6372 6574 5f69 6420 3d20 7373 6c5f  secret_id = ssl_
-0000dc00: 6b65 7973 746f 7265 5f70 6173 7377 6f72  keystore_passwor
-0000dc10: 645f 7365 6372 6574 5f69 640a 2020 2020  d_secret_id.    
-0000dc20: 2020 2020 6966 2073 736c 5f74 7275 7374      if ssl_trust
-0000dc30: 7374 6f72 655f 6c6f 6361 7469 6f6e 3a0a  store_location:.
-0000dc40: 2020 2020 2020 2020 2020 2020 6172 6773              args
-0000dc50: 2e73 736c 5f74 7275 7374 7374 6f72 655f  .ssl_truststore_
-0000dc60: 6c6f 6361 7469 6f6e 203d 2073 736c 5f74  location = ssl_t
-0000dc70: 7275 7374 7374 6f72 655f 6c6f 6361 7469  ruststore_locati
-0000dc80: 6f6e 0a20 2020 2020 2020 2069 6620 7373  on.        if ss
-0000dc90: 6c5f 7472 7573 7473 746f 7265 5f70 6173  l_truststore_pas
-0000dca0: 7377 6f72 645f 7365 6372 6574 5f69 643a  sword_secret_id:
-0000dcb0: 0a20 2020 2020 2020 2020 2020 2061 7267  .            arg
-0000dcc0: 732e 7373 6c5f 7472 7573 7473 746f 7265  s.ssl_truststore
-0000dcd0: 5f70 6173 7377 6f72 645f 7365 6372 6574  _password_secret
-0000dce0: 5f69 6420 3d20 7373 6c5f 7472 7573 7473  _id = ssl_trusts
-0000dcf0: 746f 7265 5f70 6173 7377 6f72 645f 7365  tore_password_se
-0000dd00: 6372 6574 5f69 640a 2020 2020 2020 2020  cret_id.        
-0000dd10: 6966 2073 6563 7572 6974 795f 7072 6f74  if security_prot
-0000dd20: 6f63 6f6c 3a0a 2020 2020 2020 2020 2020  ocol:.          
-0000dd30: 2020 6172 6773 2e73 6563 7572 6974 795f    args.security_
-0000dd40: 7072 6f74 6f63 6f6c 203d 2073 6563 7572  protocol = secur
-0000dd50: 6974 795f 7072 6f74 6f63 6f6c 0a20 2020  ity_protocol.   
-0000dd60: 2020 2020 2069 6620 6465 6475 706c 6963       if deduplic
-0000dd70: 6174 696f 6e5f 636f 6c75 6d6e 733a 0a20  ation_columns:. 
-0000dd80: 2020 2020 2020 2020 2020 2066 6f72 2063             for c
-0000dd90: 6f6c 756d 6e5f 6e61 6d65 2069 6e20 6465  olumn_name in de
-0000dda0: 6475 706c 6963 6174 696f 6e5f 636f 6c75  duplication_colu
-0000ddb0: 6d6e 733a 0a20 2020 2020 2020 2020 2020  mns:.           
-0000ddc0: 2020 2020 2061 7267 732e 636f 6d6d 6f6e       args.common
-0000ddd0: 5f61 7267 732e 6465 6475 706c 6963 6174  _args.deduplicat
-0000dde0: 696f 6e5f 636f 6c75 6d6e 732e 6170 7065  ion_columns.appe
-0000ddf0: 6e64 2863 6f6c 756d 6e5f 6e61 6d65 290a  nd(column_name).
-0000de00: 0a20 2020 2020 2020 2073 656c 662e 706f  .        self.po
-0000de10: 7374 5f70 726f 6365 7373 6f72 203d 2070  st_processor = p
-0000de20: 6f73 745f 7072 6f63 6573 736f 720a 0a20  ost_processor.. 
-0000de30: 2020 2064 6566 205f 6d65 7267 655f 7374     def _merge_st
-0000de40: 7265 616d 5f61 7267 7328 7365 6c66 2c20  ream_args(self, 
-0000de50: 6461 7461 5f73 6f75 7263 655f 6172 6773  data_source_args
-0000de60: 3a20 7669 7274 7561 6c5f 6461 7461 5f73  : virtual_data_s
-0000de70: 6f75 7263 655f 7062 322e 5669 7274 7561  ource_pb2.Virtua
-0000de80: 6c44 6174 6153 6f75 7263 6541 7267 7329  lDataSourceArgs)
-0000de90: 3a0a 2020 2020 2020 2020 6461 7461 5f73  :.        data_s
-0000dea0: 6f75 7263 655f 6172 6773 2e6b 6166 6b61  ource_args.kafka
-0000deb0: 5f64 735f 636f 6e66 6967 2e43 6f70 7946  _ds_config.CopyF
-0000dec0: 726f 6d28 7365 6c66 2e5f 6172 6773 290a  rom(self._args).
-0000ded0: 0a0a 636c 6173 7320 4b69 6e65 7369 7343  ..class KinesisC
-0000dee0: 6f6e 6669 6728 4261 7365 5374 7265 616d  onfig(BaseStream
-0000def0: 436f 6e66 6967 293a 0a20 2020 2022 2222  Config):.    """
-0000df00: 0a20 2020 2043 6f6e 6669 6775 7261 7469  .    Configurati
-0000df10: 6f6e 2075 7365 6420 746f 2072 6566 6572  on used to refer
-0000df20: 656e 6365 2061 204b 696e 6573 6973 2073  ence a Kinesis s
-0000df30: 7472 6561 6d2e 0a0a 2020 2020 5468 6520  tream...    The 
-0000df40: 4b69 6e65 7369 7343 6f6e 6669 6720 636c  KinesisConfig cl
-0000df50: 6173 7320 6973 2075 7365 6420 746f 2063  ass is used to c
-0000df60: 7265 6174 6520 6120 7265 6665 7265 6e63  reate a referenc
-0000df70: 6520 746f 2061 6e20 4157 5320 4b69 6e65  e to an AWS Kine
-0000df80: 7369 7320 7374 7265 616d 2e0a 0a20 2020  sis stream...   
-0000df90: 2054 6869 7320 636c 6173 7320 6973 2075   This class is u
-0000dfa0: 7365 6420 6173 2061 6e20 696e 7075 7420  sed as an input 
-0000dfb0: 746f 2061 203a 636c 6173 733a 6053 7472  to a :class:`Str
-0000dfc0: 6561 6d53 6f75 7263 6560 2773 2070 6172  eamSource`'s par
-0000dfd0: 616d 6574 6572 2060 6073 7472 6561 6d5f  ameter ``stream_
-0000dfe0: 636f 6e66 6967 6060 2e20 4465 636c 6172  config``. Declar
-0000dff0: 696e 6720 7468 6973 2063 6f6e 6669 6775  ing this configu
-0000e000: 7261 7469 6f6e 0a20 2020 2063 6c61 7373  ration.    class
-0000e010: 2061 6c6f 6e65 2077 696c 6c20 6e6f 7420   alone will not 
-0000e020: 7265 6769 7374 6572 2061 2044 6174 6120  register a Data 
-0000e030: 536f 7572 6365 2e20 496e 7374 6561 642c  Source. Instead,
-0000e040: 2064 6563 6c61 7265 2061 7320 6120 7061   declare as a pa
-0000e050: 7274 206f 6620 6060 5374 7265 616d 536f  rt of ``StreamSo
-0000e060: 7572 6365 6060 2074 6861 7420 7461 6b65  urce`` that take
-0000e070: 7320 7468 6973 2063 6f6e 6669 6775 7261  s this configura
-0000e080: 7469 6f6e 0a20 2020 2063 6c61 7373 2069  tion.    class i
-0000e090: 6e73 7461 6e63 6520 6173 2061 2070 6172  nstance as a par
-0000e0a0: 616d 6574 6572 2e0a 2020 2020 2222 220a  ameter..    """.
-0000e0b0: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
-0000e0c0: 5f28 0a20 2020 2020 2020 2073 656c 662c  _(.        self,
-0000e0d0: 0a20 2020 2020 2020 2073 7472 6561 6d5f  .        stream_
-0000e0e0: 6e61 6d65 3a20 7374 722c 0a20 2020 2020  name: str,.     
-0000e0f0: 2020 2072 6567 696f 6e3a 2073 7472 2c0a     region: str,.
-0000e100: 2020 2020 2020 2020 706f 7374 5f70 726f          post_pro
-0000e110: 6365 7373 6f72 2c0a 2020 2020 2020 2020  cessor,.        
-0000e120: 7469 6d65 7374 616d 705f 6669 656c 643a  timestamp_field:
-0000e130: 2073 7472 2c0a 2020 2020 2020 2020 696e   str,.        in
-0000e140: 6974 6961 6c5f 7374 7265 616d 5f70 6f73  itial_stream_pos
-0000e150: 6974 696f 6e3a 2073 7472 2c0a 2020 2020  ition: str,.    
-0000e160: 2020 2020 7761 7465 726d 6172 6b5f 6465      watermark_de
-0000e170: 6c61 795f 7468 7265 7368 6f6c 643a 2064  lay_threshold: d
-0000e180: 6174 6574 696d 652e 7469 6d65 6465 6c74  atetime.timedelt
-0000e190: 6120 3d20 6461 7465 7469 6d65 2e74 696d  a = datetime.tim
-0000e1a0: 6564 656c 7461 2868 6f75 7273 3d32 3429  edelta(hours=24)
-0000e1b0: 2c0a 2020 2020 2020 2020 6465 6475 706c  ,.        dedupl
-0000e1c0: 6963 6174 696f 6e5f 636f 6c75 6d6e 733a  ication_columns:
-0000e1d0: 204f 7074 696f 6e61 6c5b 4c69 7374 5b73   Optional[List[s
-0000e1e0: 7472 5d5d 203d 204e 6f6e 652c 0a20 2020  tr]] = None,.   
-0000e1f0: 2020 2020 206f 7074 696f 6e73 3a20 4f70       options: Op
-0000e200: 7469 6f6e 616c 5b44 6963 745b 7374 722c  tional[Dict[str,
-0000e210: 2073 7472 5d5d 203d 204e 6f6e 652c 0a20   str]] = None,. 
-0000e220: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-0000e230: 220a 2020 2020 2020 2020 496e 7374 616e  ".        Instan
-0000e240: 7469 6174 6573 2061 206e 6577 204b 696e  tiates a new Kin
-0000e250: 6573 6973 436f 6e66 6967 2e0a 0a20 2020  esisConfig...   
-0000e260: 2020 2020 203a 7061 7261 6d20 7374 7265       :param stre
-0000e270: 616d 5f6e 616d 653a 204e 616d 6520 6f66  am_name: Name of
-0000e280: 2074 6865 204b 696e 6573 6973 2073 7472   the Kinesis str
-0000e290: 6561 6d2e 0a20 2020 2020 2020 203a 7061  eam..        :pa
-0000e2a0: 7261 6d20 7265 6769 6f6e 3a20 4157 5320  ram region: AWS 
-0000e2b0: 7265 6769 6f6e 206f 6620 7468 6520 7374  region of the st
-0000e2c0: 7265 616d 2c20 652e 673a 2022 7573 2d77  ream, e.g: "us-w
-0000e2d0: 6573 742d 3222 2e0a 2020 2020 2020 2020  est-2"..        
-0000e2e0: 3a70 6172 616d 2070 6f73 745f 7072 6f63  :param post_proc
-0000e2f0: 6573 736f 723a 2050 7974 686f 6e20 7573  essor: Python us
-0000e300: 6572 2064 6566 696e 6564 2066 756e 6374  er defined funct
-0000e310: 696f 6e20 6060 6628 4461 7461 4672 616d  ion ``f(DataFram
-0000e320: 6529 202d 3e20 4461 7461 4672 616d 6560  e) -> DataFrame`
-0000e330: 6020 7468 6174 2074 616b 6573 2069 6e20  ` that takes in 
-0000e340: 7261 770a 2020 2020 2020 2020 2020 2020  raw.            
-0000e350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e360: 2020 2020 2020 2020 2020 5079 7370 6172            Pyspar
-0000e370: 6b20 6461 7461 2073 6f75 7263 6520 4461  k data source Da
-0000e380: 7461 4672 616d 6520 616e 6420 7472 616e  taFrame and tran
-0000e390: 736c 6174 6573 2069 7420 746f 2074 6865  slates it to the
-0000e3a0: 2044 6174 6146 7261 6d65 2074 6f20 6265   DataFrame to be
-0000e3b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e3d0: 2020 2020 2020 2063 6f6e 7375 6d65 6420         consumed 
-0000e3e0: 6279 2074 6865 2046 6561 7475 7265 2056  by the Feature V
-0000e3f0: 6965 772e 2053 6565 2061 6e20 6578 616d  iew. See an exam
-0000e400: 706c 6520 6f66 0a20 2020 2020 2020 2020  ple of.         
-0000e410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e420: 2020 2020 2020 2020 2020 2020 2070 6f73               pos
-0000e430: 745f 7072 6f63 6573 736f 7220 696e 2074  t_processor in t
-0000e440: 6865 2060 5573 6572 2047 7569 6465 605f  he `User Guide`_
-0000e450: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000e460: 2074 696d 6573 7461 6d70 5f66 6965 6c64   timestamp_field
-0000e470: 3a20 4e61 6d65 206f 6620 7468 6520 636f  : Name of the co
-0000e480: 6c75 6d6e 2063 6f6e 7461 696e 696e 6720  lumn containing 
-0000e490: 7469 6d65 7374 616d 7020 666f 7220 7761  timestamp for wa
-0000e4a0: 7465 726d 6172 6b69 6e67 2e0a 2020 2020  termarking..    
-0000e4b0: 2020 2020 3a70 6172 616d 2069 6e69 7469      :param initi
-0000e4c0: 616c 5f73 7472 6561 6d5f 706f 7369 7469  al_stream_positi
-0000e4d0: 6f6e 3a20 496e 6974 6961 6c20 706f 7369  on: Initial posi
-0000e4e0: 7469 6f6e 2069 6e20 7374 7265 616d 2c20  tion in stream, 
-0000e4f0: 652e 673a 2022 6c61 7465 7374 2220 6f72  e.g: "latest" or
-0000e500: 2022 7472 696d 5f68 6f72 697a 6f6e 222e   "trim_horizon".
-0000e510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e540: 204d 6f72 6520 696e 666f 726d 6174 696f   More informatio
-0000e550: 6e20 6176 6169 6c61 626c 6520 696e 2060  n available in `
-0000e560: 5370 6172 6b20 4b69 6e65 7369 7320 446f  Spark Kinesis Do
-0000e570: 6375 6d65 6e74 6174 696f 6e60 5f2e 0a20  cumentation`_.. 
-0000e580: 2020 2020 2020 203a 7061 7261 6d20 7761         :param wa
-0000e590: 7465 726d 6172 6b5f 6465 6c61 795f 7468  termark_delay_th
-0000e5a0: 7265 7368 6f6c 643a 2028 4465 6661 756c  reshold: (Defaul
-0000e5b0: 743a 2032 3468 2920 5761 7465 726d 6172  t: 24h) Watermar
-0000e5c0: 6b20 7469 6d65 2069 6e74 6572 7661 6c2c  k time interval,
-0000e5d0: 2065 2e67 3a20 7469 6d65 6465 6c74 6128   e.g: timedelta(
-0000e5e0: 686f 7572 733d 3336 292c 2075 7365 6420  hours=36), used 
-0000e5f0: 6279 2053 7061 726b 2053 7472 7563 7475  by Spark Structu
-0000e600: 7265 6420 5374 7265 616d 696e 6720 746f  red Streaming to
-0000e610: 2061 6363 6f75 6e74 2066 6f72 206c 6174   account for lat
-0000e620: 652d 6172 7269 7669 6e67 2064 6174 612e  e-arriving data.
-0000e630: 2053 6565 3a20 6050 726f 6475 6374 696f   See: `Productio
-0000e640: 6e69 7a69 6e67 2061 2053 7472 6561 6d60  nizing a Stream`
-0000e650: 5f2e 0a20 2020 2020 2020 203a 7061 7261  _..        :para
-0000e660: 6d20 6465 6475 706c 6963 6174 696f 6e5f  m deduplication_
-0000e670: 636f 6c75 6d6e 733a 2043 6f6c 756d 6e73  columns: Columns
-0000e680: 2069 6e20 7468 6520 7374 7265 616d 2064   in the stream d
-0000e690: 6174 6120 7468 6174 2075 6e69 7175 656c  ata that uniquel
-0000e6a0: 7920 6964 656e 7469 6679 2064 6174 6120  y identify data 
-0000e6b0: 7265 636f 7264 732e 0a20 2020 2020 2020  records..       
-0000e6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e6e0: 2055 7365 6420 666f 7220 6465 2d64 7570   Used for de-dup
-0000e6f0: 6c69 6361 7469 6e67 2e0a 2020 2020 2020  licating..      
-0000e700: 2020 3a70 6172 616d 206f 7074 696f 6e73    :param options
-0000e710: 3a20 4120 6d61 7020 6f66 2061 6464 6974  : A map of addit
-0000e720: 696f 6e61 6c20 5370 6172 6b20 7265 6164  ional Spark read
-0000e730: 5374 7265 616d 206f 7074 696f 6e73 0a0a  Stream options..
-0000e740: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-0000e750: 2041 204b 696e 6573 6973 436f 6e66 6967   A KinesisConfig
-0000e760: 2063 6c61 7373 2069 6e73 7461 6e63 652e   class instance.
-0000e770: 0a0a 2020 2020 2020 2020 2e2e 205f 5573  ..        .. _Us
-0000e780: 6572 2047 7569 6465 3a20 6874 7470 733a  er Guide: https:
-0000e790: 2f2f 646f 6373 2e74 6563 746f 6e2e 6169  //docs.tecton.ai
-0000e7a0: 2f64 6f63 732f 6465 6669 6e69 6e67 2d66  /docs/defining-f
-0000e7b0: 6561 7475 7265 732f 6461 7461 2d73 6f75  eatures/data-sou
-0000e7c0: 7263 6573 2f63 7265 6174 696e 672d 616e  rces/creating-an
-0000e7d0: 642d 7465 7374 696e 672d 612d 7374 7265  d-testing-a-stre
-0000e7e0: 616d 696e 672d 6461 7461 2d73 6f75 7263  aming-data-sourc
-0000e7f0: 6523 7772 6974 652d 7468 652d 7374 7265  e#write-the-stre
-0000e800: 616d 2d6d 6573 7361 6765 2d70 6f73 742d  am-message-post-
-0000e810: 7072 6f63 6573 736f 722d 6675 6e63 7469  processor-functi
-0000e820: 6f6e 0a20 2020 2020 2020 202e 2e20 5f50  on.        .. _P
-0000e830: 726f 6475 6374 696f 6e69 7a69 6e67 2061  roductionizing a
-0000e840: 2053 7472 6561 6d3a 2068 7474 7073 3a2f   Stream: https:/
-0000e850: 2f64 6f63 732e 7465 6374 6f6e 2e61 692f  /docs.tecton.ai/
-0000e860: 646f 6373 2f64 6566 696e 696e 672d 6665  docs/defining-fe
-0000e870: 6174 7572 6573 2f66 6561 7475 7265 2d76  atures/feature-v
-0000e880: 6965 7773 2f73 7472 6561 6d2d 6665 6174  iews/stream-feat
-0000e890: 7572 652d 7669 6577 2370 726f 6475 6374  ure-view#product
-0000e8a0: 696f 6e69 7a69 6e67 2d61 2d73 7472 6561  ionizing-a-strea
-0000e8b0: 6d0a 2020 2020 2020 2020 2e2e 205f 5370  m.        .. _Sp
-0000e8c0: 6172 6b20 4b69 6e65 7369 7320 446f 6375  ark Kinesis Docu
-0000e8d0: 6d65 6e74 6174 696f 6e3a 2068 7474 7073  mentation: https
-0000e8e0: 3a2f 2f73 7061 726b 2e61 7061 6368 652e  ://spark.apache.
-0000e8f0: 6f72 672f 646f 6373 2f6c 6174 6573 742f  org/docs/latest/
-0000e900: 7374 7265 616d 696e 672d 6b69 6e65 7369  streaming-kinesi
-0000e910: 732d 696e 7465 6772 6174 696f 6e2e 6874  s-integration.ht
-0000e920: 6d6c 0a0a 2020 2020 2020 2020 4578 616d  ml..        Exam
-0000e930: 706c 6520 6f66 2061 204b 696e 6573 6973  ple of a Kinesis
-0000e940: 436f 6e66 6967 2064 6563 6c61 7261 7469  Config declarati
-0000e950: 6f6e 3a0a 0a20 2020 2020 2020 202e 2e20  on:..        .. 
-0000e960: 636f 6465 2d62 6c6f 636b 3a3a 2070 7974  code-block:: pyt
-0000e970: 686f 6e0a 0a20 2020 2020 2020 2020 2020  hon..           
-0000e980: 2069 6d70 6f72 7420 7079 7370 6172 6b0a   import pyspark.
-0000e990: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
-0000e9a0: 2074 6563 746f 6e20 696d 706f 7274 204b   tecton import K
-0000e9b0: 696e 6573 6973 436f 6e66 6967 0a0a 0a20  inesisConfig... 
-0000e9c0: 2020 2020 2020 2020 2020 2023 2044 6566             # Def
-0000e9d0: 696e 6520 6f75 7220 6465 7365 7269 616c  ine our deserial
-0000e9e0: 697a 6174 696f 6e20 7261 7720 7374 7265  ization raw stre
-0000e9f0: 616d 2074 7261 6e73 6c61 746f 720a 2020  am translator.  
-0000ea00: 2020 2020 2020 2020 2020 6465 6620 7261            def ra
-0000ea10: 775f 6461 7461 5f64 6573 6572 6961 6c69  w_data_deseriali
-0000ea20: 7a61 7469 6f6e 2864 663a 7079 7370 6172  zation(df:pyspar
-0000ea30: 6b2e 7371 6c2e 4461 7461 4672 616d 6529  k.sql.DataFrame)
-0000ea40: 202d 3e20 7079 7370 6172 6b2e 7371 6c2e   -> pyspark.sql.
-0000ea50: 4461 7461 4672 616d 653a 0a20 2020 2020  DataFrame:.     
-0000ea60: 2020 2020 2020 2020 2020 2066 726f 6d20             from 
-0000ea70: 7079 7370 6172 6b2e 7371 6c2e 6675 6e63  pyspark.sql.func
-0000ea80: 7469 6f6e 7320 696d 706f 7274 2063 6f6c  tions import col
-0000ea90: 2c20 6672 6f6d 5f6a 736f 6e2c 2066 726f  , from_json, fro
-0000eaa0: 6d5f 7574 635f 7469 6d65 7374 616d 700a  m_utc_timestamp.
-0000eab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eac0: 6672 6f6d 2070 7973 7061 726b 2e73 716c  from pyspark.sql
-0000ead0: 2e74 7970 6573 2069 6d70 6f72 7420 5374  .types import St
-0000eae0: 7275 6374 5479 7065 2c20 5374 7269 6e67  ructType, String
-0000eaf0: 5479 7065 0a0a 2020 2020 2020 2020 2020  Type..          
-0000eb00: 2020 2020 2020 7061 796c 6f61 645f 7363        payload_sc
-0000eb10: 6865 6d61 203d 2028 0a20 2020 2020 2020  hema = (.       
-0000eb20: 2020 2020 2020 2020 2020 2053 7472 7563             Struc
-0000eb30: 7454 7970 6528 290a 2020 2020 2020 2020  tType().        
-0000eb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eb50: 2e61 6464 2827 616d 6f75 6e74 272c 2053  .add('amount', S
-0000eb60: 7472 696e 6754 7970 6528 292c 2046 616c  tringType(), Fal
-0000eb70: 7365 290a 2020 2020 2020 2020 2020 2020  se).            
-0000eb80: 2020 2020 2020 2020 2020 2020 2e61 6464              .add
-0000eb90: 2827 6973 4672 6175 6427 2c20 5374 7269  ('isFraud', Stri
-0000eba0: 6e67 5479 7065 2829 2c20 4661 6c73 6529  ngType(), False)
-0000ebb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ebc0: 2020 2020 2020 2020 202e 6164 6428 2774           .add('t
-0000ebd0: 696d 6573 7461 6d70 272c 2053 7472 696e  imestamp', Strin
-0000ebe0: 6754 7970 6528 292c 2046 616c 7365 290a  gType(), False).
-0000ebf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ec00: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000ec10: 2020 2072 6574 7572 6e20 280a 2020 2020     return (.    
-0000ec20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ec30: 6466 2e73 656c 6563 7445 7870 7228 2763  df.selectExpr('c
-0000ec40: 6173 7420 2864 6174 6120 6173 2053 5452  ast (data as STR
-0000ec50: 494e 4729 206a 736f 6e44 6174 6127 290a  ING) jsonData').
+0000c7c0: 2020 5079 7370 6172 6b20 6461 7461 2073    Pyspark data s
+0000c7d0: 6f75 7263 6520 4461 7461 4672 616d 6520  ource DataFrame 
+0000c7e0: 616e 6420 7472 616e 736c 6174 6573 2069  and translates i
+0000c7f0: 7420 746f 2074 6865 2044 6174 6146 7261  t to the DataFra
+0000c800: 6d65 2074 6f20 6265 0a20 2020 2020 2020  me to be.       
+0000c810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c820: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000c830: 6f6e 7375 6d65 6420 6279 2074 6865 2046  onsumed by the F
+0000c840: 6561 7475 7265 2056 6965 772e 2053 6565  eature View. See
+0000c850: 2061 6e20 6578 616d 706c 6520 6f66 0a20   an example of. 
+0000c860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c880: 2020 2020 2070 6f73 745f 7072 6f63 6573       post_proces
+0000c890: 736f 7220 696e 2074 6865 2060 5573 6572  sor in the `User
+0000c8a0: 2047 7569 6465 605f 2e0a 2020 2020 2020   Guide`_..      
+0000c8b0: 2020 3a70 6172 616d 2074 696d 6573 7461    :param timesta
+0000c8c0: 6d70 5f66 6965 6c64 3a20 4e61 6d65 206f  mp_field: Name o
+0000c8d0: 6620 7468 6520 636f 6c75 6d6e 2063 6f6e  f the column con
+0000c8e0: 7461 696e 696e 6720 7469 6d65 7374 616d  taining timestam
+0000c8f0: 7020 666f 7220 7761 7465 726d 6172 6b69  p for watermarki
+0000c900: 6e67 2e0a 2020 2020 2020 2020 3a70 6172  ng..        :par
+0000c910: 616d 2077 6174 6572 6d61 726b 5f64 656c  am watermark_del
+0000c920: 6179 5f74 6872 6573 686f 6c64 3a20 2844  ay_threshold: (D
+0000c930: 6566 6175 6c74 3a20 3234 6829 2057 6174  efault: 24h) Wat
+0000c940: 6572 6d61 726b 2074 696d 6520 696e 7465  ermark time inte
+0000c950: 7276 616c 2c20 652e 673a 2074 696d 6564  rval, e.g: timed
+0000c960: 656c 7461 2868 6f75 7273 3d33 3629 2c20  elta(hours=36), 
+0000c970: 7573 6564 2062 7920 5370 6172 6b20 5374  used by Spark St
+0000c980: 7275 6374 7572 6564 2053 7472 6561 6d69  ructured Streami
+0000c990: 6e67 2074 6f20 6163 636f 756e 7420 666f  ng to account fo
+0000c9a0: 7220 6c61 7465 2d61 7272 6976 696e 6720  r late-arriving 
+0000c9b0: 6461 7461 2e20 5365 653a 2060 5072 6f64  data. See: `Prod
+0000c9c0: 7563 7469 6f6e 697a 696e 6720 6120 5374  uctionizing a St
+0000c9d0: 7265 616d 605f 2e0a 2020 2020 2020 2020  ream`_..        
+0000c9e0: 3a70 6172 616d 206f 7074 696f 6e73 3a20  :param options: 
+0000c9f0: 4120 6d61 7020 6f66 2061 6464 6974 696f  A map of additio
+0000ca00: 6e61 6c20 5370 6172 6b20 7265 6164 5374  nal Spark readSt
+0000ca10: 7265 616d 206f 7074 696f 6e73 0a20 2020  ream options.   
+0000ca20: 2020 2020 203a 7061 7261 6d20 7373 6c5f       :param ssl_
+0000ca30: 6b65 7973 746f 7265 5f6c 6f63 6174 696f  keystore_locatio
+0000ca40: 6e3a 2041 6e20 4442 4653 2028 4461 7461  n: An DBFS (Data
+0000ca50: 6272 6963 6b73 206f 6e6c 7929 206f 7220  bricks only) or 
+0000ca60: 5333 2055 5249 2074 6861 7420 706f 696e  S3 URI that poin
+0000ca70: 7473 2074 6f20 7468 6520 6b65 7973 746f  ts to the keysto
+0000ca80: 7265 2066 696c 6520 7468 6174 2073 686f  re file that sho
+0000ca90: 756c 6420 6265 2075 7365 6420 666f 7220  uld be used for 
+0000caa0: 5353 4c20 6272 6f6b 6572 732e 204e 6f74  SSL brokers. Not
+0000cab0: 6520 666f 7220 5333 2055 5249 732c 2074  e for S3 URIs, t
+0000cac0: 6869 7320 6d75 7374 2062 6520 636f 6e66  his must be conf
+0000cad0: 6967 7572 6564 2062 7920 796f 7572 2054  igured by your T
+0000cae0: 6563 746f 6e20 7265 7072 6573 656e 7461  ecton representa
+0000caf0: 7469 7665 2e0a 2020 2020 2020 2020 2020  tive..          
+0000cb00: 2020 4578 616d 706c 653a 2060 6073 333a    Example: ``s3:
+0000cb10: 2f2f 7465 6374 6f6e 2d3c 6465 706c 6f79  //tecton-<deploy
+0000cb20: 6d65 6e74 206e 616d 653e 2f6b 6166 6b61  ment name>/kafka
+0000cb30: 2d63 7265 6465 6e74 6961 6c73 2f6b 6166  -credentials/kaf
+0000cb40: 6b61 5f63 6c69 656e 745f 6b65 7973 746f  ka_client_keysto
+0000cb50: 7265 2e6a 6b73 6060 0a20 2020 2020 2020  re.jks``.       
+0000cb60: 2020 2020 2045 7861 6d70 6c65 3a20 6060       Example: ``
+0000cb70: 6462 6673 3a2f 6b61 666b 612d 6372 6564  dbfs:/kafka-cred
+0000cb80: 656e 7469 616c 732f 6b61 666b 615f 636c  entials/kafka_cl
+0000cb90: 6965 6e74 5f6b 6579 7374 6f72 652e 6a6b  ient_keystore.jk
+0000cba0: 7360 600a 2020 2020 2020 2020 3a70 6172  s``.        :par
+0000cbb0: 616d 2073 736c 5f6b 6579 7374 6f72 655f  am ssl_keystore_
+0000cbc0: 7061 7373 776f 7264 5f73 6563 7265 745f  password_secret_
+0000cbd0: 6964 3a20 5468 6520 636f 6e66 6967 206b  id: The config k
+0000cbe0: 6579 2066 6f72 2074 6865 2070 6173 7377  ey for the passw
+0000cbf0: 6f72 6420 666f 7220 7468 6520 4b65 7973  ord for the Keys
+0000cc00: 746f 7265 2e0a 2020 2020 2020 2020 2020  tore..          
+0000cc10: 2020 5368 6f75 6c64 2073 7461 7274 2077    Should start w
+0000cc20: 6974 6820 6060 5345 4352 4554 5f60 602c  ith ``SECRET_``,
+0000cc30: 2065 7861 6d70 6c65 3a20 6060 5345 4352   example: ``SECR
+0000cc40: 4554 5f4b 4146 4b41 5f50 524f 4455 4354  ET_KAFKA_PRODUCT
+0000cc50: 494f 4e60 602e 0a20 2020 2020 2020 203a  ION``..        :
+0000cc60: 7061 7261 6d20 7373 6c5f 7472 7573 7473  param ssl_trusts
+0000cc70: 746f 7265 5f6c 6f63 6174 696f 6e3a 2041  tore_location: A
+0000cc80: 6e20 4442 4653 2028 4461 7461 6272 6963  n DBFS (Databric
+0000cc90: 6b73 206f 6e6c 7929 206f 7220 5333 2055  ks only) or S3 U
+0000cca0: 5249 2074 6861 7420 706f 696e 7473 2074  RI that points t
+0000ccb0: 6f20 7468 6520 7472 7573 7473 746f 7265  o the truststore
+0000ccc0: 2066 696c 6520 7468 6174 2073 686f 756c   file that shoul
+0000ccd0: 6420 6265 2075 7365 6420 666f 7220 5353  d be used for SS
+0000cce0: 4c20 6272 6f6b 6572 732e 204e 6f74 6520  L brokers. Note 
+0000ccf0: 666f 7220 5333 2055 5249 732c 2074 6869  for S3 URIs, thi
+0000cd00: 7320 6d75 7374 2062 6520 636f 6e66 6967  s must be config
+0000cd10: 7572 6564 2062 7920 796f 7572 2054 6563  ured by your Tec
+0000cd20: 746f 6e20 7265 7072 6573 656e 7461 7469  ton representati
+0000cd30: 7665 2e20 4966 206e 6f74 2070 726f 7669  ve. If not provi
+0000cd40: 6465 642c 2074 6865 2064 6566 6175 6c74  ded, the default
+0000cd50: 2074 7275 7374 7374 6f72 6520 666f 7220   truststore for 
+0000cd60: 796f 7572 2063 6f6d 7075 7465 2070 726f  your compute pro
+0000cd70: 7669 6465 7220 7769 6c6c 2062 6520 7573  vider will be us
+0000cd80: 6564 2e20 4e6f 7465 2074 6861 7420 7468  ed. Note that th
+0000cd90: 6973 2069 7320 7265 7175 6972 6564 2066  is is required f
+0000cda0: 6f72 2041 5753 2d73 6967 6e65 6420 6b65  or AWS-signed ke
+0000cdb0: 7973 746f 7265 7320 6f6e 2044 6174 6162  ystores on Datab
+0000cdc0: 7269 636b 732e 0a20 2020 2020 2020 2020  ricks..         
+0000cdd0: 2020 2045 7861 6d70 6c65 3a20 6060 7333     Example: ``s3
+0000cde0: 3a2f 2f74 6563 746f 6e2d 3c64 6570 6c6f  ://tecton-<deplo
+0000cdf0: 796d 656e 7420 6e61 6d65 3e2f 6b61 666b  yment name>/kafk
+0000ce00: 612d 6372 6564 656e 7469 616c 732f 6b61  a-credentials/ka
+0000ce10: 666b 615f 636c 6965 6e74 5f74 7275 7374  fka_client_trust
+0000ce20: 7374 6f72 652e 6a6b 7360 600a 2020 2020  store.jks``.    
+0000ce30: 2020 2020 2020 2020 4578 616d 706c 653a          Example:
+0000ce40: 2060 6064 6266 733a 2f6b 6166 6b61 2d63   ``dbfs:/kafka-c
+0000ce50: 7265 6465 6e74 6961 6c73 2f6b 6166 6b61  redentials/kafka
+0000ce60: 5f63 6c69 656e 745f 7472 7573 7473 746f  _client_truststo
+0000ce70: 7265 2e6a 6b73 6060 0a20 2020 2020 2020  re.jks``.       
+0000ce80: 203a 7061 7261 6d20 7373 6c5f 7472 7573   :param ssl_trus
+0000ce90: 7473 746f 7265 5f70 6173 7377 6f72 645f  tstore_password_
+0000cea0: 7365 6372 6574 5f69 6420 284f 7074 696f  secret_id (Optio
+0000ceb0: 6e61 6c29 3a20 5468 6520 636f 6e66 6967  nal): The config
+0000cec0: 206b 6579 2066 6f72 2074 6865 2070 6173   key for the pas
+0000ced0: 7377 6f72 6420 666f 7220 7468 6520 5472  sword for the Tr
+0000cee0: 7573 7473 746f 7265 2e0a 2020 2020 2020  uststore..      
+0000cef0: 2020 2020 2020 5368 6f75 6c64 2073 7461        Should sta
+0000cf00: 7274 2077 6974 6820 6060 5345 4352 4554  rt with ``SECRET
+0000cf10: 5f60 602c 2065 7861 6d70 6c65 3a20 6060  _``, example: ``
+0000cf20: 5345 4352 4554 5f4b 4146 4b41 5f50 524f  SECRET_KAFKA_PRO
+0000cf30: 4455 4354 494f 4e60 602e 0a20 2020 2020  DUCTION``..     
+0000cf40: 2020 203a 7061 7261 6d20 7365 6375 7269     :param securi
+0000cf50: 7479 5f70 726f 746f 636f 6c3a 2053 6563  ty_protocol: Sec
+0000cf60: 7572 6974 7920 7072 6f74 6f63 6f6c 2070  urity protocol p
+0000cf70: 6173 7365 6420 746f 206b 6166 6b61 2e73  assed to kafka.s
+0000cf80: 6563 7572 6974 792e 7072 6f74 6f63 6f6c  ecurity.protocol
+0000cf90: 2e20 5365 6520 4b61 666b 6120 646f 6375  . See Kafka docu
+0000cfa0: 6d65 6e74 6174 696f 6e20 666f 7220 7661  mentation for va
+0000cfb0: 6c69 6420 7661 6c75 6573 2e0a 2020 2020  lid values..    
+0000cfc0: 2020 2020 3a70 6172 616d 2064 6564 7570      :param dedup
+0000cfd0: 6c69 6361 7469 6f6e 5f63 6f6c 756d 6e73  lication_columns
+0000cfe0: 3a20 436f 6c75 6d6e 7320 696e 2074 6865  : Columns in the
+0000cff0: 2073 7472 6561 6d20 6461 7461 2074 6861   stream data tha
+0000d000: 7420 756e 6971 7565 6c79 2069 6465 6e74  t uniquely ident
+0000d010: 6966 7920 6461 7461 2072 6563 6f72 6473  ify data records
+0000d020: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d040: 2020 2020 2020 2020 2020 5573 6564 2066            Used f
+0000d050: 6f72 2064 652d 6475 706c 6963 6174 696e  or de-duplicatin
+0000d060: 672e 2053 7061 726b 2077 696c 6c20 6472  g. Spark will dr
+0000d070: 6f70 2072 6f77 7320 6966 2074 6865 7265  op rows if there
+0000d080: 2061 7265 2064 7570 6c69 6361 7465 7320   are duplicates 
+0000d090: 696e 2074 6865 2064 6564 7570 6c69 6361  in the deduplica
+0000d0a0: 7469 6f6e 5f63 6f6c 756d 6e73 2c20 6275  tion_columns, bu
+0000d0b0: 7420 6f6e 6c79 2077 6974 6869 6e20 7468  t only within th
+0000d0c0: 6520 7761 7465 726d 6172 6b20 6465 6c61  e watermark dela
+0000d0d0: 7920 7769 6e64 6f77 2e0a 0a20 2020 2020  y window...     
+0000d0e0: 2020 203a 7265 7475 726e 3a20 4120 4b61     :return: A Ka
+0000d0f0: 666b 6143 6f6e 6669 6720 636c 6173 7320  fkaConfig class 
+0000d100: 696e 7374 616e 6365 2e0a 0a20 2020 2020  instance...     
+0000d110: 2020 202e 2e20 5f55 7365 7220 4775 6964     .. _User Guid
+0000d120: 653a 2068 7474 7073 3a2f 2f64 6f63 732e  e: https://docs.
+0000d130: 7465 6374 6f6e 2e61 692f 646f 6373 2f64  tecton.ai/docs/d
+0000d140: 6566 696e 696e 672d 6665 6174 7572 6573  efining-features
+0000d150: 2f64 6174 612d 736f 7572 6365 732f 6372  /data-sources/cr
+0000d160: 6561 7469 6e67 2d61 6e64 2d74 6573 7469  eating-and-testi
+0000d170: 6e67 2d61 2d73 7472 6561 6d69 6e67 2d64  ng-a-streaming-d
+0000d180: 6174 612d 736f 7572 6365 2377 7269 7465  ata-source#write
+0000d190: 2d74 6865 2d73 7472 6561 6d2d 6d65 7373  -the-stream-mess
+0000d1a0: 6167 652d 706f 7374 2d70 726f 6365 7373  age-post-process
+0000d1b0: 6f72 2d66 756e 6374 696f 6e0a 2020 2020  or-function.    
+0000d1c0: 2020 2020 2e2e 205f 5072 6f64 7563 7469      .. _Producti
+0000d1d0: 6f6e 697a 696e 6720 6120 5374 7265 616d  onizing a Stream
+0000d1e0: 3a20 6874 7470 733a 2f2f 646f 6373 2e74  : https://docs.t
+0000d1f0: 6563 746f 6e2e 6169 2f64 6f63 732f 6465  ecton.ai/docs/de
+0000d200: 6669 6e69 6e67 2d66 6561 7475 7265 732f  fining-features/
+0000d210: 6665 6174 7572 652d 7669 6577 732f 7374  feature-views/st
+0000d220: 7265 616d 2d66 6561 7475 7265 2d76 6965  ream-feature-vie
+0000d230: 7723 7072 6f64 7563 7469 6f6e 697a 696e  w#productionizin
+0000d240: 672d 612d 7374 7265 616d 0a0a 2020 2020  g-a-stream..    
+0000d250: 2020 2020 4578 616d 706c 6520 6f66 2061      Example of a
+0000d260: 204b 6166 6b61 436f 6e66 6967 2064 6563   KafkaConfig dec
+0000d270: 6c61 7261 7469 6f6e 3a0a 0a20 2020 2020  laration:..     
+0000d280: 2020 202e 2e20 636f 6465 2d62 6c6f 636b     .. code-block
+0000d290: 3a3a 2070 7974 686f 6e0a 0a20 2020 2020  :: python..     
+0000d2a0: 2020 2020 2020 2069 6d70 6f72 7420 6461         import da
+0000d2b0: 7465 7469 6d65 0a20 2020 2020 2020 2020  tetime.         
+0000d2c0: 2020 2069 6d70 6f72 7420 7079 7370 6172     import pyspar
+0000d2d0: 6b0a 2020 2020 2020 2020 2020 2020 6672  k.            fr
+0000d2e0: 6f6d 2074 6563 746f 6e20 696d 706f 7274  om tecton import
+0000d2f0: 204b 6166 6b61 436f 6e66 6967 0a0a 0a20   KafkaConfig... 
+0000d300: 2020 2020 2020 2020 2020 2064 6566 2072             def r
+0000d310: 6177 5f64 6174 615f 6465 7365 7269 616c  aw_data_deserial
+0000d320: 697a 6174 696f 6e28 6466 3a70 7973 7061  ization(df:pyspa
+0000d330: 726b 2e73 716c 2e44 6174 6146 7261 6d65  rk.sql.DataFrame
+0000d340: 2920 2d3e 2070 7973 7061 726b 2e73 716c  ) -> pyspark.sql
+0000d350: 2e44 6174 6146 7261 6d65 3a0a 2020 2020  .DataFrame:.    
+0000d360: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
+0000d370: 2070 7973 7061 726b 2e73 716c 2e66 756e   pyspark.sql.fun
+0000d380: 6374 696f 6e73 2069 6d70 6f72 7420 6672  ctions import fr
+0000d390: 6f6d 5f6a 736f 6e2c 2063 6f6c 0a20 2020  om_json, col.   
+0000d3a0: 2020 2020 2020 2020 2020 2020 2066 726f               fro
+0000d3b0: 6d20 7079 7370 6172 6b2e 7371 6c2e 7479  m pyspark.sql.ty
+0000d3c0: 7065 7320 696d 706f 7274 2053 7472 696e  pes import Strin
+0000d3d0: 6754 7970 652c 2054 696d 6573 7461 6d70  gType, Timestamp
+0000d3e0: 5479 7065 0a0a 2020 2020 2020 2020 2020  Type..          
+0000d3f0: 2020 2020 2020 5041 594c 4f41 445f 5343        PAYLOAD_SC
+0000d400: 4845 4d41 203d 2028 0a20 2020 2020 2020  HEMA = (.       
+0000d410: 2020 2020 2020 2020 2020 2053 7472 7563             Struc
+0000d420: 7454 7970 6528 290a 2020 2020 2020 2020  tType().        
+0000d430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d440: 2e61 6464 2822 6163 636f 756e 7449 6422  .add("accountId"
+0000d450: 2c20 5374 7269 6e67 5479 7065 2829 2c20  , StringType(), 
+0000d460: 4661 6c73 6529 0a20 2020 2020 2020 2020  False).         
+0000d470: 2020 2020 2020 2020 2020 2020 2020 202e                 .
+0000d480: 6164 6428 2274 7261 6e73 6163 7469 6f6e  add("transaction
+0000d490: 5f69 6422 2c20 5374 7269 6e67 5479 7065  _id", StringType
+0000d4a0: 2829 2c20 4661 6c73 6529 0a20 2020 2020  (), False).     
+0000d4b0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0000d4c0: 2020 2020 2020 2020 2020 2020 2020 4556                EV
+0000d4d0: 454e 545f 454e 5645 4c4f 5045 5f53 4348  ENT_ENVELOPE_SCH
+0000d4e0: 454d 4120 3d20 280a 2020 2020 2020 2020  EMA = (.        
+0000d4f0: 2020 2020 2020 2020 2020 5374 7275 6374            Struct
+0000d500: 5479 7065 2829 0a20 2020 2020 2020 2020  Type().         
+0000d510: 2020 2020 2020 2020 2020 2020 2020 202e                 .
+0000d520: 6164 6428 2274 696d 6573 7461 6d70 222c  add("timestamp",
+0000d530: 2054 696d 6573 7461 6d70 5479 7065 2829   TimestampType()
+0000d540: 2c20 4661 6c73 6529 0a20 2020 2020 2020  , False).       
+0000d550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d560: 202e 6164 6428 2270 6179 6c6f 6164 222c   .add("payload",
+0000d570: 2050 4159 4c4f 4144 5f53 4348 454d 412c   PAYLOAD_SCHEMA,
+0000d580: 2046 616c 7365 290a 2020 2020 2020 2020   False).        
+0000d590: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+0000d5a0: 2020 2020 2020 2020 2020 2076 616c 7565             value
+0000d5b0: 203d 2063 6f6c 2822 7661 6c75 6522 292e   = col("value").
+0000d5c0: 6361 7374 2822 7374 7269 6e67 2229 0a20  cast("string"). 
+0000d5d0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0000d5e0: 6620 3d20 6466 2e77 6974 6843 6f6c 756d  f = df.withColum
+0000d5f0: 6e28 2265 7665 6e74 222c 2066 726f 6d5f  n("event", from_
+0000d600: 6a73 6f6e 2876 616c 7565 2c20 4556 454e  json(value, EVEN
+0000d610: 545f 454e 5645 4c4f 5045 5f53 4348 454d  T_ENVELOPE_SCHEM
+0000d620: 4129 290a 2020 2020 2020 2020 2020 2020  A)).            
+0000d630: 2020 2020 6466 203d 2064 662e 7769 7468      df = df.with
+0000d640: 436f 6c75 6d6e 2822 6163 636f 756e 7449  Column("accountI
+0000d650: 6422 2c20 636f 6c28 2265 7665 6e74 2e70  d", col("event.p
+0000d660: 6179 6c6f 6164 2e61 6363 6f75 6e74 4964  ayload.accountId
+0000d670: 2229 290a 2020 2020 2020 2020 2020 2020  ")).            
+0000d680: 2020 2020 6466 203d 2064 662e 7769 7468      df = df.with
+0000d690: 436f 6c75 6d6e 2822 7472 616e 7361 6374  Column("transact
+0000d6a0: 696f 6e5f 6964 222c 2063 6f6c 2822 6576  ion_id", col("ev
+0000d6b0: 656e 742e 7061 796c 6f61 642e 7472 616e  ent.payload.tran
+0000d6c0: 7361 6374 696f 6e5f 6964 2229 290a 2020  saction_id")).  
+0000d6d0: 2020 2020 2020 2020 2020 2020 2020 6466                df
+0000d6e0: 203d 2064 662e 7769 7468 436f 6c75 6d6e   = df.withColumn
+0000d6f0: 2822 7469 6d65 7374 616d 7022 2c20 636f  ("timestamp", co
+0000d700: 6c28 2265 7665 6e74 2e74 696d 6573 7461  l("event.timesta
+0000d710: 6d70 2229 290a 0a20 2020 2020 2020 2020  mp"))..         
+0000d720: 2020 2020 2020 2072 6574 7572 6e20 6466         return df
+0000d730: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+0000d740: 4465 636c 6172 6520 4b61 666b 6120 436f  Declare Kafka Co
+0000d750: 6e66 6967 2069 6e73 7461 6e63 6520 6f62  nfig instance ob
+0000d760: 6a65 6374 2074 6861 7420 6361 6e20 6265  ject that can be
+0000d770: 2075 7365 6420 6173 2061 6e20 6172 6775   used as an argu
+0000d780: 6d65 6e74 2069 6e20 5374 7265 616d 536f  ment in StreamSo
+0000d790: 7572 6365 0a20 2020 2020 2020 2020 2020  urce.           
+0000d7a0: 2063 6c69 636b 5f73 7472 6561 6d5f 6b61   click_stream_ka
+0000d7b0: 666b 615f 6473 203d 204b 6166 6b61 436f  fka_ds = KafkaCo
+0000d7c0: 6e66 6967 280a 2020 2020 2020 2020 2020  nfig(.          
+0000d7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d7e0: 2020 2020 2020 2020 2020 2020 2020 6b61                ka
+0000d7f0: 666b 615f 626f 6f74 7374 7261 705f 7365  fka_bootstrap_se
+0000d800: 7276 6572 733d 2231 3237 2e30 2e30 2e31  rvers="127.0.0.1
+0000d810: 3a31 3233 3435 222c 0a20 2020 2020 2020  :12345",.       
+0000d820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d840: 2074 6f70 6963 733d 2263 6c69 636b 2d65   topics="click-e
+0000d850: 7665 6e74 732d 6a73 6f6e 222c 0a20 2020  vents-json",.   
+0000d860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d880: 2020 2020 2074 696d 6573 7461 6d70 5f66       timestamp_f
+0000d890: 6965 6c64 3d22 636c 6963 6b5f 6576 656e  ield="click_even
+0000d8a0: 745f 7469 6d65 7374 616d 7022 2c0a 2020  t_timestamp",.  
+0000d8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d8d0: 2020 2020 2020 706f 7374 5f70 726f 6365        post_proce
+0000d8e0: 7373 6f72 3d72 6177 5f64 6174 615f 6465  ssor=raw_data_de
+0000d8f0: 7365 7269 616c 697a 6174 696f 6e29 0a20  serialization). 
+0000d900: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000d910: 2020 2073 656c 662e 5f61 7267 7320 3d20     self._args = 
+0000d920: 6172 6773 203d 2064 6174 615f 736f 7572  args = data_sour
+0000d930: 6365 5f70 6232 2e4b 6166 6b61 4461 7461  ce_pb2.KafkaData
+0000d940: 536f 7572 6365 4172 6773 2829 0a20 2020  SourceArgs().   
+0000d950: 2020 2020 2061 7267 732e 6b61 666b 615f       args.kafka_
+0000d960: 626f 6f74 7374 7261 705f 7365 7276 6572  bootstrap_server
+0000d970: 7320 3d20 6b61 666b 615f 626f 6f74 7374  s = kafka_bootst
+0000d980: 7261 705f 7365 7276 6572 730a 2020 2020  rap_servers.    
+0000d990: 2020 2020 6172 6773 2e74 6f70 6963 7320      args.topics 
+0000d9a0: 3d20 746f 7069 6373 0a20 2020 2020 2020  = topics.       
+0000d9b0: 2069 6620 6675 6e63 7469 6f6e 5f73 6572   if function_ser
+0000d9c0: 6961 6c69 7a61 7469 6f6e 2e73 686f 756c  ialization.shoul
+0000d9d0: 645f 7365 7269 616c 697a 655f 6675 6e63  d_serialize_func
+0000d9e0: 7469 6f6e 2870 6f73 745f 7072 6f63 6573  tion(post_proces
+0000d9f0: 736f 7229 3a0a 2020 2020 2020 2020 2020  sor):.          
+0000da00: 2020 6172 6773 2e63 6f6d 6d6f 6e5f 6172    args.common_ar
+0000da10: 6773 2e70 6f73 745f 7072 6f63 6573 736f  gs.post_processo
+0000da20: 722e 436f 7079 4672 6f6d 2866 756e 6374  r.CopyFrom(funct
+0000da30: 696f 6e5f 7365 7269 616c 697a 6174 696f  ion_serializatio
+0000da40: 6e2e 746f 5f70 726f 746f 2870 6f73 745f  n.to_proto(post_
+0000da50: 7072 6f63 6573 736f 7229 290a 2020 2020  processor)).    
+0000da60: 2020 2020 6172 6773 2e63 6f6d 6d6f 6e5f      args.common_
+0000da70: 6172 6773 2e74 696d 6573 7461 6d70 5f66  args.timestamp_f
+0000da80: 6965 6c64 203d 2074 696d 6573 7461 6d70  ield = timestamp
+0000da90: 5f66 6965 6c64 0a20 2020 2020 2020 2069  _field.        i
+0000daa0: 6620 7761 7465 726d 6172 6b5f 6465 6c61  f watermark_dela
+0000dab0: 795f 7468 7265 7368 6f6c 643a 0a20 2020  y_threshold:.   
+0000dac0: 2020 2020 2020 2020 2061 7267 732e 636f           args.co
+0000dad0: 6d6d 6f6e 5f61 7267 732e 7761 7465 726d  mmon_args.waterm
+0000dae0: 6172 6b5f 6465 6c61 795f 7468 7265 7368  ark_delay_thresh
+0000daf0: 6f6c 642e 4672 6f6d 5469 6d65 6465 6c74  old.FromTimedelt
+0000db00: 6128 7761 7465 726d 6172 6b5f 6465 6c61  a(watermark_dela
+0000db10: 795f 7468 7265 7368 6f6c 6429 0a20 2020  y_threshold).   
+0000db20: 2020 2020 2066 6f72 206b 6579 2069 6e20       for key in 
+0000db30: 736f 7274 6564 2828 6f70 7469 6f6e 7320  sorted((options 
+0000db40: 6f72 207b 7d29 2e6b 6579 7328 2929 3a0a  or {}).keys()):.
+0000db50: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
+0000db60: 6f6e 203d 2064 6174 615f 736f 7572 6365  on = data_source
+0000db70: 5f70 6232 2e4f 7074 696f 6e28 290a 2020  _pb2.Option().  
+0000db80: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
+0000db90: 2e6b 6579 203d 206b 6579 0a20 2020 2020  .key = key.     
+0000dba0: 2020 2020 2020 206f 7074 696f 6e2e 7661         option.va
+0000dbb0: 6c75 6520 3d20 6f70 7469 6f6e 735b 6b65  lue = options[ke
+0000dbc0: 795d 0a20 2020 2020 2020 2020 2020 2061  y].            a
+0000dbd0: 7267 732e 6f70 7469 6f6e 732e 6170 7065  rgs.options.appe
+0000dbe0: 6e64 286f 7074 696f 6e29 0a20 2020 2020  nd(option).     
+0000dbf0: 2020 2069 6620 7373 6c5f 6b65 7973 746f     if ssl_keysto
+0000dc00: 7265 5f6c 6f63 6174 696f 6e3a 0a20 2020  re_location:.   
+0000dc10: 2020 2020 2020 2020 2061 7267 732e 7373           args.ss
+0000dc20: 6c5f 6b65 7973 746f 7265 5f6c 6f63 6174  l_keystore_locat
+0000dc30: 696f 6e20 3d20 7373 6c5f 6b65 7973 746f  ion = ssl_keysto
+0000dc40: 7265 5f6c 6f63 6174 696f 6e0a 2020 2020  re_location.    
+0000dc50: 2020 2020 6966 2073 736c 5f6b 6579 7374      if ssl_keyst
+0000dc60: 6f72 655f 7061 7373 776f 7264 5f73 6563  ore_password_sec
+0000dc70: 7265 745f 6964 3a0a 2020 2020 2020 2020  ret_id:.        
+0000dc80: 2020 2020 6172 6773 2e73 736c 5f6b 6579      args.ssl_key
+0000dc90: 7374 6f72 655f 7061 7373 776f 7264 5f73  store_password_s
+0000dca0: 6563 7265 745f 6964 203d 2073 736c 5f6b  ecret_id = ssl_k
+0000dcb0: 6579 7374 6f72 655f 7061 7373 776f 7264  eystore_password
+0000dcc0: 5f73 6563 7265 745f 6964 0a20 2020 2020  _secret_id.     
+0000dcd0: 2020 2069 6620 7373 6c5f 7472 7573 7473     if ssl_trusts
+0000dce0: 746f 7265 5f6c 6f63 6174 696f 6e3a 0a20  tore_location:. 
+0000dcf0: 2020 2020 2020 2020 2020 2061 7267 732e             args.
+0000dd00: 7373 6c5f 7472 7573 7473 746f 7265 5f6c  ssl_truststore_l
+0000dd10: 6f63 6174 696f 6e20 3d20 7373 6c5f 7472  ocation = ssl_tr
+0000dd20: 7573 7473 746f 7265 5f6c 6f63 6174 696f  uststore_locatio
+0000dd30: 6e0a 2020 2020 2020 2020 6966 2073 736c  n.        if ssl
+0000dd40: 5f74 7275 7374 7374 6f72 655f 7061 7373  _truststore_pass
+0000dd50: 776f 7264 5f73 6563 7265 745f 6964 3a0a  word_secret_id:.
+0000dd60: 2020 2020 2020 2020 2020 2020 6172 6773              args
+0000dd70: 2e73 736c 5f74 7275 7374 7374 6f72 655f  .ssl_truststore_
+0000dd80: 7061 7373 776f 7264 5f73 6563 7265 745f  password_secret_
+0000dd90: 6964 203d 2073 736c 5f74 7275 7374 7374  id = ssl_trustst
+0000dda0: 6f72 655f 7061 7373 776f 7264 5f73 6563  ore_password_sec
+0000ddb0: 7265 745f 6964 0a20 2020 2020 2020 2069  ret_id.        i
+0000ddc0: 6620 7365 6375 7269 7479 5f70 726f 746f  f security_proto
+0000ddd0: 636f 6c3a 0a20 2020 2020 2020 2020 2020  col:.           
+0000dde0: 2061 7267 732e 7365 6375 7269 7479 5f70   args.security_p
+0000ddf0: 726f 746f 636f 6c20 3d20 7365 6375 7269  rotocol = securi
+0000de00: 7479 5f70 726f 746f 636f 6c0a 2020 2020  ty_protocol.    
+0000de10: 2020 2020 6966 2064 6564 7570 6c69 6361      if deduplica
+0000de20: 7469 6f6e 5f63 6f6c 756d 6e73 3a0a 2020  tion_columns:.  
+0000de30: 2020 2020 2020 2020 2020 666f 7220 636f            for co
+0000de40: 6c75 6d6e 5f6e 616d 6520 696e 2064 6564  lumn_name in ded
+0000de50: 7570 6c69 6361 7469 6f6e 5f63 6f6c 756d  uplication_colum
+0000de60: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+0000de70: 2020 2020 6172 6773 2e63 6f6d 6d6f 6e5f      args.common_
+0000de80: 6172 6773 2e64 6564 7570 6c69 6361 7469  args.deduplicati
+0000de90: 6f6e 5f63 6f6c 756d 6e73 2e61 7070 656e  on_columns.appen
+0000dea0: 6428 636f 6c75 6d6e 5f6e 616d 6529 0a0a  d(column_name)..
+0000deb0: 2020 2020 2020 2020 7365 6c66 2e70 6f73          self.pos
+0000dec0: 745f 7072 6f63 6573 736f 7220 3d20 706f  t_processor = po
+0000ded0: 7374 5f70 726f 6365 7373 6f72 0a0a 2020  st_processor..  
+0000dee0: 2020 6465 6620 5f6d 6572 6765 5f73 7472    def _merge_str
+0000def0: 6561 6d5f 6172 6773 2873 656c 662c 2064  eam_args(self, d
+0000df00: 6174 615f 736f 7572 6365 5f61 7267 733a  ata_source_args:
+0000df10: 2076 6972 7475 616c 5f64 6174 615f 736f   virtual_data_so
+0000df20: 7572 6365 5f70 6232 2e56 6972 7475 616c  urce_pb2.Virtual
+0000df30: 4461 7461 536f 7572 6365 4172 6773 293a  DataSourceArgs):
+0000df40: 0a20 2020 2020 2020 2064 6174 615f 736f  .        data_so
+0000df50: 7572 6365 5f61 7267 732e 6b61 666b 615f  urce_args.kafka_
+0000df60: 6473 5f63 6f6e 6669 672e 436f 7079 4672  ds_config.CopyFr
+0000df70: 6f6d 2873 656c 662e 5f61 7267 7329 0a0a  om(self._args)..
+0000df80: 0a63 6c61 7373 204b 696e 6573 6973 436f  .class KinesisCo
+0000df90: 6e66 6967 2842 6173 6553 7472 6561 6d43  nfig(BaseStreamC
+0000dfa0: 6f6e 6669 6729 3a0a 2020 2020 2222 220a  onfig):.    """.
+0000dfb0: 2020 2020 436f 6e66 6967 7572 6174 696f      Configuratio
+0000dfc0: 6e20 7573 6564 2074 6f20 7265 6665 7265  n used to refere
+0000dfd0: 6e63 6520 6120 4b69 6e65 7369 7320 7374  nce a Kinesis st
+0000dfe0: 7265 616d 2e0a 0a20 2020 2054 6865 204b  ream...    The K
+0000dff0: 696e 6573 6973 436f 6e66 6967 2063 6c61  inesisConfig cla
+0000e000: 7373 2069 7320 7573 6564 2074 6f20 6372  ss is used to cr
+0000e010: 6561 7465 2061 2072 6566 6572 656e 6365  eate a reference
+0000e020: 2074 6f20 616e 2041 5753 204b 696e 6573   to an AWS Kines
+0000e030: 6973 2073 7472 6561 6d2e 0a0a 2020 2020  is stream...    
+0000e040: 5468 6973 2063 6c61 7373 2069 7320 7573  This class is us
+0000e050: 6564 2061 7320 616e 2069 6e70 7574 2074  ed as an input t
+0000e060: 6f20 6120 3a63 6c61 7373 3a60 5374 7265  o a :class:`Stre
+0000e070: 616d 536f 7572 6365 6027 7320 7061 7261  amSource`'s para
+0000e080: 6d65 7465 7220 6060 7374 7265 616d 5f63  meter ``stream_c
+0000e090: 6f6e 6669 6760 602e 2044 6563 6c61 7269  onfig``. Declari
+0000e0a0: 6e67 2074 6869 7320 636f 6e66 6967 7572  ng this configur
+0000e0b0: 6174 696f 6e0a 2020 2020 636c 6173 7320  ation.    class 
+0000e0c0: 616c 6f6e 6520 7769 6c6c 206e 6f74 2072  alone will not r
+0000e0d0: 6567 6973 7465 7220 6120 4461 7461 2053  egister a Data S
+0000e0e0: 6f75 7263 652e 2049 6e73 7465 6164 2c20  ource. Instead, 
+0000e0f0: 6465 636c 6172 6520 6173 2061 2070 6172  declare as a par
+0000e100: 7420 6f66 2060 6053 7472 6561 6d53 6f75  t of ``StreamSou
+0000e110: 7263 6560 6020 7468 6174 2074 616b 6573  rce`` that takes
+0000e120: 2074 6869 7320 636f 6e66 6967 7572 6174   this configurat
+0000e130: 696f 6e0a 2020 2020 636c 6173 7320 696e  ion.    class in
+0000e140: 7374 616e 6365 2061 7320 6120 7061 7261  stance as a para
+0000e150: 6d65 7465 722e 0a20 2020 2022 2222 0a0a  meter..    """..
+0000e160: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+0000e170: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0000e180: 2020 2020 2020 2020 7374 7265 616d 5f6e          stream_n
+0000e190: 616d 653a 2073 7472 2c0a 2020 2020 2020  ame: str,.      
+0000e1a0: 2020 7265 6769 6f6e 3a20 7374 722c 0a20    region: str,. 
+0000e1b0: 2020 2020 2020 2070 6f73 745f 7072 6f63         post_proc
+0000e1c0: 6573 736f 722c 0a20 2020 2020 2020 2074  essor,.        t
+0000e1d0: 696d 6573 7461 6d70 5f66 6965 6c64 3a20  imestamp_field: 
+0000e1e0: 7374 722c 0a20 2020 2020 2020 2069 6e69  str,.        ini
+0000e1f0: 7469 616c 5f73 7472 6561 6d5f 706f 7369  tial_stream_posi
+0000e200: 7469 6f6e 3a20 7374 722c 0a20 2020 2020  tion: str,.     
+0000e210: 2020 2077 6174 6572 6d61 726b 5f64 656c     watermark_del
+0000e220: 6179 5f74 6872 6573 686f 6c64 3a20 6461  ay_threshold: da
+0000e230: 7465 7469 6d65 2e74 696d 6564 656c 7461  tetime.timedelta
+0000e240: 203d 2064 6174 6574 696d 652e 7469 6d65   = datetime.time
+0000e250: 6465 6c74 6128 686f 7572 733d 3234 292c  delta(hours=24),
+0000e260: 0a20 2020 2020 2020 2064 6564 7570 6c69  .        dedupli
+0000e270: 6361 7469 6f6e 5f63 6f6c 756d 6e73 3a20  cation_columns: 
+0000e280: 4f70 7469 6f6e 616c 5b4c 6973 745b 7374  Optional[List[st
+0000e290: 725d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  r]] = None,.    
+0000e2a0: 2020 2020 6f70 7469 6f6e 733a 204f 7074      options: Opt
+0000e2b0: 696f 6e61 6c5b 4469 6374 5b73 7472 2c20  ional[Dict[str, 
+0000e2c0: 7374 725d 5d20 3d20 4e6f 6e65 2c0a 2020  str]] = None,.  
+0000e2d0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+0000e2e0: 0a20 2020 2020 2020 2049 6e73 7461 6e74  .        Instant
+0000e2f0: 6961 7465 7320 6120 6e65 7720 4b69 6e65  iates a new Kine
+0000e300: 7369 7343 6f6e 6669 672e 0a0a 2020 2020  sisConfig...    
+0000e310: 2020 2020 3a70 6172 616d 2073 7472 6561      :param strea
+0000e320: 6d5f 6e61 6d65 3a20 4e61 6d65 206f 6620  m_name: Name of 
+0000e330: 7468 6520 4b69 6e65 7369 7320 7374 7265  the Kinesis stre
+0000e340: 616d 2e0a 2020 2020 2020 2020 3a70 6172  am..        :par
+0000e350: 616d 2072 6567 696f 6e3a 2041 5753 2072  am region: AWS r
+0000e360: 6567 696f 6e20 6f66 2074 6865 2073 7472  egion of the str
+0000e370: 6561 6d2c 2065 2e67 3a20 2275 732d 7765  eam, e.g: "us-we
+0000e380: 7374 2d32 222e 0a20 2020 2020 2020 203a  st-2"..        :
+0000e390: 7061 7261 6d20 706f 7374 5f70 726f 6365  param post_proce
+0000e3a0: 7373 6f72 3a20 5079 7468 6f6e 2075 7365  ssor: Python use
+0000e3b0: 7220 6465 6669 6e65 6420 6675 6e63 7469  r defined functi
+0000e3c0: 6f6e 2060 6066 2844 6174 6146 7261 6d65  on ``f(DataFrame
+0000e3d0: 2920 2d3e 2044 6174 6146 7261 6d65 6060  ) -> DataFrame``
+0000e3e0: 2074 6861 7420 7461 6b65 7320 696e 2072   that takes in r
+0000e3f0: 6177 0a20 2020 2020 2020 2020 2020 2020  aw.             
+0000e400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e410: 2020 2020 2020 2020 2050 7973 7061 726b           Pyspark
+0000e420: 2064 6174 6120 736f 7572 6365 2044 6174   data source Dat
+0000e430: 6146 7261 6d65 2061 6e64 2074 7261 6e73  aFrame and trans
+0000e440: 6c61 7465 7320 6974 2074 6f20 7468 6520  lates it to the 
+0000e450: 4461 7461 4672 616d 6520 746f 2062 650a  DataFrame to be.
+0000e460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e480: 2020 2020 2020 636f 6e73 756d 6564 2062        consumed b
+0000e490: 7920 7468 6520 4665 6174 7572 6520 5669  y the Feature Vi
+0000e4a0: 6577 2e20 5365 6520 616e 2065 7861 6d70  ew. See an examp
+0000e4b0: 6c65 206f 660a 2020 2020 2020 2020 2020  le of.          
+0000e4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e4d0: 2020 2020 2020 2020 2020 2020 706f 7374              post
+0000e4e0: 5f70 726f 6365 7373 6f72 2069 6e20 7468  _processor in th
+0000e4f0: 6520 6055 7365 7220 4775 6964 6560 5f2e  e `User Guide`_.
+0000e500: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000e510: 7469 6d65 7374 616d 705f 6669 656c 643a  timestamp_field:
+0000e520: 204e 616d 6520 6f66 2074 6865 2063 6f6c   Name of the col
+0000e530: 756d 6e20 636f 6e74 6169 6e69 6e67 2074  umn containing t
+0000e540: 696d 6573 7461 6d70 2066 6f72 2077 6174  imestamp for wat
+0000e550: 6572 6d61 726b 696e 672e 0a20 2020 2020  ermarking..     
+0000e560: 2020 203a 7061 7261 6d20 696e 6974 6961     :param initia
+0000e570: 6c5f 7374 7265 616d 5f70 6f73 6974 696f  l_stream_positio
+0000e580: 6e3a 2049 6e69 7469 616c 2070 6f73 6974  n: Initial posit
+0000e590: 696f 6e20 696e 2073 7472 6561 6d2c 2065  ion in stream, e
+0000e5a0: 2e67 3a20 226c 6174 6573 7422 206f 7220  .g: "latest" or 
+0000e5b0: 2274 7269 6d5f 686f 7269 7a6f 6e22 2e0a  "trim_horizon"..
+0000e5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e5f0: 4d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  More information
+0000e600: 2061 7661 696c 6162 6c65 2069 6e20 6053   available in `S
+0000e610: 7061 726b 204b 696e 6573 6973 2044 6f63  park Kinesis Doc
+0000e620: 756d 656e 7461 7469 6f6e 605f 2e0a 2020  umentation`_..  
+0000e630: 2020 2020 2020 3a70 6172 616d 2077 6174        :param wat
+0000e640: 6572 6d61 726b 5f64 656c 6179 5f74 6872  ermark_delay_thr
+0000e650: 6573 686f 6c64 3a20 2844 6566 6175 6c74  eshold: (Default
+0000e660: 3a20 3234 6829 2057 6174 6572 6d61 726b  : 24h) Watermark
+0000e670: 2074 696d 6520 696e 7465 7276 616c 2c20   time interval, 
+0000e680: 652e 673a 2074 696d 6564 656c 7461 2868  e.g: timedelta(h
+0000e690: 6f75 7273 3d33 3629 2c20 7573 6564 2062  ours=36), used b
+0000e6a0: 7920 5370 6172 6b20 5374 7275 6374 7572  y Spark Structur
+0000e6b0: 6564 2053 7472 6561 6d69 6e67 2074 6f20  ed Streaming to 
+0000e6c0: 6163 636f 756e 7420 666f 7220 6c61 7465  account for late
+0000e6d0: 2d61 7272 6976 696e 6720 6461 7461 2e20  -arriving data. 
+0000e6e0: 5365 653a 2060 5072 6f64 7563 7469 6f6e  See: `Production
+0000e6f0: 697a 696e 6720 6120 5374 7265 616d 605f  izing a Stream`_
+0000e700: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000e710: 2064 6564 7570 6c69 6361 7469 6f6e 5f63   deduplication_c
+0000e720: 6f6c 756d 6e73 3a20 436f 6c75 6d6e 7320  olumns: Columns 
+0000e730: 696e 2074 6865 2073 7472 6561 6d20 6461  in the stream da
+0000e740: 7461 2074 6861 7420 756e 6971 7565 6c79  ta that uniquely
+0000e750: 2069 6465 6e74 6966 7920 6461 7461 2072   identify data r
+0000e760: 6563 6f72 6473 2e0a 2020 2020 2020 2020  ecords..        
+0000e770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e790: 5573 6564 2066 6f72 2064 652d 6475 706c  Used for de-dupl
+0000e7a0: 6963 6174 696e 672e 0a20 2020 2020 2020  icating..       
+0000e7b0: 203a 7061 7261 6d20 6f70 7469 6f6e 733a   :param options:
+0000e7c0: 2041 206d 6170 206f 6620 6164 6469 7469   A map of additi
+0000e7d0: 6f6e 616c 2053 7061 726b 2072 6561 6453  onal Spark readS
+0000e7e0: 7472 6561 6d20 6f70 7469 6f6e 730a 0a20  tream options.. 
+0000e7f0: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+0000e800: 4120 4b69 6e65 7369 7343 6f6e 6669 6720  A KinesisConfig 
+0000e810: 636c 6173 7320 696e 7374 616e 6365 2e0a  class instance..
+0000e820: 0a20 2020 2020 2020 202e 2e20 5f55 7365  .        .. _Use
+0000e830: 7220 4775 6964 653a 2068 7474 7073 3a2f  r Guide: https:/
+0000e840: 2f64 6f63 732e 7465 6374 6f6e 2e61 692f  /docs.tecton.ai/
+0000e850: 646f 6373 2f64 6566 696e 696e 672d 6665  docs/defining-fe
+0000e860: 6174 7572 6573 2f64 6174 612d 736f 7572  atures/data-sour
+0000e870: 6365 732f 6372 6561 7469 6e67 2d61 6e64  ces/creating-and
+0000e880: 2d74 6573 7469 6e67 2d61 2d73 7472 6561  -testing-a-strea
+0000e890: 6d69 6e67 2d64 6174 612d 736f 7572 6365  ming-data-source
+0000e8a0: 2377 7269 7465 2d74 6865 2d73 7472 6561  #write-the-strea
+0000e8b0: 6d2d 6d65 7373 6167 652d 706f 7374 2d70  m-message-post-p
+0000e8c0: 726f 6365 7373 6f72 2d66 756e 6374 696f  rocessor-functio
+0000e8d0: 6e0a 2020 2020 2020 2020 2e2e 205f 5072  n.        .. _Pr
+0000e8e0: 6f64 7563 7469 6f6e 697a 696e 6720 6120  oductionizing a 
+0000e8f0: 5374 7265 616d 3a20 6874 7470 733a 2f2f  Stream: https://
+0000e900: 646f 6373 2e74 6563 746f 6e2e 6169 2f64  docs.tecton.ai/d
+0000e910: 6f63 732f 6465 6669 6e69 6e67 2d66 6561  ocs/defining-fea
+0000e920: 7475 7265 732f 6665 6174 7572 652d 7669  tures/feature-vi
+0000e930: 6577 732f 7374 7265 616d 2d66 6561 7475  ews/stream-featu
+0000e940: 7265 2d76 6965 7723 7072 6f64 7563 7469  re-view#producti
+0000e950: 6f6e 697a 696e 672d 612d 7374 7265 616d  onizing-a-stream
+0000e960: 0a20 2020 2020 2020 202e 2e20 5f53 7061  .        .. _Spa
+0000e970: 726b 204b 696e 6573 6973 2044 6f63 756d  rk Kinesis Docum
+0000e980: 656e 7461 7469 6f6e 3a20 6874 7470 733a  entation: https:
+0000e990: 2f2f 7370 6172 6b2e 6170 6163 6865 2e6f  //spark.apache.o
+0000e9a0: 7267 2f64 6f63 732f 6c61 7465 7374 2f73  rg/docs/latest/s
+0000e9b0: 7472 6561 6d69 6e67 2d6b 696e 6573 6973  treaming-kinesis
+0000e9c0: 2d69 6e74 6567 7261 7469 6f6e 2e68 746d  -integration.htm
+0000e9d0: 6c0a 0a20 2020 2020 2020 2045 7861 6d70  l..        Examp
+0000e9e0: 6c65 206f 6620 6120 4b69 6e65 7369 7343  le of a KinesisC
+0000e9f0: 6f6e 6669 6720 6465 636c 6172 6174 696f  onfig declaratio
+0000ea00: 6e3a 0a0a 2020 2020 2020 2020 2e2e 2063  n:..        .. c
+0000ea10: 6f64 652d 626c 6f63 6b3a 3a20 7079 7468  ode-block:: pyth
+0000ea20: 6f6e 0a0a 2020 2020 2020 2020 2020 2020  on..            
+0000ea30: 696d 706f 7274 2070 7973 7061 726b 0a20  import pyspark. 
+0000ea40: 2020 2020 2020 2020 2020 2066 726f 6d20             from 
+0000ea50: 7465 6374 6f6e 2069 6d70 6f72 7420 4b69  tecton import Ki
+0000ea60: 6e65 7369 7343 6f6e 6669 670a 0a0a 2020  nesisConfig...  
+0000ea70: 2020 2020 2020 2020 2020 2320 4465 6669            # Defi
+0000ea80: 6e65 206f 7572 2064 6573 6572 6961 6c69  ne our deseriali
+0000ea90: 7a61 7469 6f6e 2072 6177 2073 7472 6561  zation raw strea
+0000eaa0: 6d20 7472 616e 736c 6174 6f72 0a20 2020  m translator.   
+0000eab0: 2020 2020 2020 2020 2064 6566 2072 6177           def raw
+0000eac0: 5f64 6174 615f 6465 7365 7269 616c 697a  _data_deserializ
+0000ead0: 6174 696f 6e28 6466 3a70 7973 7061 726b  ation(df:pyspark
+0000eae0: 2e73 716c 2e44 6174 6146 7261 6d65 2920  .sql.DataFrame) 
+0000eaf0: 2d3e 2070 7973 7061 726b 2e73 716c 2e44  -> pyspark.sql.D
+0000eb00: 6174 6146 7261 6d65 3a0a 2020 2020 2020  ataFrame:.      
+0000eb10: 2020 2020 2020 2020 2020 6672 6f6d 2070            from p
+0000eb20: 7973 7061 726b 2e73 716c 2e66 756e 6374  yspark.sql.funct
+0000eb30: 696f 6e73 2069 6d70 6f72 7420 636f 6c2c  ions import col,
+0000eb40: 2066 726f 6d5f 6a73 6f6e 2c20 6672 6f6d   from_json, from
+0000eb50: 5f75 7463 5f74 696d 6573 7461 6d70 0a20  _utc_timestamp. 
+0000eb60: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000eb70: 726f 6d20 7079 7370 6172 6b2e 7371 6c2e  rom pyspark.sql.
+0000eb80: 7479 7065 7320 696d 706f 7274 2053 7472  types import Str
+0000eb90: 7563 7454 7970 652c 2053 7472 696e 6754  uctType, StringT
+0000eba0: 7970 650a 0a20 2020 2020 2020 2020 2020  ype..           
+0000ebb0: 2020 2020 2070 6179 6c6f 6164 5f73 6368       payload_sch
+0000ebc0: 656d 6120 3d20 280a 2020 2020 2020 2020  ema = (.        
+0000ebd0: 2020 2020 2020 2020 2020 5374 7275 6374            Struct
+0000ebe0: 5479 7065 2829 0a20 2020 2020 2020 2020  Type().         
+0000ebf0: 2020 2020 2020 2020 2020 2020 2020 202e                 .
+0000ec00: 6164 6428 2761 6d6f 756e 7427 2c20 5374  add('amount', St
+0000ec10: 7269 6e67 5479 7065 2829 2c20 4661 6c73  ringType(), Fals
+0000ec20: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
+0000ec30: 2020 2020 2020 2020 2020 202e 6164 6428             .add(
+0000ec40: 2769 7346 7261 7564 272c 2053 7472 696e  'isFraud', Strin
+0000ec50: 6754 7970 6528 292c 2046 616c 7365 290a  gType(), False).
 0000ec60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ec70: 2020 2020 2e73 656c 6563 7428 6672 6f6d      .select(from
-0000ec80: 5f6a 736f 6e28 276a 736f 6e44 6174 6127  _json('jsonData'
-0000ec90: 2c20 7061 796c 6f61 645f 7363 6865 6d61  , payload_schema
-0000eca0: 292e 616c 6961 7328 2770 6179 6c6f 6164  ).alias('payload
-0000ecb0: 2729 290a 2020 2020 2020 2020 2020 2020  ')).            
-0000ecc0: 2020 2020 2020 2020 2e73 656c 6563 7428          .select(
-0000ecd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ece0: 2020 2020 2020 2020 2063 6f6c 2827 7061           col('pa
-0000ecf0: 796c 6f61 642e 616d 6f75 6e74 2729 2e63  yload.amount').c
-0000ed00: 6173 7428 276c 6f6e 6727 292e 616c 6961  ast('long').alia
-0000ed10: 7328 2761 6d6f 756e 7427 292c 0a20 2020  s('amount'),.   
-0000ed20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ed30: 2020 2020 2063 6f6c 2827 7061 796c 6f61       col('payloa
-0000ed40: 642e 6973 4672 6175 6427 292e 6361 7374  d.isFraud').cast
-0000ed50: 2827 6c6f 6e67 2729 2e61 6c69 6173 2827  ('long').alias('
-0000ed60: 6973 4672 6175 6427 292c 0a20 2020 2020  isFraud'),.     
-0000ed70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ed80: 2020 2066 726f 6d5f 7574 635f 7469 6d65     from_utc_time
-0000ed90: 7374 616d 7028 2770 6179 6c6f 6164 2e74  stamp('payload.t
-0000eda0: 696d 6573 7461 6d70 272c 2027 5554 4327  imestamp', 'UTC'
-0000edb0: 292e 616c 6961 7328 2774 696d 6573 7461  ).alias('timesta
-0000edc0: 6d70 2729 0a20 2020 2020 2020 2020 2020  mp').           
-0000edd0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0000ede0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0000edf0: 2020 2020 2020 2020 2023 2044 6563 6c61           # Decla
-0000ee00: 7265 204b 696e 6573 6973 436f 6e66 6967  re KinesisConfig
-0000ee10: 2069 6e73 7461 6e63 6520 6f62 6a65 6374   instance object
-0000ee20: 2074 6861 7420 6361 6e20 6265 2075 7365   that can be use
-0000ee30: 6420 6173 2061 7267 756d 656e 7420 696e  d as argument in
-0000ee40: 2060 5374 7265 616d 536f 7572 6365 600a   `StreamSource`.
-0000ee50: 2020 2020 2020 2020 2020 2020 7374 7265              stre
-0000ee60: 616d 5f63 6f6e 6669 6720 3d20 4b69 6e65  am_config = Kine
-0000ee70: 7369 7343 6f6e 6669 6728 0a20 2020 2020  sisConfig(.     
-0000ee80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ee90: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000eea0: 7472 6561 6d5f 6e61 6d65 3d27 7472 616e  tream_name='tran
-0000eeb0: 7361 6374 696f 6e5f 6576 656e 7473 272c  saction_events',
-0000eec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000eed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eee0: 2020 2020 2072 6567 696f 6e3d 2775 732d       region='us-
-0000eef0: 7765 7374 2d32 272c 0a20 2020 2020 2020  west-2',.       
-0000ef00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ef10: 2020 2020 2020 2020 2020 2020 2069 6e69               ini
-0000ef20: 7469 616c 5f73 7472 6561 6d5f 706f 7369  tial_stream_posi
-0000ef30: 7469 6f6e 3d27 6c61 7465 7374 272c 0a20  tion='latest',. 
-0000ef40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ef50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ef60: 2020 2074 696d 6573 7461 6d70 5f66 6965     timestamp_fie
-0000ef70: 6c64 3d27 7469 6d65 7374 616d 7027 2c0a  ld='timestamp',.
+0000ec70: 2020 2020 2020 2020 2e61 6464 2827 7469          .add('ti
+0000ec80: 6d65 7374 616d 7027 2c20 5374 7269 6e67  mestamp', String
+0000ec90: 5479 7065 2829 2c20 4661 6c73 6529 0a20  Type(), False). 
+0000eca0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0000ecb0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000ecc0: 2020 7265 7475 726e 2028 0a20 2020 2020    return (.     
+0000ecd0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0000ece0: 662e 7365 6c65 6374 4578 7072 2827 6361  f.selectExpr('ca
+0000ecf0: 7374 2028 6461 7461 2061 7320 5354 5249  st (data as STRI
+0000ed00: 4e47 2920 6a73 6f6e 4461 7461 2729 0a20  NG) jsonData'). 
+0000ed10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ed20: 2020 202e 7365 6c65 6374 2866 726f 6d5f     .select(from_
+0000ed30: 6a73 6f6e 2827 6a73 6f6e 4461 7461 272c  json('jsonData',
+0000ed40: 2070 6179 6c6f 6164 5f73 6368 656d 6129   payload_schema)
+0000ed50: 2e61 6c69 6173 2827 7061 796c 6f61 6427  .alias('payload'
+0000ed60: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+0000ed70: 2020 2020 2020 202e 7365 6c65 6374 280a         .select(.
+0000ed80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ed90: 2020 2020 2020 2020 636f 6c28 2770 6179          col('pay
+0000eda0: 6c6f 6164 2e61 6d6f 756e 7427 292e 6361  load.amount').ca
+0000edb0: 7374 2827 6c6f 6e67 2729 2e61 6c69 6173  st('long').alias
+0000edc0: 2827 616d 6f75 6e74 2729 2c0a 2020 2020  ('amount'),.    
+0000edd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ede0: 2020 2020 636f 6c28 2770 6179 6c6f 6164      col('payload
+0000edf0: 2e69 7346 7261 7564 2729 2e63 6173 7428  .isFraud').cast(
+0000ee00: 276c 6f6e 6727 292e 616c 6961 7328 2769  'long').alias('i
+0000ee10: 7346 7261 7564 2729 2c0a 2020 2020 2020  sFraud'),.      
+0000ee20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ee30: 2020 6672 6f6d 5f75 7463 5f74 696d 6573    from_utc_times
+0000ee40: 7461 6d70 2827 7061 796c 6f61 642e 7469  tamp('payload.ti
+0000ee50: 6d65 7374 616d 7027 2c20 2755 5443 2729  mestamp', 'UTC')
+0000ee60: 2e61 6c69 6173 2827 7469 6d65 7374 616d  .alias('timestam
+0000ee70: 7027 290a 2020 2020 2020 2020 2020 2020  p').            
+0000ee80: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000ee90: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0000eea0: 2020 2020 2020 2020 2320 4465 636c 6172          # Declar
+0000eeb0: 6520 4b69 6e65 7369 7343 6f6e 6669 6720  e KinesisConfig 
+0000eec0: 696e 7374 616e 6365 206f 626a 6563 7420  instance object 
+0000eed0: 7468 6174 2063 616e 2062 6520 7573 6564  that can be used
+0000eee0: 2061 7320 6172 6775 6d65 6e74 2069 6e20   as argument in 
+0000eef0: 6053 7472 6561 6d53 6f75 7263 6560 0a20  `StreamSource`. 
+0000ef00: 2020 2020 2020 2020 2020 2073 7472 6561             strea
+0000ef10: 6d5f 636f 6e66 6967 203d 204b 696e 6573  m_config = Kines
+0000ef20: 6973 436f 6e66 6967 280a 2020 2020 2020  isConfig(.      
+0000ef30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ef40: 2020 2020 2020 2020 2020 2020 2020 7374                st
+0000ef50: 7265 616d 5f6e 616d 653d 2774 7261 6e73  ream_name='trans
+0000ef60: 6163 7469 6f6e 5f65 7665 6e74 7327 2c0a  action_events',.
+0000ef70: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000ef80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ef90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000efa0: 2020 2020 706f 7374 5f70 726f 6365 7373      post_process
-0000efb0: 6f72 3d72 6177 5f64 6174 615f 6465 7365  or=raw_data_dese
-0000efc0: 7269 616c 697a 6174 696f 6e2c 0a20 2020  rialization,.   
-0000efd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000efe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eff0: 206f 7074 696f 6e73 3d7b 2772 6f6c 6541   options={'roleA
-0000f000: 726e 273a 2027 6172 6e3a 6177 733a 6961  rn': 'arn:aws:ia
-0000f010: 6d3a 3a34 3732 3534 3232 3239 3231 373a  m::472542229217:
-0000f020: 726f 6c65 2f64 656d 6f2d 6372 6f73 732d  role/demo-cross-
-0000f030: 6163 636f 756e 742d 6b69 6e65 7369 732d  account-kinesis-
-0000f040: 726f 277d 0a20 2020 2020 2020 2020 2020  ro'}.           
-0000f050: 2029 0a20 2020 2020 2020 2022 2222 0a0a   ).        """..
-0000f060: 2020 2020 2020 2020 6172 6773 203d 2064          args = d
-0000f070: 6174 615f 736f 7572 6365 5f70 6232 2e4b  ata_source_pb2.K
-0000f080: 696e 6573 6973 4461 7461 536f 7572 6365  inesisDataSource
-0000f090: 4172 6773 2829 0a20 2020 2020 2020 2061  Args().        a
-0000f0a0: 7267 732e 7374 7265 616d 5f6e 616d 6520  rgs.stream_name 
-0000f0b0: 3d20 7374 7265 616d 5f6e 616d 650a 2020  = stream_name.  
-0000f0c0: 2020 2020 2020 6172 6773 2e72 6567 696f        args.regio
-0000f0d0: 6e20 3d20 7265 6769 6f6e 0a20 2020 2020  n = region.     
-0000f0e0: 2020 2069 6620 6675 6e63 7469 6f6e 5f73     if function_s
-0000f0f0: 6572 6961 6c69 7a61 7469 6f6e 2e73 686f  erialization.sho
-0000f100: 756c 645f 7365 7269 616c 697a 655f 6675  uld_serialize_fu
-0000f110: 6e63 7469 6f6e 2870 6f73 745f 7072 6f63  nction(post_proc
-0000f120: 6573 736f 7229 3a0a 2020 2020 2020 2020  essor):.        
-0000f130: 2020 2020 6172 6773 2e63 6f6d 6d6f 6e5f      args.common_
-0000f140: 6172 6773 2e70 6f73 745f 7072 6f63 6573  args.post_proces
-0000f150: 736f 722e 436f 7079 4672 6f6d 2866 756e  sor.CopyFrom(fun
-0000f160: 6374 696f 6e5f 7365 7269 616c 697a 6174  ction_serializat
-0000f170: 696f 6e2e 746f 5f70 726f 746f 2870 6f73  ion.to_proto(pos
-0000f180: 745f 7072 6f63 6573 736f 7229 290a 2020  t_processor)).  
-0000f190: 2020 2020 2020 6172 6773 2e63 6f6d 6d6f        args.commo
-0000f1a0: 6e5f 6172 6773 2e74 696d 6573 7461 6d70  n_args.timestamp
-0000f1b0: 5f66 6965 6c64 203d 2074 696d 6573 7461  _field = timesta
-0000f1c0: 6d70 5f66 6965 6c64 0a20 2020 2020 2020  mp_field.       
-0000f1d0: 2069 6620 696e 6974 6961 6c5f 7374 7265   if initial_stre
-0000f1e0: 616d 5f70 6f73 6974 696f 6e3a 0a20 2020  am_position:.   
-0000f1f0: 2020 2020 2020 2020 2061 7267 732e 696e           args.in
-0000f200: 6974 6961 6c5f 7374 7265 616d 5f70 6f73  itial_stream_pos
-0000f210: 6974 696f 6e20 3d20 6461 7461 5f73 6f75  ition = data_sou
-0000f220: 7263 655f 6865 6c70 6572 2e49 4e49 5449  rce_helper.INITI
-0000f230: 414c 5f53 5452 4541 4d5f 504f 5349 5449  AL_STREAM_POSITI
-0000f240: 4f4e 5f53 5452 5f54 4f5f 454e 554d 5b0a  ON_STR_TO_ENUM[.
-0000f250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f260: 696e 6974 6961 6c5f 7374 7265 616d 5f70  initial_stream_p
-0000f270: 6f73 6974 696f 6e0a 2020 2020 2020 2020  osition.        
-0000f280: 2020 2020 5d0a 2020 2020 2020 2020 6966      ].        if
-0000f290: 2077 6174 6572 6d61 726b 5f64 656c 6179   watermark_delay
-0000f2a0: 5f74 6872 6573 686f 6c64 3a0a 2020 2020  _threshold:.    
-0000f2b0: 2020 2020 2020 2020 6172 6773 2e63 6f6d          args.com
-0000f2c0: 6d6f 6e5f 6172 6773 2e77 6174 6572 6d61  mon_args.waterma
-0000f2d0: 726b 5f64 656c 6179 5f74 6872 6573 686f  rk_delay_thresho
-0000f2e0: 6c64 2e46 726f 6d54 696d 6564 656c 7461  ld.FromTimedelta
-0000f2f0: 2877 6174 6572 6d61 726b 5f64 656c 6179  (watermark_delay
-0000f300: 5f74 6872 6573 686f 6c64 290a 2020 2020  _threshold).    
-0000f310: 2020 2020 6966 2064 6564 7570 6c69 6361      if deduplica
-0000f320: 7469 6f6e 5f63 6f6c 756d 6e73 3a0a 2020  tion_columns:.  
-0000f330: 2020 2020 2020 2020 2020 666f 7220 636f            for co
-0000f340: 6c75 6d6e 5f6e 616d 6520 696e 2064 6564  lumn_name in ded
-0000f350: 7570 6c69 6361 7469 6f6e 5f63 6f6c 756d  uplication_colum
-0000f360: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
-0000f370: 2020 2020 6172 6773 2e63 6f6d 6d6f 6e5f      args.common_
-0000f380: 6172 6773 2e64 6564 7570 6c69 6361 7469  args.deduplicati
-0000f390: 6f6e 5f63 6f6c 756d 6e73 2e61 7070 656e  on_columns.appen
-0000f3a0: 6428 636f 6c75 6d6e 5f6e 616d 6529 0a20  d(column_name). 
-0000f3b0: 2020 2020 2020 206f 7074 696f 6e73 5f20         options_ 
-0000f3c0: 3d20 6f70 7469 6f6e 7320 6f72 207b 7d0a  = options or {}.
-0000f3d0: 2020 2020 2020 2020 666f 7220 6b65 7920          for key 
-0000f3e0: 696e 2073 6f72 7465 6428 6f70 7469 6f6e  in sorted(option
-0000f3f0: 735f 2e6b 6579 7328 2929 3a0a 2020 2020  s_.keys()):.    
-0000f400: 2020 2020 2020 2020 6f70 7469 6f6e 203d          option =
-0000f410: 2064 6174 615f 736f 7572 6365 5f70 6232   data_source_pb2
-0000f420: 2e4f 7074 696f 6e28 290a 2020 2020 2020  .Option().      
-0000f430: 2020 2020 2020 6f70 7469 6f6e 2e6b 6579        option.key
-0000f440: 203d 206b 6579 0a20 2020 2020 2020 2020   = key.         
-0000f450: 2020 206f 7074 696f 6e2e 7661 6c75 6520     option.value 
-0000f460: 3d20 6f70 7469 6f6e 735f 5b6b 6579 5d0a  = options_[key].
-0000f470: 2020 2020 2020 2020 2020 2020 6172 6773              args
-0000f480: 2e6f 7074 696f 6e73 2e61 7070 656e 6428  .options.append(
-0000f490: 6f70 7469 6f6e 290a 0a20 2020 2020 2020  option)..       
-0000f4a0: 2073 656c 662e 5f61 7267 7320 3d20 6172   self._args = ar
-0000f4b0: 6773 0a20 2020 2020 2020 2073 656c 662e  gs.        self.
-0000f4c0: 706f 7374 5f70 726f 6365 7373 6f72 203d  post_processor =
-0000f4d0: 2070 6f73 745f 7072 6f63 6573 736f 720a   post_processor.
-0000f4e0: 0a20 2020 2064 6566 205f 6d65 7267 655f  .    def _merge_
-0000f4f0: 7374 7265 616d 5f61 7267 7328 7365 6c66  stream_args(self
-0000f500: 2c20 6461 7461 5f73 6f75 7263 655f 6172  , data_source_ar
-0000f510: 6773 3a20 7669 7274 7561 6c5f 6461 7461  gs: virtual_data
-0000f520: 5f73 6f75 7263 655f 7062 322e 5669 7274  _source_pb2.Virt
-0000f530: 7561 6c44 6174 6153 6f75 7263 6541 7267  ualDataSourceArg
-0000f540: 7329 3a0a 2020 2020 2020 2020 6461 7461  s):.        data
-0000f550: 5f73 6f75 7263 655f 6172 6773 2e6b 696e  _source_args.kin
-0000f560: 6573 6973 5f64 735f 636f 6e66 6967 2e43  esis_ds_config.C
-0000f570: 6f70 7946 726f 6d28 7365 6c66 2e5f 6172  opyFrom(self._ar
-0000f580: 6773 290a 0a0a 636c 6173 7320 5075 7368  gs)...class Push
-0000f590: 436f 6e66 6967 2842 6173 6553 7472 6561  Config(BaseStrea
-0000f5a0: 6d43 6f6e 6669 6729 3a0a 2020 2020 2222  mConfig):.    ""
-0000f5b0: 220a 2020 2020 5468 6520 5075 7368 436f  ".    The PushCo
-0000f5c0: 6e66 6967 2063 6c61 7373 2069 7320 7573  nfig class is us
-0000f5d0: 6564 2074 6f20 636f 6e66 6967 7572 6520  ed to configure 
-0000f5e0: 7468 6520 5374 7265 616d 2049 6e67 6573  the Stream Inges
-0000f5f0: 7420 4150 4920 746f 2061 6c6c 6f77 2069  t API to allow i
-0000f600: 6e67 6573 7469 6f6e 206f 660a 2020 2020  ngestion of.    
-0000f610: 7265 636f 7264 7320 7669 6120 7468 6520  records via the 
-0000f620: 5374 7265 616d 2049 6e67 6573 7420 4150  Stream Ingest AP
-0000f630: 492e 0a0a 2020 2020 5468 6973 2063 6c61  I...    This cla
-0000f640: 7373 2069 7320 7573 6564 2061 7320 616e  ss is used as an
-0000f650: 2069 6e70 7574 2074 6f20 6120 3a63 6c61   input to a :cla
-0000f660: 7373 3a60 5374 7265 616d 536f 7572 6365  ss:`StreamSource
-0000f670: 6027 7320 7061 7261 6d65 7465 7220 6060  `'s parameter ``
-0000f680: 7374 7265 616d 5f63 6f6e 6669 6760 602e  stream_config``.
-0000f690: 2044 6563 6c61 7269 6e67 2074 6869 7320   Declaring this 
-0000f6a0: 636f 6e66 6967 7572 6174 696f 6e0a 2020  configuration.  
-0000f6b0: 2020 636c 6173 7320 616c 6f6e 6520 7769    class alone wi
-0000f6c0: 6c6c 206e 6f74 2072 6567 6973 7465 7220  ll not register 
-0000f6d0: 6120 4461 7461 2053 6f75 7263 652e 2049  a Data Source. I
-0000f6e0: 6e73 7465 6164 2c20 6465 636c 6172 6520  nstead, declare 
-0000f6f0: 6173 2061 2070 6172 7420 6f66 2060 6053  as a part of ``S
-0000f700: 7472 6561 6d53 6f75 7263 6560 6020 7468  treamSource`` th
-0000f710: 6174 2074 616b 6573 2074 6869 7320 636f  at takes this co
-0000f720: 6e66 6967 7572 6174 696f 6e0a 2020 2020  nfiguration.    
-0000f730: 636c 6173 7320 696e 7374 616e 6365 2061  class instance a
-0000f740: 7320 6120 7061 7261 6d65 7465 722e 0a20  s a parameter.. 
-0000f750: 2020 2022 2222 0a0a 2020 2020 6465 6620     """..    def 
-0000f760: 5f5f 696e 6974 5f5f 280a 2020 2020 2020  __init__(.      
-0000f770: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-0000f780: 6c6f 675f 6f66 666c 696e 653a 2062 6f6f  log_offline: boo
-0000f790: 6c20 3d20 4661 6c73 652c 0a20 2020 2020  l = False,.     
-0000f7a0: 2020 2070 6f73 745f 7072 6f63 6573 736f     post_processo
-0000f7b0: 723a 204f 7074 696f 6e61 6c5b 0a20 2020  r: Optional[.   
-0000f7c0: 2020 2020 2020 2020 2055 6e69 6f6e 5b43           Union[C
-0000f7d0: 616c 6c61 626c 655b 5b44 6963 745d 2c20  allable[[Dict], 
-0000f7e0: 4f70 7469 6f6e 616c 5b44 6963 745d 5d2c  Optional[Dict]],
-0000f7f0: 2043 616c 6c61 626c 655b 5b70 642e 4461   Callable[[pd.Da
-0000f800: 7461 4672 616d 655d 2c20 4f70 7469 6f6e  taFrame], Option
-0000f810: 616c 5b70 642e 4461 7461 4672 616d 655d  al[pd.DataFrame]
-0000f820: 5d5d 0a20 2020 2020 2020 205d 203d 204e  ]].        ] = N
-0000f830: 6f6e 652c 0a20 2020 2020 2020 2070 6f73  one,.        pos
-0000f840: 745f 7072 6f63 6573 736f 725f 6d6f 6465  t_processor_mode
-0000f850: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-0000f860: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0000f870: 696e 7075 745f 7363 6865 6d61 3a20 4f70  input_schema: Op
-0000f880: 7469 6f6e 616c 5b4c 6973 745b 7479 7065  tional[List[type
-0000f890: 732e 4669 656c 645d 5d20 3d20 4e6f 6e65  s.Field]] = None
-0000f8a0: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-0000f8b0: 2022 2222 0a20 2020 2020 2020 2049 6e73   """.        Ins
-0000f8c0: 7461 6e74 6961 7465 7320 6120 6e65 7720  tantiates a new 
-0000f8d0: 5075 7368 436f 6e66 6967 2e0a 0a20 2020  PushConfig...   
-0000f8e0: 2020 2020 203a 7061 7261 6d3a 206c 6f67       :param: log
-0000f8f0: 5f6f 6666 6c69 6e65 3a20 4966 2073 6574  _offline: If set
-0000f900: 2074 6f20 5472 7565 2c20 7468 6520 5374   to True, the St
-0000f910: 7265 616d 2049 6e67 6573 7420 4150 4920  ream Ingest API 
-0000f920: 7769 6c6c 206c 6f67 2074 6865 2069 6e63  will log the inc
-0000f930: 6f6d 696e 6720 7265 636f 7264 7320 666f  oming records fo
-0000f940: 7220 7468 6520 7075 7368 2073 6f75 7263  r the push sourc
-0000f950: 6520 746f 2061 6e20 6f66 666c 696e 6520  e to an offline 
-0000f960: 7461 626c 652e 0a20 2020 2020 2020 203a  table..        :
-0000f970: 7061 7261 6d3a 2070 6f73 745f 7072 6f63  param: post_proc
-0000f980: 6573 736f 723a 2041 6e20 6f70 7469 6f6e  essor: An option
-0000f990: 616c 2075 7365 722d 6465 6669 6e65 6420  al user-defined 
-0000f9a0: 6675 6e63 7469 6f6e 2074 6861 7420 7072  function that pr
-0000f9b0: 652d 7072 6f63 6573 7365 7320 7265 636f  e-processes reco
-0000f9c0: 7264 7320 696e 2074 6865 2073 6f75 7263  rds in the sourc
-0000f9d0: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-0000f9e0: 6d3a 2070 6f73 745f 7072 6f63 6573 736f  m: post_processo
-0000f9f0: 725f 6d6f 6465 3a20 4578 6563 7574 696f  r_mode: Executio
-0000fa00: 6e20 6d6f 6465 2066 6f72 2074 6865 2060  n mode for the `
-0000fa10: 706f 7374 5f70 726f 6365 7373 6f72 602c  post_processor`,
-0000fa20: 206d 7573 7420 6265 206f 6e65 206f 6620   must be one of 
-0000fa30: 6070 7974 686f 6e60 206f 7220 6070 616e  `python` or `pan
-0000fa40: 6461 7360 0a20 2020 2020 2020 203a 7061  das`.        :pa
-0000fa50: 7261 6d3a 2069 6e70 7574 5f73 6368 656d  ram: input_schem
-0000fa60: 613a 2049 6e70 7574 2073 6368 656d 6120  a: Input schema 
-0000fa70: 666f 7220 7468 6520 6070 6f73 745f 7072  for the `post_pr
-0000fa80: 6f63 6573 736f 7260 0a0a 2020 2020 2020  ocessor`..      
-0000fa90: 2020 3a72 6574 7572 6e3a 2041 2050 7573    :return: A Pus
-0000faa0: 6843 6f6e 6669 6720 636c 6173 7320 696e  hConfig class in
-0000fab0: 7374 616e 6365 2e0a 0a20 2020 2020 2020  stance...       
-0000fac0: 202e 2e20 5f55 7365 7220 4775 6964 653a   .. _User Guide:
-0000fad0: 2068 7474 7073 3a2f 2f64 6f63 732e 7465   https://docs.te
-0000fae0: 6374 6f6e 2e61 692f 646f 6373 2f64 6566  cton.ai/docs/def
-0000faf0: 696e 696e 672d 6665 6174 7572 6573 2f66  ining-features/f
-0000fb00: 6561 7475 7265 2d76 6965 7773 2f73 7472  eature-views/str
-0000fb10: 6561 6d2d 6665 6174 7572 652d 7669 6577  eam-feature-view
-0000fb20: 2f73 7472 6561 6d2d 6665 6174 7572 652d  /stream-feature-
-0000fb30: 7669 6577 2d77 6974 682d 7374 7265 616d  view-with-stream
-0000fb40: 2d69 6e67 6573 742d 6170 690a 0a20 2020  -ingest-api..   
-0000fb50: 2020 2020 2045 7861 6d70 6c65 206f 6620       Example of 
-0000fb60: 6120 5075 7368 436f 6e66 6967 2064 6563  a PushConfig dec
-0000fb70: 6c61 7261 7469 6f6e 3a0a 0a20 2020 2020  laration:..     
-0000fb80: 2020 202e 2e20 636f 6465 2d62 6c6f 636b     .. code-block
-0000fb90: 3a3a 2070 7974 686f 6e0a 0a20 2020 2020  :: python..     
-0000fba0: 2020 2020 2020 2069 6d70 6f72 7420 7079         import py
-0000fbb0: 7370 6172 6b0a 2020 2020 2020 2020 2020  spark.          
-0000fbc0: 2020 6672 6f6d 2074 6563 746f 6e20 696d    from tecton im
-0000fbd0: 706f 7274 2050 7573 6843 6f6e 6669 672c  port PushConfig,
-0000fbe0: 2053 7472 6561 6d53 6f75 7263 650a 2020   StreamSource.  
-0000fbf0: 2020 2020 2020 2020 2020 6672 6f6d 2074            from t
-0000fc00: 6563 746f 6e2e 7479 7065 7320 696d 706f  ecton.types impo
-0000fc10: 7274 2046 6965 6c64 2c20 5374 7269 6e67  rt Field, String
-0000fc20: 2c20 5469 6d65 7374 616d 702c 2049 6e74  , Timestamp, Int
-0000fc30: 3634 0a0a 2020 2020 2020 2020 2020 2020  64..            
-0000fc40: 2320 4465 636c 6172 6520 5075 7368 436f  # Declare PushCo
-0000fc50: 6e66 6967 2069 6e73 7461 6e63 6520 6f62  nfig instance ob
-0000fc60: 6a65 6374 2074 6861 7420 6361 6e20 6265  ject that can be
-0000fc70: 2075 7365 6420 6173 2061 7267 756d 656e   used as argumen
-0000fc80: 7420 696e 2060 5374 7265 616d 536f 7572  t in `StreamSour
-0000fc90: 6365 600a 2020 2020 2020 2020 2020 2020  ce`.            
-0000fca0: 7374 7265 616d 5f63 6f6e 6669 6720 3d20  stream_config = 
-0000fcb0: 5075 7368 436f 6e66 6967 2829 0a20 2020  PushConfig().   
-0000fcc0: 2020 2020 2020 2020 2073 6f75 7263 6520           source 
-0000fcd0: 3d20 5374 7265 616d 536f 7572 6365 280a  = StreamSource(.
-0000fce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fcf0: 6e61 6d65 3d22 6d79 5f73 7472 6561 6d5f  name="my_stream_
-0000fd00: 736f 7572 6365 222c 0a20 2020 2020 2020  source",.       
-0000fd10: 2020 2020 2020 2020 2073 7472 6561 6d5f           stream_
-0000fd20: 636f 6e66 6967 3d73 7472 6561 6d5f 636f  config=stream_co
-0000fd30: 6e66 6967 2c0a 2020 2020 2020 2020 2020  nfig,.          
-0000fd40: 2020 2020 2020 7363 6865 6d61 3d5b 0a20        schema=[. 
-0000fd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fd60: 2020 2046 6965 6c64 2822 5553 4552 5f49     Field("USER_I
-0000fd70: 4422 2c20 5374 7269 6e67 292c 0a20 2020  D", String),.   
-0000fd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fd90: 2046 6965 6c64 2822 5449 4d45 5354 414d   Field("TIMESTAM
-0000fda0: 5022 2c20 5469 6d65 7374 616d 7029 2c0a  P", Timestamp),.
-0000fdb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fdc0: 2020 2020 4669 656c 6428 2256 414c 5545      Field("VALUE
-0000fdd0: 222c 2049 6e74 3634 292c 0a20 2020 2020  ", Int64),.     
-0000fde0: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
-0000fdf0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000fe00: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000fe10: 5f6d 6f64 6520 3d20 280a 2020 2020 2020  _mode = (.      
-0000fe20: 2020 2020 2020 6765 745f 7472 616e 7366        get_transf
-0000fe30: 6f72 6d61 7469 6f6e 5f6d 6f64 655f 656e  ormation_mode_en
-0000fe40: 756d 286d 6f64 653d 706f 7374 5f70 726f  um(mode=post_pro
-0000fe50: 6365 7373 6f72 5f6d 6f64 652c 206e 616d  cessor_mode, nam
-0000fe60: 653d 2250 7573 6843 6f6e 6669 6722 2920  e="PushConfig") 
-0000fe70: 6966 2070 6f73 745f 7072 6f63 6573 736f  if post_processo
-0000fe80: 725f 6d6f 6465 2065 6c73 6520 4e6f 6e65  r_mode else None
-0000fe90: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0000fea0: 2020 205f 706f 7374 5f70 726f 6365 7373     _post_process
-0000feb0: 6f72 5f66 756e 6374 696f 6e20 3d20 6675  or_function = fu
-0000fec0: 6e63 7469 6f6e 5f73 6572 6961 6c69 7a61  nction_serializa
-0000fed0: 7469 6f6e 2e74 6f5f 7072 6f74 6f28 706f  tion.to_proto(po
-0000fee0: 7374 5f70 726f 6365 7373 6f72 2920 6966  st_processor) if
-0000fef0: 2070 6f73 745f 7072 6f63 6573 736f 7220   post_processor 
-0000ff00: 656c 7365 204e 6f6e 650a 2020 2020 2020  else None.      
-0000ff10: 2020 7465 6374 6f6e 5f73 6368 656d 6120    tecton_schema 
-0000ff20: 3d20 7479 7065 5f75 7469 6c73 2e74 6f5f  = type_utils.to_
-0000ff30: 7465 6374 6f6e 5f73 6368 656d 6128 696e  tecton_schema(in
-0000ff40: 7075 745f 7363 6865 6d61 2920 6966 2069  put_schema) if i
-0000ff50: 6e70 7574 5f73 6368 656d 6120 656c 7365  nput_schema else
-0000ff60: 204e 6f6e 650a 0a20 2020 2020 2020 2073   None..        s
-0000ff70: 656c 662e 5f61 7267 7320 3d20 6461 7461  elf._args = data
-0000ff80: 5f73 6f75 7263 655f 7062 322e 5075 7368  _source_pb2.Push
-0000ff90: 536f 7572 6365 4172 6773 280a 2020 2020  SourceArgs(.    
-0000ffa0: 2020 2020 2020 2020 6c6f 675f 6f66 666c          log_offl
-0000ffb0: 696e 653d 6c6f 675f 6f66 666c 696e 652c  ine=log_offline,
-0000ffc0: 0a20 2020 2020 2020 2020 2020 2070 6f73  .            pos
-0000ffd0: 745f 7072 6f63 6573 736f 723d 5f70 6f73  t_processor=_pos
-0000ffe0: 745f 7072 6f63 6573 736f 725f 6675 6e63  t_processor_func
-0000fff0: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
-00010000: 2020 706f 7374 5f70 726f 6365 7373 6f72    post_processor
-00010010: 5f6d 6f64 653d 5f6d 6f64 652c 0a20 2020  _mode=_mode,.   
-00010020: 2020 2020 2020 2020 2069 6e70 7574 5f73           input_s
-00010030: 6368 656d 613d 7465 6374 6f6e 5f73 6368  chema=tecton_sch
-00010040: 656d 612c 0a20 2020 2020 2020 2029 0a0a  ema,.        )..
-00010050: 2020 2020 6465 6620 5f6d 6572 6765 5f73      def _merge_s
-00010060: 7472 6561 6d5f 6172 6773 2873 656c 662c  tream_args(self,
-00010070: 2064 6174 615f 736f 7572 6365 5f61 7267   data_source_arg
-00010080: 733a 2076 6972 7475 616c 5f64 6174 615f  s: virtual_data_
-00010090: 736f 7572 6365 5f70 6232 2e56 6972 7475  source_pb2.Virtu
-000100a0: 616c 4461 7461 536f 7572 6365 4172 6773  alDataSourceArgs
-000100b0: 293a 0a20 2020 2020 2020 2064 6174 615f  ):.        data_
-000100c0: 736f 7572 6365 5f61 7267 732e 7075 7368  source_args.push
-000100d0: 5f63 6f6e 6669 672e 436f 7079 4672 6f6d  _config.CopyFrom
-000100e0: 2873 656c 662e 5f61 7267 7329 0a0a 0a63  (self._args)...c
-000100f0: 6c61 7373 2048 6976 6543 6f6e 6669 6728  lass HiveConfig(
-00010100: 4261 7365 4261 7463 6843 6f6e 6669 6729  BaseBatchConfig)
-00010110: 3a0a 2020 2020 2222 220a 2020 2020 436f  :.    """.    Co
-00010120: 6e66 6967 7572 6174 696f 6e20 7573 6564  nfiguration used
-00010130: 2074 6f20 7265 6665 7265 6e63 6520 6120   to reference a 
-00010140: 4869 7665 2074 6162 6c65 2e0a 0a20 2020  Hive table...   
-00010150: 2054 6865 2048 6976 6543 6f6e 6669 6720   The HiveConfig 
-00010160: 636c 6173 7320 6973 2075 7365 6420 746f  class is used to
-00010170: 2063 7265 6174 6520 6120 7265 6665 7265   create a refere
-00010180: 6e63 6520 746f 2061 2048 6976 6520 5461  nce to a Hive Ta
-00010190: 626c 652e 0a0a 2020 2020 5468 6973 2063  ble...    This c
-000101a0: 6c61 7373 2069 7320 7573 6564 2061 7320  lass is used as 
-000101b0: 616e 2069 6e70 7574 2074 6f20 6120 3a63  an input to a :c
-000101c0: 6c61 7373 3a60 4261 7463 6853 6f75 7263  lass:`BatchSourc
-000101d0: 6560 2773 2070 6172 616d 6574 6572 2060  e`'s parameter `
-000101e0: 6062 6174 6368 5f63 6f6e 6669 6760 602e  `batch_config``.
-000101f0: 2044 6563 6c61 7269 6e67 2074 6869 7320   Declaring this 
-00010200: 636f 6e66 6967 7572 6174 696f 6e0a 2020  configuration.  
-00010210: 2020 636c 6173 7320 616c 6f6e 6520 7769    class alone wi
-00010220: 6c6c 206e 6f74 2072 6567 6973 7465 7220  ll not register 
-00010230: 6120 4461 7461 2053 6f75 7263 652e 2049  a Data Source. I
-00010240: 6e73 7465 6164 2c20 6465 636c 6172 6520  nstead, declare 
-00010250: 6173 2061 2070 6172 7420 6f66 2060 6042  as a part of ``B
-00010260: 6174 6368 536f 7572 6365 6060 2074 6861  atchSource`` tha
-00010270: 7420 7461 6b65 7320 7468 6973 2063 6f6e  t takes this con
-00010280: 6669 6775 7261 7469 6f6e 0a20 2020 2063  figuration.    c
-00010290: 6c61 7373 2069 6e73 7461 6e63 6520 6173  lass instance as
-000102a0: 2061 2070 6172 616d 6574 6572 2e0a 2020   a parameter..  
-000102b0: 2020 2222 220a 0a20 2020 2064 6566 205f    """..    def _
-000102c0: 5f69 6e69 745f 5f28 0a20 2020 2020 2020  _init__(.       
-000102d0: 2073 656c 662c 0a20 2020 2020 2020 2074   self,.        t
-000102e0: 6162 6c65 3a20 7374 722c 0a20 2020 2020  able: str,.     
-000102f0: 2020 2064 6174 6162 6173 653a 2073 7472     database: str
-00010300: 2c0a 2020 2020 2020 2020 7469 6d65 7374  ,.        timest
-00010310: 616d 705f 6669 656c 643a 204f 7074 696f  amp_field: Optio
-00010320: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
-00010330: 0a20 2020 2020 2020 2074 696d 6573 7461  .        timesta
-00010340: 6d70 5f66 6f72 6d61 743a 204f 7074 696f  mp_format: Optio
-00010350: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
-00010360: 0a20 2020 2020 2020 2064 6174 6574 696d  .        datetim
-00010370: 655f 7061 7274 6974 696f 6e5f 636f 6c75  e_partition_colu
-00010380: 6d6e 733a 204f 7074 696f 6e61 6c5b 4c69  mns: Optional[Li
-00010390: 7374 5b44 6174 6574 696d 6550 6172 7469  st[DatetimeParti
-000103a0: 7469 6f6e 436f 6c75 6d6e 5d5d 203d 204e  tionColumn]] = N
-000103b0: 6f6e 652c 0a20 2020 2020 2020 2070 6f73  one,.        pos
-000103c0: 745f 7072 6f63 6573 736f 723a 204f 7074  t_processor: Opt
-000103d0: 696f 6e61 6c5b 4361 6c6c 6162 6c65 5d20  ional[Callable] 
-000103e0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-000103f0: 6461 7461 5f64 656c 6179 3a20 6461 7465  data_delay: date
-00010400: 7469 6d65 2e74 696d 6564 656c 7461 203d  time.timedelta =
-00010410: 2064 6174 6574 696d 652e 7469 6d65 6465   datetime.timede
-00010420: 6c74 6128 7365 636f 6e64 733d 3029 2c0a  lta(seconds=0),.
-00010430: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
-00010440: 2222 0a20 2020 2020 2020 2049 6e73 7461  "".        Insta
-00010450: 6e74 6961 7465 7320 6120 6e65 7720 4869  ntiates a new Hi
-00010460: 7665 436f 6e66 6967 2e0a 0a20 2020 2020  veConfig...     
-00010470: 2020 203a 7061 7261 6d20 7461 626c 653a     :param table:
-00010480: 2041 2074 6162 6c65 2072 6567 6973 7465   A table registe
-00010490: 7265 6420 696e 2048 6976 6520 4d65 7461  red in Hive Meta
-000104a0: 5374 6f72 652e 0a20 2020 2020 2020 203a  Store..        :
-000104b0: 7061 7261 6d20 6461 7461 6261 7365 3a20  param database: 
-000104c0: 4120 6461 7461 6261 7365 2072 6567 6973  A database regis
-000104d0: 7465 7265 6420 696e 2048 6976 6520 4d65  tered in Hive Me
-000104e0: 7461 5374 6f72 652e 0a20 2020 2020 2020  taStore..       
-000104f0: 203a 7061 7261 6d20 7469 6d65 7374 616d   :param timestam
-00010500: 705f 6669 656c 643a 2054 6865 2074 696d  p_field: The tim
-00010510: 6573 7461 6d70 2063 6f6c 756d 6e20 696e  estamp column in
-00010520: 2074 6869 7320 6461 7461 2073 6f75 7263   this data sourc
-00010530: 6520 7468 6174 2073 686f 756c 6420 6265  e that should be
-00010540: 2075 7365 6420 6279 2060 4669 6c74 6572   used by `Filter
-00010550: 6564 536f 7572 6365 600a 2020 2020 2020  edSource`.      
-00010560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010570: 2020 2020 2020 2020 2020 2020 2020 746f                to
-00010580: 2066 696c 7465 7220 6461 7461 2066 726f   filter data fro
-00010590: 6d20 7468 6973 2073 6f75 7263 652c 2062  m this source, b
-000105a0: 6566 6f72 6520 616e 7920 6665 6174 7572  efore any featur
-000105b0: 6520 7669 6577 2074 7261 6e73 666f 726d  e view transform
-000105c0: 6174 696f 6e73 2061 7265 2061 7070 6c69  ations are appli
-000105d0: 6564 2e0a 2020 2020 2020 2020 2020 2020  ed..            
-000105e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000105f0: 2020 2020 2020 2020 4f6e 6c79 2072 6571          Only req
-00010600: 7569 7265 6420 6966 2074 6869 7320 736f  uired if this so
-00010610: 7572 6365 2069 7320 7573 6564 2077 6974  urce is used wit
-00010620: 6820 6046 696c 7465 7265 6453 6f75 7263  h `FilteredSourc
-00010630: 6560 2e0a 2020 2020 2020 2020 3a70 6172  e`..        :par
-00010640: 616d 2074 696d 6573 7461 6d70 5f66 6f72  am timestamp_for
-00010650: 6d61 743a 2046 6f72 6d61 7420 6f66 2073  mat: Format of s
-00010660: 7472 696e 672d 656e 636f 6465 6420 7469  tring-encoded ti
-00010670: 6d65 7374 616d 7020 636f 6c75 6d6e 2028  mestamp column (
-00010680: 652e 672e 2022 7979 7979 2d4d 4d2d 6464  e.g. "yyyy-MM-dd
-00010690: 2754 2768 683a 6d6d 3a73 732e 5353 5327  'T'hh:mm:ss.SSS'
-000106a0: 5a27 2229 2e0a 2020 2020 2020 2020 2020  Z'")..          
-000106b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000106c0: 2020 2020 2020 2049 6620 7468 6520 7469         If the ti
-000106d0: 6d65 7374 616d 7020 7374 7269 6e67 2063  mestamp string c
-000106e0: 616e 6e6f 7420 6265 2070 6172 7365 6420  annot be parsed 
-000106f0: 7769 7468 2074 6869 7320 666f 726d 6174  with this format
-00010700: 2c20 5465 6374 6f6e 2077 696c 6c20 6661  , Tecton will fa
-00010710: 6c6c 6261 636b 2061 6e64 2061 7474 656d  llback and attem
-00010720: 7074 2074 6f0a 2020 2020 2020 2020 2020  pt to.          
-00010730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010740: 2020 2020 2020 2075 7365 2074 6865 2064         use the d
-00010750: 6566 6175 6c74 2074 696d 6573 7461 6d70  efault timestamp
-00010760: 2070 6172 7365 722e 0a20 2020 2020 2020   parser..       
-00010770: 203a 7061 7261 6d20 6461 7465 7469 6d65   :param datetime
-00010780: 5f70 6172 7469 7469 6f6e 5f63 6f6c 756d  _partition_colum
-00010790: 6e73 3a20 4c69 7374 206f 6620 4461 7465  ns: List of Date
-000107a0: 7469 6d65 5061 7274 6974 696f 6e43 6f6c  timePartitionCol
-000107b0: 756d 6e20 7468 6520 7261 7720 6461 7461  umn the raw data
-000107c0: 2069 7320 7061 7274 6974 696f 6e65 6420   is partitioned 
-000107d0: 6279 2c20 6f74 6865 7277 6973 6520 4e6f  by, otherwise No
-000107e0: 6e65 2e0a 2020 2020 2020 2020 3a70 6172  ne..        :par
-000107f0: 616d 2070 6f73 745f 7072 6f63 6573 736f  am post_processo
-00010800: 723a 2050 7974 686f 6e20 7573 6572 2064  r: Python user d
-00010810: 6566 696e 6564 2066 756e 6374 696f 6e20  efined function 
-00010820: 6060 6628 4461 7461 4672 616d 6529 202d  ``f(DataFrame) -
-00010830: 3e20 4461 7461 4672 616d 6560 6020 7468  > DataFrame`` th
-00010840: 6174 2074 616b 6573 2069 6e20 7261 770a  at takes in raw.
-00010850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010870: 2020 2020 2050 7953 7061 726b 2064 6174       PySpark dat
-00010880: 6120 736f 7572 6365 2044 6174 6146 7261  a source DataFra
-00010890: 6d65 2061 6e64 2074 7261 6e73 6c61 7465  me and translate
-000108a0: 7320 6974 2074 6f20 7468 6520 4461 7461  s it to the Data
-000108b0: 4672 616d 6520 746f 2062 650a 2020 2020  Frame to be.    
-000108c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000108d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000108e0: 2063 6f6e 7375 6d65 6420 6279 2074 6865   consumed by the
-000108f0: 2046 6561 7475 7265 2056 6965 772e 0a20   Feature View.. 
-00010900: 2020 2020 2020 203a 7061 7261 6d20 6461         :param da
-00010910: 7461 5f64 656c 6179 3a20 4279 2064 6566  ta_delay: By def
-00010920: 6175 6c74 2c20 696e 6372 656d 656e 7461  ault, incrementa
-00010930: 6c20 6d61 7465 7269 616c 697a 6174 696f  l materializatio
-00010940: 6e20 6a6f 6273 2072 756e 2069 6d6d 6564  n jobs run immed
-00010950: 6961 7465 6c79 2061 7420 7468 6520 656e  iately at the en
-00010960: 6420 6f66 2074 6865 0a20 2020 2020 2020  d of the.       
+0000ef90: 2020 2020 7265 6769 6f6e 3d27 7573 2d77      region='us-w
+0000efa0: 6573 742d 3227 2c0a 2020 2020 2020 2020  est-2',.        
+0000efb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000efc0: 2020 2020 2020 2020 2020 2020 696e 6974              init
+0000efd0: 6961 6c5f 7374 7265 616d 5f70 6f73 6974  ial_stream_posit
+0000efe0: 696f 6e3d 276c 6174 6573 7427 2c0a 2020  ion='latest',.  
+0000eff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f010: 2020 7469 6d65 7374 616d 705f 6669 656c    timestamp_fiel
+0000f020: 643d 2774 696d 6573 7461 6d70 272c 0a20  d='timestamp',. 
+0000f030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f050: 2020 2070 6f73 745f 7072 6f63 6573 736f     post_processo
+0000f060: 723d 7261 775f 6461 7461 5f64 6573 6572  r=raw_data_deser
+0000f070: 6961 6c69 7a61 7469 6f6e 2c0a 2020 2020  ialization,.    
+0000f080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f0a0: 6f70 7469 6f6e 733d 7b27 726f 6c65 4172  options={'roleAr
+0000f0b0: 6e27 3a20 2761 726e 3a61 7773 3a69 616d  n': 'arn:aws:iam
+0000f0c0: 3a3a 3437 3235 3432 3232 3932 3137 3a72  ::472542229217:r
+0000f0d0: 6f6c 652f 6465 6d6f 2d63 726f 7373 2d61  ole/demo-cross-a
+0000f0e0: 6363 6f75 6e74 2d6b 696e 6573 6973 2d72  ccount-kinesis-r
+0000f0f0: 6f27 7d0a 2020 2020 2020 2020 2020 2020  o'}.            
+0000f100: 290a 2020 2020 2020 2020 2222 220a 0a20  ).        """.. 
+0000f110: 2020 2020 2020 2061 7267 7320 3d20 6461         args = da
+0000f120: 7461 5f73 6f75 7263 655f 7062 322e 4b69  ta_source_pb2.Ki
+0000f130: 6e65 7369 7344 6174 6153 6f75 7263 6541  nesisDataSourceA
+0000f140: 7267 7328 290a 2020 2020 2020 2020 6172  rgs().        ar
+0000f150: 6773 2e73 7472 6561 6d5f 6e61 6d65 203d  gs.stream_name =
+0000f160: 2073 7472 6561 6d5f 6e61 6d65 0a20 2020   stream_name.   
+0000f170: 2020 2020 2061 7267 732e 7265 6769 6f6e       args.region
+0000f180: 203d 2072 6567 696f 6e0a 2020 2020 2020   = region.      
+0000f190: 2020 6966 2066 756e 6374 696f 6e5f 7365    if function_se
+0000f1a0: 7269 616c 697a 6174 696f 6e2e 7368 6f75  rialization.shou
+0000f1b0: 6c64 5f73 6572 6961 6c69 7a65 5f66 756e  ld_serialize_fun
+0000f1c0: 6374 696f 6e28 706f 7374 5f70 726f 6365  ction(post_proce
+0000f1d0: 7373 6f72 293a 0a20 2020 2020 2020 2020  ssor):.         
+0000f1e0: 2020 2061 7267 732e 636f 6d6d 6f6e 5f61     args.common_a
+0000f1f0: 7267 732e 706f 7374 5f70 726f 6365 7373  rgs.post_process
+0000f200: 6f72 2e43 6f70 7946 726f 6d28 6675 6e63  or.CopyFrom(func
+0000f210: 7469 6f6e 5f73 6572 6961 6c69 7a61 7469  tion_serializati
+0000f220: 6f6e 2e74 6f5f 7072 6f74 6f28 706f 7374  on.to_proto(post
+0000f230: 5f70 726f 6365 7373 6f72 2929 0a20 2020  _processor)).   
+0000f240: 2020 2020 2061 7267 732e 636f 6d6d 6f6e       args.common
+0000f250: 5f61 7267 732e 7469 6d65 7374 616d 705f  _args.timestamp_
+0000f260: 6669 656c 6420 3d20 7469 6d65 7374 616d  field = timestam
+0000f270: 705f 6669 656c 640a 2020 2020 2020 2020  p_field.        
+0000f280: 6966 2069 6e69 7469 616c 5f73 7472 6561  if initial_strea
+0000f290: 6d5f 706f 7369 7469 6f6e 3a0a 2020 2020  m_position:.    
+0000f2a0: 2020 2020 2020 2020 6172 6773 2e69 6e69          args.ini
+0000f2b0: 7469 616c 5f73 7472 6561 6d5f 706f 7369  tial_stream_posi
+0000f2c0: 7469 6f6e 203d 2064 6174 615f 736f 7572  tion = data_sour
+0000f2d0: 6365 5f68 656c 7065 722e 494e 4954 4941  ce_helper.INITIA
+0000f2e0: 4c5f 5354 5245 414d 5f50 4f53 4954 494f  L_STREAM_POSITIO
+0000f2f0: 4e5f 5354 525f 544f 5f45 4e55 4d5b 0a20  N_STR_TO_ENUM[. 
+0000f300: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000f310: 6e69 7469 616c 5f73 7472 6561 6d5f 706f  nitial_stream_po
+0000f320: 7369 7469 6f6e 0a20 2020 2020 2020 2020  sition.         
+0000f330: 2020 205d 0a20 2020 2020 2020 2069 6620     ].        if 
+0000f340: 7761 7465 726d 6172 6b5f 6465 6c61 795f  watermark_delay_
+0000f350: 7468 7265 7368 6f6c 643a 0a20 2020 2020  threshold:.     
+0000f360: 2020 2020 2020 2061 7267 732e 636f 6d6d         args.comm
+0000f370: 6f6e 5f61 7267 732e 7761 7465 726d 6172  on_args.watermar
+0000f380: 6b5f 6465 6c61 795f 7468 7265 7368 6f6c  k_delay_threshol
+0000f390: 642e 4672 6f6d 5469 6d65 6465 6c74 6128  d.FromTimedelta(
+0000f3a0: 7761 7465 726d 6172 6b5f 6465 6c61 795f  watermark_delay_
+0000f3b0: 7468 7265 7368 6f6c 6429 0a20 2020 2020  threshold).     
+0000f3c0: 2020 2069 6620 6465 6475 706c 6963 6174     if deduplicat
+0000f3d0: 696f 6e5f 636f 6c75 6d6e 733a 0a20 2020  ion_columns:.   
+0000f3e0: 2020 2020 2020 2020 2066 6f72 2063 6f6c           for col
+0000f3f0: 756d 6e5f 6e61 6d65 2069 6e20 6465 6475  umn_name in dedu
+0000f400: 706c 6963 6174 696f 6e5f 636f 6c75 6d6e  plication_column
+0000f410: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+0000f420: 2020 2061 7267 732e 636f 6d6d 6f6e 5f61     args.common_a
+0000f430: 7267 732e 6465 6475 706c 6963 6174 696f  rgs.deduplicatio
+0000f440: 6e5f 636f 6c75 6d6e 732e 6170 7065 6e64  n_columns.append
+0000f450: 2863 6f6c 756d 6e5f 6e61 6d65 290a 2020  (column_name).  
+0000f460: 2020 2020 2020 6f70 7469 6f6e 735f 203d        options_ =
+0000f470: 206f 7074 696f 6e73 206f 7220 7b7d 0a20   options or {}. 
+0000f480: 2020 2020 2020 2066 6f72 206b 6579 2069         for key i
+0000f490: 6e20 736f 7274 6564 286f 7074 696f 6e73  n sorted(options
+0000f4a0: 5f2e 6b65 7973 2829 293a 0a20 2020 2020  _.keys()):.     
+0000f4b0: 2020 2020 2020 206f 7074 696f 6e20 3d20         option = 
+0000f4c0: 6461 7461 5f73 6f75 7263 655f 7062 322e  data_source_pb2.
+0000f4d0: 4f70 7469 6f6e 2829 0a20 2020 2020 2020  Option().       
+0000f4e0: 2020 2020 206f 7074 696f 6e2e 6b65 7920       option.key 
+0000f4f0: 3d20 6b65 790a 2020 2020 2020 2020 2020  = key.          
+0000f500: 2020 6f70 7469 6f6e 2e76 616c 7565 203d    option.value =
+0000f510: 206f 7074 696f 6e73 5f5b 6b65 795d 0a20   options_[key]. 
+0000f520: 2020 2020 2020 2020 2020 2061 7267 732e             args.
+0000f530: 6f70 7469 6f6e 732e 6170 7065 6e64 286f  options.append(o
+0000f540: 7074 696f 6e29 0a0a 2020 2020 2020 2020  ption)..        
+0000f550: 7365 6c66 2e5f 6172 6773 203d 2061 7267  self._args = arg
+0000f560: 730a 2020 2020 2020 2020 7365 6c66 2e70  s.        self.p
+0000f570: 6f73 745f 7072 6f63 6573 736f 7220 3d20  ost_processor = 
+0000f580: 706f 7374 5f70 726f 6365 7373 6f72 0a0a  post_processor..
+0000f590: 2020 2020 6465 6620 5f6d 6572 6765 5f73      def _merge_s
+0000f5a0: 7472 6561 6d5f 6172 6773 2873 656c 662c  tream_args(self,
+0000f5b0: 2064 6174 615f 736f 7572 6365 5f61 7267   data_source_arg
+0000f5c0: 733a 2076 6972 7475 616c 5f64 6174 615f  s: virtual_data_
+0000f5d0: 736f 7572 6365 5f70 6232 2e56 6972 7475  source_pb2.Virtu
+0000f5e0: 616c 4461 7461 536f 7572 6365 4172 6773  alDataSourceArgs
+0000f5f0: 293a 0a20 2020 2020 2020 2064 6174 615f  ):.        data_
+0000f600: 736f 7572 6365 5f61 7267 732e 6b69 6e65  source_args.kine
+0000f610: 7369 735f 6473 5f63 6f6e 6669 672e 436f  sis_ds_config.Co
+0000f620: 7079 4672 6f6d 2873 656c 662e 5f61 7267  pyFrom(self._arg
+0000f630: 7329 0a0a 0a63 6c61 7373 2050 7573 6843  s)...class PushC
+0000f640: 6f6e 6669 6728 4261 7365 5374 7265 616d  onfig(BaseStream
+0000f650: 436f 6e66 6967 293a 0a20 2020 2022 2222  Config):.    """
+0000f660: 0a20 2020 2054 6865 2050 7573 6843 6f6e  .    The PushCon
+0000f670: 6669 6720 636c 6173 7320 6973 2075 7365  fig class is use
+0000f680: 6420 746f 2063 6f6e 6669 6775 7265 2074  d to configure t
+0000f690: 6865 2053 7472 6561 6d20 496e 6765 7374  he Stream Ingest
+0000f6a0: 2041 5049 2074 6f20 616c 6c6f 7720 696e   API to allow in
+0000f6b0: 6765 7374 696f 6e20 6f66 0a20 2020 2072  gestion of.    r
+0000f6c0: 6563 6f72 6473 2076 6961 2074 6865 2053  ecords via the S
+0000f6d0: 7472 6561 6d20 496e 6765 7374 2041 5049  tream Ingest API
+0000f6e0: 2e0a 0a20 2020 2054 6869 7320 636c 6173  ...    This clas
+0000f6f0: 7320 6973 2075 7365 6420 6173 2061 6e20  s is used as an 
+0000f700: 696e 7075 7420 746f 2061 203a 636c 6173  input to a :clas
+0000f710: 733a 6053 7472 6561 6d53 6f75 7263 6560  s:`StreamSource`
+0000f720: 2773 2070 6172 616d 6574 6572 2060 6073  's parameter ``s
+0000f730: 7472 6561 6d5f 636f 6e66 6967 6060 2e20  tream_config``. 
+0000f740: 4465 636c 6172 696e 6720 7468 6973 2063  Declaring this c
+0000f750: 6f6e 6669 6775 7261 7469 6f6e 0a20 2020  onfiguration.   
+0000f760: 2063 6c61 7373 2061 6c6f 6e65 2077 696c   class alone wil
+0000f770: 6c20 6e6f 7420 7265 6769 7374 6572 2061  l not register a
+0000f780: 2044 6174 6120 536f 7572 6365 2e20 496e   Data Source. In
+0000f790: 7374 6561 642c 2064 6563 6c61 7265 2061  stead, declare a
+0000f7a0: 7320 6120 7061 7274 206f 6620 6060 5374  s a part of ``St
+0000f7b0: 7265 616d 536f 7572 6365 6060 2074 6861  reamSource`` tha
+0000f7c0: 7420 7461 6b65 7320 7468 6973 2063 6f6e  t takes this con
+0000f7d0: 6669 6775 7261 7469 6f6e 0a20 2020 2063  figuration.    c
+0000f7e0: 6c61 7373 2069 6e73 7461 6e63 6520 6173  lass instance as
+0000f7f0: 2061 2070 6172 616d 6574 6572 2e0a 2020   a parameter..  
+0000f800: 2020 2222 220a 0a20 2020 2064 6566 205f    """..    def _
+0000f810: 5f69 6e69 745f 5f28 0a20 2020 2020 2020  _init__(.       
+0000f820: 2073 656c 662c 0a20 2020 2020 2020 206c   self,.        l
+0000f830: 6f67 5f6f 6666 6c69 6e65 3a20 626f 6f6c  og_offline: bool
+0000f840: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
+0000f850: 2020 706f 7374 5f70 726f 6365 7373 6f72    post_processor
+0000f860: 3a20 4f70 7469 6f6e 616c 5b0a 2020 2020  : Optional[.    
+0000f870: 2020 2020 2020 2020 556e 696f 6e5b 4361          Union[Ca
+0000f880: 6c6c 6162 6c65 5b5b 4469 6374 5d2c 204f  llable[[Dict], O
+0000f890: 7074 696f 6e61 6c5b 4469 6374 5d5d 2c20  ptional[Dict]], 
+0000f8a0: 4361 6c6c 6162 6c65 5b5b 7064 2e44 6174  Callable[[pd.Dat
+0000f8b0: 6146 7261 6d65 5d2c 204f 7074 696f 6e61  aFrame], Optiona
+0000f8c0: 6c5b 7064 2e44 6174 6146 7261 6d65 5d5d  l[pd.DataFrame]]
+0000f8d0: 5d0a 2020 2020 2020 2020 5d20 3d20 4e6f  ].        ] = No
+0000f8e0: 6e65 2c0a 2020 2020 2020 2020 706f 7374  ne,.        post
+0000f8f0: 5f70 726f 6365 7373 6f72 5f6d 6f64 653a  _processor_mode:
+0000f900: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
+0000f910: 204e 6f6e 652c 0a20 2020 2020 2020 2069   None,.        i
+0000f920: 6e70 7574 5f73 6368 656d 613a 204f 7074  nput_schema: Opt
+0000f930: 696f 6e61 6c5b 4c69 7374 5b74 7970 6573  ional[List[types
+0000f940: 2e46 6965 6c64 5d5d 203d 204e 6f6e 652c  .Field]] = None,
+0000f950: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+0000f960: 2222 220a 2020 2020 2020 2020 496e 7374  """.        Inst
+0000f970: 616e 7469 6174 6573 2061 206e 6577 2050  antiates a new P
+0000f980: 7573 6843 6f6e 6669 672e 0a0a 2020 2020  ushConfig...    
+0000f990: 2020 2020 3a70 6172 616d 3a20 6c6f 675f      :param: log_
+0000f9a0: 6f66 666c 696e 653a 2049 6620 7365 7420  offline: If set 
+0000f9b0: 746f 2054 7275 652c 2074 6865 2053 7472  to True, the Str
+0000f9c0: 6561 6d20 496e 6765 7374 2041 5049 2077  eam Ingest API w
+0000f9d0: 696c 6c20 6c6f 6720 7468 6520 696e 636f  ill log the inco
+0000f9e0: 6d69 6e67 2072 6563 6f72 6473 2066 6f72  ming records for
+0000f9f0: 2074 6865 2070 7573 6820 736f 7572 6365   the push source
+0000fa00: 2074 6f20 616e 206f 6666 6c69 6e65 2074   to an offline t
+0000fa10: 6162 6c65 2e0a 2020 2020 2020 2020 3a70  able..        :p
+0000fa20: 6172 616d 3a20 706f 7374 5f70 726f 6365  aram: post_proce
+0000fa30: 7373 6f72 3a20 416e 206f 7074 696f 6e61  ssor: An optiona
+0000fa40: 6c20 7573 6572 2d64 6566 696e 6564 2066  l user-defined f
+0000fa50: 756e 6374 696f 6e20 7468 6174 2070 7265  unction that pre
+0000fa60: 2d70 726f 6365 7373 6573 2072 6563 6f72  -processes recor
+0000fa70: 6473 2069 6e20 7468 6520 736f 7572 6365  ds in the source
+0000fa80: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000fa90: 3a20 706f 7374 5f70 726f 6365 7373 6f72  : post_processor
+0000faa0: 5f6d 6f64 653a 2045 7865 6375 7469 6f6e  _mode: Execution
+0000fab0: 206d 6f64 6520 666f 7220 7468 6520 6070   mode for the `p
+0000fac0: 6f73 745f 7072 6f63 6573 736f 7260 2c20  ost_processor`, 
+0000fad0: 6d75 7374 2062 6520 6f6e 6520 6f66 2060  must be one of `
+0000fae0: 7079 7468 6f6e 6020 6f72 2060 7061 6e64  python` or `pand
+0000faf0: 6173 600a 2020 2020 2020 2020 3a70 6172  as`.        :par
+0000fb00: 616d 3a20 696e 7075 745f 7363 6865 6d61  am: input_schema
+0000fb10: 3a20 496e 7075 7420 7363 6865 6d61 2066  : Input schema f
+0000fb20: 6f72 2074 6865 2060 706f 7374 5f70 726f  or the `post_pro
+0000fb30: 6365 7373 6f72 600a 0a20 2020 2020 2020  cessor`..       
+0000fb40: 203a 7265 7475 726e 3a20 4120 5075 7368   :return: A Push
+0000fb50: 436f 6e66 6967 2063 6c61 7373 2069 6e73  Config class ins
+0000fb60: 7461 6e63 652e 0a0a 2020 2020 2020 2020  tance...        
+0000fb70: 2e2e 205f 5573 6572 2047 7569 6465 3a20  .. _User Guide: 
+0000fb80: 6874 7470 733a 2f2f 646f 6373 2e74 6563  https://docs.tec
+0000fb90: 746f 6e2e 6169 2f64 6f63 732f 6465 6669  ton.ai/docs/defi
+0000fba0: 6e69 6e67 2d66 6561 7475 7265 732f 6665  ning-features/fe
+0000fbb0: 6174 7572 652d 7669 6577 732f 7374 7265  ature-views/stre
+0000fbc0: 616d 2d66 6561 7475 7265 2d76 6965 772f  am-feature-view/
+0000fbd0: 7374 7265 616d 2d66 6561 7475 7265 2d76  stream-feature-v
+0000fbe0: 6965 772d 7769 7468 2d73 7472 6561 6d2d  iew-with-stream-
+0000fbf0: 696e 6765 7374 2d61 7069 0a0a 2020 2020  ingest-api..    
+0000fc00: 2020 2020 4578 616d 706c 6520 6f66 2061      Example of a
+0000fc10: 2050 7573 6843 6f6e 6669 6720 6465 636c   PushConfig decl
+0000fc20: 6172 6174 696f 6e3a 0a0a 2020 2020 2020  aration:..      
+0000fc30: 2020 2e2e 2063 6f64 652d 626c 6f63 6b3a    .. code-block:
+0000fc40: 3a20 7079 7468 6f6e 0a0a 2020 2020 2020  : python..      
+0000fc50: 2020 2020 2020 696d 706f 7274 2070 7973        import pys
+0000fc60: 7061 726b 0a20 2020 2020 2020 2020 2020  park.           
+0000fc70: 2066 726f 6d20 7465 6374 6f6e 2069 6d70   from tecton imp
+0000fc80: 6f72 7420 5075 7368 436f 6e66 6967 2c20  ort PushConfig, 
+0000fc90: 5374 7265 616d 536f 7572 6365 0a20 2020  StreamSource.   
+0000fca0: 2020 2020 2020 2020 2066 726f 6d20 7465           from te
+0000fcb0: 6374 6f6e 2e74 7970 6573 2069 6d70 6f72  cton.types impor
+0000fcc0: 7420 4669 656c 642c 2053 7472 696e 672c  t Field, String,
+0000fcd0: 2054 696d 6573 7461 6d70 2c20 496e 7436   Timestamp, Int6
+0000fce0: 340a 0a20 2020 2020 2020 2020 2020 2023  4..            #
+0000fcf0: 2044 6563 6c61 7265 2050 7573 6843 6f6e   Declare PushCon
+0000fd00: 6669 6720 696e 7374 616e 6365 206f 626a  fig instance obj
+0000fd10: 6563 7420 7468 6174 2063 616e 2062 6520  ect that can be 
+0000fd20: 7573 6564 2061 7320 6172 6775 6d65 6e74  used as argument
+0000fd30: 2069 6e20 6053 7472 6561 6d53 6f75 7263   in `StreamSourc
+0000fd40: 6560 0a20 2020 2020 2020 2020 2020 2073  e`.            s
+0000fd50: 7472 6561 6d5f 636f 6e66 6967 203d 2050  tream_config = P
+0000fd60: 7573 6843 6f6e 6669 6728 290a 2020 2020  ushConfig().    
+0000fd70: 2020 2020 2020 2020 736f 7572 6365 203d          source =
+0000fd80: 2053 7472 6561 6d53 6f75 7263 6528 0a20   StreamSource(. 
+0000fd90: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0000fda0: 616d 653d 226d 795f 7374 7265 616d 5f73  ame="my_stream_s
+0000fdb0: 6f75 7263 6522 2c0a 2020 2020 2020 2020  ource",.        
+0000fdc0: 2020 2020 2020 2020 7374 7265 616d 5f63          stream_c
+0000fdd0: 6f6e 6669 673d 7374 7265 616d 5f63 6f6e  onfig=stream_con
+0000fde0: 6669 672c 0a20 2020 2020 2020 2020 2020  fig,.           
+0000fdf0: 2020 2020 2073 6368 656d 613d 5b0a 2020       schema=[.  
+0000fe00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fe10: 2020 4669 656c 6428 2255 5345 525f 4944    Field("USER_ID
+0000fe20: 222c 2053 7472 696e 6729 2c0a 2020 2020  ", String),.    
+0000fe30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fe40: 4669 656c 6428 2254 494d 4553 5441 4d50  Field("TIMESTAMP
+0000fe50: 222c 2054 696d 6573 7461 6d70 292c 0a20  ", Timestamp),. 
+0000fe60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fe70: 2020 2046 6965 6c64 2822 5641 4c55 4522     Field("VALUE"
+0000fe80: 2c20 496e 7436 3429 2c0a 2020 2020 2020  , Int64),.      
+0000fe90: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
+0000fea0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0000feb0: 2020 2022 2222 0a20 2020 2020 2020 205f     """.        _
+0000fec0: 6d6f 6465 203d 2028 0a20 2020 2020 2020  mode = (.       
+0000fed0: 2020 2020 2067 6574 5f74 7261 6e73 666f       get_transfo
+0000fee0: 726d 6174 696f 6e5f 6d6f 6465 5f65 6e75  rmation_mode_enu
+0000fef0: 6d28 6d6f 6465 3d70 6f73 745f 7072 6f63  m(mode=post_proc
+0000ff00: 6573 736f 725f 6d6f 6465 2c20 6e61 6d65  essor_mode, name
+0000ff10: 3d22 5075 7368 436f 6e66 6967 2229 2069  ="PushConfig") i
+0000ff20: 6620 706f 7374 5f70 726f 6365 7373 6f72  f post_processor
+0000ff30: 5f6d 6f64 6520 656c 7365 204e 6f6e 650a  _mode else None.
+0000ff40: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000ff50: 2020 5f70 6f73 745f 7072 6f63 6573 736f    _post_processo
+0000ff60: 725f 6675 6e63 7469 6f6e 203d 2066 756e  r_function = fun
+0000ff70: 6374 696f 6e5f 7365 7269 616c 697a 6174  ction_serializat
+0000ff80: 696f 6e2e 746f 5f70 726f 746f 2870 6f73  ion.to_proto(pos
+0000ff90: 745f 7072 6f63 6573 736f 7229 2069 6620  t_processor) if 
+0000ffa0: 706f 7374 5f70 726f 6365 7373 6f72 2065  post_processor e
+0000ffb0: 6c73 6520 4e6f 6e65 0a20 2020 2020 2020  lse None.       
+0000ffc0: 2074 6563 746f 6e5f 7363 6865 6d61 203d   tecton_schema =
+0000ffd0: 2074 7970 655f 7574 696c 732e 746f 5f74   type_utils.to_t
+0000ffe0: 6563 746f 6e5f 7363 6865 6d61 2869 6e70  ecton_schema(inp
+0000fff0: 7574 5f73 6368 656d 6129 2069 6620 696e  ut_schema) if in
+00010000: 7075 745f 7363 6865 6d61 2065 6c73 6520  put_schema else 
+00010010: 4e6f 6e65 0a0a 2020 2020 2020 2020 7365  None..        se
+00010020: 6c66 2e5f 6172 6773 203d 2064 6174 615f  lf._args = data_
+00010030: 736f 7572 6365 5f70 6232 2e50 7573 6853  source_pb2.PushS
+00010040: 6f75 7263 6541 7267 7328 0a20 2020 2020  ourceArgs(.     
+00010050: 2020 2020 2020 206c 6f67 5f6f 6666 6c69         log_offli
+00010060: 6e65 3d6c 6f67 5f6f 6666 6c69 6e65 2c0a  ne=log_offline,.
+00010070: 2020 2020 2020 2020 2020 2020 706f 7374              post
+00010080: 5f70 726f 6365 7373 6f72 3d5f 706f 7374  _processor=_post
+00010090: 5f70 726f 6365 7373 6f72 5f66 756e 6374  _processor_funct
+000100a0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+000100b0: 2070 6f73 745f 7072 6f63 6573 736f 725f   post_processor_
+000100c0: 6d6f 6465 3d5f 6d6f 6465 2c0a 2020 2020  mode=_mode,.    
+000100d0: 2020 2020 2020 2020 696e 7075 745f 7363          input_sc
+000100e0: 6865 6d61 3d74 6563 746f 6e5f 7363 6865  hema=tecton_sche
+000100f0: 6d61 2c0a 2020 2020 2020 2020 290a 0a20  ma,.        ).. 
+00010100: 2020 2064 6566 205f 6d65 7267 655f 7374     def _merge_st
+00010110: 7265 616d 5f61 7267 7328 7365 6c66 2c20  ream_args(self, 
+00010120: 6461 7461 5f73 6f75 7263 655f 6172 6773  data_source_args
+00010130: 3a20 7669 7274 7561 6c5f 6461 7461 5f73  : virtual_data_s
+00010140: 6f75 7263 655f 7062 322e 5669 7274 7561  ource_pb2.Virtua
+00010150: 6c44 6174 6153 6f75 7263 6541 7267 7329  lDataSourceArgs)
+00010160: 3a0a 2020 2020 2020 2020 6461 7461 5f73  :.        data_s
+00010170: 6f75 7263 655f 6172 6773 2e70 7573 685f  ource_args.push_
+00010180: 636f 6e66 6967 2e43 6f70 7946 726f 6d28  config.CopyFrom(
+00010190: 7365 6c66 2e5f 6172 6773 290a 0a0a 636c  self._args)...cl
+000101a0: 6173 7320 4869 7665 436f 6e66 6967 2842  ass HiveConfig(B
+000101b0: 6173 6542 6174 6368 436f 6e66 6967 293a  aseBatchConfig):
+000101c0: 0a20 2020 2022 2222 0a20 2020 2043 6f6e  .    """.    Con
+000101d0: 6669 6775 7261 7469 6f6e 2075 7365 6420  figuration used 
+000101e0: 746f 2072 6566 6572 656e 6365 2061 2048  to reference a H
+000101f0: 6976 6520 7461 626c 652e 0a0a 2020 2020  ive table...    
+00010200: 5468 6520 4869 7665 436f 6e66 6967 2063  The HiveConfig c
+00010210: 6c61 7373 2069 7320 7573 6564 2074 6f20  lass is used to 
+00010220: 6372 6561 7465 2061 2072 6566 6572 656e  create a referen
+00010230: 6365 2074 6f20 6120 4869 7665 2054 6162  ce to a Hive Tab
+00010240: 6c65 2e0a 0a20 2020 2054 6869 7320 636c  le...    This cl
+00010250: 6173 7320 6973 2075 7365 6420 6173 2061  ass is used as a
+00010260: 6e20 696e 7075 7420 746f 2061 203a 636c  n input to a :cl
+00010270: 6173 733a 6042 6174 6368 536f 7572 6365  ass:`BatchSource
+00010280: 6027 7320 7061 7261 6d65 7465 7220 6060  `'s parameter ``
+00010290: 6261 7463 685f 636f 6e66 6967 6060 2e20  batch_config``. 
+000102a0: 4465 636c 6172 696e 6720 7468 6973 2063  Declaring this c
+000102b0: 6f6e 6669 6775 7261 7469 6f6e 0a20 2020  onfiguration.   
+000102c0: 2063 6c61 7373 2061 6c6f 6e65 2077 696c   class alone wil
+000102d0: 6c20 6e6f 7420 7265 6769 7374 6572 2061  l not register a
+000102e0: 2044 6174 6120 536f 7572 6365 2e20 496e   Data Source. In
+000102f0: 7374 6561 642c 2064 6563 6c61 7265 2061  stead, declare a
+00010300: 7320 6120 7061 7274 206f 6620 6060 4261  s a part of ``Ba
+00010310: 7463 6853 6f75 7263 6560 6020 7468 6174  tchSource`` that
+00010320: 2074 616b 6573 2074 6869 7320 636f 6e66   takes this conf
+00010330: 6967 7572 6174 696f 6e0a 2020 2020 636c  iguration.    cl
+00010340: 6173 7320 696e 7374 616e 6365 2061 7320  ass instance as 
+00010350: 6120 7061 7261 6d65 7465 722e 0a20 2020  a parameter..   
+00010360: 2022 2222 0a0a 2020 2020 6465 6620 5f5f   """..    def __
+00010370: 696e 6974 5f5f 280a 2020 2020 2020 2020  init__(.        
+00010380: 7365 6c66 2c0a 2020 2020 2020 2020 7461  self,.        ta
+00010390: 626c 653a 2073 7472 2c0a 2020 2020 2020  ble: str,.      
+000103a0: 2020 6461 7461 6261 7365 3a20 7374 722c    database: str,
+000103b0: 0a20 2020 2020 2020 2074 696d 6573 7461  .        timesta
+000103c0: 6d70 5f66 6965 6c64 3a20 4f70 7469 6f6e  mp_field: Option
+000103d0: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
+000103e0: 2020 2020 2020 2020 7469 6d65 7374 616d          timestam
+000103f0: 705f 666f 726d 6174 3a20 4f70 7469 6f6e  p_format: Option
+00010400: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
+00010410: 2020 2020 2020 2020 6461 7465 7469 6d65          datetime
+00010420: 5f70 6172 7469 7469 6f6e 5f63 6f6c 756d  _partition_colum
+00010430: 6e73 3a20 4f70 7469 6f6e 616c 5b4c 6973  ns: Optional[Lis
+00010440: 745b 4461 7465 7469 6d65 5061 7274 6974  t[DatetimePartit
+00010450: 696f 6e43 6f6c 756d 6e5d 5d20 3d20 4e6f  ionColumn]] = No
+00010460: 6e65 2c0a 2020 2020 2020 2020 706f 7374  ne,.        post
+00010470: 5f70 726f 6365 7373 6f72 3a20 4f70 7469  _processor: Opti
+00010480: 6f6e 616c 5b43 616c 6c61 626c 655d 203d  onal[Callable] =
+00010490: 204e 6f6e 652c 0a20 2020 2020 2020 2064   None,.        d
+000104a0: 6174 615f 6465 6c61 793a 2064 6174 6574  ata_delay: datet
+000104b0: 696d 652e 7469 6d65 6465 6c74 6120 3d20  ime.timedelta = 
+000104c0: 6461 7465 7469 6d65 2e74 696d 6564 656c  datetime.timedel
+000104d0: 7461 2873 6563 6f6e 6473 3d30 292c 0a20  ta(seconds=0),. 
+000104e0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+000104f0: 220a 2020 2020 2020 2020 496e 7374 616e  ".        Instan
+00010500: 7469 6174 6573 2061 206e 6577 2048 6976  tiates a new Hiv
+00010510: 6543 6f6e 6669 672e 0a0a 2020 2020 2020  eConfig...      
+00010520: 2020 3a70 6172 616d 2074 6162 6c65 3a20    :param table: 
+00010530: 4120 7461 626c 6520 7265 6769 7374 6572  A table register
+00010540: 6564 2069 6e20 4869 7665 204d 6574 6153  ed in Hive MetaS
+00010550: 746f 7265 2e0a 2020 2020 2020 2020 3a70  tore..        :p
+00010560: 6172 616d 2064 6174 6162 6173 653a 2041  aram database: A
+00010570: 2064 6174 6162 6173 6520 7265 6769 7374   database regist
+00010580: 6572 6564 2069 6e20 4869 7665 204d 6574  ered in Hive Met
+00010590: 6153 746f 7265 2e0a 2020 2020 2020 2020  aStore..        
+000105a0: 3a70 6172 616d 2074 696d 6573 7461 6d70  :param timestamp
+000105b0: 5f66 6965 6c64 3a20 5468 6520 7469 6d65  _field: The time
+000105c0: 7374 616d 7020 636f 6c75 6d6e 2069 6e20  stamp column in 
+000105d0: 7468 6973 2064 6174 6120 736f 7572 6365  this data source
+000105e0: 2074 6861 7420 7368 6f75 6c64 2062 6520   that should be 
+000105f0: 7573 6564 2062 7920 6046 696c 7465 7265  used by `Filtere
+00010600: 6453 6f75 7263 6560 0a20 2020 2020 2020  dSource`.       
+00010610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010620: 2020 2020 2020 2020 2020 2020 2074 6f20               to 
+00010630: 6669 6c74 6572 2064 6174 6120 6672 6f6d  filter data from
+00010640: 2074 6869 7320 736f 7572 6365 2c20 6265   this source, be
+00010650: 666f 7265 2061 6e79 2066 6561 7475 7265  fore any feature
+00010660: 2076 6965 7720 7472 616e 7366 6f72 6d61   view transforma
+00010670: 7469 6f6e 7320 6172 6520 6170 706c 6965  tions are applie
+00010680: 642e 0a20 2020 2020 2020 2020 2020 2020  d..             
+00010690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000106a0: 2020 2020 2020 204f 6e6c 7920 7265 7175         Only requ
+000106b0: 6972 6564 2069 6620 7468 6973 2073 6f75  ired if this sou
+000106c0: 7263 6520 6973 2075 7365 6420 7769 7468  rce is used with
+000106d0: 2060 4669 6c74 6572 6564 536f 7572 6365   `FilteredSource
+000106e0: 602e 0a20 2020 2020 2020 203a 7061 7261  `..        :para
+000106f0: 6d20 7469 6d65 7374 616d 705f 666f 726d  m timestamp_form
+00010700: 6174 3a20 466f 726d 6174 206f 6620 7374  at: Format of st
+00010710: 7269 6e67 2d65 6e63 6f64 6564 2074 696d  ring-encoded tim
+00010720: 6573 7461 6d70 2063 6f6c 756d 6e20 2865  estamp column (e
+00010730: 2e67 2e20 2279 7979 792d 4d4d 2d64 6427  .g. "yyyy-MM-dd'
+00010740: 5427 6868 3a6d 6d3a 7373 2e53 5353 275a  T'hh:mm:ss.SSS'Z
+00010750: 2722 292e 0a20 2020 2020 2020 2020 2020  '")..           
+00010760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010770: 2020 2020 2020 4966 2074 6865 2074 696d        If the tim
+00010780: 6573 7461 6d70 2073 7472 696e 6720 6361  estamp string ca
+00010790: 6e6e 6f74 2062 6520 7061 7273 6564 2077  nnot be parsed w
+000107a0: 6974 6820 7468 6973 2066 6f72 6d61 742c  ith this format,
+000107b0: 2054 6563 746f 6e20 7769 6c6c 2066 616c   Tecton will fal
+000107c0: 6c62 6163 6b20 616e 6420 6174 7465 6d70  lback and attemp
+000107d0: 7420 746f 0a20 2020 2020 2020 2020 2020  t to.           
+000107e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000107f0: 2020 2020 2020 7573 6520 7468 6520 6465        use the de
+00010800: 6661 756c 7420 7469 6d65 7374 616d 7020  fault timestamp 
+00010810: 7061 7273 6572 2e0a 2020 2020 2020 2020  parser..        
+00010820: 3a70 6172 616d 2064 6174 6574 696d 655f  :param datetime_
+00010830: 7061 7274 6974 696f 6e5f 636f 6c75 6d6e  partition_column
+00010840: 733a 204c 6973 7420 6f66 2044 6174 6574  s: List of Datet
+00010850: 696d 6550 6172 7469 7469 6f6e 436f 6c75  imePartitionColu
+00010860: 6d6e 2074 6865 2072 6177 2064 6174 6120  mn the raw data 
+00010870: 6973 2070 6172 7469 7469 6f6e 6564 2062  is partitioned b
+00010880: 792c 206f 7468 6572 7769 7365 204e 6f6e  y, otherwise Non
+00010890: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+000108a0: 6d20 706f 7374 5f70 726f 6365 7373 6f72  m post_processor
+000108b0: 3a20 5079 7468 6f6e 2075 7365 7220 6465  : Python user de
+000108c0: 6669 6e65 6420 6675 6e63 7469 6f6e 2060  fined function `
+000108d0: 6066 2844 6174 6146 7261 6d65 2920 2d3e  `f(DataFrame) ->
+000108e0: 2044 6174 6146 7261 6d65 6060 2074 6861   DataFrame`` tha
+000108f0: 7420 7461 6b65 7320 696e 2072 6177 0a20  t takes in raw. 
+00010900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010920: 2020 2020 5079 5370 6172 6b20 6461 7461      PySpark data
+00010930: 2073 6f75 7263 6520 4461 7461 4672 616d   source DataFram
+00010940: 6520 616e 6420 7472 616e 736c 6174 6573  e and translates
+00010950: 2069 7420 746f 2074 6865 2044 6174 6146   it to the DataF
+00010960: 7261 6d65 2074 6f20 6265 0a20 2020 2020  rame to be.     
 00010970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010980: 2020 2020 2020 2020 2020 2020 2062 6174               bat
-00010990: 6368 2073 6368 6564 756c 6520 7065 7269  ch schedule peri
-000109a0: 6f64 2e20 5468 6973 2070 6172 616d 6574  od. This paramet
-000109b0: 6572 2063 6f6e 6669 6775 7265 7320 686f  er configures ho
-000109c0: 7720 6c6f 6e67 2074 6865 7920 7761 6974  w long they wait
-000109d0: 2061 6674 6572 2074 6865 2065 6e64 0a20   after the end. 
-000109e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000109f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010a00: 2020 206f 6620 7468 6520 7065 7269 6f64     of the period
-00010a10: 2062 6566 6f72 6520 7374 6172 7469 6e67   before starting
-00010a20: 2c20 7479 7069 6361 6c6c 7920 746f 2065  , typically to e
-00010a30: 6e73 7572 6520 7468 6174 2061 6c6c 2064  nsure that all d
-00010a40: 6174 6120 6861 7320 6c61 6e64 6564 2e0a  ata has landed..
-00010a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010a70: 2020 2020 466f 7220 6578 616d 706c 652c      For example,
-00010a80: 2069 6620 6120 6665 6174 7572 6520 7669   if a feature vi
-00010a90: 6577 2068 6173 2061 2060 6261 7463 685f  ew has a `batch_
-00010aa0: 7363 6865 6475 6c65 6020 6f66 2031 2064  schedule` of 1 d
-00010ab0: 6179 2061 6e64 206f 6e65 206f 660a 2020  ay and one of.  
-00010ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ae0: 2020 7468 6520 6461 7461 2073 6f75 7263    the data sourc
-00010af0: 6520 696e 7075 7473 2068 6173 2060 6461  e inputs has `da
-00010b00: 7461 5f64 656c 6179 3d74 696d 6564 656c  ta_delay=timedel
-00010b10: 7461 2868 6f75 7273 3d31 2960 2073 6574  ta(hours=1)` set
-00010b20: 2c20 7468 656e 0a20 2020 2020 2020 2020  , then.         
-00010b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010b40: 2020 2020 2020 2020 2020 2069 6e63 7265             incre
-00010b50: 6d65 6e74 616c 206d 6174 6572 6961 6c69  mental materiali
-00010b60: 7a61 7469 6f6e 206a 6f62 7320 7769 6c6c  zation jobs will
-00010b70: 2072 756e 2061 7420 6030 313a 3030 6020   run at `01:00` 
-00010b80: 5554 432e 0a0a 2020 2020 2020 2020 3a72  UTC...        :r
-00010b90: 6574 7572 6e3a 2041 2048 6976 6543 6f6e  eturn: A HiveCon
-00010ba0: 6669 6720 636c 6173 7320 696e 7374 616e  fig class instan
-00010bb0: 6365 2e0a 0a0a 2020 2020 2020 2020 4578  ce....        Ex
-00010bc0: 616d 706c 6520 6f66 2061 2048 6976 6543  ample of a HiveC
-00010bd0: 6f6e 6669 6720 6465 636c 6172 6174 696f  onfig declaratio
-00010be0: 6e3a 0a0a 2020 2020 2020 2020 2e2e 2063  n:..        .. c
-00010bf0: 6f64 652d 626c 6f63 6b3a 3a20 7079 7468  ode-block:: pyth
-00010c00: 6f6e 0a0a 2020 2020 2020 2020 2020 2020  on..            
-00010c10: 6672 6f6d 2074 6563 746f 6e20 696d 706f  from tecton impo
-00010c20: 7274 2048 6976 6543 6f6e 6669 670a 2020  rt HiveConfig.  
-00010c30: 2020 2020 2020 2020 2020 696d 706f 7274            import
-00010c40: 2070 7973 7061 726b 0a0a 2020 2020 2020   pyspark..      
-00010c50: 2020 2020 2020 6465 6620 636f 6e76 6572        def conver
-00010c60: 745f 7465 6d70 6572 6174 7572 6528 6466  t_temperature(df
-00010c70: 3a20 7079 7370 6172 6b2e 7371 6c2e 4461  : pyspark.sql.Da
-00010c80: 7461 4672 616d 6529 202d 3e20 7079 7370  taFrame) -> pysp
-00010c90: 6172 6b2e 7371 6c2e 4461 7461 4672 616d  ark.sql.DataFram
-00010ca0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00010cb0: 2020 2066 726f 6d20 7079 7370 6172 6b2e     from pyspark.
-00010cc0: 7371 6c2e 6675 6e63 7469 6f6e 7320 696d  sql.functions im
-00010cd0: 706f 7274 2075 6466 2c63 6f6c 0a20 2020  port udf,col.   
-00010ce0: 2020 2020 2020 2020 2020 2020 2066 726f               fro
-00010cf0: 6d20 7079 7370 6172 6b2e 7371 6c2e 7479  m pyspark.sql.ty
-00010d00: 7065 7320 696d 706f 7274 2044 6f75 626c  pes import Doubl
-00010d10: 6554 7970 650a 0a20 2020 2020 2020 2020  eType..         
-00010d20: 2020 2020 2020 2023 2043 6f6e 7665 7274         # Convert
-00010d30: 2074 6865 2069 6e63 6f6d 696e 6720 5079   the incoming Py
-00010d40: 5370 6172 6b20 4461 7461 4672 616d 6520  Spark DataFrame 
-00010d50: 7465 6d70 6572 6174 7572 6520 4365 6c73  temperature Cels
-00010d60: 6975 7320 746f 2046 6168 7265 6e68 6569  ius to Fahrenhei
-00010d70: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
-00010d80: 2020 7564 665f 636f 6e76 6572 7420 3d20    udf_convert = 
-00010d90: 7564 6628 6c61 6d62 6461 2078 3a20 7820  udf(lambda x: x 
-00010da0: 2a20 312e 3820 2b20 3332 2e30 2c20 446f  * 1.8 + 32.0, Do
-00010db0: 7562 6c65 5479 7065 2829 290a 2020 2020  ubleType()).    
-00010dc0: 2020 2020 2020 2020 2020 2020 636f 6e76              conv
-00010dd0: 6572 7465 645f 6466 203d 2064 662e 7769  erted_df = df.wi
-00010de0: 7468 436f 6c75 6d6e 2822 4661 6872 656e  thColumn("Fahren
-00010df0: 6865 6974 222c 2075 6466 5f63 6f6e 7665  heit", udf_conve
-00010e00: 7274 2863 6f6c 2822 5465 6d70 6572 6174  rt(col("Temperat
-00010e10: 7572 6522 2929 292e 6472 6f70 2822 5465  ure"))).drop("Te
-00010e20: 6d70 6572 6174 7572 6522 290a 2020 2020  mperature").    
-00010e30: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00010e40: 726e 2063 6f6e 7665 7274 6564 5f64 660a  rn converted_df.
-00010e50: 0a20 2020 2020 2020 2020 2020 2023 2064  .            # d
-00010e60: 6563 6c61 7265 2061 2048 6976 6543 6f6e  eclare a HiveCon
-00010e70: 6669 6720 696e 7374 616e 6365 2c20 7768  fig instance, wh
-00010e80: 6963 6820 6361 6e20 6265 2075 7365 6420  ich can be used 
-00010e90: 6173 2061 2070 6172 616d 6574 6572 2074  as a parameter t
-00010ea0: 6f20 6120 4261 7463 6853 6f75 7263 650a  o a BatchSource.
-00010eb0: 2020 2020 2020 2020 2020 2020 6261 7463              batc
-00010ec0: 685f 636f 6e66 6967 3d48 6976 6543 6f6e  h_config=HiveCon
-00010ed0: 6669 6728 6461 7461 6261 7365 3d27 676c  fig(database='gl
-00010ee0: 6f62 616c 5f74 656d 7065 7261 7475 7265  obal_temperature
-00010ef0: 7327 2c0a 2020 2020 2020 2020 2020 2020  s',.            
-00010f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010f10: 2020 2020 2020 2020 2020 2020 7461 626c              tabl
-00010f20: 653d 2775 735f 6369 7469 6573 272c 0a20  e='us_cities',. 
-00010f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010f50: 2020 2020 2020 2074 696d 6573 7461 6d70         timestamp
-00010f60: 5f66 6965 6c64 3d27 7469 6d65 7374 616d  _field='timestam
-00010f70: 7027 2c0a 2020 2020 2020 2020 2020 2020  p',.            
-00010f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010f90: 2020 2020 2020 2020 2020 2020 706f 7374              post
-00010fa0: 5f70 726f 6365 7373 6f72 3d63 6f6e 7665  _processor=conve
-00010fb0: 7274 5f74 656d 7065 7261 7475 7265 290a  rt_temperature).
-00010fc0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00010fd0: 2020 2020 2073 656c 662e 5f61 7267 7320       self._args 
-00010fe0: 3d20 6461 7461 5f73 6f75 7263 655f 7062  = data_source_pb
-00010ff0: 322e 4869 7665 4461 7461 536f 7572 6365  2.HiveDataSource
-00011000: 4172 6773 2829 0a20 2020 2020 2020 2073  Args().        s
-00011010: 656c 662e 5f61 7267 732e 7461 626c 6520  elf._args.table 
-00011020: 3d20 7461 626c 650a 2020 2020 2020 2020  = table.        
-00011030: 7365 6c66 2e5f 6172 6773 2e64 6174 6162  self._args.datab
-00011040: 6173 6520 3d20 6461 7461 6261 7365 0a20  ase = database. 
-00011050: 2020 2020 2020 2069 6620 7469 6d65 7374         if timest
-00011060: 616d 705f 6669 656c 643a 0a20 2020 2020  amp_field:.     
-00011070: 2020 2020 2020 2073 656c 662e 5f61 7267         self._arg
-00011080: 732e 636f 6d6d 6f6e 5f61 7267 732e 7469  s.common_args.ti
-00011090: 6d65 7374 616d 705f 6669 656c 6420 3d20  mestamp_field = 
-000110a0: 7469 6d65 7374 616d 705f 6669 656c 640a  timestamp_field.
-000110b0: 2020 2020 2020 2020 6966 2074 696d 6573          if times
-000110c0: 7461 6d70 5f66 6f72 6d61 743a 0a20 2020  tamp_format:.   
-000110d0: 2020 2020 2020 2020 2073 656c 662e 5f61           self._a
-000110e0: 7267 732e 7469 6d65 7374 616d 705f 666f  rgs.timestamp_fo
-000110f0: 726d 6174 203d 2074 696d 6573 7461 6d70  rmat = timestamp
-00011100: 5f66 6f72 6d61 740a 0a20 2020 2020 2020  _format..       
-00011110: 2069 6620 6461 7465 7469 6d65 5f70 6172   if datetime_par
-00011120: 7469 7469 6f6e 5f63 6f6c 756d 6e73 3a0a  tition_columns:.
-00011130: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00011140: 636f 6c75 6d6e 2069 6e20 6461 7465 7469  column in dateti
-00011150: 6d65 5f70 6172 7469 7469 6f6e 5f63 6f6c  me_partition_col
-00011160: 756d 6e73 3a0a 2020 2020 2020 2020 2020  umns:.          
-00011170: 2020 2020 2020 636f 6c75 6d6e 5f61 7267        column_arg
-00011180: 7320 3d20 6461 7461 5f73 6f75 7263 655f  s = data_source_
-00011190: 7062 322e 4461 7465 7469 6d65 5061 7274  pb2.DatetimePart
-000111a0: 6974 696f 6e43 6f6c 756d 6e41 7267 7328  itionColumnArgs(
-000111b0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000111c0: 2020 636f 6c75 6d6e 5f61 7267 732e 636f    column_args.co
-000111d0: 6c75 6d6e 5f6e 616d 6520 3d20 636f 6c75  lumn_name = colu
-000111e0: 6d6e 2e63 6f6c 756d 6e5f 6e61 6d65 0a20  mn.column_name. 
-000111f0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00011200: 6f6c 756d 6e5f 6172 6773 2e64 6174 6570  olumn_args.datep
-00011210: 6172 7420 3d20 636f 6c75 6d6e 2e64 6174  art = column.dat
-00011220: 6570 6172 740a 2020 2020 2020 2020 2020  epart.          
-00011230: 2020 2020 2020 636f 6c75 6d6e 5f61 7267        column_arg
-00011240: 732e 7a65 726f 5f70 6164 6465 6420 3d20  s.zero_padded = 
-00011250: 636f 6c75 6d6e 2e7a 6572 6f5f 7061 6464  column.zero_padd
-00011260: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
-00011270: 2020 2069 6620 636f 6c75 6d6e 2e66 6f72     if column.for
-00011280: 6d61 745f 7374 7269 6e67 3a0a 2020 2020  mat_string:.    
-00011290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000112a0: 636f 6c75 6d6e 5f61 7267 732e 666f 726d  column_args.form
-000112b0: 6174 5f73 7472 696e 6720 3d20 636f 6c75  at_string = colu
-000112c0: 6d6e 2e66 6f72 6d61 745f 7374 7269 6e67  mn.format_string
-000112d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000112e0: 2073 656c 662e 5f61 7267 732e 6461 7465   self._args.date
-000112f0: 7469 6d65 5f70 6172 7469 7469 6f6e 5f63  time_partition_c
-00011300: 6f6c 756d 6e73 2e61 7070 656e 6428 636f  olumns.append(co
-00011310: 6c75 6d6e 5f61 7267 7329 0a20 2020 2020  lumn_args).     
-00011320: 2020 2069 6620 706f 7374 5f70 726f 6365     if post_proce
-00011330: 7373 6f72 2069 7320 6e6f 7420 4e6f 6e65  ssor is not None
-00011340: 2061 6e64 2066 756e 6374 696f 6e5f 7365   and function_se
-00011350: 7269 616c 697a 6174 696f 6e2e 7368 6f75  rialization.shou
-00011360: 6c64 5f73 6572 6961 6c69 7a65 5f66 756e  ld_serialize_fun
-00011370: 6374 696f 6e28 706f 7374 5f70 726f 6365  ction(post_proce
-00011380: 7373 6f72 293a 0a20 2020 2020 2020 2020  ssor):.         
-00011390: 2020 2073 656c 662e 5f61 7267 732e 636f     self._args.co
-000113a0: 6d6d 6f6e 5f61 7267 732e 706f 7374 5f70  mmon_args.post_p
-000113b0: 726f 6365 7373 6f72 2e43 6f70 7946 726f  rocessor.CopyFro
-000113c0: 6d28 6675 6e63 7469 6f6e 5f73 6572 6961  m(function_seria
-000113d0: 6c69 7a61 7469 6f6e 2e74 6f5f 7072 6f74  lization.to_prot
-000113e0: 6f28 706f 7374 5f70 726f 6365 7373 6f72  o(post_processor
-000113f0: 2929 0a0a 2020 2020 2020 2020 7365 6c66  ))..        self
-00011400: 2e5f 6172 6773 2e63 6f6d 6d6f 6e5f 6172  ._args.common_ar
-00011410: 6773 2e64 6174 615f 6465 6c61 792e 4672  gs.data_delay.Fr
-00011420: 6f6d 5469 6d65 6465 6c74 6128 6461 7461  omTimedelta(data
-00011430: 5f64 656c 6179 290a 2020 2020 2020 2020  _delay).        
-00011440: 7365 6c66 2e5f 6461 7461 5f64 656c 6179  self._data_delay
-00011450: 203d 2064 6174 615f 6465 6c61 790a 2020   = data_delay.  
-00011460: 2020 2020 2020 7365 6c66 2e70 6f73 745f        self.post_
-00011470: 7072 6f63 6573 736f 7220 3d20 706f 7374  processor = post
-00011480: 5f70 726f 6365 7373 6f72 0a0a 2020 2020  _processor..    
-00011490: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-000114a0: 6620 6461 7461 5f64 656c 6179 2873 656c  f data_delay(sel
-000114b0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-000114c0: 726e 2073 656c 662e 5f64 6174 615f 6465  rn self._data_de
-000114d0: 6c61 790a 0a20 2020 2064 6566 205f 6d65  lay..    def _me
-000114e0: 7267 655f 6261 7463 685f 6172 6773 2873  rge_batch_args(s
-000114f0: 656c 662c 2064 6174 615f 736f 7572 6365  elf, data_source
-00011500: 5f61 7267 733a 2076 6972 7475 616c 5f64  _args: virtual_d
-00011510: 6174 615f 736f 7572 6365 5f70 6232 2e56  ata_source_pb2.V
-00011520: 6972 7475 616c 4461 7461 536f 7572 6365  irtualDataSource
-00011530: 4172 6773 293a 0a20 2020 2020 2020 2064  Args):.        d
-00011540: 6174 615f 736f 7572 6365 5f61 7267 732e  ata_source_args.
-00011550: 6869 7665 5f64 735f 636f 6e66 6967 2e43  hive_ds_config.C
-00011560: 6f70 7946 726f 6d28 7365 6c66 2e5f 6172  opyFrom(self._ar
-00011570: 6773 290a 0a0a 636c 6173 7320 556e 6974  gs)...class Unit
-00011580: 7943 6f6e 6669 6728 4261 7365 4261 7463  yConfig(BaseBatc
-00011590: 6843 6f6e 6669 6729 3a0a 2020 2020 2222  hConfig):.    ""
-000115a0: 220a 2020 2020 436f 6e66 6967 7572 6174  ".    Configurat
-000115b0: 696f 6e20 7573 6564 2074 6f20 7265 6665  ion used to refe
-000115c0: 7265 6e63 6520 6120 556e 6974 7920 7461  rence a Unity ta
-000115d0: 626c 652e 0a0a 2020 2020 5468 6520 556e  ble...    The Un
-000115e0: 6974 7943 6f6e 6669 6720 636c 6173 7320  ityConfig class 
-000115f0: 6973 2075 7365 6420 746f 2063 7265 6174  is used to creat
-00011600: 6520 6120 7265 6665 7265 6e63 6520 746f  e a reference to
-00011610: 2061 2055 6e69 7479 2054 6162 6c65 2e0a   a Unity Table..
-00011620: 0a20 2020 2054 6869 7320 636c 6173 7320  .    This class 
-00011630: 6973 2075 7365 6420 6173 2061 6e20 696e  is used as an in
-00011640: 7075 7420 746f 2061 203a 636c 6173 733a  put to a :class:
-00011650: 6042 6174 6368 536f 7572 6365 6027 7320  `BatchSource`'s 
-00011660: 7061 7261 6d65 7465 7220 6060 6261 7463  parameter ``batc
-00011670: 685f 636f 6e66 6967 6060 2e20 4465 636c  h_config``. Decl
-00011680: 6172 696e 6720 7468 6973 2063 6f6e 6669  aring this confi
-00011690: 6775 7261 7469 6f6e 0a20 2020 2063 6c61  guration.    cla
-000116a0: 7373 2061 6c6f 6e65 2077 696c 6c20 6e6f  ss alone will no
-000116b0: 7420 7265 6769 7374 6572 2061 2044 6174  t register a Dat
-000116c0: 6120 536f 7572 6365 2e20 496e 7374 6561  a Source. Instea
-000116d0: 642c 2064 6563 6c61 7265 2061 7320 6120  d, declare as a 
-000116e0: 7061 7274 206f 6620 6060 4261 7463 6853  part of ``BatchS
-000116f0: 6f75 7263 6560 6020 7468 6174 2074 616b  ource`` that tak
-00011700: 6573 2074 6869 7320 636f 6e66 6967 7572  es this configur
-00011710: 6174 696f 6e0a 2020 2020 636c 6173 7320  ation.    class 
-00011720: 696e 7374 616e 6365 2061 7320 6120 7061  instance as a pa
-00011730: 7261 6d65 7465 722e 0a20 2020 2022 2222  rameter..    """
-00011740: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
-00011750: 5f5f 280a 2020 2020 2020 2020 7365 6c66  __(.        self
-00011760: 2c0a 2020 2020 2020 2020 6361 7461 6c6f  ,.        catalo
-00011770: 673a 2073 7472 2c0a 2020 2020 2020 2020  g: str,.        
-00011780: 7363 6865 6d61 3a20 7374 722c 0a20 2020  schema: str,.   
-00011790: 2020 2020 2074 6162 6c65 3a20 7374 722c       table: str,
-000117a0: 0a20 2020 2020 2020 2074 696d 6573 7461  .        timesta
-000117b0: 6d70 5f66 6965 6c64 3a20 4f70 7469 6f6e  mp_field: Option
-000117c0: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
-000117d0: 2020 2020 2020 2020 7469 6d65 7374 616d          timestam
-000117e0: 705f 666f 726d 6174 3a20 4f70 7469 6f6e  p_format: Option
-000117f0: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
-00011800: 2020 2020 2020 2020 6461 7465 7469 6d65          datetime
-00011810: 5f70 6172 7469 7469 6f6e 5f63 6f6c 756d  _partition_colum
-00011820: 6e73 3a20 4f70 7469 6f6e 616c 5b4c 6973  ns: Optional[Lis
-00011830: 745b 4461 7465 7469 6d65 5061 7274 6974  t[DatetimePartit
-00011840: 696f 6e43 6f6c 756d 6e5d 5d20 3d20 4e6f  ionColumn]] = No
-00011850: 6e65 2c0a 2020 2020 2020 2020 706f 7374  ne,.        post
-00011860: 5f70 726f 6365 7373 6f72 3a20 4f70 7469  _processor: Opti
-00011870: 6f6e 616c 5b43 616c 6c61 626c 655d 203d  onal[Callable] =
-00011880: 204e 6f6e 652c 0a20 2020 2020 2020 2064   None,.        d
-00011890: 6174 615f 6465 6c61 793a 2064 6174 6574  ata_delay: datet
-000118a0: 696d 652e 7469 6d65 6465 6c74 6120 3d20  ime.timedelta = 
-000118b0: 6461 7465 7469 6d65 2e74 696d 6564 656c  datetime.timedel
-000118c0: 7461 2873 6563 6f6e 6473 3d30 292c 0a20  ta(seconds=0),. 
-000118d0: 2020 2020 2020 2061 6363 6573 735f 6d6f         access_mo
-000118e0: 6465 3a20 556e 6974 7943 6174 616c 6f67  de: UnityCatalog
-000118f0: 4163 6365 7373 4d6f 6465 203d 204e 6f6e  AccessMode = Non
-00011900: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-00011910: 2020 2222 220a 2020 2020 2020 2020 496e    """.        In
-00011920: 7374 616e 7469 6174 6573 2061 206e 6577  stantiates a new
-00011930: 2055 6e69 7479 436f 6e66 6967 2e0a 0a20   UnityConfig... 
-00011940: 2020 2020 2020 203a 7061 7261 6d20 6361         :param ca
-00011950: 7461 6c6f 673a 2041 2063 6174 616c 6f67  talog: A catalog
-00011960: 2072 6567 6973 7465 7265 6420 696e 2055   registered in U
-00011970: 6e69 7479 0a20 2020 2020 2020 203a 7061  nity.        :pa
-00011980: 7261 6d20 7363 6865 6d61 3a20 4120 7363  ram schema: A sc
-00011990: 6865 6d61 2072 6567 6973 7465 7265 6420  hema registered 
-000119a0: 696e 2055 6e69 7479 0a20 2020 2020 2020  in Unity.       
-000119b0: 203a 7061 7261 6d20 7461 626c 653a 2041   :param table: A
-000119c0: 2074 6162 6c65 2072 6567 6973 7465 7265   table registere
-000119d0: 6420 696e 2055 6e69 7479 0a20 2020 2020  d in Unity.     
-000119e0: 2020 203a 7061 7261 6d20 7469 6d65 7374     :param timest
-000119f0: 616d 705f 6669 656c 643a 2054 6865 2074  amp_field: The t
-00011a00: 696d 6573 7461 6d70 2063 6f6c 756d 6e20  imestamp column 
-00011a10: 696e 2074 6869 7320 6461 7461 2073 6f75  in this data sou
-00011a20: 7263 6520 7468 6174 2073 686f 756c 6420  rce that should 
-00011a30: 6265 2075 7365 6420 6279 2060 4669 6c74  be used by `Filt
-00011a40: 6572 6564 536f 7572 6365 600a 2020 2020  eredSource`.    
-00011a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011a70: 746f 2066 696c 7465 7220 6461 7461 2066  to filter data f
-00011a80: 726f 6d20 7468 6973 2073 6f75 7263 652c  rom this source,
-00011a90: 2062 6566 6f72 6520 616e 7920 6665 6174   before any feat
-00011aa0: 7572 6520 7669 6577 2074 7261 6e73 666f  ure view transfo
-00011ab0: 726d 6174 696f 6e73 2061 7265 2061 7070  rmations are app
-00011ac0: 6c69 6564 2e0a 2020 2020 2020 2020 2020  lied..          
-00011ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011ae0: 2020 2020 2020 2020 2020 4f6e 6c79 2072            Only r
-00011af0: 6571 7569 7265 6420 6966 2074 6869 7320  equired if this 
-00011b00: 736f 7572 6365 2069 7320 7573 6564 2077  source is used w
-00011b10: 6974 6820 6046 696c 7465 7265 6453 6f75  ith `FilteredSou
-00011b20: 7263 6560 2e0a 2020 2020 2020 2020 3a70  rce`..        :p
-00011b30: 6172 616d 2074 696d 6573 7461 6d70 5f66  aram timestamp_f
-00011b40: 6f72 6d61 743a 2046 6f72 6d61 7420 6f66  ormat: Format of
-00011b50: 2073 7472 696e 672d 656e 636f 6465 6420   string-encoded 
-00011b60: 7469 6d65 7374 616d 7020 636f 6c75 6d6e  timestamp column
-00011b70: 2028 652e 672e 2022 7979 7979 2d4d 4d2d   (e.g. "yyyy-MM-
-00011b80: 6464 2754 2768 683a 6d6d 3a73 732e 5353  dd'T'hh:mm:ss.SS
-00011b90: 5327 5a27 2229 2e0a 2020 2020 2020 2020  S'Z'")..        
-00011ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011bb0: 2020 2020 2020 2020 2049 6620 7468 6520           If the 
-00011bc0: 7469 6d65 7374 616d 7020 7374 7269 6e67  timestamp string
-00011bd0: 2063 616e 6e6f 7420 6265 2070 6172 7365   cannot be parse
-00011be0: 6420 7769 7468 2074 6869 7320 666f 726d  d with this form
-00011bf0: 6174 2c20 5465 6374 6f6e 2077 696c 6c20  at, Tecton will 
-00011c00: 6661 6c6c 6261 636b 2061 6e64 2061 7474  fallback and att
-00011c10: 656d 7074 2074 6f0a 2020 2020 2020 2020  empt to.        
-00011c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011c30: 2020 2020 2020 2020 2075 7365 2074 6865           use the
-00011c40: 2064 6566 6175 6c74 2074 696d 6573 7461   default timesta
-00011c50: 6d70 2070 6172 7365 722e 0a20 2020 2020  mp parser..     
-00011c60: 2020 203a 7061 7261 6d20 6461 7465 7469     :param dateti
-00011c70: 6d65 5f70 6172 7469 7469 6f6e 5f63 6f6c  me_partition_col
-00011c80: 756d 6e73 3a20 4c69 7374 206f 6620 4461  umns: List of Da
-00011c90: 7465 7469 6d65 5061 7274 6974 696f 6e43  tetimePartitionC
-00011ca0: 6f6c 756d 6e20 7468 6520 7261 7720 6461  olumn the raw da
-00011cb0: 7461 2069 7320 7061 7274 6974 696f 6e65  ta is partitione
-00011cc0: 6420 6279 2c20 6f74 6865 7277 6973 6520  d by, otherwise 
-00011cd0: 4e6f 6e65 2e0a 2020 2020 2020 2020 3a70  None..        :p
-00011ce0: 6172 616d 2070 6f73 745f 7072 6f63 6573  aram post_proces
-00011cf0: 736f 723a 2050 7974 686f 6e20 7573 6572  sor: Python user
-00011d00: 2064 6566 696e 6564 2066 756e 6374 696f   defined functio
-00011d10: 6e20 6060 6628 4461 7461 4672 616d 6529  n ``f(DataFrame)
-00011d20: 202d 3e20 4461 7461 4672 616d 6560 6020   -> DataFrame`` 
-00011d30: 7468 6174 2074 616b 6573 2069 6e20 7261  that takes in ra
-00011d40: 770a 2020 2020 2020 2020 2020 2020 2020  w.              
-00011d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011d60: 2020 2020 2020 2050 7953 7061 726b 2064         PySpark d
-00011d70: 6174 6120 736f 7572 6365 2044 6174 6146  ata source DataF
-00011d80: 7261 6d65 2061 6e64 2074 7261 6e73 6c61  rame and transla
-00011d90: 7465 7320 6974 2074 6f20 7468 6520 4461  tes it to the Da
-00011da0: 7461 4672 616d 6520 746f 2062 650a 2020  taFrame to be.  
-00011db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011dd0: 2020 2063 6f6e 7375 6d65 6420 6279 2074     consumed by t
-00011de0: 6865 2046 6561 7475 7265 2056 6965 772e  he Feature View.
-00011df0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00011e00: 6461 7461 5f64 656c 6179 3a20 4279 2064  data_delay: By d
-00011e10: 6566 6175 6c74 2c20 696e 6372 656d 656e  efault, incremen
-00011e20: 7461 6c20 6d61 7465 7269 616c 697a 6174  tal materializat
-00011e30: 696f 6e20 6a6f 6273 2072 756e 2069 6d6d  ion jobs run imm
-00011e40: 6564 6961 7465 6c79 2061 7420 7468 6520  ediately at the 
-00011e50: 656e 6420 6f66 2074 6865 0a20 2020 2020  end of the.     
+00010980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010990: 636f 6e73 756d 6564 2062 7920 7468 6520  consumed by the 
+000109a0: 4665 6174 7572 6520 5669 6577 2e0a 2020  Feature View..  
+000109b0: 2020 2020 2020 3a70 6172 616d 2064 6174        :param dat
+000109c0: 615f 6465 6c61 793a 2042 7920 6465 6661  a_delay: By defa
+000109d0: 756c 742c 2069 6e63 7265 6d65 6e74 616c  ult, incremental
+000109e0: 206d 6174 6572 6961 6c69 7a61 7469 6f6e   materialization
+000109f0: 206a 6f62 7320 7275 6e20 696d 6d65 6469   jobs run immedi
+00010a00: 6174 656c 7920 6174 2074 6865 2065 6e64  ately at the end
+00010a10: 206f 6620 7468 650a 2020 2020 2020 2020   of the.        
+00010a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010a30: 2020 2020 2020 2020 2020 2020 6261 7463              batc
+00010a40: 6820 7363 6865 6475 6c65 2070 6572 696f  h schedule perio
+00010a50: 642e 2054 6869 7320 7061 7261 6d65 7465  d. This paramete
+00010a60: 7220 636f 6e66 6967 7572 6573 2068 6f77  r configures how
+00010a70: 206c 6f6e 6720 7468 6579 2077 6169 7420   long they wait 
+00010a80: 6166 7465 7220 7468 6520 656e 640a 2020  after the end.  
+00010a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010ab0: 2020 6f66 2074 6865 2070 6572 696f 6420    of the period 
+00010ac0: 6265 666f 7265 2073 7461 7274 696e 672c  before starting,
+00010ad0: 2074 7970 6963 616c 6c79 2074 6f20 656e   typically to en
+00010ae0: 7375 7265 2074 6861 7420 616c 6c20 6461  sure that all da
+00010af0: 7461 2068 6173 206c 616e 6465 642e 0a20  ta has landed.. 
+00010b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010b20: 2020 2046 6f72 2065 7861 6d70 6c65 2c20     For example, 
+00010b30: 6966 2061 2066 6561 7475 7265 2076 6965  if a feature vie
+00010b40: 7720 6861 7320 6120 6062 6174 6368 5f73  w has a `batch_s
+00010b50: 6368 6564 756c 6560 206f 6620 3120 6461  chedule` of 1 da
+00010b60: 7920 616e 6420 6f6e 6520 6f66 0a20 2020  y and one of.   
+00010b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010b90: 2074 6865 2064 6174 6120 736f 7572 6365   the data source
+00010ba0: 2069 6e70 7574 7320 6861 7320 6064 6174   inputs has `dat
+00010bb0: 615f 6465 6c61 793d 7469 6d65 6465 6c74  a_delay=timedelt
+00010bc0: 6128 686f 7572 733d 3129 6020 7365 742c  a(hours=1)` set,
+00010bd0: 2074 6865 6e0a 2020 2020 2020 2020 2020   then.          
+00010be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010bf0: 2020 2020 2020 2020 2020 696e 6372 656d            increm
+00010c00: 656e 7461 6c20 6d61 7465 7269 616c 697a  ental materializ
+00010c10: 6174 696f 6e20 6a6f 6273 2077 696c 6c20  ation jobs will 
+00010c20: 7275 6e20 6174 2060 3031 3a30 3060 2055  run at `01:00` U
+00010c30: 5443 2e0a 0a20 2020 2020 2020 203a 7265  TC...        :re
+00010c40: 7475 726e 3a20 4120 4869 7665 436f 6e66  turn: A HiveConf
+00010c50: 6967 2063 6c61 7373 2069 6e73 7461 6e63  ig class instanc
+00010c60: 652e 0a0a 0a20 2020 2020 2020 2045 7861  e....        Exa
+00010c70: 6d70 6c65 206f 6620 6120 4869 7665 436f  mple of a HiveCo
+00010c80: 6e66 6967 2064 6563 6c61 7261 7469 6f6e  nfig declaration
+00010c90: 3a0a 0a20 2020 2020 2020 202e 2e20 636f  :..        .. co
+00010ca0: 6465 2d62 6c6f 636b 3a3a 2070 7974 686f  de-block:: pytho
+00010cb0: 6e0a 0a20 2020 2020 2020 2020 2020 2066  n..            f
+00010cc0: 726f 6d20 7465 6374 6f6e 2069 6d70 6f72  rom tecton impor
+00010cd0: 7420 4869 7665 436f 6e66 6967 0a20 2020  t HiveConfig.   
+00010ce0: 2020 2020 2020 2020 2069 6d70 6f72 7420           import 
+00010cf0: 7079 7370 6172 6b0a 0a20 2020 2020 2020  pyspark..       
+00010d00: 2020 2020 2064 6566 2063 6f6e 7665 7274       def convert
+00010d10: 5f74 656d 7065 7261 7475 7265 2864 663a  _temperature(df:
+00010d20: 2070 7973 7061 726b 2e73 716c 2e44 6174   pyspark.sql.Dat
+00010d30: 6146 7261 6d65 2920 2d3e 2070 7973 7061  aFrame) -> pyspa
+00010d40: 726b 2e73 716c 2e44 6174 6146 7261 6d65  rk.sql.DataFrame
+00010d50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00010d60: 2020 6672 6f6d 2070 7973 7061 726b 2e73    from pyspark.s
+00010d70: 716c 2e66 756e 6374 696f 6e73 2069 6d70  ql.functions imp
+00010d80: 6f72 7420 7564 662c 636f 6c0a 2020 2020  ort udf,col.    
+00010d90: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
+00010da0: 2070 7973 7061 726b 2e73 716c 2e74 7970   pyspark.sql.typ
+00010db0: 6573 2069 6d70 6f72 7420 446f 7562 6c65  es import Double
+00010dc0: 5479 7065 0a0a 2020 2020 2020 2020 2020  Type..          
+00010dd0: 2020 2020 2020 2320 436f 6e76 6572 7420        # Convert 
+00010de0: 7468 6520 696e 636f 6d69 6e67 2050 7953  the incoming PyS
+00010df0: 7061 726b 2044 6174 6146 7261 6d65 2074  park DataFrame t
+00010e00: 656d 7065 7261 7475 7265 2043 656c 7369  emperature Celsi
+00010e10: 7573 2074 6f20 4661 6872 656e 6865 6974  us to Fahrenheit
+00010e20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010e30: 2075 6466 5f63 6f6e 7665 7274 203d 2075   udf_convert = u
+00010e40: 6466 286c 616d 6264 6120 783a 2078 202a  df(lambda x: x *
+00010e50: 2031 2e38 202b 2033 322e 302c 2044 6f75   1.8 + 32.0, Dou
+00010e60: 626c 6554 7970 6528 2929 0a20 2020 2020  bleType()).     
+00010e70: 2020 2020 2020 2020 2020 2063 6f6e 7665             conve
+00010e80: 7274 6564 5f64 6620 3d20 6466 2e77 6974  rted_df = df.wit
+00010e90: 6843 6f6c 756d 6e28 2246 6168 7265 6e68  hColumn("Fahrenh
+00010ea0: 6569 7422 2c20 7564 665f 636f 6e76 6572  eit", udf_conver
+00010eb0: 7428 636f 6c28 2254 656d 7065 7261 7475  t(col("Temperatu
+00010ec0: 7265 2229 2929 2e64 726f 7028 2254 656d  re"))).drop("Tem
+00010ed0: 7065 7261 7475 7265 2229 0a20 2020 2020  perature").     
+00010ee0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00010ef0: 6e20 636f 6e76 6572 7465 645f 6466 0a0a  n converted_df..
+00010f00: 2020 2020 2020 2020 2020 2020 2320 6465              # de
+00010f10: 636c 6172 6520 6120 4869 7665 436f 6e66  clare a HiveConf
+00010f20: 6967 2069 6e73 7461 6e63 652c 2077 6869  ig instance, whi
+00010f30: 6368 2063 616e 2062 6520 7573 6564 2061  ch can be used a
+00010f40: 7320 6120 7061 7261 6d65 7465 7220 746f  s a parameter to
+00010f50: 2061 2042 6174 6368 536f 7572 6365 0a20   a BatchSource. 
+00010f60: 2020 2020 2020 2020 2020 2062 6174 6368             batch
+00010f70: 5f63 6f6e 6669 673d 4869 7665 436f 6e66  _config=HiveConf
+00010f80: 6967 2864 6174 6162 6173 653d 2767 6c6f  ig(database='glo
+00010f90: 6261 6c5f 7465 6d70 6572 6174 7572 6573  bal_temperatures
+00010fa0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+00010fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010fc0: 2020 2020 2020 2020 2020 2074 6162 6c65             table
+00010fd0: 3d27 7573 5f63 6974 6965 7327 2c0a 2020  ='us_cities',.  
+00010fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011000: 2020 2020 2020 7469 6d65 7374 616d 705f        timestamp_
+00011010: 6669 656c 643d 2774 696d 6573 7461 6d70  field='timestamp
+00011020: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+00011030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011040: 2020 2020 2020 2020 2020 2070 6f73 745f             post_
+00011050: 7072 6f63 6573 736f 723d 636f 6e76 6572  processor=conver
+00011060: 745f 7465 6d70 6572 6174 7572 6529 0a0a  t_temperature)..
+00011070: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00011080: 2020 2020 7365 6c66 2e5f 6172 6773 203d      self._args =
+00011090: 2064 6174 615f 736f 7572 6365 5f70 6232   data_source_pb2
+000110a0: 2e48 6976 6544 6174 6153 6f75 7263 6541  .HiveDataSourceA
+000110b0: 7267 7328 290a 2020 2020 2020 2020 7365  rgs().        se
+000110c0: 6c66 2e5f 6172 6773 2e74 6162 6c65 203d  lf._args.table =
+000110d0: 2074 6162 6c65 0a20 2020 2020 2020 2073   table.        s
+000110e0: 656c 662e 5f61 7267 732e 6461 7461 6261  elf._args.databa
+000110f0: 7365 203d 2064 6174 6162 6173 650a 2020  se = database.  
+00011100: 2020 2020 2020 6966 2074 696d 6573 7461        if timesta
+00011110: 6d70 5f66 6965 6c64 3a0a 2020 2020 2020  mp_field:.      
+00011120: 2020 2020 2020 7365 6c66 2e5f 6172 6773        self._args
+00011130: 2e63 6f6d 6d6f 6e5f 6172 6773 2e74 696d  .common_args.tim
+00011140: 6573 7461 6d70 5f66 6965 6c64 203d 2074  estamp_field = t
+00011150: 696d 6573 7461 6d70 5f66 6965 6c64 0a20  imestamp_field. 
+00011160: 2020 2020 2020 2069 6620 7469 6d65 7374         if timest
+00011170: 616d 705f 666f 726d 6174 3a0a 2020 2020  amp_format:.    
+00011180: 2020 2020 2020 2020 7365 6c66 2e5f 6172          self._ar
+00011190: 6773 2e74 696d 6573 7461 6d70 5f66 6f72  gs.timestamp_for
+000111a0: 6d61 7420 3d20 7469 6d65 7374 616d 705f  mat = timestamp_
+000111b0: 666f 726d 6174 0a0a 2020 2020 2020 2020  format..        
+000111c0: 6966 2064 6174 6574 696d 655f 7061 7274  if datetime_part
+000111d0: 6974 696f 6e5f 636f 6c75 6d6e 733a 0a20  ition_columns:. 
+000111e0: 2020 2020 2020 2020 2020 2066 6f72 2063             for c
+000111f0: 6f6c 756d 6e20 696e 2064 6174 6574 696d  olumn in datetim
+00011200: 655f 7061 7274 6974 696f 6e5f 636f 6c75  e_partition_colu
+00011210: 6d6e 733a 0a20 2020 2020 2020 2020 2020  mns:.           
+00011220: 2020 2020 2063 6f6c 756d 6e5f 6172 6773       column_args
+00011230: 203d 2064 6174 615f 736f 7572 6365 5f70   = data_source_p
+00011240: 6232 2e44 6174 6574 696d 6550 6172 7469  b2.DatetimeParti
+00011250: 7469 6f6e 436f 6c75 6d6e 4172 6773 2829  tionColumnArgs()
+00011260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011270: 2063 6f6c 756d 6e5f 6172 6773 2e63 6f6c   column_args.col
+00011280: 756d 6e5f 6e61 6d65 203d 2063 6f6c 756d  umn_name = colum
+00011290: 6e2e 636f 6c75 6d6e 5f6e 616d 650a 2020  n.column_name.  
+000112a0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+000112b0: 6c75 6d6e 5f61 7267 732e 6461 7465 7061  lumn_args.datepa
+000112c0: 7274 203d 2063 6f6c 756d 6e2e 6461 7465  rt = column.date
+000112d0: 7061 7274 0a20 2020 2020 2020 2020 2020  part.           
+000112e0: 2020 2020 2063 6f6c 756d 6e5f 6172 6773       column_args
+000112f0: 2e7a 6572 6f5f 7061 6464 6564 203d 2063  .zero_padded = c
+00011300: 6f6c 756d 6e2e 7a65 726f 5f70 6164 6465  olumn.zero_padde
+00011310: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+00011320: 2020 6966 2063 6f6c 756d 6e2e 666f 726d    if column.form
+00011330: 6174 5f73 7472 696e 673a 0a20 2020 2020  at_string:.     
+00011340: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00011350: 6f6c 756d 6e5f 6172 6773 2e66 6f72 6d61  olumn_args.forma
+00011360: 745f 7374 7269 6e67 203d 2063 6f6c 756d  t_string = colum
+00011370: 6e2e 666f 726d 6174 5f73 7472 696e 670a  n.format_string.
+00011380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011390: 7365 6c66 2e5f 6172 6773 2e64 6174 6574  self._args.datet
+000113a0: 696d 655f 7061 7274 6974 696f 6e5f 636f  ime_partition_co
+000113b0: 6c75 6d6e 732e 6170 7065 6e64 2863 6f6c  lumns.append(col
+000113c0: 756d 6e5f 6172 6773 290a 2020 2020 2020  umn_args).      
+000113d0: 2020 6966 2070 6f73 745f 7072 6f63 6573    if post_proces
+000113e0: 736f 7220 6973 206e 6f74 204e 6f6e 6520  sor is not None 
+000113f0: 616e 6420 6675 6e63 7469 6f6e 5f73 6572  and function_ser
+00011400: 6961 6c69 7a61 7469 6f6e 2e73 686f 756c  ialization.shoul
+00011410: 645f 7365 7269 616c 697a 655f 6675 6e63  d_serialize_func
+00011420: 7469 6f6e 2870 6f73 745f 7072 6f63 6573  tion(post_proces
+00011430: 736f 7229 3a0a 2020 2020 2020 2020 2020  sor):.          
+00011440: 2020 7365 6c66 2e5f 6172 6773 2e63 6f6d    self._args.com
+00011450: 6d6f 6e5f 6172 6773 2e70 6f73 745f 7072  mon_args.post_pr
+00011460: 6f63 6573 736f 722e 436f 7079 4672 6f6d  ocessor.CopyFrom
+00011470: 2866 756e 6374 696f 6e5f 7365 7269 616c  (function_serial
+00011480: 697a 6174 696f 6e2e 746f 5f70 726f 746f  ization.to_proto
+00011490: 2870 6f73 745f 7072 6f63 6573 736f 7229  (post_processor)
+000114a0: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+000114b0: 5f61 7267 732e 636f 6d6d 6f6e 5f61 7267  _args.common_arg
+000114c0: 732e 6461 7461 5f64 656c 6179 2e46 726f  s.data_delay.Fro
+000114d0: 6d54 696d 6564 656c 7461 2864 6174 615f  mTimedelta(data_
+000114e0: 6465 6c61 7929 0a20 2020 2020 2020 2073  delay).        s
+000114f0: 656c 662e 5f64 6174 615f 6465 6c61 7920  elf._data_delay 
+00011500: 3d20 6461 7461 5f64 656c 6179 0a20 2020  = data_delay.   
+00011510: 2020 2020 2073 656c 662e 706f 7374 5f70       self.post_p
+00011520: 726f 6365 7373 6f72 203d 2070 6f73 745f  rocessor = post_
+00011530: 7072 6f63 6573 736f 720a 0a20 2020 2040  processor..    @
+00011540: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00011550: 2064 6174 615f 6465 6c61 7928 7365 6c66   data_delay(self
+00011560: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00011570: 6e20 7365 6c66 2e5f 6461 7461 5f64 656c  n self._data_del
+00011580: 6179 0a0a 2020 2020 6465 6620 5f6d 6572  ay..    def _mer
+00011590: 6765 5f62 6174 6368 5f61 7267 7328 7365  ge_batch_args(se
+000115a0: 6c66 2c20 6461 7461 5f73 6f75 7263 655f  lf, data_source_
+000115b0: 6172 6773 3a20 7669 7274 7561 6c5f 6461  args: virtual_da
+000115c0: 7461 5f73 6f75 7263 655f 7062 322e 5669  ta_source_pb2.Vi
+000115d0: 7274 7561 6c44 6174 6153 6f75 7263 6541  rtualDataSourceA
+000115e0: 7267 7329 3a0a 2020 2020 2020 2020 6461  rgs):.        da
+000115f0: 7461 5f73 6f75 7263 655f 6172 6773 2e68  ta_source_args.h
+00011600: 6976 655f 6473 5f63 6f6e 6669 672e 436f  ive_ds_config.Co
+00011610: 7079 4672 6f6d 2873 656c 662e 5f61 7267  pyFrom(self._arg
+00011620: 7329 0a0a 0a63 6c61 7373 2055 6e69 7479  s)...class Unity
+00011630: 436f 6e66 6967 2842 6173 6542 6174 6368  Config(BaseBatch
+00011640: 436f 6e66 6967 293a 0a20 2020 2022 2222  Config):.    """
+00011650: 0a20 2020 2043 6f6e 6669 6775 7261 7469  .    Configurati
+00011660: 6f6e 2075 7365 6420 746f 2072 6566 6572  on used to refer
+00011670: 656e 6365 2061 2055 6e69 7479 2074 6162  ence a Unity tab
+00011680: 6c65 2e0a 0a20 2020 2054 6865 2055 6e69  le...    The Uni
+00011690: 7479 436f 6e66 6967 2063 6c61 7373 2069  tyConfig class i
+000116a0: 7320 7573 6564 2074 6f20 6372 6561 7465  s used to create
+000116b0: 2061 2072 6566 6572 656e 6365 2074 6f20   a reference to 
+000116c0: 6120 556e 6974 7920 5461 626c 652e 0a0a  a Unity Table...
+000116d0: 2020 2020 5468 6973 2063 6c61 7373 2069      This class i
+000116e0: 7320 7573 6564 2061 7320 616e 2069 6e70  s used as an inp
+000116f0: 7574 2074 6f20 6120 3a63 6c61 7373 3a60  ut to a :class:`
+00011700: 4261 7463 6853 6f75 7263 6560 2773 2070  BatchSource`'s p
+00011710: 6172 616d 6574 6572 2060 6062 6174 6368  arameter ``batch
+00011720: 5f63 6f6e 6669 6760 602e 2044 6563 6c61  _config``. Decla
+00011730: 7269 6e67 2074 6869 7320 636f 6e66 6967  ring this config
+00011740: 7572 6174 696f 6e0a 2020 2020 636c 6173  uration.    clas
+00011750: 7320 616c 6f6e 6520 7769 6c6c 206e 6f74  s alone will not
+00011760: 2072 6567 6973 7465 7220 6120 4461 7461   register a Data
+00011770: 2053 6f75 7263 652e 2049 6e73 7465 6164   Source. Instead
+00011780: 2c20 6465 636c 6172 6520 6173 2061 2070  , declare as a p
+00011790: 6172 7420 6f66 2060 6042 6174 6368 536f  art of ``BatchSo
+000117a0: 7572 6365 6060 2074 6861 7420 7461 6b65  urce`` that take
+000117b0: 7320 7468 6973 2063 6f6e 6669 6775 7261  s this configura
+000117c0: 7469 6f6e 0a20 2020 2063 6c61 7373 2069  tion.    class i
+000117d0: 6e73 7461 6e63 6520 6173 2061 2070 6172  nstance as a par
+000117e0: 616d 6574 6572 2e0a 2020 2020 2222 220a  ameter..    """.
+000117f0: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+00011800: 5f28 0a20 2020 2020 2020 2073 656c 662c  _(.        self,
+00011810: 0a20 2020 2020 2020 2063 6174 616c 6f67  .        catalog
+00011820: 3a20 7374 722c 0a20 2020 2020 2020 2073  : str,.        s
+00011830: 6368 656d 613a 2073 7472 2c0a 2020 2020  chema: str,.    
+00011840: 2020 2020 7461 626c 653a 2073 7472 2c0a      table: str,.
+00011850: 2020 2020 2020 2020 7469 6d65 7374 616d          timestam
+00011860: 705f 6669 656c 643a 204f 7074 696f 6e61  p_field: Optiona
+00011870: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
+00011880: 2020 2020 2020 2074 696d 6573 7461 6d70         timestamp
+00011890: 5f66 6f72 6d61 743a 204f 7074 696f 6e61  _format: Optiona
+000118a0: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
+000118b0: 2020 2020 2020 2064 6174 6574 696d 655f         datetime_
+000118c0: 7061 7274 6974 696f 6e5f 636f 6c75 6d6e  partition_column
+000118d0: 733a 204f 7074 696f 6e61 6c5b 4c69 7374  s: Optional[List
+000118e0: 5b44 6174 6574 696d 6550 6172 7469 7469  [DatetimePartiti
+000118f0: 6f6e 436f 6c75 6d6e 5d5d 203d 204e 6f6e  onColumn]] = Non
+00011900: 652c 0a20 2020 2020 2020 2070 6f73 745f  e,.        post_
+00011910: 7072 6f63 6573 736f 723a 204f 7074 696f  processor: Optio
+00011920: 6e61 6c5b 4361 6c6c 6162 6c65 5d20 3d20  nal[Callable] = 
+00011930: 4e6f 6e65 2c0a 2020 2020 2020 2020 6461  None,.        da
+00011940: 7461 5f64 656c 6179 3a20 6461 7465 7469  ta_delay: dateti
+00011950: 6d65 2e74 696d 6564 656c 7461 203d 2064  me.timedelta = d
+00011960: 6174 6574 696d 652e 7469 6d65 6465 6c74  atetime.timedelt
+00011970: 6128 7365 636f 6e64 733d 3029 2c0a 2020  a(seconds=0),.  
+00011980: 2020 2020 2020 6163 6365 7373 5f6d 6f64        access_mod
+00011990: 653a 2055 6e69 7479 4361 7461 6c6f 6741  e: UnityCatalogA
+000119a0: 6363 6573 734d 6f64 6520 3d20 4e6f 6e65  ccessMode = None
+000119b0: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+000119c0: 2022 2222 0a20 2020 2020 2020 2049 6e73   """.        Ins
+000119d0: 7461 6e74 6961 7465 7320 6120 6e65 7720  tantiates a new 
+000119e0: 556e 6974 7943 6f6e 6669 672e 0a0a 2020  UnityConfig...  
+000119f0: 2020 2020 2020 3a70 6172 616d 2063 6174        :param cat
+00011a00: 616c 6f67 3a20 4120 6361 7461 6c6f 6720  alog: A catalog 
+00011a10: 7265 6769 7374 6572 6564 2069 6e20 556e  registered in Un
+00011a20: 6974 790a 2020 2020 2020 2020 3a70 6172  ity.        :par
+00011a30: 616d 2073 6368 656d 613a 2041 2073 6368  am schema: A sch
+00011a40: 656d 6120 7265 6769 7374 6572 6564 2069  ema registered i
+00011a50: 6e20 556e 6974 790a 2020 2020 2020 2020  n Unity.        
+00011a60: 3a70 6172 616d 2074 6162 6c65 3a20 4120  :param table: A 
+00011a70: 7461 626c 6520 7265 6769 7374 6572 6564  table registered
+00011a80: 2069 6e20 556e 6974 790a 2020 2020 2020   in Unity.      
+00011a90: 2020 3a70 6172 616d 2074 696d 6573 7461    :param timesta
+00011aa0: 6d70 5f66 6965 6c64 3a20 5468 6520 7469  mp_field: The ti
+00011ab0: 6d65 7374 616d 7020 636f 6c75 6d6e 2069  mestamp column i
+00011ac0: 6e20 7468 6973 2064 6174 6120 736f 7572  n this data sour
+00011ad0: 6365 2074 6861 7420 7368 6f75 6c64 2062  ce that should b
+00011ae0: 6520 7573 6564 2062 7920 6046 696c 7465  e used by `Filte
+00011af0: 7265 6453 6f75 7263 6560 0a20 2020 2020  redSource`.     
+00011b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011b10: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00011b20: 6f20 6669 6c74 6572 2064 6174 6120 6672  o filter data fr
+00011b30: 6f6d 2074 6869 7320 736f 7572 6365 2c20  om this source, 
+00011b40: 6265 666f 7265 2061 6e79 2066 6561 7475  before any featu
+00011b50: 7265 2076 6965 7720 7472 616e 7366 6f72  re view transfor
+00011b60: 6d61 7469 6f6e 7320 6172 6520 6170 706c  mations are appl
+00011b70: 6965 642e 0a20 2020 2020 2020 2020 2020  ied..           
+00011b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011b90: 2020 2020 2020 2020 204f 6e6c 7920 7265           Only re
+00011ba0: 7175 6972 6564 2069 6620 7468 6973 2073  quired if this s
+00011bb0: 6f75 7263 6520 6973 2075 7365 6420 7769  ource is used wi
+00011bc0: 7468 2060 4669 6c74 6572 6564 536f 7572  th `FilteredSour
+00011bd0: 6365 602e 0a20 2020 2020 2020 203a 7061  ce`..        :pa
+00011be0: 7261 6d20 7469 6d65 7374 616d 705f 666f  ram timestamp_fo
+00011bf0: 726d 6174 3a20 466f 726d 6174 206f 6620  rmat: Format of 
+00011c00: 7374 7269 6e67 2d65 6e63 6f64 6564 2074  string-encoded t
+00011c10: 696d 6573 7461 6d70 2063 6f6c 756d 6e20  imestamp column 
+00011c20: 2865 2e67 2e20 2279 7979 792d 4d4d 2d64  (e.g. "yyyy-MM-d
+00011c30: 6427 5427 6868 3a6d 6d3a 7373 2e53 5353  d'T'hh:mm:ss.SSS
+00011c40: 275a 2722 292e 0a20 2020 2020 2020 2020  'Z'")..         
+00011c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011c60: 2020 2020 2020 2020 4966 2074 6865 2074          If the t
+00011c70: 696d 6573 7461 6d70 2073 7472 696e 6720  imestamp string 
+00011c80: 6361 6e6e 6f74 2062 6520 7061 7273 6564  cannot be parsed
+00011c90: 2077 6974 6820 7468 6973 2066 6f72 6d61   with this forma
+00011ca0: 742c 2054 6563 746f 6e20 7769 6c6c 2066  t, Tecton will f
+00011cb0: 616c 6c62 6163 6b20 616e 6420 6174 7465  allback and atte
+00011cc0: 6d70 7420 746f 0a20 2020 2020 2020 2020  mpt to.         
+00011cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011ce0: 2020 2020 2020 2020 7573 6520 7468 6520          use the 
+00011cf0: 6465 6661 756c 7420 7469 6d65 7374 616d  default timestam
+00011d00: 7020 7061 7273 6572 2e0a 2020 2020 2020  p parser..      
+00011d10: 2020 3a70 6172 616d 2064 6174 6574 696d    :param datetim
+00011d20: 655f 7061 7274 6974 696f 6e5f 636f 6c75  e_partition_colu
+00011d30: 6d6e 733a 204c 6973 7420 6f66 2044 6174  mns: List of Dat
+00011d40: 6574 696d 6550 6172 7469 7469 6f6e 436f  etimePartitionCo
+00011d50: 6c75 6d6e 2074 6865 2072 6177 2064 6174  lumn the raw dat
+00011d60: 6120 6973 2070 6172 7469 7469 6f6e 6564  a is partitioned
+00011d70: 2062 792c 206f 7468 6572 7769 7365 204e   by, otherwise N
+00011d80: 6f6e 652e 0a20 2020 2020 2020 203a 7061  one..        :pa
+00011d90: 7261 6d20 706f 7374 5f70 726f 6365 7373  ram post_process
+00011da0: 6f72 3a20 5079 7468 6f6e 2075 7365 7220  or: Python user 
+00011db0: 6465 6669 6e65 6420 6675 6e63 7469 6f6e  defined function
+00011dc0: 2060 6066 2844 6174 6146 7261 6d65 2920   ``f(DataFrame) 
+00011dd0: 2d3e 2044 6174 6146 7261 6d65 6060 2074  -> DataFrame`` t
+00011de0: 6861 7420 7461 6b65 7320 696e 2072 6177  hat takes in raw
+00011df0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011e10: 2020 2020 2020 5079 5370 6172 6b20 6461        PySpark da
+00011e20: 7461 2073 6f75 7263 6520 4461 7461 4672  ta source DataFr
+00011e30: 616d 6520 616e 6420 7472 616e 736c 6174  ame and translat
+00011e40: 6573 2069 7420 746f 2074 6865 2044 6174  es it to the Dat
+00011e50: 6146 7261 6d65 2074 6f20 6265 0a20 2020  aFrame to be.   
 00011e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011e70: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00011e80: 6174 6368 2073 6368 6564 756c 6520 7065  atch schedule pe
-00011e90: 7269 6f64 2e20 5468 6973 2070 6172 616d  riod. This param
-00011ea0: 6574 6572 2063 6f6e 6669 6775 7265 7320  eter configures 
-00011eb0: 686f 7720 6c6f 6e67 2074 6865 7920 7761  how long they wa
-00011ec0: 6974 2061 6674 6572 2074 6865 2065 6e64  it after the end
-00011ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011ef0: 2020 2020 206f 6620 7468 6520 7065 7269       of the peri
-00011f00: 6f64 2062 6566 6f72 6520 7374 6172 7469  od before starti
-00011f10: 6e67 2c20 7479 7069 6361 6c6c 7920 746f  ng, typically to
-00011f20: 2065 6e73 7572 6520 7468 6174 2061 6c6c   ensure that all
-00011f30: 2064 6174 6120 6861 7320 6c61 6e64 6564   data has landed
-00011f40: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00011f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011f60: 2020 2020 2020 466f 7220 6578 616d 706c        For exampl
-00011f70: 652c 2069 6620 6120 6665 6174 7572 6520  e, if a feature 
-00011f80: 7669 6577 2068 6173 2061 2060 6261 7463  view has a `batc
-00011f90: 685f 7363 6865 6475 6c65 6020 6f66 2031  h_schedule` of 1
-00011fa0: 2064 6179 2061 6e64 206f 6e65 206f 660a   day and one of.
-00011fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011fd0: 2020 2020 7468 6520 6461 7461 2073 6f75      the data sou
-00011fe0: 7263 6520 696e 7075 7473 2068 6173 2060  rce inputs has `
-00011ff0: 6461 7461 5f64 656c 6179 3d74 696d 6564  data_delay=timed
-00012000: 656c 7461 2868 6f75 7273 3d31 2960 2073  elta(hours=1)` s
-00012010: 6574 2c20 7468 656e 0a20 2020 2020 2020  et, then.       
-00012020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012030: 2020 2020 2020 2020 2020 2020 2069 6e63               inc
-00012040: 7265 6d65 6e74 616c 206d 6174 6572 6961  remental materia
-00012050: 6c69 7a61 7469 6f6e 206a 6f62 7320 7769  lization jobs wi
-00012060: 6c6c 2072 756e 2061 7420 6030 313a 3030  ll run at `01:00
-00012070: 6020 5554 432e 0a20 2020 2020 2020 203a  ` UTC..        :
-00012080: 7061 7261 6d20 6163 6365 7373 5f6d 6f64  param access_mod
-00012090: 653a 2054 6865 2055 6e69 7479 2043 6174  e: The Unity Cat
-000120a0: 616c 6f67 2041 6363 6573 7320 4d6f 6465  alog Access Mode
-000120b0: 2066 6f72 2074 6865 2055 6e69 7479 2074   for the Unity t
-000120c0: 6162 6c65 2e20 4966 206e 6f74 2073 7065  able. If not spe
-000120d0: 6369 6669 6564 2c20 7573 6573 2074 6865  cified, uses the
-000120e0: 2053 696e 676c 6520 5573 6572 0a20 2020   Single User.   
-000120f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012110: 2041 6363 6573 7320 4d6f 6465 2061 7320   Access Mode as 
-00012120: 6465 6661 756c 742e 0a0a 2020 2020 2020  default...      
-00012130: 2020 3a72 6574 7572 6e3a 2041 2055 6e69    :return: A Uni
-00012140: 7479 436f 6e66 6967 2063 6c61 7373 2069  tyConfig class i
-00012150: 6e73 7461 6e63 652e 0a0a 2020 2020 2020  nstance...      
-00012160: 2020 2222 220a 2020 2020 2020 2020 7365    """.        se
-00012170: 6c66 2e5f 6172 6773 203d 2064 6174 615f  lf._args = data_
-00012180: 736f 7572 6365 5f70 6232 2e55 6e69 7479  source_pb2.Unity
-00012190: 4461 7461 536f 7572 6365 4172 6773 280a  DataSourceArgs(.
-000121a0: 2020 2020 2020 2020 2020 2020 6361 7461              cata
-000121b0: 6c6f 673d 6361 7461 6c6f 672c 0a20 2020  log=catalog,.   
-000121c0: 2020 2020 2020 2020 2073 6368 656d 613d           schema=
-000121d0: 7363 6865 6d61 2c0a 2020 2020 2020 2020  schema,.        
-000121e0: 2020 2020 7461 626c 653d 7461 626c 652c      table=table,
-000121f0: 0a20 2020 2020 2020 2020 2020 2074 696d  .            tim
-00012200: 6573 7461 6d70 5f66 6f72 6d61 743d 7469  estamp_format=ti
-00012210: 6d65 7374 616d 705f 666f 726d 6174 2c0a  mestamp_format,.
-00012220: 2020 2020 2020 2020 2020 2020 636f 6d6d              comm
-00012230: 6f6e 5f61 7267 733d 6461 7461 5f73 6f75  on_args=data_sou
-00012240: 7263 655f 7062 322e 4261 7463 6844 6174  rce_pb2.BatchDat
-00012250: 6153 6f75 7263 6543 6f6d 6d6f 6e41 7267  aSourceCommonArg
-00012260: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
-00012270: 2020 2064 6174 615f 6465 6c61 793d 7469     data_delay=ti
-00012280: 6d65 5f75 7469 6c73 2e74 696d 6564 656c  me_utils.timedel
-00012290: 7461 5f74 6f5f 7072 6f74 6f28 6461 7461  ta_to_proto(data
-000122a0: 5f64 656c 6179 292c 0a20 2020 2020 2020  _delay),.       
-000122b0: 2020 2020 2020 2020 2074 696d 6573 7461           timesta
-000122c0: 6d70 5f66 6965 6c64 3d74 696d 6573 7461  mp_field=timesta
-000122d0: 6d70 5f66 6965 6c64 2c0a 2020 2020 2020  mp_field,.      
-000122e0: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
-000122f0: 2020 2020 2061 6363 6573 735f 6d6f 6465       access_mode
-00012300: 3d61 6363 6573 735f 6d6f 6465 2e76 616c  =access_mode.val
-00012310: 7565 2069 6620 6163 6365 7373 5f6d 6f64  ue if access_mod
-00012320: 6520 6973 206e 6f74 204e 6f6e 6520 656c  e is not None el
-00012330: 7365 2055 6e69 7479 4361 7461 6c6f 6741  se UnityCatalogA
-00012340: 6363 6573 734d 6f64 652e 5349 4e47 4c45  ccessMode.SINGLE
-00012350: 5f55 5345 522e 7661 6c75 652c 0a20 2020  _USER.value,.   
-00012360: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00012370: 6966 2064 6174 6574 696d 655f 7061 7274  if datetime_part
-00012380: 6974 696f 6e5f 636f 6c75 6d6e 733a 0a20  ition_columns:. 
-00012390: 2020 2020 2020 2020 2020 2066 6f72 2063             for c
-000123a0: 6f6c 756d 6e20 696e 2064 6174 6574 696d  olumn in datetim
-000123b0: 655f 7061 7274 6974 696f 6e5f 636f 6c75  e_partition_colu
-000123c0: 6d6e 733a 0a20 2020 2020 2020 2020 2020  mns:.           
-000123d0: 2020 2020 2063 6f6c 756d 6e5f 6172 6773       column_args
-000123e0: 203d 2064 6174 615f 736f 7572 6365 5f70   = data_source_p
-000123f0: 6232 2e44 6174 6574 696d 6550 6172 7469  b2.DatetimeParti
-00012400: 7469 6f6e 436f 6c75 6d6e 4172 6773 280a  tionColumnArgs(.
-00012410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012420: 2020 2020 636f 6c75 6d6e 5f6e 616d 653d      column_name=
-00012430: 636f 6c75 6d6e 2e63 6f6c 756d 6e5f 6e61  column.column_na
-00012440: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-00012450: 2020 2020 2020 2020 6461 7465 7061 7274          datepart
-00012460: 3d63 6f6c 756d 6e2e 6461 7465 7061 7274  =column.datepart
-00012470: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00012480: 2020 2020 2020 7a65 726f 5f70 6164 6465        zero_padde
-00012490: 643d 636f 6c75 6d6e 2e7a 6572 6f5f 7061  d=column.zero_pa
-000124a0: 6464 6564 2c0a 2020 2020 2020 2020 2020  dded,.          
-000124b0: 2020 2020 2020 2020 2020 666f 726d 6174            format
-000124c0: 5f73 7472 696e 673d 636f 6c75 6d6e 2e66  _string=column.f
-000124d0: 6f72 6d61 745f 7374 7269 6e67 2c0a 2020  ormat_string,.  
-000124e0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-000124f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012500: 7365 6c66 2e5f 6172 6773 2e64 6174 6574  self._args.datet
-00012510: 696d 655f 7061 7274 6974 696f 6e5f 636f  ime_partition_co
-00012520: 6c75 6d6e 732e 6170 7065 6e64 2863 6f6c  lumns.append(col
-00012530: 756d 6e5f 6172 6773 290a 2020 2020 2020  umn_args).      
-00012540: 2020 6966 2070 6f73 745f 7072 6f63 6573    if post_proces
-00012550: 736f 7220 6973 206e 6f74 204e 6f6e 6520  sor is not None 
-00012560: 616e 6420 6675 6e63 7469 6f6e 5f73 6572  and function_ser
-00012570: 6961 6c69 7a61 7469 6f6e 2e73 686f 756c  ialization.shoul
-00012580: 645f 7365 7269 616c 697a 655f 6675 6e63  d_serialize_func
-00012590: 7469 6f6e 2870 6f73 745f 7072 6f63 6573  tion(post_proces
-000125a0: 736f 7229 3a0a 2020 2020 2020 2020 2020  sor):.          
-000125b0: 2020 7365 6c66 2e5f 6172 6773 2e63 6f6d    self._args.com
-000125c0: 6d6f 6e5f 6172 6773 2e70 6f73 745f 7072  mon_args.post_pr
-000125d0: 6f63 6573 736f 722e 436f 7079 4672 6f6d  ocessor.CopyFrom
-000125e0: 2866 756e 6374 696f 6e5f 7365 7269 616c  (function_serial
-000125f0: 697a 6174 696f 6e2e 746f 5f70 726f 746f  ization.to_proto
-00012600: 2870 6f73 745f 7072 6f63 6573 736f 7229  (post_processor)
-00012610: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-00012620: 5f64 6174 615f 6465 6c61 7920 3d20 6461  _data_delay = da
-00012630: 7461 5f64 656c 6179 0a20 2020 2020 2020  ta_delay.       
-00012640: 2073 656c 662e 706f 7374 5f70 726f 6365   self.post_proce
-00012650: 7373 6f72 203d 2070 6f73 745f 7072 6f63  ssor = post_proc
-00012660: 6573 736f 720a 0a20 2020 2040 7072 6f70  essor..    @prop
-00012670: 6572 7479 0a20 2020 2064 6566 2064 6174  erty.    def dat
-00012680: 615f 6465 6c61 7928 7365 6c66 293a 0a20  a_delay(self):. 
-00012690: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000126a0: 6c66 2e5f 6461 7461 5f64 656c 6179 0a0a  lf._data_delay..
-000126b0: 2020 2020 6465 6620 5f6d 6572 6765 5f62      def _merge_b
-000126c0: 6174 6368 5f61 7267 7328 7365 6c66 2c20  atch_args(self, 
-000126d0: 6461 7461 5f73 6f75 7263 655f 6172 6773  data_source_args
-000126e0: 3a20 7669 7274 7561 6c5f 6461 7461 5f73  : virtual_data_s
-000126f0: 6f75 7263 655f 7062 322e 5669 7274 7561  ource_pb2.Virtua
-00012700: 6c44 6174 6153 6f75 7263 6541 7267 7329  lDataSourceArgs)
-00012710: 3a0a 2020 2020 2020 2020 6461 7461 5f73  :.        data_s
-00012720: 6f75 7263 655f 6172 6773 2e75 6e69 7479  ource_args.unity
-00012730: 5f64 735f 636f 6e66 6967 2e43 6f70 7946  _ds_config.CopyF
-00012740: 726f 6d28 7365 6c66 2e5f 6172 6773 290a  rom(self._args).
-00012750: 0a0a 636c 6173 7320 536e 6f77 666c 616b  ..class Snowflak
-00012760: 6543 6f6e 6669 6728 4261 7365 4261 7463  eConfig(BaseBatc
-00012770: 6843 6f6e 6669 6729 3a0a 2020 2020 2222  hConfig):.    ""
-00012780: 220a 2020 2020 436f 6e66 6967 7572 6174  ".    Configurat
-00012790: 696f 6e20 7573 6564 2074 6f20 7265 6665  ion used to refe
-000127a0: 7265 6e63 6520 6120 536e 6f77 666c 616b  rence a Snowflak
-000127b0: 6520 7461 626c 6520 6f72 2071 7565 7279  e table or query
-000127c0: 2e0a 0a20 2020 2054 6865 2053 6e6f 7766  ...    The Snowf
-000127d0: 6c61 6b65 436f 6e66 6967 2063 6c61 7373  lakeConfig class
-000127e0: 2069 7320 7573 6564 2074 6f20 6372 6561   is used to crea
-000127f0: 7465 2061 2072 6566 6572 656e 6365 2074  te a reference t
-00012800: 6f20 6120 536e 6f77 666c 616b 6520 7461  o a Snowflake ta
-00012810: 626c 652e 2059 6f75 2063 616e 2061 6c73  ble. You can als
-00012820: 6f20 6372 6561 7465 2061 0a20 2020 2072  o create a.    r
-00012830: 6566 6572 656e 6365 2074 6f20 6120 7175  eference to a qu
-00012840: 6572 7920 6f6e 206f 6e65 206f 7220 6d6f  ery on one or mo
-00012850: 7265 2074 6162 6c65 732c 2077 6869 6368  re tables, which
-00012860: 2077 696c 6c20 6265 2072 6567 6973 7465   will be registe
-00012870: 7265 6420 696e 2054 6563 746f 6e20 696e  red in Tecton in
-00012880: 2061 2073 696d 696c 6172 2077 6179 2061   a similar way a
-00012890: 7320 6120 7669 6577 0a20 2020 2069 7320  s a view.    is 
-000128a0: 7265 6769 7374 6572 6564 2069 6e20 6f74  registered in ot
-000128b0: 6865 7220 6461 7461 2073 7973 7465 6d73  her data systems
-000128c0: 2e0a 0a20 2020 2054 6869 7320 636c 6173  ...    This clas
-000128d0: 7320 6973 2075 7365 6420 6173 2061 6e20  s is used as an 
-000128e0: 696e 7075 7420 746f 2061 203a 636c 6173  input to a :clas
-000128f0: 733a 6042 6174 6368 536f 7572 6365 6027  s:`BatchSource`'
-00012900: 7320 7061 7261 6d65 7465 7220 6060 6261  s parameter ``ba
-00012910: 7463 685f 636f 6e66 6967 6060 2e20 4465  tch_config``. De
-00012920: 636c 6172 696e 6720 7468 6973 2063 6f6e  claring this con
-00012930: 6669 6775 7261 7469 6f6e 0a20 2020 2063  figuration.    c
-00012940: 6c61 7373 2061 6c6f 6e65 2077 696c 6c20  lass alone will 
-00012950: 6e6f 7420 7265 6769 7374 6572 2061 2044  not register a D
-00012960: 6174 6120 536f 7572 6365 2e20 496e 7374  ata Source. Inst
-00012970: 6561 642c 2064 6563 6c61 7265 2061 7320  ead, declare as 
-00012980: 6120 7061 7274 206f 6620 6060 4261 7463  a part of ``Batc
-00012990: 6853 6f75 7263 6560 6020 7468 6174 2074  hSource`` that t
-000129a0: 616b 6573 2074 6869 7320 636f 6e66 6967  akes this config
-000129b0: 7572 6174 696f 6e0a 2020 2020 636c 6173  uration.    clas
-000129c0: 7320 696e 7374 616e 6365 2061 7320 6120  s instance as a 
-000129d0: 7061 7261 6d65 7465 722e 0a20 2020 2022  parameter..    "
-000129e0: 2222 0a0a 2020 2020 6465 6620 5f5f 696e  ""..    def __in
-000129f0: 6974 5f5f 280a 2020 2020 2020 2020 7365  it__(.        se
-00012a00: 6c66 2c0a 2020 2020 2020 2020 2a2c 0a20  lf,.        *,. 
-00012a10: 2020 2020 2020 2064 6174 6162 6173 653a         database:
-00012a20: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
-00012a30: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
-00012a40: 6368 656d 613a 204f 7074 696f 6e61 6c5b  chema: Optional[
-00012a50: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
-00012a60: 2020 2020 2077 6172 6568 6f75 7365 3a20       warehouse: 
-00012a70: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
-00012a80: 4e6f 6e65 2c0a 2020 2020 2020 2020 7572  None,.        ur
-00012a90: 6c3a 204f 7074 696f 6e61 6c5b 7374 725d  l: Optional[str]
-00012aa0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00012ab0: 2072 6f6c 653a 204f 7074 696f 6e61 6c5b   role: Optional[
-00012ac0: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
-00012ad0: 2020 2020 2074 6162 6c65 3a20 4f70 7469       table: Opti
-00012ae0: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
-00012af0: 2c0a 2020 2020 2020 2020 7175 6572 793a  ,.        query:
-00012b00: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
-00012b10: 204e 6f6e 652c 0a20 2020 2020 2020 2074   None,.        t
-00012b20: 696d 6573 7461 6d70 5f66 6965 6c64 3a20  imestamp_field: 
-00012b30: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
-00012b40: 4e6f 6e65 2c0a 2020 2020 2020 2020 706f  None,.        po
-00012b50: 7374 5f70 726f 6365 7373 6f72 3a20 4f70  st_processor: Op
-00012b60: 7469 6f6e 616c 5b43 616c 6c61 626c 655d  tional[Callable]
-00012b70: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00012b80: 2064 6174 615f 6465 6c61 793a 2064 6174   data_delay: dat
-00012b90: 6574 696d 652e 7469 6d65 6465 6c74 6120  etime.timedelta 
-00012ba0: 3d20 6461 7465 7469 6d65 2e74 696d 6564  = datetime.timed
-00012bb0: 656c 7461 2873 6563 6f6e 6473 3d30 292c  elta(seconds=0),
-00012bc0: 0a20 2020 2020 2020 2075 7365 723a 2055  .        user: U
-00012bd0: 6e69 6f6e 5b73 7472 2c20 5365 6372 6574  nion[str, Secret
-00012be0: 2c20 4e6f 6e65 5d20 3d20 4e6f 6e65 2c0a  , None] = None,.
-00012bf0: 2020 2020 2020 2020 7061 7373 776f 7264          password
-00012c00: 3a20 556e 696f 6e5b 7374 722c 2053 6563  : Union[str, Sec
-00012c10: 7265 742c 204e 6f6e 655d 203d 204e 6f6e  ret, None] = Non
-00012c20: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-00012c30: 2020 2222 220a 2020 2020 2020 2020 496e    """.        In
-00012c40: 7374 616e 7469 6174 6573 2061 206e 6577  stantiates a new
-00012c50: 2053 6e6f 7766 6c61 6b65 436f 6e66 6967   SnowflakeConfig
-00012c60: 2e20 4f6e 6520 6f66 2074 6162 6c65 2061  . One of table a
-00012c70: 6e64 2071 7565 7279 2073 686f 756c 6420  nd query should 
-00012c80: 6265 2073 7065 6369 6669 6564 2077 6865  be specified whe
-00012c90: 6e20 6372 6561 7469 6e67 2074 6869 7320  n creating this 
-00012ca0: 6669 6c65 2e0a 0a20 2020 2020 2020 203a  file...        :
-00012cb0: 7061 7261 6d20 6461 7461 6261 7365 3a20  param database: 
-00012cc0: 5468 6520 536e 6f77 666c 616b 6520 6461  The Snowflake da
-00012cd0: 7461 6261 7365 2066 6f72 2074 6869 7320  tabase for this 
-00012ce0: 4461 7461 2073 6f75 7263 652e 0a20 2020  Data source..   
-00012cf0: 2020 2020 203a 7061 7261 6d20 7363 6865       :param sche
-00012d00: 6d61 3a20 5468 6520 536e 6f77 666c 616b  ma: The Snowflak
-00012d10: 6520 7363 6865 6d61 2066 6f72 2074 6869  e schema for thi
-00012d20: 7320 4461 7461 2073 6f75 7263 652e 0a20  s Data source.. 
-00012d30: 2020 2020 2020 203a 7061 7261 6d20 7761         :param wa
-00012d40: 7265 686f 7573 653a 2054 6865 2053 6e6f  rehouse: The Sno
-00012d50: 7766 6c61 6b65 2077 6172 6568 6f75 7365  wflake warehouse
-00012d60: 2066 6f72 2074 6869 7320 4461 7461 2073   for this Data s
-00012d70: 6f75 7263 652e 2054 6869 7320 7061 7261  ource. This para
-00012d80: 6d65 7465 7220 6973 206e 6f74 2073 7570  meter is not sup
-00012d90: 706f 7274 6564 2069 6e20 5465 6374 6f6e  ported in Tecton
-00012da0: 206f 6e20 536e 6f77 666c 616b 652e 0a20   on Snowflake.. 
-00012db0: 2020 2020 2020 203a 7061 7261 6d20 7572         :param ur
-00012dc0: 6c3a 2054 6865 2063 6f6e 6e65 6374 696f  l: The connectio
-00012dd0: 6e20 5552 4c20 746f 2053 6e6f 7766 6c61  n URL to Snowfla
-00012de0: 6b65 2c20 7768 6963 6820 636f 6e74 6169  ke, which contai
-00012df0: 6e73 2061 6363 6f75 6e74 2069 6e66 6f72  ns account infor
-00012e00: 6d61 7469 6f6e 0a20 2020 2020 2020 2020  mation.         
-00012e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012e20: 2865 2e67 2e20 6874 7470 733a 2f2f 7879  (e.g. https://xy
-00012e30: 3132 3334 352e 6575 2d77 6573 742d 312e  12345.eu-west-1.
-00012e40: 736e 6f77 666c 616b 6563 6f6d 7075 7469  snowflakecomputi
-00012e50: 6e67 2e63 6f6d 292e 2054 6869 7320 7061  ng.com). This pa
-00012e60: 7261 6d65 7465 7220 6973 206e 6f74 2073  rameter is not s
-00012e70: 7570 706f 7274 6564 2069 6e20 5465 6374  upported in Tect
-00012e80: 6f6e 206f 6e20 536e 6f77 666c 616b 652e  on on Snowflake.
-00012e90: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00012ea0: 726f 6c65 3a20 5468 6520 536e 6f77 666c  role: The Snowfl
-00012eb0: 616b 6520 726f 6c65 2074 6861 7420 7368  ake role that sh
-00012ec0: 6f75 6c64 2062 6520 7573 6564 2066 6f72  ould be used for
-00012ed0: 2074 6869 7320 4461 7461 2073 6f75 7263   this Data sourc
-00012ee0: 652e 2054 6869 7320 7061 7261 6d65 7465  e. This paramete
-00012ef0: 7220 6973 206e 6f74 2073 7570 706f 7274  r is not support
-00012f00: 6564 2069 6e20 5465 6374 6f6e 206f 6e20  ed in Tecton on 
-00012f10: 536e 6f77 666c 616b 652e 0a0a 2020 2020  Snowflake...    
-00012f20: 2020 2020 3a70 6172 616d 2074 6162 6c65      :param table
-00012f30: 3a20 5468 6520 7461 626c 6520 666f 7220  : The table for 
-00012f40: 7468 6973 2044 6174 6120 736f 7572 6365  this Data source
-00012f50: 2e20 4f6e 6c79 206f 6e65 206f 6620 6074  . Only one of `t
-00012f60: 6162 6c65 6020 616e 6420 6071 7565 7279  able` and `query
-00012f70: 6020 6d75 7374 2062 6520 7370 6563 6966  ` must be specif
-00012f80: 6965 642e 2049 6620 7573 696e 6720 5269  ied. If using Ri
-00012f90: 6674 2c0a 2020 2020 2020 2020 2020 2020  ft,.            
-00012fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012fb0: 2020 2020 2020 2020 7468 6973 2074 6162          this tab
-00012fc0: 6c65 206e 616d 6520 6361 6e6e 6f74 2069  le name cannot i
-00012fd0: 6e63 6c75 6465 2071 756f 7461 7469 6f6e  nclude quotation
-00012fe0: 206d 6172 6b73 2e20 466f 7220 6578 616d   marks. For exam
-00012ff0: 706c 652c 2074 6865 0a20 2020 2020 2020  ple, the.       
-00013000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013010: 2020 2020 2020 2020 2020 2020 2074 6162               tab
-00013020: 6c65 206e 616d 6520 2766 6f6f 2262 6172  le name 'foo"bar
-00013030: 2720 6973 206e 6f74 2073 7570 706f 7274  ' is not support
-00013040: 6564 2e0a 2020 2020 2020 2020 3a70 6172  ed..        :par
-00013050: 616d 2071 7565 7279 3a20 5468 6520 7175  am query: The qu
-00013060: 6572 7920 666f 7220 7468 6973 2044 6174  ery for this Dat
-00013070: 6120 736f 7572 6365 2e20 4f6e 6c79 206f  a source. Only o
-00013080: 6e65 206f 6620 6074 6162 6c65 6020 616e  ne of `table` an
-00013090: 6420 6071 7565 7279 6020 6d75 7374 2062  d `query` must b
-000130a0: 6520 7370 6563 6966 6965 642e 0a20 2020  e specified..   
-000130b0: 2020 2020 203a 7061 7261 6d20 7469 6d65       :param time
-000130c0: 7374 616d 705f 6669 656c 643a 2054 6865  stamp_field: The
-000130d0: 2074 696d 6573 7461 6d70 2063 6f6c 756d   timestamp colum
-000130e0: 6e20 696e 2074 6869 7320 6461 7461 2073  n in this data s
-000130f0: 6f75 7263 6520 7468 6174 2073 686f 756c  ource that shoul
-00013100: 6420 6265 2075 7365 6420 6279 2060 4669  d be used by `Fi
-00013110: 6c74 6572 6564 536f 7572 6365 600a 2020  lteredSource`.  
-00013120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013140: 2020 746f 2066 696c 7465 7220 6461 7461    to filter data
-00013150: 2066 726f 6d20 7468 6973 2073 6f75 7263   from this sourc
-00013160: 652c 2062 6566 6f72 6520 616e 7920 6665  e, before any fe
-00013170: 6174 7572 6520 7669 6577 2074 7261 6e73  ature view trans
-00013180: 666f 726d 6174 696f 6e73 2061 7265 2061  formations are a
-00013190: 7070 6c69 6564 2e0a 2020 2020 2020 2020  pplied..        
-000131a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000131b0: 2020 2020 2020 2020 2020 2020 4f6e 6c79              Only
-000131c0: 2072 6571 7569 7265 6420 6966 2074 6869   required if thi
-000131d0: 7320 736f 7572 6365 2069 7320 7573 6564  s source is used
-000131e0: 2077 6974 6820 6046 696c 7465 7265 6453   with `FilteredS
-000131f0: 6f75 7263 6560 2e0a 2020 2020 2020 2020  ource`..        
-00013200: 3a70 6172 616d 2070 6f73 745f 7072 6f63  :param post_proc
-00013210: 6573 736f 723a 2050 7974 686f 6e20 7573  essor: Python us
-00013220: 6572 2064 6566 696e 6564 2066 756e 6374  er defined funct
-00013230: 696f 6e20 6060 6628 4461 7461 4672 616d  ion ``f(DataFram
-00013240: 6529 202d 3e20 4461 7461 4672 616d 6560  e) -> DataFrame`
-00013250: 6020 7468 6174 2074 616b 6573 2069 6e20  ` that takes in 
-00013260: 7261 770a 2020 2020 2020 2020 2020 2020  raw.            
-00013270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013280: 2020 2020 2020 2020 2050 7953 7061 726b           PySpark
-00013290: 2064 6174 6120 736f 7572 6365 2044 6174   data source Dat
-000132a0: 6146 7261 6d65 2061 6e64 2074 7261 6e73  aFrame and trans
-000132b0: 6c61 7465 7320 6974 2074 6f20 7468 6520  lates it to the 
-000132c0: 4461 7461 4672 616d 6520 746f 2062 650a  DataFrame to be.
-000132d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000132e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000132f0: 2020 2020 2063 6f6e 7375 6d65 6420 6279       consumed by
-00013300: 2074 6865 2046 6561 7475 7265 2056 6965   the Feature Vie
-00013310: 772e 2054 6869 7320 7061 7261 6d65 7465  w. This paramete
-00013320: 7220 6973 206e 6f74 2073 7570 706f 7274  r is not support
-00013330: 6564 2069 6e20 5465 6374 6f6e 206f 6e20  ed in Tecton on 
-00013340: 536e 6f77 666c 616b 652e 0a20 2020 2020  Snowflake..     
-00013350: 2020 203a 7061 7261 6d20 6461 7461 5f64     :param data_d
-00013360: 656c 6179 3a20 4279 2064 6566 6175 6c74  elay: By default
-00013370: 2c20 696e 6372 656d 656e 7461 6c20 6d61  , incremental ma
-00013380: 7465 7269 616c 697a 6174 696f 6e20 6a6f  terialization jo
-00013390: 6273 2072 756e 2069 6d6d 6564 6961 7465  bs run immediate
-000133a0: 6c79 2061 7420 7468 6520 656e 6420 6f66  ly at the end of
-000133b0: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-000133c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133d0: 2020 2020 2020 2020 2062 6174 6368 2073           batch s
-000133e0: 6368 6564 756c 6520 7065 7269 6f64 2e20  chedule period. 
-000133f0: 5468 6973 2070 6172 616d 6574 6572 2063  This parameter c
-00013400: 6f6e 6669 6775 7265 7320 686f 7720 6c6f  onfigures how lo
-00013410: 6e67 2074 6865 7920 7761 6974 2061 6674  ng they wait aft
-00013420: 6572 2074 6865 2065 6e64 0a20 2020 2020  er the end.     
-00013430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013440: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00013450: 6620 7468 6520 7065 7269 6f64 2062 6566  f the period bef
-00013460: 6f72 6520 7374 6172 7469 6e67 2c20 7479  ore starting, ty
-00013470: 7069 6361 6c6c 7920 746f 2065 6e73 7572  pically to ensur
-00013480: 6520 7468 6174 2061 6c6c 2064 6174 6120  e that all data 
-00013490: 6861 7320 6c61 6e64 6564 2e0a 2020 2020  has landed..    
-000134a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000134b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000134c0: 466f 7220 6578 616d 706c 652c 2069 6620  For example, if 
-000134d0: 6120 6665 6174 7572 6520 7669 6577 2068  a feature view h
-000134e0: 6173 2061 2060 6261 7463 685f 7363 6865  as a `batch_sche
-000134f0: 6475 6c65 6020 6f66 2031 2064 6179 2061  dule` of 1 day a
-00013500: 6e64 206f 6e65 206f 660a 2020 2020 2020  nd one of.      
-00013510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013520: 2020 2020 2020 2020 2020 2020 2020 7468                th
-00013530: 6520 6461 7461 2073 6f75 7263 6520 696e  e data source in
-00013540: 7075 7473 2068 6173 2060 6461 7461 5f64  puts has `data_d
-00013550: 656c 6179 3d74 696d 6564 656c 7461 2868  elay=timedelta(h
-00013560: 6f75 7273 3d31 2960 2073 6574 2c20 7468  ours=1)` set, th
-00013570: 656e 0a20 2020 2020 2020 2020 2020 2020  en.             
-00013580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013590: 2020 2020 2020 2069 6e63 7265 6d65 6e74         increment
-000135a0: 616c 206d 6174 6572 6961 6c69 7a61 7469  al materializati
-000135b0: 6f6e 206a 6f62 7320 7769 6c6c 2072 756e  on jobs will run
-000135c0: 2061 7420 6030 313a 3030 6020 5554 432e   at `01:00` UTC.
-000135d0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000135e0: 7573 6572 3a20 284f 6e6c 7920 7375 7070  user: (Only supp
-000135f0: 6f72 7465 6420 696e 2052 6966 7429 2054  orted in Rift) T
-00013600: 6865 2075 7365 7220 7573 6564 2074 6f20  he user used to 
-00013610: 636f 6e6e 6563 7420 746f 2053 6e6f 7766  connect to Snowf
-00013620: 6c61 6b65 2e0a 2020 2020 2020 2020 2020  lake..          
-00013630: 2020 2020 2020 2020 2020 2054 6869 7320             This 
-00013640: 6361 6e20 6265 2061 2073 7472 696e 6720  can be a string 
-00013650: 6f72 2061 2060 5365 6372 6574 602e 2049  or a `Secret`. I
-00013660: 6620 756e 7365 7420 534e 4f57 464c 414b  f unset SNOWFLAK
-00013670: 455f 5553 4552 2066 726f 6d20 7468 6520  E_USER from the 
-00013680: 656e 7669 726f 6e6d 656e 7420 6973 2075  environment is u
-00013690: 7365 642e 0a20 2020 2020 2020 203a 7061  sed..        :pa
-000136a0: 7261 6d20 7061 7373 776f 7264 3a20 284f  ram password: (O
-000136b0: 6e6c 7920 7375 7070 6f72 7465 6420 696e  nly supported in
-000136c0: 2052 6966 7429 2054 6865 2070 6173 7377   Rift) The passw
-000136d0: 6f72 6420 7573 6564 2074 6f20 636f 6e6e  ord used to conn
-000136e0: 6563 7420 746f 2053 6e6f 7766 6c61 6b65  ect to Snowflake
-000136f0: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00013700: 2020 2020 2020 2020 2020 2054 6869 7320             This 
-00013710: 6361 6e20 6265 2061 2073 7472 696e 6720  can be a string 
-00013720: 6f72 2061 2060 5365 6372 6574 602e 2049  or a `Secret`. I
-00013730: 6620 756e 7365 7420 534e 4f57 464c 414b  f unset SNOWFLAK
-00013740: 455f 5041 5353 574f 5244 2066 726f 6d20  E_PASSWORD from 
-00013750: 7468 6520 656e 7669 726f 6e6d 656e 7420  the environment 
-00013760: 6973 2075 7365 642e 0a0a 2020 2020 2020  is used...      
-00013770: 2020 3a72 6574 7572 6e3a 2041 2053 6e6f    :return: A Sno
-00013780: 7766 6c61 6b65 436f 6e66 6967 2063 6c61  wflakeConfig cla
-00013790: 7373 2069 6e73 7461 6e63 652e 0a0a 0a20  ss instance.... 
-000137a0: 2020 2020 2020 2045 7861 6d70 6c65 206f         Example o
-000137b0: 6620 6120 536e 6f77 666c 616b 6543 6f6e  f a SnowflakeCon
-000137c0: 6669 6720 6465 636c 6172 6174 696f 6e3a  fig declaration:
-000137d0: 0a0a 2020 2020 2020 2020 2e2e 2063 6f64  ..        .. cod
-000137e0: 652d 626c 6f63 6b3a 3a20 7079 7468 6f6e  e-block:: python
-000137f0: 0a0a 2020 2020 2020 2020 2020 2020 6672  ..            fr
-00013800: 6f6d 2074 6563 746f 6e20 696d 706f 7274  om tecton import
-00013810: 2053 6e6f 7766 6c61 6b65 436f 6e66 6967   SnowflakeConfig
-00013820: 2c20 4261 7463 6853 6f75 7263 650a 0a20  , BatchSource.. 
-00013830: 2020 2020 2020 2020 2020 2023 2044 6563             # Dec
-00013840: 6c61 7265 2053 6e6f 7766 6c61 6b65 436f  lare SnowflakeCo
-00013850: 6e66 6967 2069 6e73 7461 6e63 6520 6f62  nfig instance ob
-00013860: 6a65 6374 2074 6861 7420 6361 6e20 6265  ject that can be
-00013870: 2075 7365 6420 6173 2061 6e20 6172 6775   used as an argu
-00013880: 6d65 6e74 2069 6e20 4261 7463 6853 6f75  ment in BatchSou
-00013890: 7263 650a 2020 2020 2020 2020 2020 2020  rce.            
-000138a0: 736e 6f77 666c 616b 655f 6473 5f63 6f6e  snowflake_ds_con
-000138b0: 6669 6720 3d20 536e 6f77 666c 616b 6543  fig = SnowflakeC
-000138c0: 6f6e 6669 6728 0a20 2020 2020 2020 2020  onfig(.         
-000138d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000138e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000138f0: 2020 2020 2075 726c 3d22 6874 7470 733a       url="https:
-00013900: 2f2f 3c79 6f75 722d 636c 7573 7465 723e  //<your-cluster>
-00013910: 2e65 752d 7765 7374 2d31 2e73 6e6f 7766  .eu-west-1.snowf
-00013920: 6c61 6b65 636f 6d70 7574 696e 672e 636f  lakecomputing.co
-00013930: 6d2f 222c 0a20 2020 2020 2020 2020 2020  m/",.           
-00013940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013960: 2020 2064 6174 6162 6173 653d 2243 4c49     database="CLI
-00013970: 434b 5f53 5452 4541 4d5f 4442 222c 0a20  CK_STREAM_DB",. 
+00011e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011e80: 2020 636f 6e73 756d 6564 2062 7920 7468    consumed by th
+00011e90: 6520 4665 6174 7572 6520 5669 6577 2e0a  e Feature View..
+00011ea0: 2020 2020 2020 2020 3a70 6172 616d 2064          :param d
+00011eb0: 6174 615f 6465 6c61 793a 2042 7920 6465  ata_delay: By de
+00011ec0: 6661 756c 742c 2069 6e63 7265 6d65 6e74  fault, increment
+00011ed0: 616c 206d 6174 6572 6961 6c69 7a61 7469  al materializati
+00011ee0: 6f6e 206a 6f62 7320 7275 6e20 696d 6d65  on jobs run imme
+00011ef0: 6469 6174 656c 7920 6174 2074 6865 2065  diately at the e
+00011f00: 6e64 206f 6620 7468 650a 2020 2020 2020  nd of the.      
+00011f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011f20: 2020 2020 2020 2020 2020 2020 2020 6261                ba
+00011f30: 7463 6820 7363 6865 6475 6c65 2070 6572  tch schedule per
+00011f40: 696f 642e 2054 6869 7320 7061 7261 6d65  iod. This parame
+00011f50: 7465 7220 636f 6e66 6967 7572 6573 2068  ter configures h
+00011f60: 6f77 206c 6f6e 6720 7468 6579 2077 6169  ow long they wai
+00011f70: 7420 6166 7465 7220 7468 6520 656e 640a  t after the end.
+00011f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011fa0: 2020 2020 6f66 2074 6865 2070 6572 696f      of the perio
+00011fb0: 6420 6265 666f 7265 2073 7461 7274 696e  d before startin
+00011fc0: 672c 2074 7970 6963 616c 6c79 2074 6f20  g, typically to 
+00011fd0: 656e 7375 7265 2074 6861 7420 616c 6c20  ensure that all 
+00011fe0: 6461 7461 2068 6173 206c 616e 6465 642e  data has landed.
+00011ff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012010: 2020 2020 2046 6f72 2065 7861 6d70 6c65       For example
+00012020: 2c20 6966 2061 2066 6561 7475 7265 2076  , if a feature v
+00012030: 6965 7720 6861 7320 6120 6062 6174 6368  iew has a `batch
+00012040: 5f73 6368 6564 756c 6560 206f 6620 3120  _schedule` of 1 
+00012050: 6461 7920 616e 6420 6f6e 6520 6f66 0a20  day and one of. 
+00012060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012080: 2020 2074 6865 2064 6174 6120 736f 7572     the data sour
+00012090: 6365 2069 6e70 7574 7320 6861 7320 6064  ce inputs has `d
+000120a0: 6174 615f 6465 6c61 793d 7469 6d65 6465  ata_delay=timede
+000120b0: 6c74 6128 686f 7572 733d 3129 6020 7365  lta(hours=1)` se
+000120c0: 742c 2074 6865 6e0a 2020 2020 2020 2020  t, then.        
+000120d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000120e0: 2020 2020 2020 2020 2020 2020 696e 6372              incr
+000120f0: 656d 656e 7461 6c20 6d61 7465 7269 616c  emental material
+00012100: 697a 6174 696f 6e20 6a6f 6273 2077 696c  ization jobs wil
+00012110: 6c20 7275 6e20 6174 2060 3031 3a30 3060  l run at `01:00`
+00012120: 2055 5443 2e0a 2020 2020 2020 2020 3a70   UTC..        :p
+00012130: 6172 616d 2061 6363 6573 735f 6d6f 6465  aram access_mode
+00012140: 3a20 5468 6520 556e 6974 7920 4361 7461  : The Unity Cata
+00012150: 6c6f 6720 4163 6365 7373 204d 6f64 6520  log Access Mode 
+00012160: 666f 7220 7468 6520 556e 6974 7920 7461  for the Unity ta
+00012170: 626c 652e 2049 6620 6e6f 7420 7370 6563  ble. If not spec
+00012180: 6966 6965 642c 2075 7365 7320 7468 6520  ified, uses the 
+00012190: 5369 6e67 6c65 2055 7365 720a 2020 2020  Single User.    
+000121a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000121b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000121c0: 4163 6365 7373 204d 6f64 6520 6173 2064  Access Mode as d
+000121d0: 6566 6175 6c74 2e0a 0a20 2020 2020 2020  efault...       
+000121e0: 203a 7265 7475 726e 3a20 4120 556e 6974   :return: A Unit
+000121f0: 7943 6f6e 6669 6720 636c 6173 7320 696e  yConfig class in
+00012200: 7374 616e 6365 2e0a 0a20 2020 2020 2020  stance...       
+00012210: 2022 2222 0a20 2020 2020 2020 2073 656c   """.        sel
+00012220: 662e 5f61 7267 7320 3d20 6461 7461 5f73  f._args = data_s
+00012230: 6f75 7263 655f 7062 322e 556e 6974 7944  ource_pb2.UnityD
+00012240: 6174 6153 6f75 7263 6541 7267 7328 0a20  ataSourceArgs(. 
+00012250: 2020 2020 2020 2020 2020 2063 6174 616c             catal
+00012260: 6f67 3d63 6174 616c 6f67 2c0a 2020 2020  og=catalog,.    
+00012270: 2020 2020 2020 2020 7363 6865 6d61 3d73          schema=s
+00012280: 6368 656d 612c 0a20 2020 2020 2020 2020  chema,.         
+00012290: 2020 2074 6162 6c65 3d74 6162 6c65 2c0a     table=table,.
+000122a0: 2020 2020 2020 2020 2020 2020 7469 6d65              time
+000122b0: 7374 616d 705f 666f 726d 6174 3d74 696d  stamp_format=tim
+000122c0: 6573 7461 6d70 5f66 6f72 6d61 742c 0a20  estamp_format,. 
+000122d0: 2020 2020 2020 2020 2020 2063 6f6d 6d6f             commo
+000122e0: 6e5f 6172 6773 3d64 6174 615f 736f 7572  n_args=data_sour
+000122f0: 6365 5f70 6232 2e42 6174 6368 4461 7461  ce_pb2.BatchData
+00012300: 536f 7572 6365 436f 6d6d 6f6e 4172 6773  SourceCommonArgs
+00012310: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00012320: 2020 6461 7461 5f64 656c 6179 3d74 696d    data_delay=tim
+00012330: 655f 7574 696c 732e 7469 6d65 6465 6c74  e_utils.timedelt
+00012340: 615f 746f 5f70 726f 746f 2864 6174 615f  a_to_proto(data_
+00012350: 6465 6c61 7929 2c0a 2020 2020 2020 2020  delay),.        
+00012360: 2020 2020 2020 2020 7469 6d65 7374 616d          timestam
+00012370: 705f 6669 656c 643d 7469 6d65 7374 616d  p_field=timestam
+00012380: 705f 6669 656c 642c 0a20 2020 2020 2020  p_field,.       
+00012390: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+000123a0: 2020 2020 6163 6365 7373 5f6d 6f64 653d      access_mode=
+000123b0: 6163 6365 7373 5f6d 6f64 652e 7661 6c75  access_mode.valu
+000123c0: 6520 6966 2061 6363 6573 735f 6d6f 6465  e if access_mode
+000123d0: 2069 7320 6e6f 7420 4e6f 6e65 2065 6c73   is not None els
+000123e0: 6520 556e 6974 7943 6174 616c 6f67 4163  e UnityCatalogAc
+000123f0: 6365 7373 4d6f 6465 2e53 494e 474c 455f  cessMode.SINGLE_
+00012400: 5553 4552 2e76 616c 7565 2c0a 2020 2020  USER.value,.    
+00012410: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
+00012420: 6620 6461 7465 7469 6d65 5f70 6172 7469  f datetime_parti
+00012430: 7469 6f6e 5f63 6f6c 756d 6e73 3a0a 2020  tion_columns:.  
+00012440: 2020 2020 2020 2020 2020 666f 7220 636f            for co
+00012450: 6c75 6d6e 2069 6e20 6461 7465 7469 6d65  lumn in datetime
+00012460: 5f70 6172 7469 7469 6f6e 5f63 6f6c 756d  _partition_colum
+00012470: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+00012480: 2020 2020 636f 6c75 6d6e 5f61 7267 7320      column_args 
+00012490: 3d20 6461 7461 5f73 6f75 7263 655f 7062  = data_source_pb
+000124a0: 322e 4461 7465 7469 6d65 5061 7274 6974  2.DatetimePartit
+000124b0: 696f 6e43 6f6c 756d 6e41 7267 7328 0a20  ionColumnArgs(. 
+000124c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000124d0: 2020 2063 6f6c 756d 6e5f 6e61 6d65 3d63     column_name=c
+000124e0: 6f6c 756d 6e2e 636f 6c75 6d6e 5f6e 616d  olumn.column_nam
+000124f0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00012500: 2020 2020 2020 2064 6174 6570 6172 743d         datepart=
+00012510: 636f 6c75 6d6e 2e64 6174 6570 6172 742c  column.datepart,
+00012520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012530: 2020 2020 207a 6572 6f5f 7061 6464 6564       zero_padded
+00012540: 3d63 6f6c 756d 6e2e 7a65 726f 5f70 6164  =column.zero_pad
+00012550: 6465 642c 0a20 2020 2020 2020 2020 2020  ded,.           
+00012560: 2020 2020 2020 2020 2066 6f72 6d61 745f           format_
+00012570: 7374 7269 6e67 3d63 6f6c 756d 6e2e 666f  string=column.fo
+00012580: 726d 6174 5f73 7472 696e 672c 0a20 2020  rmat_string,.   
+00012590: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+000125a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000125b0: 656c 662e 5f61 7267 732e 6461 7465 7469  elf._args.dateti
+000125c0: 6d65 5f70 6172 7469 7469 6f6e 5f63 6f6c  me_partition_col
+000125d0: 756d 6e73 2e61 7070 656e 6428 636f 6c75  umns.append(colu
+000125e0: 6d6e 5f61 7267 7329 0a20 2020 2020 2020  mn_args).       
+000125f0: 2069 6620 706f 7374 5f70 726f 6365 7373   if post_process
+00012600: 6f72 2069 7320 6e6f 7420 4e6f 6e65 2061  or is not None a
+00012610: 6e64 2066 756e 6374 696f 6e5f 7365 7269  nd function_seri
+00012620: 616c 697a 6174 696f 6e2e 7368 6f75 6c64  alization.should
+00012630: 5f73 6572 6961 6c69 7a65 5f66 756e 6374  _serialize_funct
+00012640: 696f 6e28 706f 7374 5f70 726f 6365 7373  ion(post_process
+00012650: 6f72 293a 0a20 2020 2020 2020 2020 2020  or):.           
+00012660: 2073 656c 662e 5f61 7267 732e 636f 6d6d   self._args.comm
+00012670: 6f6e 5f61 7267 732e 706f 7374 5f70 726f  on_args.post_pro
+00012680: 6365 7373 6f72 2e43 6f70 7946 726f 6d28  cessor.CopyFrom(
+00012690: 6675 6e63 7469 6f6e 5f73 6572 6961 6c69  function_seriali
+000126a0: 7a61 7469 6f6e 2e74 6f5f 7072 6f74 6f28  zation.to_proto(
+000126b0: 706f 7374 5f70 726f 6365 7373 6f72 2929  post_processor))
+000126c0: 0a0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+000126d0: 6461 7461 5f64 656c 6179 203d 2064 6174  data_delay = dat
+000126e0: 615f 6465 6c61 790a 2020 2020 2020 2020  a_delay.        
+000126f0: 7365 6c66 2e70 6f73 745f 7072 6f63 6573  self.post_proces
+00012700: 736f 7220 3d20 706f 7374 5f70 726f 6365  sor = post_proce
+00012710: 7373 6f72 0a0a 2020 2020 4070 726f 7065  ssor..    @prope
+00012720: 7274 790a 2020 2020 6465 6620 6461 7461  rty.    def data
+00012730: 5f64 656c 6179 2873 656c 6629 3a0a 2020  _delay(self):.  
+00012740: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00012750: 662e 5f64 6174 615f 6465 6c61 790a 0a20  f._data_delay.. 
+00012760: 2020 2064 6566 205f 6d65 7267 655f 6261     def _merge_ba
+00012770: 7463 685f 6172 6773 2873 656c 662c 2064  tch_args(self, d
+00012780: 6174 615f 736f 7572 6365 5f61 7267 733a  ata_source_args:
+00012790: 2076 6972 7475 616c 5f64 6174 615f 736f   virtual_data_so
+000127a0: 7572 6365 5f70 6232 2e56 6972 7475 616c  urce_pb2.Virtual
+000127b0: 4461 7461 536f 7572 6365 4172 6773 293a  DataSourceArgs):
+000127c0: 0a20 2020 2020 2020 2064 6174 615f 736f  .        data_so
+000127d0: 7572 6365 5f61 7267 732e 756e 6974 795f  urce_args.unity_
+000127e0: 6473 5f63 6f6e 6669 672e 436f 7079 4672  ds_config.CopyFr
+000127f0: 6f6d 2873 656c 662e 5f61 7267 7329 0a0a  om(self._args)..
+00012800: 0a63 6c61 7373 2053 6e6f 7766 6c61 6b65  .class Snowflake
+00012810: 436f 6e66 6967 2842 6173 6542 6174 6368  Config(BaseBatch
+00012820: 436f 6e66 6967 293a 0a20 2020 2022 2222  Config):.    """
+00012830: 0a20 2020 2043 6f6e 6669 6775 7261 7469  .    Configurati
+00012840: 6f6e 2075 7365 6420 746f 2072 6566 6572  on used to refer
+00012850: 656e 6365 2061 2053 6e6f 7766 6c61 6b65  ence a Snowflake
+00012860: 2074 6162 6c65 206f 7220 7175 6572 792e   table or query.
+00012870: 0a0a 2020 2020 5468 6520 536e 6f77 666c  ..    The Snowfl
+00012880: 616b 6543 6f6e 6669 6720 636c 6173 7320  akeConfig class 
+00012890: 6973 2075 7365 6420 746f 2063 7265 6174  is used to creat
+000128a0: 6520 6120 7265 6665 7265 6e63 6520 746f  e a reference to
+000128b0: 2061 2053 6e6f 7766 6c61 6b65 2074 6162   a Snowflake tab
+000128c0: 6c65 2e20 596f 7520 6361 6e20 616c 736f  le. You can also
+000128d0: 2063 7265 6174 6520 610a 2020 2020 7265   create a.    re
+000128e0: 6665 7265 6e63 6520 746f 2061 2071 7565  ference to a que
+000128f0: 7279 206f 6e20 6f6e 6520 6f72 206d 6f72  ry on one or mor
+00012900: 6520 7461 626c 6573 2c20 7768 6963 6820  e tables, which 
+00012910: 7769 6c6c 2062 6520 7265 6769 7374 6572  will be register
+00012920: 6564 2069 6e20 5465 6374 6f6e 2069 6e20  ed in Tecton in 
+00012930: 6120 7369 6d69 6c61 7220 7761 7920 6173  a similar way as
+00012940: 2061 2076 6965 770a 2020 2020 6973 2072   a view.    is r
+00012950: 6567 6973 7465 7265 6420 696e 206f 7468  egistered in oth
+00012960: 6572 2064 6174 6120 7379 7374 656d 732e  er data systems.
+00012970: 0a0a 2020 2020 5468 6973 2063 6c61 7373  ..    This class
+00012980: 2069 7320 7573 6564 2061 7320 616e 2069   is used as an i
+00012990: 6e70 7574 2074 6f20 6120 3a63 6c61 7373  nput to a :class
+000129a0: 3a60 4261 7463 6853 6f75 7263 6560 2773  :`BatchSource`'s
+000129b0: 2070 6172 616d 6574 6572 2060 6062 6174   parameter ``bat
+000129c0: 6368 5f63 6f6e 6669 6760 602e 2044 6563  ch_config``. Dec
+000129d0: 6c61 7269 6e67 2074 6869 7320 636f 6e66  laring this conf
+000129e0: 6967 7572 6174 696f 6e0a 2020 2020 636c  iguration.    cl
+000129f0: 6173 7320 616c 6f6e 6520 7769 6c6c 206e  ass alone will n
+00012a00: 6f74 2072 6567 6973 7465 7220 6120 4461  ot register a Da
+00012a10: 7461 2053 6f75 7263 652e 2049 6e73 7465  ta Source. Inste
+00012a20: 6164 2c20 6465 636c 6172 6520 6173 2061  ad, declare as a
+00012a30: 2070 6172 7420 6f66 2060 6042 6174 6368   part of ``Batch
+00012a40: 536f 7572 6365 6060 2074 6861 7420 7461  Source`` that ta
+00012a50: 6b65 7320 7468 6973 2063 6f6e 6669 6775  kes this configu
+00012a60: 7261 7469 6f6e 0a20 2020 2063 6c61 7373  ration.    class
+00012a70: 2069 6e73 7461 6e63 6520 6173 2061 2070   instance as a p
+00012a80: 6172 616d 6574 6572 2e0a 2020 2020 2222  arameter..    ""
+00012a90: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
+00012aa0: 745f 5f28 0a20 2020 2020 2020 2073 656c  t__(.        sel
+00012ab0: 662c 0a20 2020 2020 2020 202a 2c0a 2020  f,.        *,.  
+00012ac0: 2020 2020 2020 6461 7461 6261 7365 3a20        database: 
+00012ad0: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+00012ae0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7363  None,.        sc
+00012af0: 6865 6d61 3a20 4f70 7469 6f6e 616c 5b73  hema: Optional[s
+00012b00: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
+00012b10: 2020 2020 7761 7265 686f 7573 653a 204f      warehouse: O
+00012b20: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
+00012b30: 6f6e 652c 0a20 2020 2020 2020 2075 726c  one,.        url
+00012b40: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+00012b50: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+00012b60: 726f 6c65 3a20 4f70 7469 6f6e 616c 5b73  role: Optional[s
+00012b70: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
+00012b80: 2020 2020 7461 626c 653a 204f 7074 696f      table: Optio
+00012b90: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
+00012ba0: 0a20 2020 2020 2020 2071 7565 7279 3a20  .        query: 
+00012bb0: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+00012bc0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7469  None,.        ti
+00012bd0: 6d65 7374 616d 705f 6669 656c 643a 204f  mestamp_field: O
+00012be0: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
+00012bf0: 6f6e 652c 0a20 2020 2020 2020 2070 6f73  one,.        pos
+00012c00: 745f 7072 6f63 6573 736f 723a 204f 7074  t_processor: Opt
+00012c10: 696f 6e61 6c5b 4361 6c6c 6162 6c65 5d20  ional[Callable] 
+00012c20: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+00012c30: 6461 7461 5f64 656c 6179 3a20 6461 7465  data_delay: date
+00012c40: 7469 6d65 2e74 696d 6564 656c 7461 203d  time.timedelta =
+00012c50: 2064 6174 6574 696d 652e 7469 6d65 6465   datetime.timede
+00012c60: 6c74 6128 7365 636f 6e64 733d 3029 2c0a  lta(seconds=0),.
+00012c70: 2020 2020 2020 2020 7573 6572 3a20 556e          user: Un
+00012c80: 696f 6e5b 7374 722c 2053 6563 7265 742c  ion[str, Secret,
+00012c90: 204e 6f6e 655d 203d 204e 6f6e 652c 0a20   None] = None,. 
+00012ca0: 2020 2020 2020 2070 6173 7377 6f72 643a         password:
+00012cb0: 2055 6e69 6f6e 5b73 7472 2c20 5365 6372   Union[str, Secr
+00012cc0: 6574 2c20 4e6f 6e65 5d20 3d20 4e6f 6e65  et, None] = None
+00012cd0: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+00012ce0: 2022 2222 0a20 2020 2020 2020 2049 6e73   """.        Ins
+00012cf0: 7461 6e74 6961 7465 7320 6120 6e65 7720  tantiates a new 
+00012d00: 536e 6f77 666c 616b 6543 6f6e 6669 672e  SnowflakeConfig.
+00012d10: 204f 6e65 206f 6620 7461 626c 6520 616e   One of table an
+00012d20: 6420 7175 6572 7920 7368 6f75 6c64 2062  d query should b
+00012d30: 6520 7370 6563 6966 6965 6420 7768 656e  e specified when
+00012d40: 2063 7265 6174 696e 6720 7468 6973 2066   creating this f
+00012d50: 696c 652e 0a0a 2020 2020 2020 2020 3a70  ile...        :p
+00012d60: 6172 616d 2064 6174 6162 6173 653a 2054  aram database: T
+00012d70: 6865 2053 6e6f 7766 6c61 6b65 2064 6174  he Snowflake dat
+00012d80: 6162 6173 6520 666f 7220 7468 6973 2044  abase for this D
+00012d90: 6174 6120 736f 7572 6365 2e0a 2020 2020  ata source..    
+00012da0: 2020 2020 3a70 6172 616d 2073 6368 656d      :param schem
+00012db0: 613a 2054 6865 2053 6e6f 7766 6c61 6b65  a: The Snowflake
+00012dc0: 2073 6368 656d 6120 666f 7220 7468 6973   schema for this
+00012dd0: 2044 6174 6120 736f 7572 6365 2e0a 2020   Data source..  
+00012de0: 2020 2020 2020 3a70 6172 616d 2077 6172        :param war
+00012df0: 6568 6f75 7365 3a20 5468 6520 536e 6f77  ehouse: The Snow
+00012e00: 666c 616b 6520 7761 7265 686f 7573 6520  flake warehouse 
+00012e10: 666f 7220 7468 6973 2044 6174 6120 736f  for this Data so
+00012e20: 7572 6365 2e20 5468 6973 2070 6172 616d  urce. This param
+00012e30: 6574 6572 2069 7320 6e6f 7420 7375 7070  eter is not supp
+00012e40: 6f72 7465 6420 696e 2054 6563 746f 6e20  orted in Tecton 
+00012e50: 6f6e 2053 6e6f 7766 6c61 6b65 2e0a 2020  on Snowflake..  
+00012e60: 2020 2020 2020 3a70 6172 616d 2075 726c        :param url
+00012e70: 3a20 5468 6520 636f 6e6e 6563 7469 6f6e  : The connection
+00012e80: 2055 524c 2074 6f20 536e 6f77 666c 616b   URL to Snowflak
+00012e90: 652c 2077 6869 6368 2063 6f6e 7461 696e  e, which contain
+00012ea0: 7320 6163 636f 756e 7420 696e 666f 726d  s account inform
+00012eb0: 6174 696f 6e0a 2020 2020 2020 2020 2020  ation.          
+00012ec0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+00012ed0: 652e 672e 2068 7474 7073 3a2f 2f78 7931  e.g. https://xy1
+00012ee0: 3233 3435 2e65 752d 7765 7374 2d31 2e73  2345.eu-west-1.s
+00012ef0: 6e6f 7766 6c61 6b65 636f 6d70 7574 696e  nowflakecomputin
+00012f00: 672e 636f 6d29 2e20 5468 6973 2070 6172  g.com). This par
+00012f10: 616d 6574 6572 2069 7320 6e6f 7420 7375  ameter is not su
+00012f20: 7070 6f72 7465 6420 696e 2054 6563 746f  pported in Tecto
+00012f30: 6e20 6f6e 2053 6e6f 7766 6c61 6b65 2e0a  n on Snowflake..
+00012f40: 2020 2020 2020 2020 3a70 6172 616d 2072          :param r
+00012f50: 6f6c 653a 2054 6865 2053 6e6f 7766 6c61  ole: The Snowfla
+00012f60: 6b65 2072 6f6c 6520 7468 6174 2073 686f  ke role that sho
+00012f70: 756c 6420 6265 2075 7365 6420 666f 7220  uld be used for 
+00012f80: 7468 6973 2044 6174 6120 736f 7572 6365  this Data source
+00012f90: 2e20 5468 6973 2070 6172 616d 6574 6572  . This parameter
+00012fa0: 2069 7320 6e6f 7420 7375 7070 6f72 7465   is not supporte
+00012fb0: 6420 696e 2054 6563 746f 6e20 6f6e 2053  d in Tecton on S
+00012fc0: 6e6f 7766 6c61 6b65 2e0a 0a20 2020 2020  nowflake...     
+00012fd0: 2020 203a 7061 7261 6d20 7461 626c 653a     :param table:
+00012fe0: 2054 6865 2074 6162 6c65 2066 6f72 2074   The table for t
+00012ff0: 6869 7320 4461 7461 2073 6f75 7263 652e  his Data source.
+00013000: 204f 6e6c 7920 6f6e 6520 6f66 2060 7461   Only one of `ta
+00013010: 626c 6560 2061 6e64 2060 7175 6572 7960  ble` and `query`
+00013020: 206d 7573 7420 6265 2073 7065 6369 6669   must be specifi
+00013030: 6564 2e20 4966 2075 7369 6e67 2052 6966  ed. If using Rif
+00013040: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+00013050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013060: 2020 2020 2020 2074 6869 7320 7461 626c         this tabl
+00013070: 6520 6e61 6d65 2063 616e 6e6f 7420 696e  e name cannot in
+00013080: 636c 7564 6520 7175 6f74 6174 696f 6e20  clude quotation 
+00013090: 6d61 726b 732e 2046 6f72 2065 7861 6d70  marks. For examp
+000130a0: 6c65 2c20 7468 650a 2020 2020 2020 2020  le, the.        
+000130b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000130c0: 2020 2020 2020 2020 2020 2020 7461 626c              tabl
+000130d0: 6520 6e61 6d65 2027 666f 6f22 6261 7227  e name 'foo"bar'
+000130e0: 2069 7320 6e6f 7420 7375 7070 6f72 7465   is not supporte
+000130f0: 642e 0a20 2020 2020 2020 203a 7061 7261  d..        :para
+00013100: 6d20 7175 6572 793a 2054 6865 2071 7565  m query: The que
+00013110: 7279 2066 6f72 2074 6869 7320 4461 7461  ry for this Data
+00013120: 2073 6f75 7263 652e 204f 6e6c 7920 6f6e   source. Only on
+00013130: 6520 6f66 2060 7461 626c 6560 2061 6e64  e of `table` and
+00013140: 2060 7175 6572 7960 206d 7573 7420 6265   `query` must be
+00013150: 2073 7065 6369 6669 6564 2e0a 2020 2020   specified..    
+00013160: 2020 2020 3a70 6172 616d 2074 696d 6573      :param times
+00013170: 7461 6d70 5f66 6965 6c64 3a20 5468 6520  tamp_field: The 
+00013180: 7469 6d65 7374 616d 7020 636f 6c75 6d6e  timestamp column
+00013190: 2069 6e20 7468 6973 2064 6174 6120 736f   in this data so
+000131a0: 7572 6365 2074 6861 7420 7368 6f75 6c64  urce that should
+000131b0: 2062 6520 7573 6564 2062 7920 6046 696c   be used by `Fil
+000131c0: 7465 7265 6453 6f75 7263 6560 0a20 2020  teredSource`.   
+000131d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000131e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000131f0: 2074 6f20 6669 6c74 6572 2064 6174 6120   to filter data 
+00013200: 6672 6f6d 2074 6869 7320 736f 7572 6365  from this source
+00013210: 2c20 6265 666f 7265 2061 6e79 2066 6561  , before any fea
+00013220: 7475 7265 2076 6965 7720 7472 616e 7366  ture view transf
+00013230: 6f72 6d61 7469 6f6e 7320 6172 6520 6170  ormations are ap
+00013240: 706c 6965 642e 0a20 2020 2020 2020 2020  plied..         
+00013250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013260: 2020 2020 2020 2020 2020 204f 6e6c 7920             Only 
+00013270: 7265 7175 6972 6564 2069 6620 7468 6973  required if this
+00013280: 2073 6f75 7263 6520 6973 2075 7365 6420   source is used 
+00013290: 7769 7468 2060 4669 6c74 6572 6564 536f  with `FilteredSo
+000132a0: 7572 6365 602e 0a20 2020 2020 2020 203a  urce`..        :
+000132b0: 7061 7261 6d20 706f 7374 5f70 726f 6365  param post_proce
+000132c0: 7373 6f72 3a20 5079 7468 6f6e 2075 7365  ssor: Python use
+000132d0: 7220 6465 6669 6e65 6420 6675 6e63 7469  r defined functi
+000132e0: 6f6e 2060 6066 2844 6174 6146 7261 6d65  on ``f(DataFrame
+000132f0: 2920 2d3e 2044 6174 6146 7261 6d65 6060  ) -> DataFrame``
+00013300: 2074 6861 7420 7461 6b65 7320 696e 2072   that takes in r
+00013310: 6177 0a20 2020 2020 2020 2020 2020 2020  aw.             
+00013320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013330: 2020 2020 2020 2020 5079 5370 6172 6b20          PySpark 
+00013340: 6461 7461 2073 6f75 7263 6520 4461 7461  data source Data
+00013350: 4672 616d 6520 616e 6420 7472 616e 736c  Frame and transl
+00013360: 6174 6573 2069 7420 746f 2074 6865 2044  ates it to the D
+00013370: 6174 6146 7261 6d65 2074 6f20 6265 0a20  ataFrame to be. 
+00013380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000133a0: 2020 2020 636f 6e73 756d 6564 2062 7920      consumed by 
+000133b0: 7468 6520 4665 6174 7572 6520 5669 6577  the Feature View
+000133c0: 2e20 5468 6973 2070 6172 616d 6574 6572  . This parameter
+000133d0: 2069 7320 6e6f 7420 7375 7070 6f72 7465   is not supporte
+000133e0: 6420 696e 2054 6563 746f 6e20 6f6e 2053  d in Tecton on S
+000133f0: 6e6f 7766 6c61 6b65 2e0a 2020 2020 2020  nowflake..      
+00013400: 2020 3a70 6172 616d 2064 6174 615f 6465    :param data_de
+00013410: 6c61 793a 2042 7920 6465 6661 756c 742c  lay: By default,
+00013420: 2069 6e63 7265 6d65 6e74 616c 206d 6174   incremental mat
+00013430: 6572 6961 6c69 7a61 7469 6f6e 206a 6f62  erialization job
+00013440: 7320 7275 6e20 696d 6d65 6469 6174 656c  s run immediatel
+00013450: 7920 6174 2074 6865 2065 6e64 206f 6620  y at the end of 
+00013460: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
+00013470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013480: 2020 2020 2020 2020 6261 7463 6820 7363          batch sc
+00013490: 6865 6475 6c65 2070 6572 696f 642e 2054  hedule period. T
+000134a0: 6869 7320 7061 7261 6d65 7465 7220 636f  his parameter co
+000134b0: 6e66 6967 7572 6573 2068 6f77 206c 6f6e  nfigures how lon
+000134c0: 6720 7468 6579 2077 6169 7420 6166 7465  g they wait afte
+000134d0: 7220 7468 6520 656e 640a 2020 2020 2020  r the end.      
+000134e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000134f0: 2020 2020 2020 2020 2020 2020 2020 6f66                of
+00013500: 2074 6865 2070 6572 696f 6420 6265 666f   the period befo
+00013510: 7265 2073 7461 7274 696e 672c 2074 7970  re starting, typ
+00013520: 6963 616c 6c79 2074 6f20 656e 7375 7265  ically to ensure
+00013530: 2074 6861 7420 616c 6c20 6461 7461 2068   that all data h
+00013540: 6173 206c 616e 6465 642e 0a20 2020 2020  as landed..     
+00013550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013560: 2020 2020 2020 2020 2020 2020 2020 2046                 F
+00013570: 6f72 2065 7861 6d70 6c65 2c20 6966 2061  or example, if a
+00013580: 2066 6561 7475 7265 2076 6965 7720 6861   feature view ha
+00013590: 7320 6120 6062 6174 6368 5f73 6368 6564  s a `batch_sched
+000135a0: 756c 6560 206f 6620 3120 6461 7920 616e  ule` of 1 day an
+000135b0: 6420 6f6e 6520 6f66 0a20 2020 2020 2020  d one of.       
+000135c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000135d0: 2020 2020 2020 2020 2020 2020 2074 6865               the
+000135e0: 2064 6174 6120 736f 7572 6365 2069 6e70   data source inp
+000135f0: 7574 7320 6861 7320 6064 6174 615f 6465  uts has `data_de
+00013600: 6c61 793d 7469 6d65 6465 6c74 6128 686f  lay=timedelta(ho
+00013610: 7572 733d 3129 6020 7365 742c 2074 6865  urs=1)` set, the
+00013620: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
+00013630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013640: 2020 2020 2020 696e 6372 656d 656e 7461        incrementa
+00013650: 6c20 6d61 7465 7269 616c 697a 6174 696f  l materializatio
+00013660: 6e20 6a6f 6273 2077 696c 6c20 7275 6e20  n jobs will run 
+00013670: 6174 2060 3031 3a30 3060 2055 5443 2e0a  at `01:00` UTC..
+00013680: 2020 2020 2020 2020 3a70 6172 616d 2075          :param u
+00013690: 7365 723a 2028 4f6e 6c79 2073 7570 706f  ser: (Only suppo
+000136a0: 7274 6564 2069 6e20 5269 6674 2920 5468  rted in Rift) Th
+000136b0: 6520 7573 6572 2075 7365 6420 746f 2063  e user used to c
+000136c0: 6f6e 6e65 6374 2074 6f20 536e 6f77 666c  onnect to Snowfl
+000136d0: 616b 652e 0a20 2020 2020 2020 2020 2020  ake..           
+000136e0: 2020 2020 2020 2020 2020 5468 6973 2063            This c
+000136f0: 616e 2062 6520 6120 7374 7269 6e67 206f  an be a string o
+00013700: 7220 6120 6053 6563 7265 7460 2e20 4966  r a `Secret`. If
+00013710: 2075 6e73 6574 2053 4e4f 5746 4c41 4b45   unset SNOWFLAKE
+00013720: 5f55 5345 5220 6672 6f6d 2074 6865 2065  _USER from the e
+00013730: 6e76 6972 6f6e 6d65 6e74 2069 7320 7573  nvironment is us
+00013740: 6564 2e0a 2020 2020 2020 2020 3a70 6172  ed..        :par
+00013750: 616d 2070 6173 7377 6f72 643a 2028 4f6e  am password: (On
+00013760: 6c79 2073 7570 706f 7274 6564 2069 6e20  ly supported in 
+00013770: 5269 6674 2920 5468 6520 7061 7373 776f  Rift) The passwo
+00013780: 7264 2075 7365 6420 746f 2063 6f6e 6e65  rd used to conne
+00013790: 6374 2074 6f20 536e 6f77 666c 616b 652e  ct to Snowflake.
+000137a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000137b0: 2020 2020 2020 2020 2020 5468 6973 2063            This c
+000137c0: 616e 2062 6520 6120 7374 7269 6e67 206f  an be a string o
+000137d0: 7220 6120 6053 6563 7265 7460 2e20 4966  r a `Secret`. If
+000137e0: 2075 6e73 6574 2053 4e4f 5746 4c41 4b45   unset SNOWFLAKE
+000137f0: 5f50 4153 5357 4f52 4420 6672 6f6d 2074  _PASSWORD from t
+00013800: 6865 2065 6e76 6972 6f6e 6d65 6e74 2069  he environment i
+00013810: 7320 7573 6564 2e0a 0a20 2020 2020 2020  s used...       
+00013820: 203a 7265 7475 726e 3a20 4120 536e 6f77   :return: A Snow
+00013830: 666c 616b 6543 6f6e 6669 6720 636c 6173  flakeConfig clas
+00013840: 7320 696e 7374 616e 6365 2e0a 0a0a 2020  s instance....  
+00013850: 2020 2020 2020 4578 616d 706c 6520 6f66        Example of
+00013860: 2061 2053 6e6f 7766 6c61 6b65 436f 6e66   a SnowflakeConf
+00013870: 6967 2064 6563 6c61 7261 7469 6f6e 3a0a  ig declaration:.
+00013880: 0a20 2020 2020 2020 202e 2e20 636f 6465  .        .. code
+00013890: 2d62 6c6f 636b 3a3a 2070 7974 686f 6e0a  -block:: python.
+000138a0: 0a20 2020 2020 2020 2020 2020 2066 726f  .            fro
+000138b0: 6d20 7465 6374 6f6e 2069 6d70 6f72 7420  m tecton import 
+000138c0: 536e 6f77 666c 616b 6543 6f6e 6669 672c  SnowflakeConfig,
+000138d0: 2042 6174 6368 536f 7572 6365 0a0a 2020   BatchSource..  
+000138e0: 2020 2020 2020 2020 2020 2320 4465 636c            # Decl
+000138f0: 6172 6520 536e 6f77 666c 616b 6543 6f6e  are SnowflakeCon
+00013900: 6669 6720 696e 7374 616e 6365 206f 626a  fig instance obj
+00013910: 6563 7420 7468 6174 2063 616e 2062 6520  ect that can be 
+00013920: 7573 6564 2061 7320 616e 2061 7267 756d  used as an argum
+00013930: 656e 7420 696e 2042 6174 6368 536f 7572  ent in BatchSour
+00013940: 6365 0a20 2020 2020 2020 2020 2020 2073  ce.            s
+00013950: 6e6f 7766 6c61 6b65 5f64 735f 636f 6e66  nowflake_ds_conf
+00013960: 6967 203d 2053 6e6f 7766 6c61 6b65 436f  ig = SnowflakeCo
+00013970: 6e66 6967 280a 2020 2020 2020 2020 2020  nfig(.          
 00013980: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00013990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000139a0: 2020 2020 2020 2020 2020 2020 2073 6368               sch
-000139b0: 656d 613d 2243 4c49 434b 5f53 5452 4541  ema="CLICK_STREA
-000139c0: 4d5f 5343 4845 4d41 222c 0a20 2020 2020  M_SCHEMA",.     
-000139d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000139e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000139f0: 2020 2020 2020 2020 2077 6172 6568 6f75           warehou
-00013a00: 7365 3d22 434f 4d50 5554 455f 5748 222c  se="COMPUTE_WH",
-00013a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013a30: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00013a40: 6162 6c65 3d22 434c 4943 4b5f 5354 5245  able="CLICK_STRE
-00013a50: 414d 5f46 4541 5455 5245 5322 2c0a 2020  AM_FEATURES",.  
-00013a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013a80: 2020 2020 2020 2020 2020 2020 7175 6572              quer
-00013a90: 793d 2253 454c 4543 5420 7469 6d65 7374  y="SELECT timest
-00013aa0: 616d 7020 6173 2074 732c 2063 7265 6174  amp as ts, creat
-00013ab0: 6564 2c20 7573 6572 5f69 642c 2063 6c69  ed, user_id, cli
-00013ac0: 636b 732c 2063 6c69 636b 5f72 6174 6522  cks, click_rate"
-00013ad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013b00: 2020 2020 2020 2246 524f 4d20 434c 4943        "FROM CLIC
-00013b10: 4b5f 5354 5245 414d 5f44 422e 434c 4943  K_STREAM_DB.CLIC
-00013b20: 4b5f 5354 5245 414d 5f46 4541 5455 5245  K_STREAM_FEATURE
-00013b30: 5322 290a 0a20 2020 2020 2020 2020 2020  S")..           
-00013b40: 2023 2055 7365 2069 6e20 7468 6520 4261   # Use in the Ba
-00013b50: 7463 6853 6f75 7263 650a 2020 2020 2020  tchSource.      
-00013b60: 2020 2020 2020 736e 6f77 666c 616b 655f        snowflake_
-00013b70: 6473 203d 2042 6174 6368 536f 7572 6365  ds = BatchSource
-00013b80: 286e 616d 653d 2263 6c69 636b 5f73 7472  (name="click_str
-00013b90: 6561 6d5f 736e 6f77 666c 616b 655f 6473  eam_snowflake_ds
-00013ba0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00013bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013bc0: 2020 2020 2020 2020 2020 2020 2020 6261                ba
-00013bd0: 7463 685f 636f 6e66 6967 3d73 6e6f 7766  tch_config=snowf
-00013be0: 6c61 6b65 5f64 735f 636f 6e66 6967 290a  lake_ds_config).
-00013bf0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-00013c00: 2020 2020 2023 2052 6966 7420 646f 6573       # Rift does
-00013c10: 206e 6f74 2061 6c6c 6f77 2073 6e6f 7766   not allow snowf
-00013c20: 6c61 6b65 2074 6162 6c65 7320 746f 2068  lake tables to h
-00013c30: 6176 6520 646f 7562 6c65 2071 756f 7465  ave double quote
-00013c40: 7320 696e 2074 6865 2074 6162 6c65 206e  s in the table n
-00013c50: 616d 650a 2020 2020 2020 2020 230a 2020  ame.        #.  
-00013c60: 2020 2020 2020 2320 5365 6520 6874 7470        # See http
-00013c70: 733a 2f2f 7465 6374 6f6e 2e61 746c 6173  s://tecton.atlas
-00013c80: 7369 616e 2e6e 6574 2f62 726f 7773 652f  sian.net/browse/
-00013c90: 5445 432d 3137 3731 3520 666f 7220 6d6f  TEC-17715 for mo
-00013ca0: 7265 2064 6574 6169 6c73 2e0a 2020 2020  re details..    
-00013cb0: 2020 2020 2320 4368 6563 6b69 6e67 2074      # Checking t
-00013cc0: 6865 2074 6162 6c65 2066 6972 7374 2061  he table first a
-00013cd0: 6e64 2074 6865 6e20 7468 6520 6261 7463  nd then the batc
-00013ce0: 6820 636f 6d70 7574 6520 6d6f 6465 2069  h compute mode i
-00013cf0: 7320 646f 6e65 2066 6f72 2074 6865 2073  s done for the s
-00013d00: 616b 6520 6f66 0a20 2020 2020 2020 2023  ake of.        #
-00013d10: 2053 444b 2074 6573 7473 2077 6869 6368   SDK tests which
-00013d20: 2064 6f20 6e6f 7420 7365 740a 2020 2020   do not set.    
-00013d30: 2020 2020 6966 2074 6162 6c65 2061 6e64      if table and
-00013d40: 2027 2227 2069 6e20 7461 626c 653a 0a20   '"' in table:. 
-00013d50: 2020 2020 2020 2020 2020 2062 6174 6368             batch
-00013d60: 5f63 6f6d 7075 7465 5f6d 6f64 6520 3d20  _compute_mode = 
-00013d70: 6465 6661 756c 745f 6261 7463 685f 636f  default_batch_co
-00013d80: 6d70 7574 655f 6d6f 6465 2829 0a20 2020  mpute_mode().   
-00013d90: 2020 2020 2020 2020 2069 6620 6261 7463           if batc
-00013da0: 685f 636f 6d70 7574 655f 6d6f 6465 203d  h_compute_mode =
-00013db0: 3d20 4261 7463 6843 6f6d 7075 7465 4d6f  = BatchComputeMo
-00013dc0: 6465 2e52 4946 543a 0a20 2020 2020 2020  de.RIFT:.       
-00013dd0: 2020 2020 2020 2020 206d 7367 203d 2022           msg = "
-00013de0: 5269 6674 2064 6f65 7320 6e6f 7420 7375  Rift does not su
-00013df0: 7070 6f72 7420 536e 6f77 666c 616b 6520  pport Snowflake 
-00013e00: 7461 626c 6520 6e61 6d65 7320 636f 6e74  table names cont
-00013e10: 6169 6e69 6e67 2064 6f75 626c 6520 7175  aining double qu
-00013e20: 6f74 6174 696f 6e20 6d61 726b 732e 220a  otation marks.".
-00013e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013e40: 7261 6973 6520 5465 6374 6f6e 5661 6c69  raise TectonVali
-00013e50: 6461 7469 6f6e 4572 726f 7228 6d73 6729  dationError(msg)
-00013e60: 0a0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-00013e70: 6172 6773 203d 2061 7267 7320 3d20 6461  args = args = da
-00013e80: 7461 5f73 6f75 7263 655f 7062 322e 536e  ta_source_pb2.Sn
-00013e90: 6f77 666c 616b 6544 6174 6153 6f75 7263  owflakeDataSourc
-00013ea0: 6541 7267 7328 0a20 2020 2020 2020 2020  eArgs(.         
-00013eb0: 2020 2064 6174 6162 6173 653d 6461 7461     database=data
-00013ec0: 6261 7365 2c0a 2020 2020 2020 2020 2020  base,.          
-00013ed0: 2020 7363 6865 6d61 3d73 6368 656d 612c    schema=schema,
-00013ee0: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
-00013ef0: 6568 6f75 7365 3d77 6172 6568 6f75 7365  ehouse=warehouse
-00013f00: 2c0a 2020 2020 2020 2020 2020 2020 7572  ,.            ur
-00013f10: 6c3d 7572 6c2c 0a20 2020 2020 2020 2020  l=url,.         
-00013f20: 2020 2072 6f6c 653d 726f 6c65 2c0a 2020     role=role,.  
-00013f30: 2020 2020 2020 2020 2020 7461 626c 653d            table=
-00013f40: 7461 626c 652c 0a20 2020 2020 2020 2020  table,.         
-00013f50: 2020 2071 7565 7279 3d71 7565 7279 2c0a     query=query,.
-00013f60: 2020 2020 2020 2020 2020 2020 7573 6572              user
-00013f70: 3d5f 636f 6e76 6572 745f 7365 6372 6574  =_convert_secret
-00013f80: 5f74 6f5f 7361 6e69 7469 7a65 645f 7265  _to_sanitized_re
-00013f90: 6665 7265 6e63 6528 7573 6572 2920 6966  ference(user) if
-00013fa0: 2075 7365 7220 656c 7365 204e 6f6e 652c   user else None,
-00013fb0: 0a20 2020 2020 2020 2020 2020 2070 6173  .            pas
-00013fc0: 7377 6f72 643d 5f63 6f6e 7665 7274 5f73  sword=_convert_s
-00013fd0: 6563 7265 745f 746f 5f73 616e 6974 697a  ecret_to_sanitiz
-00013fe0: 6564 5f72 6566 6572 656e 6365 2870 6173  ed_reference(pas
-00013ff0: 7377 6f72 6429 2069 6620 7061 7373 776f  sword) if passwo
-00014000: 7264 2065 6c73 6520 4e6f 6e65 2c0a 2020  rd else None,.  
-00014010: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00014020: 2069 6620 706f 7374 5f70 726f 6365 7373   if post_process
-00014030: 6f72 2069 7320 6e6f 7420 4e6f 6e65 2061  or is not None a
-00014040: 6e64 2066 756e 6374 696f 6e5f 7365 7269  nd function_seri
-00014050: 616c 697a 6174 696f 6e2e 7368 6f75 6c64  alization.should
-00014060: 5f73 6572 6961 6c69 7a65 5f66 756e 6374  _serialize_funct
-00014070: 696f 6e28 706f 7374 5f70 726f 6365 7373  ion(post_process
-00014080: 6f72 293a 0a20 2020 2020 2020 2020 2020  or):.           
-00014090: 2061 7267 732e 636f 6d6d 6f6e 5f61 7267   args.common_arg
-000140a0: 732e 706f 7374 5f70 726f 6365 7373 6f72  s.post_processor
-000140b0: 2e43 6f70 7946 726f 6d28 6675 6e63 7469  .CopyFrom(functi
-000140c0: 6f6e 5f73 6572 6961 6c69 7a61 7469 6f6e  on_serialization
-000140d0: 2e74 6f5f 7072 6f74 6f28 706f 7374 5f70  .to_proto(post_p
-000140e0: 726f 6365 7373 6f72 2929 0a20 2020 2020  rocessor)).     
-000140f0: 2020 2069 6620 7469 6d65 7374 616d 705f     if timestamp_
-00014100: 6669 656c 643a 0a20 2020 2020 2020 2020  field:.         
-00014110: 2020 2061 7267 732e 636f 6d6d 6f6e 5f61     args.common_a
-00014120: 7267 732e 7469 6d65 7374 616d 705f 6669  rgs.timestamp_fi
-00014130: 656c 6420 3d20 7469 6d65 7374 616d 705f  eld = timestamp_
-00014140: 6669 656c 640a 0a20 2020 2020 2020 2061  field..        a
-00014150: 7267 732e 636f 6d6d 6f6e 5f61 7267 732e  rgs.common_args.
-00014160: 6461 7461 5f64 656c 6179 2e46 726f 6d54  data_delay.FromT
-00014170: 696d 6564 656c 7461 2864 6174 615f 6465  imedelta(data_de
-00014180: 6c61 7929 0a20 2020 2020 2020 2073 656c  lay).        sel
-00014190: 662e 5f64 6174 615f 6465 6c61 7920 3d20  f._data_delay = 
-000141a0: 6461 7461 5f64 656c 6179 0a20 2020 2020  data_delay.     
-000141b0: 2020 2073 656c 662e 706f 7374 5f70 726f     self.post_pro
-000141c0: 6365 7373 6f72 203d 2070 6f73 745f 7072  cessor = post_pr
-000141d0: 6f63 6573 736f 720a 0a20 2020 2040 7072  ocessor..    @pr
-000141e0: 6f70 6572 7479 0a20 2020 2064 6566 2064  operty.    def d
-000141f0: 6174 615f 6465 6c61 7928 7365 6c66 293a  ata_delay(self):
-00014200: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00014210: 7365 6c66 2e5f 6461 7461 5f64 656c 6179  self._data_delay
-00014220: 0a0a 2020 2020 6465 6620 5f6d 6572 6765  ..    def _merge
-00014230: 5f62 6174 6368 5f61 7267 7328 7365 6c66  _batch_args(self
-00014240: 2c20 6461 7461 5f73 6f75 7263 655f 6172  , data_source_ar
-00014250: 6773 3a20 7669 7274 7561 6c5f 6461 7461  gs: virtual_data
-00014260: 5f73 6f75 7263 655f 7062 322e 5669 7274  _source_pb2.Virt
-00014270: 7561 6c44 6174 6153 6f75 7263 6541 7267  ualDataSourceArg
-00014280: 7329 3a0a 2020 2020 2020 2020 6461 7461  s):.        data
-00014290: 5f73 6f75 7263 655f 6172 6773 2e73 6e6f  _source_args.sno
-000142a0: 7766 6c61 6b65 5f64 735f 636f 6e66 6967  wflake_ds_config
-000142b0: 2e43 6f70 7946 726f 6d28 7365 6c66 2e5f  .CopyFrom(self._
-000142c0: 6172 6773 290a 0a0a 636c 6173 7320 5265  args)...class Re
-000142d0: 6473 6869 6674 436f 6e66 6967 2842 6173  dshiftConfig(Bas
-000142e0: 6542 6174 6368 436f 6e66 6967 293a 0a20  eBatchConfig):. 
-000142f0: 2020 2022 2222 0a20 2020 2043 6f6e 6669     """.    Confi
-00014300: 6775 7261 7469 6f6e 2075 7365 6420 746f  guration used to
-00014310: 2072 6566 6572 656e 6365 2061 2052 6564   reference a Red
-00014320: 7368 6966 7420 7461 626c 6520 6f72 2071  shift table or q
-00014330: 7565 7279 2e0a 0a20 2020 2054 6865 2052  uery...    The R
-00014340: 6564 7368 6966 7443 6f6e 6669 6720 636c  edshiftConfig cl
-00014350: 6173 7320 6973 2075 7365 6420 746f 2063  ass is used to c
-00014360: 7265 6174 6520 6120 7265 6665 7265 6e63  reate a referenc
-00014370: 6520 746f 2061 2052 6564 7368 6966 7420  e to a Redshift 
-00014380: 7461 626c 652e 2059 6f75 2063 616e 2061  table. You can a
-00014390: 6c73 6f20 6372 6561 7465 2061 0a20 2020  lso create a.   
-000143a0: 2072 6566 6572 656e 6365 2074 6f20 6120   reference to a 
-000143b0: 7175 6572 7920 6f6e 206f 6e65 206f 7220  query on one or 
-000143c0: 6d6f 7265 2074 6162 6c65 732c 2077 6869  more tables, whi
-000143d0: 6368 2077 696c 6c20 6265 2072 6567 6973  ch will be regis
-000143e0: 7465 7265 6420 696e 2054 6563 746f 6e20  tered in Tecton 
-000143f0: 696e 2061 2073 696d 696c 6172 2077 6179  in a similar way
-00014400: 2061 7320 6120 7669 6577 0a20 2020 2069   as a view.    i
-00014410: 7320 7265 6769 7374 6572 6564 2069 6e20  s registered in 
-00014420: 6f74 6865 7220 6461 7461 2073 7973 7465  other data syste
-00014430: 6d73 2e0a 0a20 2020 2054 6869 7320 636c  ms...    This cl
-00014440: 6173 7320 7573 6564 2061 7320 616e 2069  ass used as an i
-00014450: 6e70 7574 2074 6f20 6120 3a63 6c61 7373  nput to a :class
-00014460: 3a60 4261 7463 6853 6f75 7263 6560 2773  :`BatchSource`'s
-00014470: 2070 6172 616d 6574 6572 2060 6062 6174   parameter ``bat
-00014480: 6368 5f63 6f6e 6669 6760 602e 2054 6869  ch_config``. Thi
-00014490: 7320 636c 6173 7320 6973 206e 6f74 0a20  s class is not. 
-000144a0: 2020 2061 2054 6563 746f 6e20 4f62 6a65     a Tecton Obje
-000144b0: 6374 3a20 6974 2069 7320 6120 6772 6f75  ct: it is a grou
-000144c0: 7069 6e67 206f 6620 7061 7261 6d65 7465  ping of paramete
-000144d0: 7273 2e20 4465 636c 6172 696e 6720 7468  rs. Declaring th
-000144e0: 6973 2063 6c61 7373 2061 6c6f 6e65 2077  is class alone w
-000144f0: 696c 6c20 6e6f 7420 7265 6769 7374 6572  ill not register
-00014500: 2061 2064 6174 6120 736f 7572 6365 2e0a   a data source..
-00014510: 2020 2020 496e 7374 6561 642c 2064 6563      Instead, dec
-00014520: 6c61 7265 2061 7320 7061 7274 206f 6620  lare as part of 
-00014530: 6060 4261 7463 6853 6f75 7263 6560 6020  ``BatchSource`` 
-00014540: 7468 6174 2074 616b 6573 2074 6869 7320  that takes this 
-00014550: 636f 6e66 6967 7572 6174 696f 6e20 636c  configuration cl
-00014560: 6173 7320 696e 7374 616e 6365 2061 7320  ass instance as 
-00014570: 6120 7061 7261 6d65 7465 722e 0a20 2020  a parameter..   
-00014580: 2022 2222 0a0a 2020 2020 6465 6620 5f5f   """..    def __
-00014590: 696e 6974 5f5f 280a 2020 2020 2020 2020  init__(.        
-000145a0: 7365 6c66 2c0a 2020 2020 2020 2020 656e  self,.        en
-000145b0: 6470 6f69 6e74 3a20 7374 722c 0a20 2020  dpoint: str,.   
-000145c0: 2020 2020 2074 6162 6c65 3a20 4f70 7469       table: Opti
-000145d0: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
-000145e0: 2c0a 2020 2020 2020 2020 706f 7374 5f70  ,.        post_p
-000145f0: 726f 6365 7373 6f72 3a20 4f70 7469 6f6e  rocessor: Option
-00014600: 616c 5b43 616c 6c61 626c 655d 203d 204e  al[Callable] = N
-00014610: 6f6e 652c 0a20 2020 2020 2020 2071 7565  one,.        que
-00014620: 7279 3a20 4f70 7469 6f6e 616c 5b73 7472  ry: Optional[str
-00014630: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-00014640: 2020 7469 6d65 7374 616d 705f 6669 656c    timestamp_fiel
-00014650: 643a 204f 7074 696f 6e61 6c5b 7374 725d  d: Optional[str]
-00014660: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00014670: 2064 6174 615f 6465 6c61 793a 2064 6174   data_delay: dat
-00014680: 6574 696d 652e 7469 6d65 6465 6c74 6120  etime.timedelta 
-00014690: 3d20 6461 7465 7469 6d65 2e74 696d 6564  = datetime.timed
-000146a0: 656c 7461 2873 6563 6f6e 6473 3d30 292c  elta(seconds=0),
-000146b0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-000146c0: 2222 220a 2020 2020 2020 2020 496e 7374  """.        Inst
-000146d0: 616e 7469 6174 6573 2061 206e 6577 2052  antiates a new R
-000146e0: 6564 7368 6966 7443 6f6e 6669 672e 204f  edshiftConfig. O
-000146f0: 6e65 206f 6620 7461 626c 6520 616e 6420  ne of table and 
-00014700: 7175 6572 7920 7368 6f75 6c64 2062 6520  query should be 
-00014710: 7370 6563 6966 6965 6420 7768 656e 2063  specified when c
-00014720: 7265 6174 696e 6720 7468 6973 2066 696c  reating this fil
-00014730: 652e 0a0a 2020 2020 2020 2020 3a70 6172  e...        :par
-00014740: 616d 2065 6e64 706f 696e 743a 2054 6865  am endpoint: The
-00014750: 2063 6f6e 6e65 6374 696f 6e20 656e 6470   connection endp
-00014760: 6f69 6e74 2074 6f20 5265 6473 6869 6674  oint to Redshift
-00014770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014780: 2020 2020 2020 2020 2020 2865 2e67 2e20            (e.g. 
-00014790: 7265 6473 6869 6674 2d63 6c75 7374 6572  redshift-cluster
-000147a0: 2d31 2e63 6967 6377 7a73 646c 746a 732e  -1.cigcwzsdltjs.
-000147b0: 7573 2d77 6573 742d 322e 7265 6473 6869  us-west-2.redshi
-000147c0: 6674 2e61 6d61 7a6f 6e61 7773 2e63 6f6d  ft.amazonaws.com
-000147d0: 3a35 3433 392f 6465 7629 2e0a 2020 2020  :5439/dev)..    
-000147e0: 2020 2020 3a70 6172 616d 2074 6162 6c65      :param table
-000147f0: 3a20 5468 6520 5265 6473 6869 6674 2074  : The Redshift t
-00014800: 6162 6c65 2066 6f72 2074 6869 7320 4461  able for this Da
-00014810: 7461 2073 6f75 7263 652e 204f 6e6c 7920  ta source. Only 
-00014820: 6f6e 6520 6f66 2074 6162 6c65 2061 6e64  one of table and
-00014830: 2071 7565 7279 2073 686f 756c 6420 6265   query should be
-00014840: 2073 7065 6369 6669 6564 2e0a 2020 2020   specified..    
-00014850: 2020 2020 3a70 6172 616d 2070 6f73 745f      :param post_
-00014860: 7072 6f63 6573 736f 723a 2050 7974 686f  processor: Pytho
-00014870: 6e20 7573 6572 2064 6566 696e 6564 2066  n user defined f
-00014880: 756e 6374 696f 6e20 6060 6628 4461 7461  unction ``f(Data
-00014890: 4672 616d 6529 202d 3e20 4461 7461 4672  Frame) -> DataFr
-000148a0: 616d 6560 6020 7468 6174 2074 616b 6573  ame`` that takes
-000148b0: 2069 6e20 7261 770a 2020 2020 2020 2020   in raw.        
-000148c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000148d0: 2020 2020 2020 2020 2020 2020 2050 7953               PyS
-000148e0: 7061 726b 2064 6174 6120 736f 7572 6365  park data source
-000148f0: 2044 6174 6146 7261 6d65 2061 6e64 2074   DataFrame and t
-00014900: 7261 6e73 6c61 7465 7320 6974 2074 6f20  ranslates it to 
-00014910: 7468 6520 4461 7461 4672 616d 6520 746f  the DataFrame to
-00014920: 2062 650a 2020 2020 2020 2020 2020 2020   be.            
-00014930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014940: 2020 2020 2020 2020 2063 6f6e 7375 6d65           consume
-00014950: 6420 6279 2074 6865 2046 6561 7475 7265  d by the Feature
-00014960: 2056 6965 772e 0a20 2020 2020 2020 203a   View..        :
-00014970: 7061 7261 6d20 7175 6572 793a 2041 2052  param query: A R
-00014980: 6564 7368 6966 7420 7175 6572 7920 666f  edshift query fo
-00014990: 7220 7468 6973 2044 6174 6120 736f 7572  r this Data sour
-000149a0: 6365 2e20 4f6e 6c79 206f 6e65 206f 6620  ce. Only one of 
-000149b0: 7461 626c 6520 616e 6420 7175 6572 7920  table and query 
-000149c0: 7368 6f75 6c64 2062 6520 7370 6563 6966  should be specif
-000149d0: 6965 642e 0a20 2020 2020 2020 203a 7061  ied..        :pa
-000149e0: 7261 6d20 7469 6d65 7374 616d 705f 6669  ram timestamp_fi
-000149f0: 656c 643a 2054 6865 2074 696d 6573 7461  eld: The timesta
-00014a00: 6d70 2063 6f6c 756d 6e20 696e 2074 6869  mp column in thi
-00014a10: 7320 6461 7461 2073 6f75 7263 6520 7468  s data source th
-00014a20: 6174 2073 686f 756c 6420 6265 2075 7365  at should be use
-00014a30: 6420 6279 2060 4669 6c74 6572 6564 536f  d by `FilteredSo
-00014a40: 7572 6365 600a 2020 2020 2020 2020 2020  urce`.          
-00014a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014a60: 2020 2020 2020 2020 2020 746f 2066 696c            to fil
-00014a70: 7465 7220 6461 7461 2066 726f 6d20 7468  ter data from th
-00014a80: 6973 2073 6f75 7263 652c 2062 6566 6f72  is source, befor
-00014a90: 6520 616e 7920 6665 6174 7572 6520 7669  e any feature vi
-00014aa0: 6577 2074 7261 6e73 666f 726d 6174 696f  ew transformatio
-00014ab0: 6e73 2061 7265 2061 7070 6c69 6564 2e0a  ns are applied..
-00014ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014ae0: 2020 2020 4f6e 6c79 2072 6571 7569 7265      Only require
-00014af0: 6420 6966 2074 6869 7320 736f 7572 6365  d if this source
-00014b00: 2069 7320 7573 6564 2077 6974 6820 6046   is used with `F
-00014b10: 696c 7465 7265 6453 6f75 7263 6560 2e0a  ilteredSource`..
-00014b20: 2020 2020 2020 2020 3a70 6172 616d 2064          :param d
-00014b30: 6174 615f 6465 6c61 793a 2042 7920 6465  ata_delay: By de
-00014b40: 6661 756c 742c 2069 6e63 7265 6d65 6e74  fault, increment
-00014b50: 616c 206d 6174 6572 6961 6c69 7a61 7469  al materializati
-00014b60: 6f6e 206a 6f62 7320 7275 6e20 696d 6d65  on jobs run imme
-00014b70: 6469 6174 656c 7920 6174 2074 6865 2065  diately at the e
-00014b80: 6e64 206f 6620 7468 650a 2020 2020 2020  nd of the.      
-00014b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014ba0: 2020 2020 2020 2020 2020 2020 2020 6261                ba
-00014bb0: 7463 6820 7363 6865 6475 6c65 2070 6572  tch schedule per
-00014bc0: 696f 642e 2054 6869 7320 7061 7261 6d65  iod. This parame
-00014bd0: 7465 7220 636f 6e66 6967 7572 6573 2068  ter configures h
-00014be0: 6f77 206c 6f6e 6720 7468 6579 2077 6169  ow long they wai
-00014bf0: 7420 6166 7465 7220 7468 6520 656e 640a  t after the end.
-00014c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014c20: 2020 2020 6f66 2074 6865 2070 6572 696f      of the perio
-00014c30: 6420 6265 666f 7265 2073 7461 7274 696e  d before startin
-00014c40: 672c 2074 7970 6963 616c 6c79 2074 6f20  g, typically to 
-00014c50: 656e 7375 7265 2074 6861 7420 616c 6c20  ensure that all 
-00014c60: 6461 7461 2068 6173 206c 616e 6465 642e  data has landed.
-00014c70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014c90: 2020 2020 2046 6f72 2065 7861 6d70 6c65       For example
-00014ca0: 2c20 6966 2061 2066 6561 7475 7265 2076  , if a feature v
-00014cb0: 6965 7720 6861 7320 6120 6062 6174 6368  iew has a `batch
-00014cc0: 5f73 6368 6564 756c 6560 206f 6620 3120  _schedule` of 1 
-00014cd0: 6461 7920 616e 6420 6f6e 6520 6f66 0a20  day and one of. 
-00014ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014d00: 2020 2074 6865 2064 6174 6120 736f 7572     the data sour
-00014d10: 6365 2069 6e70 7574 7320 6861 7320 6064  ce inputs has `d
-00014d20: 6174 615f 6465 6c61 793d 7469 6d65 6465  ata_delay=timede
-00014d30: 6c74 6128 686f 7572 733d 3129 6020 7365  lta(hours=1)` se
-00014d40: 742c 2074 6865 6e0a 2020 2020 2020 2020  t, then.        
-00014d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014d60: 2020 2020 2020 2020 2020 2020 696e 6372              incr
-00014d70: 656d 656e 7461 6c20 6d61 7465 7269 616c  emental material
-00014d80: 697a 6174 696f 6e20 6a6f 6273 2077 696c  ization jobs wil
-00014d90: 6c20 7275 6e20 6174 2060 3031 3a30 3060  l run at `01:00`
-00014da0: 2055 5443 2e0a 0a20 2020 2020 2020 203a   UTC...        :
-00014db0: 7265 7475 726e 3a20 4120 5265 6473 6869  return: A Redshi
-00014dc0: 6674 436f 6e66 6967 2063 6c61 7373 2069  ftConfig class i
-00014dd0: 6e73 7461 6e63 652e 0a0a 2020 2020 2020  nstance...      
-00014de0: 2020 4578 616d 706c 6520 6f66 2061 2052    Example of a R
-00014df0: 6564 7368 6966 7443 6f6e 6669 6720 6465  edshiftConfig de
-00014e00: 636c 6172 6174 696f 6e3a 0a0a 2020 2020  claration:..    
-00014e10: 2020 2020 2e2e 2063 6f64 652d 626c 6f63      .. code-bloc
-00014e20: 6b3a 3a20 7079 7468 6f6e 0a0a 2020 2020  k:: python..    
-00014e30: 2020 2020 2020 2020 6672 6f6d 2074 6563          from tec
-00014e40: 746f 6e20 696d 706f 7274 2052 6564 7368  ton import Redsh
-00014e50: 6966 7443 6f6e 6669 670a 0a20 2020 2020  iftConfig..     
-00014e60: 2020 2020 2020 2023 2044 6563 6c61 7265         # Declare
-00014e70: 2052 6564 7368 6966 7443 6f6e 6669 6720   RedshiftConfig 
-00014e80: 696e 7374 616e 6365 206f 626a 6563 7420  instance object 
-00014e90: 7468 6174 2063 616e 2062 6520 7573 6564  that can be used
-00014ea0: 2061 7320 616e 2061 7267 756d 656e 7420   as an argument 
-00014eb0: 696e 2042 6174 6368 536f 7572 6365 0a20  in BatchSource. 
-00014ec0: 2020 2020 2020 2020 2020 2072 6564 7368             redsh
-00014ed0: 6966 745f 6473 5f63 6f6e 6669 6720 3d20  ift_ds_config = 
-00014ee0: 5265 6473 6869 6674 436f 6e66 6967 2865  RedshiftConfig(e
-00014ef0: 6e64 706f 696e 743d 2263 6c75 7374 6572  ndpoint="cluster
-00014f00: 2d31 2e75 732d 7765 7374 2d32 2e72 6564  -1.us-west-2.red
-00014f10: 7368 6966 742e 616d 617a 6f6e 6177 732e  shift.amazonaws.
-00014f20: 636f 6d3a 3534 3339 2f64 6576 222c 0a20  com:5439/dev",. 
-00014f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f60: 2071 7565 7279 3d22 5345 4c45 4354 2074   query="SELECT t
-00014f70: 696d 6573 7461 6d70 2061 7320 7473 2c20  imestamp as ts, 
-00014f80: 6372 6561 7465 642c 2075 7365 725f 6964  created, user_id
-00014f90: 2c20 6164 5f69 642c 2064 7572 6174 696f  , ad_id, duratio
-00014fa0: 6e22 0a20 2020 2020 2020 2020 2020 2020  n".             
-00014fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014fd0: 2020 2020 2020 2020 2020 2022 4652 4f4d             "FROM
-00014fe0: 2061 645f 7365 7276 696e 675f 6665 6174   ad_serving_feat
-00014ff0: 7572 6573 2229 0a20 2020 2020 2020 2022  ures").        "
-00015000: 2222 0a20 2020 2020 2020 2073 656c 662e  "".        self.
-00015010: 5f61 7267 7320 3d20 6172 6773 203d 2064  _args = args = d
-00015020: 6174 615f 736f 7572 6365 5f70 6232 2e52  ata_source_pb2.R
-00015030: 6564 7368 6966 7444 6174 6153 6f75 7263  edshiftDataSourc
-00015040: 6541 7267 7328 290a 2020 2020 2020 2020  eArgs().        
-00015050: 6172 6773 2e65 6e64 706f 696e 7420 3d20  args.endpoint = 
-00015060: 656e 6470 6f69 6e74 0a0a 2020 2020 2020  endpoint..      
-00015070: 2020 6966 2074 6162 6c65 2061 6e64 2071    if table and q
-00015080: 7565 7279 3a0a 2020 2020 2020 2020 2020  uery:.          
-00015090: 2020 6d73 6720 3d20 2253 686f 756c 6420    msg = "Should 
-000150a0: 6f6e 6c79 2073 7065 6369 6679 206f 6e65  only specify one
-000150b0: 206f 6620 7461 626c 6520 616e 6420 7175   of table and qu
-000150c0: 6572 7920 736f 7572 6365 7320 666f 7220  ery sources for 
-000150d0: 7265 6473 6869 6674 220a 2020 2020 2020  redshift".      
-000150e0: 2020 2020 2020 7261 6973 6520 4173 7365        raise Asse
-000150f0: 7274 696f 6e45 7272 6f72 286d 7367 290a  rtionError(msg).
-00015100: 2020 2020 2020 2020 6966 206e 6f74 2074          if not t
-00015110: 6162 6c65 2061 6e64 206e 6f74 2071 7565  able and not que
-00015120: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-00015130: 6d73 6720 3d20 224d 6973 7369 6e67 2062  msg = "Missing b
-00015140: 6f74 6820 7461 626c 6520 616e 6420 7175  oth table and qu
-00015150: 6572 7920 736f 7572 6365 7320 666f 7220  ery sources for 
-00015160: 7265 6473 6869 6674 2c20 6578 6163 746c  redshift, exactl
-00015170: 7920 6f6e 6520 6d75 7374 2062 6520 7072  y one must be pr
-00015180: 6573 656e 7422 0a20 2020 2020 2020 2020  esent".         
-00015190: 2020 2072 6169 7365 2041 7373 6572 7469     raise Asserti
-000151a0: 6f6e 4572 726f 7228 6d73 6729 0a0a 2020  onError(msg)..  
-000151b0: 2020 2020 2020 6966 2074 6162 6c65 3a0a        if table:.
-000151c0: 2020 2020 2020 2020 2020 2020 6172 6773              args
-000151d0: 2e74 6162 6c65 203d 2074 6162 6c65 0a20  .table = table. 
-000151e0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000151f0: 2020 2020 2020 2020 2061 7267 732e 7175           args.qu
-00015200: 6572 7920 3d20 7175 6572 790a 0a20 2020  ery = query..   
-00015210: 2020 2020 2069 6620 706f 7374 5f70 726f       if post_pro
-00015220: 6365 7373 6f72 2069 7320 6e6f 7420 4e6f  cessor is not No
-00015230: 6e65 2061 6e64 2066 756e 6374 696f 6e5f  ne and function_
-00015240: 7365 7269 616c 697a 6174 696f 6e2e 7368  serialization.sh
-00015250: 6f75 6c64 5f73 6572 6961 6c69 7a65 5f66  ould_serialize_f
-00015260: 756e 6374 696f 6e28 706f 7374 5f70 726f  unction(post_pro
-00015270: 6365 7373 6f72 293a 0a20 2020 2020 2020  cessor):.       
-00015280: 2020 2020 2061 7267 732e 636f 6d6d 6f6e       args.common
-00015290: 5f61 7267 732e 706f 7374 5f70 726f 6365  _args.post_proce
-000152a0: 7373 6f72 2e43 6f70 7946 726f 6d28 6675  ssor.CopyFrom(fu
-000152b0: 6e63 7469 6f6e 5f73 6572 6961 6c69 7a61  nction_serializa
-000152c0: 7469 6f6e 2e74 6f5f 7072 6f74 6f28 706f  tion.to_proto(po
-000152d0: 7374 5f70 726f 6365 7373 6f72 2929 0a20  st_processor)). 
-000152e0: 2020 2020 2020 2069 6620 7469 6d65 7374         if timest
-000152f0: 616d 705f 6669 656c 643a 0a20 2020 2020  amp_field:.     
-00015300: 2020 2020 2020 2061 7267 732e 636f 6d6d         args.comm
-00015310: 6f6e 5f61 7267 732e 7469 6d65 7374 616d  on_args.timestam
-00015320: 705f 6669 656c 6420 3d20 7469 6d65 7374  p_field = timest
-00015330: 616d 705f 6669 656c 640a 0a20 2020 2020  amp_field..     
-00015340: 2020 2061 7267 732e 636f 6d6d 6f6e 5f61     args.common_a
-00015350: 7267 732e 6461 7461 5f64 656c 6179 2e46  rgs.data_delay.F
-00015360: 726f 6d54 696d 6564 656c 7461 2864 6174  romTimedelta(dat
-00015370: 615f 6465 6c61 7929 0a20 2020 2020 2020  a_delay).       
-00015380: 2073 656c 662e 5f64 6174 615f 6465 6c61   self._data_dela
-00015390: 7920 3d20 6461 7461 5f64 656c 6179 0a20  y = data_delay. 
-000153a0: 2020 2020 2020 2073 656c 662e 706f 7374         self.post
-000153b0: 5f70 726f 6365 7373 6f72 203d 2070 6f73  _processor = pos
-000153c0: 745f 7072 6f63 6573 736f 720a 0a20 2020  t_processor..   
-000153d0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-000153e0: 6566 2064 6174 615f 6465 6c61 7928 7365  ef data_delay(se
-000153f0: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00015400: 7572 6e20 7365 6c66 2e5f 6461 7461 5f64  urn self._data_d
-00015410: 656c 6179 0a0a 2020 2020 6465 6620 5f6d  elay..    def _m
-00015420: 6572 6765 5f62 6174 6368 5f61 7267 7328  erge_batch_args(
-00015430: 7365 6c66 2c20 6461 7461 5f73 6f75 7263  self, data_sourc
-00015440: 655f 6172 6773 3a20 7669 7274 7561 6c5f  e_args: virtual_
-00015450: 6461 7461 5f73 6f75 7263 655f 7062 322e  data_source_pb2.
-00015460: 5669 7274 7561 6c44 6174 6153 6f75 7263  VirtualDataSourc
-00015470: 6541 7267 7329 3a0a 2020 2020 2020 2020  eArgs):.        
-00015480: 6461 7461 5f73 6f75 7263 655f 6172 6773  data_source_args
-00015490: 2e72 6564 7368 6966 745f 6473 5f63 6f6e  .redshift_ds_con
-000154a0: 6669 672e 436f 7079 4672 6f6d 2873 656c  fig.CopyFrom(sel
-000154b0: 662e 5f61 7267 7329 0a0a 0a63 6c61 7373  f._args)...class
-000154c0: 2053 7061 726b 4261 7463 6843 6f6e 6669   SparkBatchConfi
-000154d0: 6728 4261 7365 4261 7463 6843 6f6e 6669  g(BaseBatchConfi
-000154e0: 6729 3a0a 2020 2020 2222 220a 2020 2020  g):.    """.    
-000154f0: 436f 6e66 6967 7572 6174 696f 6e20 7573  Configuration us
-00015500: 6564 2074 6f20 6465 6669 6e65 2061 2062  ed to define a b
-00015510: 6174 6368 2073 6f75 7263 6520 7573 696e  atch source usin
-00015520: 6720 6120 4461 7461 2053 6f75 7263 6520  g a Data Source 
-00015530: 4675 6e63 7469 6f6e 2e0a 0a20 2020 2054  Function...    T
-00015540: 6865 2060 6053 7061 726b 4261 7463 6843  he ``SparkBatchC
-00015550: 6f6e 6669 6760 6020 636c 6173 7320 6973  onfig`` class is
-00015560: 2075 7365 6420 746f 2063 6f6e 6669 6775   used to configu
-00015570: 7265 2061 2062 6174 6368 2073 6f75 7263  re a batch sourc
-00015580: 6520 7573 696e 6720 6120 7573 6572 2064  e using a user d
-00015590: 6566 696e 6564 2044 6174 6120 536f 7572  efined Data Sour
-000155a0: 6365 2046 756e 6374 696f 6e2e 0a0a 2020  ce Function...  
-000155b0: 2020 5468 6973 2063 6c61 7373 2069 7320    This class is 
-000155c0: 7573 6564 2061 7320 616e 2069 6e70 7574  used as an input
-000155d0: 2074 6f20 6120 3a63 6c61 7373 3a60 4261   to a :class:`Ba
-000155e0: 7463 6853 6f75 7263 6560 2773 2070 6172  tchSource`'s par
-000155f0: 616d 6574 6572 2060 6062 6174 6368 5f63  ameter ``batch_c
-00015600: 6f6e 6669 6760 602e 2044 6563 6c61 7269  onfig``. Declari
-00015610: 6e67 2074 6869 7320 636f 6e66 6967 7572  ng this configur
-00015620: 6174 696f 6e0a 2020 2020 636c 6173 7320  ation.    class 
-00015630: 616c 6f6e 6520 7769 6c6c 206e 6f74 2072  alone will not r
-00015640: 6567 6973 7465 7220 6120 4461 7461 2053  egister a Data S
-00015650: 6f75 7263 652e 2049 6e73 7465 6164 2c20  ource. Instead, 
-00015660: 6465 636c 6172 6520 6173 2061 2070 6172  declare as a par
-00015670: 7420 6f66 2060 6042 6174 6368 536f 7572  t of ``BatchSour
-00015680: 6365 6060 2074 6861 7420 7461 6b65 7320  ce`` that takes 
-00015690: 7468 6973 2063 6f6e 6669 6775 7261 7469  this configurati
-000156a0: 6f6e 0a20 2020 2063 6c61 7373 2069 6e73  on.    class ins
-000156b0: 7461 6e63 6520 6173 2061 2070 6172 616d  tance as a param
-000156c0: 6574 6572 2e0a 0a20 2020 202a 2a44 6f20  eter...    **Do 
-000156d0: 6e6f 7420 696e 7374 616e 7469 6174 6520  not instantiate 
-000156e0: 7468 6973 2063 6c61 7373 2064 6972 6563  this class direc
-000156f0: 746c 792e 2a2a 2055 7365 203a 7079 3a66  tly.** Use :py:f
-00015700: 756e 633a 6074 6563 746f 6e2e 7370 6172  unc:`tecton.spar
-00015710: 6b5f 6261 7463 685f 636f 6e66 6967 6020  k_batch_config` 
-00015720: 696e 7374 6561 642e 0a20 2020 2022 2222  instead..    """
-00015730: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
-00015740: 5f5f 280a 2020 2020 2020 2020 7365 6c66  __(.        self
-00015750: 2c0a 2020 2020 2020 2020 6461 7461 5f73  ,.        data_s
-00015760: 6f75 7263 655f 6675 6e63 7469 6f6e 3a20  ource_function: 
-00015770: 556e 696f 6e5b 0a20 2020 2020 2020 2020  Union[.         
-00015780: 2020 2043 616c 6c61 626c 655b 5b53 7061     Callable[[Spa
-00015790: 726b 5365 7373 696f 6e5d 2c20 4461 7461  rkSession], Data
-000157a0: 4672 616d 655d 2c20 4361 6c6c 6162 6c65  Frame], Callable
-000157b0: 5b5b 5370 6172 6b53 6573 7369 6f6e 2c20  [[SparkSession, 
-000157c0: 4669 6c74 6572 436f 6e74 6578 745d 2c20  FilterContext], 
-000157d0: 4461 7461 4672 616d 655d 0a20 2020 2020  DataFrame].     
-000157e0: 2020 205d 2c0a 2020 2020 2020 2020 6461     ],.        da
-000157f0: 7461 5f64 656c 6179 3a20 6461 7465 7469  ta_delay: dateti
-00015800: 6d65 2e74 696d 6564 656c 7461 203d 2064  me.timedelta = d
-00015810: 6174 6574 696d 652e 7469 6d65 6465 6c74  atetime.timedelt
-00015820: 6128 7365 636f 6e64 733d 3029 2c0a 2020  a(seconds=0),.  
-00015830: 2020 2020 2020 7375 7070 6f72 7473 5f74        supports_t
-00015840: 696d 655f 6669 6c74 6572 696e 673a 2062  ime_filtering: b
-00015850: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-00015860: 2029 3a0a 2020 2020 2020 2020 2222 220a   ):.        """.
-00015870: 2020 2020 2020 2020 496e 7374 616e 7469          Instanti
-00015880: 6174 6573 2061 206e 6577 2053 7061 726b  ates a new Spark
-00015890: 4261 7463 6843 6f6e 6669 672e 0a0a 2020  BatchConfig...  
-000158a0: 2020 2020 2020 3a70 6172 616d 2064 6174        :param dat
-000158b0: 615f 736f 7572 6365 5f66 756e 6374 696f  a_source_functio
-000158c0: 6e3a 2055 7365 7220 6465 6669 6e65 6420  n: User defined 
-000158d0: 4461 7461 2053 6f75 7263 6520 4675 6e63  Data Source Func
-000158e0: 7469 6f6e 2074 6861 7420 7461 6b65 7320  tion that takes 
-000158f0: 696e 2061 2060 6053 7061 726b 5365 7373  in a ``SparkSess
-00015900: 696f 6e60 6020 616e 6420 616e 206f 7074  ion`` and an opt
-00015910: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-00015920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015930: 2020 2020 2020 2020 2020 3a63 6c61 7373            :class
-00015940: 3a60 7465 6374 6f6e 2e46 696c 7465 7243  :`tecton.FilterC
-00015950: 6f6e 7465 7874 602c 2069 6620 6060 7375  ontext`, if ``su
-00015960: 7070 6f72 7473 5f74 696d 655f 6669 6c74  pports_time_filt
-00015970: 6572 696e 673d 5472 7565 6060 2e20 5265  ering=True``. Re
-00015980: 7475 726e 7320 6120 6060 4461 7461 4672  turns a ``DataFr
-00015990: 616d 6560 602e 0a20 2020 2020 2020 203a  ame``..        :
-000159a0: 7061 7261 6d20 6461 7461 5f64 656c 6179  param data_delay
-000159b0: 3a20 4279 2064 6566 6175 6c74 2c20 696e  : By default, in
-000159c0: 6372 656d 656e 7461 6c20 6d61 7465 7269  cremental materi
-000159d0: 616c 697a 6174 696f 6e20 6a6f 6273 2072  alization jobs r
-000159e0: 756e 2069 6d6d 6564 6961 7465 6c79 2061  un immediately a
-000159f0: 7420 7468 6520 656e 6420 6f66 2074 6865  t the end of the
-00015a00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015a20: 2020 2020 2062 6174 6368 2073 6368 6564       batch sched
-00015a30: 756c 6520 7065 7269 6f64 2e20 5468 6973  ule period. This
-00015a40: 2070 6172 616d 6574 6572 2063 6f6e 6669   parameter confi
-00015a50: 6775 7265 7320 686f 7720 6c6f 6e67 2074  gures how long t
-00015a60: 6865 7920 7761 6974 2061 6674 6572 2074  hey wait after t
-00015a70: 6865 2065 6e64 0a20 2020 2020 2020 2020  he end.         
-00015a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015a90: 2020 2020 2020 2020 2020 206f 6620 7468             of th
-00015aa0: 6520 7065 7269 6f64 2062 6566 6f72 6520  e period before 
-00015ab0: 7374 6172 7469 6e67 2c20 7479 7069 6361  starting, typica
-00015ac0: 6c6c 7920 746f 2065 6e73 7572 6520 7468  lly to ensure th
-00015ad0: 6174 2061 6c6c 2064 6174 6120 6861 7320  at all data has 
-00015ae0: 6c61 6e64 6564 2e0a 2020 2020 2020 2020  landed..        
-00015af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015b00: 2020 2020 2020 2020 2020 2020 466f 7220              For 
-00015b10: 6578 616d 706c 652c 2069 6620 6120 6665  example, if a fe
-00015b20: 6174 7572 6520 7669 6577 2068 6173 2061  ature view has a
-00015b30: 2060 6062 6174 6368 5f73 6368 6564 756c   ``batch_schedul
-00015b40: 6560 6020 6f66 2031 2064 6179 2061 6e64  e`` of 1 day and
-00015b50: 206f 6e65 206f 660a 2020 2020 2020 2020   one of.        
-00015b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015b70: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-00015b80: 6461 7461 2073 6f75 7263 6520 696e 7075  data source inpu
-00015b90: 7473 2068 6173 2061 2060 6064 6174 615f  ts has a ``data_
-00015ba0: 6465 6c61 7960 6020 6f66 2031 2068 6f75  delay`` of 1 hou
-00015bb0: 722c 2074 6865 6e0a 2020 2020 2020 2020  r, then.        
-00015bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015bd0: 2020 2020 2020 2020 2020 2020 696e 6372              incr
-00015be0: 656d 656e 7461 6c20 6d61 7465 7269 616c  emental material
-00015bf0: 697a 6174 696f 6e20 6a6f 6273 2077 696c  ization jobs wil
-00015c00: 6c20 7275 6e20 6174 2060 6030 313a 3030  l run at ``01:00
-00015c10: 6060 2055 5443 2e0a 2020 2020 2020 2020  `` UTC..        
-00015c20: 3a70 6172 616d 2073 7570 706f 7274 735f  :param supports_
-00015c30: 7469 6d65 5f66 696c 7465 7269 6e67 3a20  time_filtering: 
-00015c40: 5768 656e 2073 6574 2074 6f20 6060 5472  When set to ``Tr
-00015c50: 7565 6060 2c20 7468 6520 4461 7461 2053  ue``, the Data S
-00015c60: 6f75 7263 6520 4675 6e63 7469 6f6e 206d  ource Function m
-00015c70: 7573 7420 7461 6b65 2074 6865 2060 6066  ust take the ``f
-00015c80: 696c 7465 725f 636f 6e74 6578 7460 600a  ilter_context``.
-00015c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015cb0: 2020 2020 7061 7261 6d65 7465 7220 616e      parameter an
-00015cc0: 6420 696d 706c 656d 656e 7420 7469 6d65  d implement time
-00015cd0: 2066 696c 7465 7269 6e67 206c 6f67 6963   filtering logic
-00015ce0: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00015cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d00: 2020 2020 2020 6060 7375 7070 6f72 7473        ``supports
-00015d10: 5f74 696d 655f 6669 6c74 6572 696e 6760  _time_filtering`
-00015d20: 6020 6d75 7374 2062 6520 7365 7420 746f  ` must be set to
-00015d30: 2060 5472 7565 6020 6966 2060 603c 6461   `True` if ``<da
-00015d40: 7461 2073 6f75 7263 653e 2e67 6574 5f64  ta source>.get_d
-00015d50: 6174 6166 7261 6d65 2829 6060 2069 7320  ataframe()`` is 
-00015d60: 6361 6c6c 6564 2077 6974 6820 6060 7374  called with ``st
-00015d70: 6172 745f 7469 6d65 6060 0a20 2020 2020  art_time``.     
-00015d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d90: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00015da0: 7220 6060 656e 645f 7469 6d65 6060 2e20  r ``end_time``. 
-00015db0: 6060 7375 7070 6f72 7473 5f74 696d 655f  ``supports_time_
-00015dc0: 6669 6c74 6572 696e 6760 6020 6d75 7374  filtering`` must
-00015dd0: 2061 6c73 6f20 6265 2073 6574 2074 6f20   also be set to 
-00015de0: 6060 5472 7565 6060 2069 6620 7573 696e  ``True`` if usin
-00015df0: 6720 3a63 6c61 7373 3a60 7465 6374 6f6e  g :class:`tecton
-00015e00: 2e64 6563 6c61 7261 7469 7665 2e46 696c  .declarative.Fil
-00015e10: 7465 7265 6453 6f75 7263 6560 0a20 2020  teredSource`.   
-00015e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000139a0: 2020 2020 7572 6c3d 2268 7474 7073 3a2f      url="https:/
+000139b0: 2f3c 796f 7572 2d63 6c75 7374 6572 3e2e  /<your-cluster>.
+000139c0: 6575 2d77 6573 742d 312e 736e 6f77 666c  eu-west-1.snowfl
+000139d0: 616b 6563 6f6d 7075 7469 6e67 2e63 6f6d  akecomputing.com
+000139e0: 2f22 2c0a 2020 2020 2020 2020 2020 2020  /",.            
+000139f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013a10: 2020 6461 7461 6261 7365 3d22 434c 4943    database="CLIC
+00013a20: 4b5f 5354 5245 414d 5f44 4222 2c0a 2020  K_STREAM_DB",.  
+00013a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013a50: 2020 2020 2020 2020 2020 2020 7363 6865              sche
+00013a60: 6d61 3d22 434c 4943 4b5f 5354 5245 414d  ma="CLICK_STREAM
+00013a70: 5f53 4348 454d 4122 2c0a 2020 2020 2020  _SCHEMA",.      
+00013a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013aa0: 2020 2020 2020 2020 7761 7265 686f 7573          warehous
+00013ab0: 653d 2243 4f4d 5055 5445 5f57 4822 2c0a  e="COMPUTE_WH",.
+00013ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013ae0: 2020 2020 2020 2020 2020 2020 2020 7461                ta
+00013af0: 626c 653d 2243 4c49 434b 5f53 5452 4541  ble="CLICK_STREA
+00013b00: 4d5f 4645 4154 5552 4553 222c 0a20 2020  M_FEATURES",.   
+00013b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013b30: 2020 2020 2020 2020 2020 2071 7565 7279             query
+00013b40: 3d22 5345 4c45 4354 2074 696d 6573 7461  ="SELECT timesta
+00013b50: 6d70 2061 7320 7473 2c20 6372 6561 7465  mp as ts, create
+00013b60: 642c 2075 7365 725f 6964 2c20 636c 6963  d, user_id, clic
+00013b70: 6b73 2c20 636c 6963 6b5f 7261 7465 220a  ks, click_rate".
+00013b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013bb0: 2020 2020 2022 4652 4f4d 2043 4c49 434b       "FROM CLICK
+00013bc0: 5f53 5452 4541 4d5f 4442 2e43 4c49 434b  _STREAM_DB.CLICK
+00013bd0: 5f53 5452 4541 4d5f 4645 4154 5552 4553  _STREAM_FEATURES
+00013be0: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
+00013bf0: 2320 5573 6520 696e 2074 6865 2042 6174  # Use in the Bat
+00013c00: 6368 536f 7572 6365 0a20 2020 2020 2020  chSource.       
+00013c10: 2020 2020 2073 6e6f 7766 6c61 6b65 5f64       snowflake_d
+00013c20: 7320 3d20 4261 7463 6853 6f75 7263 6528  s = BatchSource(
+00013c30: 6e61 6d65 3d22 636c 6963 6b5f 7374 7265  name="click_stre
+00013c40: 616d 5f73 6e6f 7766 6c61 6b65 5f64 7322  am_snowflake_ds"
+00013c50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00013c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013c70: 2020 2020 2020 2020 2020 2020 2062 6174               bat
+00013c80: 6368 5f63 6f6e 6669 673d 736e 6f77 666c  ch_config=snowfl
+00013c90: 616b 655f 6473 5f63 6f6e 6669 6729 0a20  ake_ds_config). 
+00013ca0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+00013cb0: 2020 2020 2320 5269 6674 2064 6f65 7320      # Rift does 
+00013cc0: 6e6f 7420 616c 6c6f 7720 736e 6f77 666c  not allow snowfl
+00013cd0: 616b 6520 7461 626c 6573 2074 6f20 6861  ake tables to ha
+00013ce0: 7665 2064 6f75 626c 6520 7175 6f74 6573  ve double quotes
+00013cf0: 2069 6e20 7468 6520 7461 626c 6520 6e61   in the table na
+00013d00: 6d65 0a20 2020 2020 2020 2023 0a20 2020  me.        #.   
+00013d10: 2020 2020 2023 2053 6565 2068 7474 7073       # See https
+00013d20: 3a2f 2f74 6563 746f 6e2e 6174 6c61 7373  ://tecton.atlass
+00013d30: 6961 6e2e 6e65 742f 6272 6f77 7365 2f54  ian.net/browse/T
+00013d40: 4543 2d31 3737 3135 2066 6f72 206d 6f72  EC-17715 for mor
+00013d50: 6520 6465 7461 696c 732e 0a20 2020 2020  e details..     
+00013d60: 2020 2023 2043 6865 636b 696e 6720 7468     # Checking th
+00013d70: 6520 7461 626c 6520 6669 7273 7420 616e  e table first an
+00013d80: 6420 7468 656e 2074 6865 2062 6174 6368  d then the batch
+00013d90: 2063 6f6d 7075 7465 206d 6f64 6520 6973   compute mode is
+00013da0: 2064 6f6e 6520 666f 7220 7468 6520 7361   done for the sa
+00013db0: 6b65 206f 660a 2020 2020 2020 2020 2320  ke of.        # 
+00013dc0: 5344 4b20 7465 7374 7320 7768 6963 6820  SDK tests which 
+00013dd0: 646f 206e 6f74 2073 6574 0a20 2020 2020  do not set.     
+00013de0: 2020 2069 6620 7461 626c 6520 616e 6420     if table and 
+00013df0: 2722 2720 696e 2074 6162 6c65 3a0a 2020  '"' in table:.  
+00013e00: 2020 2020 2020 2020 2020 6261 7463 685f            batch_
+00013e10: 636f 6d70 7574 655f 6d6f 6465 203d 2064  compute_mode = d
+00013e20: 6566 6175 6c74 5f62 6174 6368 5f63 6f6d  efault_batch_com
+00013e30: 7075 7465 5f6d 6f64 6528 290a 2020 2020  pute_mode().    
+00013e40: 2020 2020 2020 2020 6966 2062 6174 6368          if batch
+00013e50: 5f63 6f6d 7075 7465 5f6d 6f64 6520 3d3d  _compute_mode ==
+00013e60: 2042 6174 6368 436f 6d70 7574 654d 6f64   BatchComputeMod
+00013e70: 652e 5249 4654 3a0a 2020 2020 2020 2020  e.RIFT:.        
+00013e80: 2020 2020 2020 2020 6d73 6720 3d20 2252          msg = "R
+00013e90: 6966 7420 646f 6573 206e 6f74 2073 7570  ift does not sup
+00013ea0: 706f 7274 2053 6e6f 7766 6c61 6b65 2074  port Snowflake t
+00013eb0: 6162 6c65 206e 616d 6573 2063 6f6e 7461  able names conta
+00013ec0: 696e 696e 6720 646f 7562 6c65 2071 756f  ining double quo
+00013ed0: 7461 7469 6f6e 206d 6172 6b73 2e22 0a20  tation marks.". 
+00013ee0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00013ef0: 6169 7365 2054 6563 746f 6e56 616c 6964  aise TectonValid
+00013f00: 6174 696f 6e45 7272 6f72 286d 7367 290a  ationError(msg).
+00013f10: 0a20 2020 2020 2020 2073 656c 662e 5f61  .        self._a
+00013f20: 7267 7320 3d20 6172 6773 203d 2064 6174  rgs = args = dat
+00013f30: 615f 736f 7572 6365 5f70 6232 2e53 6e6f  a_source_pb2.Sno
+00013f40: 7766 6c61 6b65 4461 7461 536f 7572 6365  wflakeDataSource
+00013f50: 4172 6773 280a 2020 2020 2020 2020 2020  Args(.          
+00013f60: 2020 6461 7461 6261 7365 3d64 6174 6162    database=datab
+00013f70: 6173 652c 0a20 2020 2020 2020 2020 2020  ase,.           
+00013f80: 2073 6368 656d 613d 7363 6865 6d61 2c0a   schema=schema,.
+00013f90: 2020 2020 2020 2020 2020 2020 7761 7265              ware
+00013fa0: 686f 7573 653d 7761 7265 686f 7573 652c  house=warehouse,
+00013fb0: 0a20 2020 2020 2020 2020 2020 2075 726c  .            url
+00013fc0: 3d75 726c 2c0a 2020 2020 2020 2020 2020  =url,.          
+00013fd0: 2020 726f 6c65 3d72 6f6c 652c 0a20 2020    role=role,.   
+00013fe0: 2020 2020 2020 2020 2074 6162 6c65 3d74           table=t
+00013ff0: 6162 6c65 2c0a 2020 2020 2020 2020 2020  able,.          
+00014000: 2020 7175 6572 793d 7175 6572 792c 0a20    query=query,. 
+00014010: 2020 2020 2020 2020 2020 2075 7365 723d             user=
+00014020: 5f63 6f6e 7665 7274 5f73 6563 7265 745f  _convert_secret_
+00014030: 746f 5f73 616e 6974 697a 6564 5f72 6566  to_sanitized_ref
+00014040: 6572 656e 6365 2875 7365 7229 2069 6620  erence(user) if 
+00014050: 7573 6572 2065 6c73 6520 4e6f 6e65 2c0a  user else None,.
+00014060: 2020 2020 2020 2020 2020 2020 7061 7373              pass
+00014070: 776f 7264 3d5f 636f 6e76 6572 745f 7365  word=_convert_se
+00014080: 6372 6574 5f74 6f5f 7361 6e69 7469 7a65  cret_to_sanitize
+00014090: 645f 7265 6665 7265 6e63 6528 7061 7373  d_reference(pass
+000140a0: 776f 7264 2920 6966 2070 6173 7377 6f72  word) if passwor
+000140b0: 6420 656c 7365 204e 6f6e 652c 0a20 2020  d else None,.   
+000140c0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+000140d0: 6966 2070 6f73 745f 7072 6f63 6573 736f  if post_processo
+000140e0: 7220 6973 206e 6f74 204e 6f6e 6520 616e  r is not None an
+000140f0: 6420 6675 6e63 7469 6f6e 5f73 6572 6961  d function_seria
+00014100: 6c69 7a61 7469 6f6e 2e73 686f 756c 645f  lization.should_
+00014110: 7365 7269 616c 697a 655f 6675 6e63 7469  serialize_functi
+00014120: 6f6e 2870 6f73 745f 7072 6f63 6573 736f  on(post_processo
+00014130: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+00014140: 6172 6773 2e63 6f6d 6d6f 6e5f 6172 6773  args.common_args
+00014150: 2e70 6f73 745f 7072 6f63 6573 736f 722e  .post_processor.
+00014160: 436f 7079 4672 6f6d 2866 756e 6374 696f  CopyFrom(functio
+00014170: 6e5f 7365 7269 616c 697a 6174 696f 6e2e  n_serialization.
+00014180: 746f 5f70 726f 746f 2870 6f73 745f 7072  to_proto(post_pr
+00014190: 6f63 6573 736f 7229 290a 2020 2020 2020  ocessor)).      
+000141a0: 2020 6966 2074 696d 6573 7461 6d70 5f66    if timestamp_f
+000141b0: 6965 6c64 3a0a 2020 2020 2020 2020 2020  ield:.          
+000141c0: 2020 6172 6773 2e63 6f6d 6d6f 6e5f 6172    args.common_ar
+000141d0: 6773 2e74 696d 6573 7461 6d70 5f66 6965  gs.timestamp_fie
+000141e0: 6c64 203d 2074 696d 6573 7461 6d70 5f66  ld = timestamp_f
+000141f0: 6965 6c64 0a0a 2020 2020 2020 2020 6172  ield..        ar
+00014200: 6773 2e63 6f6d 6d6f 6e5f 6172 6773 2e64  gs.common_args.d
+00014210: 6174 615f 6465 6c61 792e 4672 6f6d 5469  ata_delay.FromTi
+00014220: 6d65 6465 6c74 6128 6461 7461 5f64 656c  medelta(data_del
+00014230: 6179 290a 2020 2020 2020 2020 7365 6c66  ay).        self
+00014240: 2e5f 6461 7461 5f64 656c 6179 203d 2064  ._data_delay = d
+00014250: 6174 615f 6465 6c61 790a 2020 2020 2020  ata_delay.      
+00014260: 2020 7365 6c66 2e70 6f73 745f 7072 6f63    self.post_proc
+00014270: 6573 736f 7220 3d20 706f 7374 5f70 726f  essor = post_pro
+00014280: 6365 7373 6f72 0a0a 2020 2020 4070 726f  cessor..    @pro
+00014290: 7065 7274 790a 2020 2020 6465 6620 6461  perty.    def da
+000142a0: 7461 5f64 656c 6179 2873 656c 6629 3a0a  ta_delay(self):.
+000142b0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000142c0: 656c 662e 5f64 6174 615f 6465 6c61 790a  elf._data_delay.
+000142d0: 0a20 2020 2064 6566 205f 6d65 7267 655f  .    def _merge_
+000142e0: 6261 7463 685f 6172 6773 2873 656c 662c  batch_args(self,
+000142f0: 2064 6174 615f 736f 7572 6365 5f61 7267   data_source_arg
+00014300: 733a 2076 6972 7475 616c 5f64 6174 615f  s: virtual_data_
+00014310: 736f 7572 6365 5f70 6232 2e56 6972 7475  source_pb2.Virtu
+00014320: 616c 4461 7461 536f 7572 6365 4172 6773  alDataSourceArgs
+00014330: 293a 0a20 2020 2020 2020 2064 6174 615f  ):.        data_
+00014340: 736f 7572 6365 5f61 7267 732e 736e 6f77  source_args.snow
+00014350: 666c 616b 655f 6473 5f63 6f6e 6669 672e  flake_ds_config.
+00014360: 436f 7079 4672 6f6d 2873 656c 662e 5f61  CopyFrom(self._a
+00014370: 7267 7329 0a0a 0a63 6c61 7373 2052 6564  rgs)...class Red
+00014380: 7368 6966 7443 6f6e 6669 6728 4261 7365  shiftConfig(Base
+00014390: 4261 7463 6843 6f6e 6669 6729 3a0a 2020  BatchConfig):.  
+000143a0: 2020 2222 220a 2020 2020 436f 6e66 6967    """.    Config
+000143b0: 7572 6174 696f 6e20 7573 6564 2074 6f20  uration used to 
+000143c0: 7265 6665 7265 6e63 6520 6120 5265 6473  reference a Reds
+000143d0: 6869 6674 2074 6162 6c65 206f 7220 7175  hift table or qu
+000143e0: 6572 792e 0a0a 2020 2020 5468 6520 5265  ery...    The Re
+000143f0: 6473 6869 6674 436f 6e66 6967 2063 6c61  dshiftConfig cla
+00014400: 7373 2069 7320 7573 6564 2074 6f20 6372  ss is used to cr
+00014410: 6561 7465 2061 2072 6566 6572 656e 6365  eate a reference
+00014420: 2074 6f20 6120 5265 6473 6869 6674 2074   to a Redshift t
+00014430: 6162 6c65 2e20 596f 7520 6361 6e20 616c  able. You can al
+00014440: 736f 2063 7265 6174 6520 610a 2020 2020  so create a.    
+00014450: 7265 6665 7265 6e63 6520 746f 2061 2071  reference to a q
+00014460: 7565 7279 206f 6e20 6f6e 6520 6f72 206d  uery on one or m
+00014470: 6f72 6520 7461 626c 6573 2c20 7768 6963  ore tables, whic
+00014480: 6820 7769 6c6c 2062 6520 7265 6769 7374  h will be regist
+00014490: 6572 6564 2069 6e20 5465 6374 6f6e 2069  ered in Tecton i
+000144a0: 6e20 6120 7369 6d69 6c61 7220 7761 7920  n a similar way 
+000144b0: 6173 2061 2076 6965 770a 2020 2020 6973  as a view.    is
+000144c0: 2072 6567 6973 7465 7265 6420 696e 206f   registered in o
+000144d0: 7468 6572 2064 6174 6120 7379 7374 656d  ther data system
+000144e0: 732e 0a0a 2020 2020 5468 6973 2063 6c61  s...    This cla
+000144f0: 7373 2075 7365 6420 6173 2061 6e20 696e  ss used as an in
+00014500: 7075 7420 746f 2061 203a 636c 6173 733a  put to a :class:
+00014510: 6042 6174 6368 536f 7572 6365 6027 7320  `BatchSource`'s 
+00014520: 7061 7261 6d65 7465 7220 6060 6261 7463  parameter ``batc
+00014530: 685f 636f 6e66 6967 6060 2e20 5468 6973  h_config``. This
+00014540: 2063 6c61 7373 2069 7320 6e6f 740a 2020   class is not.  
+00014550: 2020 6120 5465 6374 6f6e 204f 626a 6563    a Tecton Objec
+00014560: 743a 2069 7420 6973 2061 2067 726f 7570  t: it is a group
+00014570: 696e 6720 6f66 2070 6172 616d 6574 6572  ing of parameter
+00014580: 732e 2044 6563 6c61 7269 6e67 2074 6869  s. Declaring thi
+00014590: 7320 636c 6173 7320 616c 6f6e 6520 7769  s class alone wi
+000145a0: 6c6c 206e 6f74 2072 6567 6973 7465 7220  ll not register 
+000145b0: 6120 6461 7461 2073 6f75 7263 652e 0a20  a data source.. 
+000145c0: 2020 2049 6e73 7465 6164 2c20 6465 636c     Instead, decl
+000145d0: 6172 6520 6173 2070 6172 7420 6f66 2060  are as part of `
+000145e0: 6042 6174 6368 536f 7572 6365 6060 2074  `BatchSource`` t
+000145f0: 6861 7420 7461 6b65 7320 7468 6973 2063  hat takes this c
+00014600: 6f6e 6669 6775 7261 7469 6f6e 2063 6c61  onfiguration cla
+00014610: 7373 2069 6e73 7461 6e63 6520 6173 2061  ss instance as a
+00014620: 2070 6172 616d 6574 6572 2e0a 2020 2020   parameter..    
+00014630: 2222 220a 0a20 2020 2064 6566 205f 5f69  """..    def __i
+00014640: 6e69 745f 5f28 0a20 2020 2020 2020 2073  nit__(.        s
+00014650: 656c 662c 0a20 2020 2020 2020 2065 6e64  elf,.        end
+00014660: 706f 696e 743a 2073 7472 2c0a 2020 2020  point: str,.    
+00014670: 2020 2020 7461 626c 653a 204f 7074 696f      table: Optio
+00014680: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
+00014690: 0a20 2020 2020 2020 2070 6f73 745f 7072  .        post_pr
+000146a0: 6f63 6573 736f 723a 204f 7074 696f 6e61  ocessor: Optiona
+000146b0: 6c5b 4361 6c6c 6162 6c65 5d20 3d20 4e6f  l[Callable] = No
+000146c0: 6e65 2c0a 2020 2020 2020 2020 7175 6572  ne,.        quer
+000146d0: 793a 204f 7074 696f 6e61 6c5b 7374 725d  y: Optional[str]
+000146e0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+000146f0: 2074 696d 6573 7461 6d70 5f66 6965 6c64   timestamp_field
+00014700: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+00014710: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+00014720: 6461 7461 5f64 656c 6179 3a20 6461 7465  data_delay: date
+00014730: 7469 6d65 2e74 696d 6564 656c 7461 203d  time.timedelta =
+00014740: 2064 6174 6574 696d 652e 7469 6d65 6465   datetime.timede
+00014750: 6c74 6128 7365 636f 6e64 733d 3029 2c0a  lta(seconds=0),.
+00014760: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+00014770: 2222 0a20 2020 2020 2020 2049 6e73 7461  "".        Insta
+00014780: 6e74 6961 7465 7320 6120 6e65 7720 5265  ntiates a new Re
+00014790: 6473 6869 6674 436f 6e66 6967 2e20 4f6e  dshiftConfig. On
+000147a0: 6520 6f66 2074 6162 6c65 2061 6e64 2071  e of table and q
+000147b0: 7565 7279 2073 686f 756c 6420 6265 2073  uery should be s
+000147c0: 7065 6369 6669 6564 2077 6865 6e20 6372  pecified when cr
+000147d0: 6561 7469 6e67 2074 6869 7320 6669 6c65  eating this file
+000147e0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+000147f0: 6d20 656e 6470 6f69 6e74 3a20 5468 6520  m endpoint: The 
+00014800: 636f 6e6e 6563 7469 6f6e 2065 6e64 706f  connection endpo
+00014810: 696e 7420 746f 2052 6564 7368 6966 740a  int to Redshift.
+00014820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014830: 2020 2020 2020 2020 2028 652e 672e 2072           (e.g. r
+00014840: 6564 7368 6966 742d 636c 7573 7465 722d  edshift-cluster-
+00014850: 312e 6369 6763 777a 7364 6c74 6a73 2e75  1.cigcwzsdltjs.u
+00014860: 732d 7765 7374 2d32 2e72 6564 7368 6966  s-west-2.redshif
+00014870: 742e 616d 617a 6f6e 6177 732e 636f 6d3a  t.amazonaws.com:
+00014880: 3534 3339 2f64 6576 292e 0a20 2020 2020  5439/dev)..     
+00014890: 2020 203a 7061 7261 6d20 7461 626c 653a     :param table:
+000148a0: 2054 6865 2052 6564 7368 6966 7420 7461   The Redshift ta
+000148b0: 626c 6520 666f 7220 7468 6973 2044 6174  ble for this Dat
+000148c0: 6120 736f 7572 6365 2e20 4f6e 6c79 206f  a source. Only o
+000148d0: 6e65 206f 6620 7461 626c 6520 616e 6420  ne of table and 
+000148e0: 7175 6572 7920 7368 6f75 6c64 2062 6520  query should be 
+000148f0: 7370 6563 6966 6965 642e 0a20 2020 2020  specified..     
+00014900: 2020 203a 7061 7261 6d20 706f 7374 5f70     :param post_p
+00014910: 726f 6365 7373 6f72 3a20 5079 7468 6f6e  rocessor: Python
+00014920: 2075 7365 7220 6465 6669 6e65 6420 6675   user defined fu
+00014930: 6e63 7469 6f6e 2060 6066 2844 6174 6146  nction ``f(DataF
+00014940: 7261 6d65 2920 2d3e 2044 6174 6146 7261  rame) -> DataFra
+00014950: 6d65 6060 2074 6861 7420 7461 6b65 7320  me`` that takes 
+00014960: 696e 2072 6177 0a20 2020 2020 2020 2020  in raw.         
+00014970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014980: 2020 2020 2020 2020 2020 2020 5079 5370              PySp
+00014990: 6172 6b20 6461 7461 2073 6f75 7263 6520  ark data source 
+000149a0: 4461 7461 4672 616d 6520 616e 6420 7472  DataFrame and tr
+000149b0: 616e 736c 6174 6573 2069 7420 746f 2074  anslates it to t
+000149c0: 6865 2044 6174 6146 7261 6d65 2074 6f20  he DataFrame to 
+000149d0: 6265 0a20 2020 2020 2020 2020 2020 2020  be.             
+000149e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000149f0: 2020 2020 2020 2020 636f 6e73 756d 6564          consumed
+00014a00: 2062 7920 7468 6520 4665 6174 7572 6520   by the Feature 
+00014a10: 5669 6577 2e0a 2020 2020 2020 2020 3a70  View..        :p
+00014a20: 6172 616d 2071 7565 7279 3a20 4120 5265  aram query: A Re
+00014a30: 6473 6869 6674 2071 7565 7279 2066 6f72  dshift query for
+00014a40: 2074 6869 7320 4461 7461 2073 6f75 7263   this Data sourc
+00014a50: 652e 204f 6e6c 7920 6f6e 6520 6f66 2074  e. Only one of t
+00014a60: 6162 6c65 2061 6e64 2071 7565 7279 2073  able and query s
+00014a70: 686f 756c 6420 6265 2073 7065 6369 6669  hould be specifi
+00014a80: 6564 2e0a 2020 2020 2020 2020 3a70 6172  ed..        :par
+00014a90: 616d 2074 696d 6573 7461 6d70 5f66 6965  am timestamp_fie
+00014aa0: 6c64 3a20 5468 6520 7469 6d65 7374 616d  ld: The timestam
+00014ab0: 7020 636f 6c75 6d6e 2069 6e20 7468 6973  p column in this
+00014ac0: 2064 6174 6120 736f 7572 6365 2074 6861   data source tha
+00014ad0: 7420 7368 6f75 6c64 2062 6520 7573 6564  t should be used
+00014ae0: 2062 7920 6046 696c 7465 7265 6453 6f75   by `FilteredSou
+00014af0: 7263 6560 0a20 2020 2020 2020 2020 2020  rce`.           
+00014b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014b10: 2020 2020 2020 2020 2074 6f20 6669 6c74           to filt
+00014b20: 6572 2064 6174 6120 6672 6f6d 2074 6869  er data from thi
+00014b30: 7320 736f 7572 6365 2c20 6265 666f 7265  s source, before
+00014b40: 2061 6e79 2066 6561 7475 7265 2076 6965   any feature vie
+00014b50: 7720 7472 616e 7366 6f72 6d61 7469 6f6e  w transformation
+00014b60: 7320 6172 6520 6170 706c 6965 642e 0a20  s are applied.. 
+00014b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014b90: 2020 204f 6e6c 7920 7265 7175 6972 6564     Only required
+00014ba0: 2069 6620 7468 6973 2073 6f75 7263 6520   if this source 
+00014bb0: 6973 2075 7365 6420 7769 7468 2060 4669  is used with `Fi
+00014bc0: 6c74 6572 6564 536f 7572 6365 602e 0a20  lteredSource`.. 
+00014bd0: 2020 2020 2020 203a 7061 7261 6d20 6461         :param da
+00014be0: 7461 5f64 656c 6179 3a20 4279 2064 6566  ta_delay: By def
+00014bf0: 6175 6c74 2c20 696e 6372 656d 656e 7461  ault, incrementa
+00014c00: 6c20 6d61 7465 7269 616c 697a 6174 696f  l materializatio
+00014c10: 6e20 6a6f 6273 2072 756e 2069 6d6d 6564  n jobs run immed
+00014c20: 6961 7465 6c79 2061 7420 7468 6520 656e  iately at the en
+00014c30: 6420 6f66 2074 6865 0a20 2020 2020 2020  d of the.       
+00014c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014c50: 2020 2020 2020 2020 2020 2020 2062 6174               bat
+00014c60: 6368 2073 6368 6564 756c 6520 7065 7269  ch schedule peri
+00014c70: 6f64 2e20 5468 6973 2070 6172 616d 6574  od. This paramet
+00014c80: 6572 2063 6f6e 6669 6775 7265 7320 686f  er configures ho
+00014c90: 7720 6c6f 6e67 2074 6865 7920 7761 6974  w long they wait
+00014ca0: 2061 6674 6572 2074 6865 2065 6e64 0a20   after the end. 
+00014cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014cd0: 2020 206f 6620 7468 6520 7065 7269 6f64     of the period
+00014ce0: 2062 6566 6f72 6520 7374 6172 7469 6e67   before starting
+00014cf0: 2c20 7479 7069 6361 6c6c 7920 746f 2065  , typically to e
+00014d00: 6e73 7572 6520 7468 6174 2061 6c6c 2064  nsure that all d
+00014d10: 6174 6120 6861 7320 6c61 6e64 6564 2e0a  ata has landed..
+00014d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014d40: 2020 2020 466f 7220 6578 616d 706c 652c      For example,
+00014d50: 2069 6620 6120 6665 6174 7572 6520 7669   if a feature vi
+00014d60: 6577 2068 6173 2061 2060 6261 7463 685f  ew has a `batch_
+00014d70: 7363 6865 6475 6c65 6020 6f66 2031 2064  schedule` of 1 d
+00014d80: 6179 2061 6e64 206f 6e65 206f 660a 2020  ay and one of.  
+00014d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014db0: 2020 7468 6520 6461 7461 2073 6f75 7263    the data sourc
+00014dc0: 6520 696e 7075 7473 2068 6173 2060 6461  e inputs has `da
+00014dd0: 7461 5f64 656c 6179 3d74 696d 6564 656c  ta_delay=timedel
+00014de0: 7461 2868 6f75 7273 3d31 2960 2073 6574  ta(hours=1)` set
+00014df0: 2c20 7468 656e 0a20 2020 2020 2020 2020  , then.         
+00014e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014e10: 2020 2020 2020 2020 2020 2069 6e63 7265             incre
+00014e20: 6d65 6e74 616c 206d 6174 6572 6961 6c69  mental materiali
+00014e30: 7a61 7469 6f6e 206a 6f62 7320 7769 6c6c  zation jobs will
+00014e40: 2072 756e 2061 7420 6030 313a 3030 6020   run at `01:00` 
+00014e50: 5554 432e 0a0a 2020 2020 2020 2020 3a72  UTC...        :r
+00014e60: 6574 7572 6e3a 2041 2052 6564 7368 6966  eturn: A Redshif
+00014e70: 7443 6f6e 6669 6720 636c 6173 7320 696e  tConfig class in
+00014e80: 7374 616e 6365 2e0a 0a20 2020 2020 2020  stance...       
+00014e90: 2045 7861 6d70 6c65 206f 6620 6120 5265   Example of a Re
+00014ea0: 6473 6869 6674 436f 6e66 6967 2064 6563  dshiftConfig dec
+00014eb0: 6c61 7261 7469 6f6e 3a0a 0a20 2020 2020  laration:..     
+00014ec0: 2020 202e 2e20 636f 6465 2d62 6c6f 636b     .. code-block
+00014ed0: 3a3a 2070 7974 686f 6e0a 0a20 2020 2020  :: python..     
+00014ee0: 2020 2020 2020 2066 726f 6d20 7465 6374         from tect
+00014ef0: 6f6e 2069 6d70 6f72 7420 5265 6473 6869  on import Redshi
+00014f00: 6674 436f 6e66 6967 0a0a 2020 2020 2020  ftConfig..      
+00014f10: 2020 2020 2020 2320 4465 636c 6172 6520        # Declare 
+00014f20: 5265 6473 6869 6674 436f 6e66 6967 2069  RedshiftConfig i
+00014f30: 6e73 7461 6e63 6520 6f62 6a65 6374 2074  nstance object t
+00014f40: 6861 7420 6361 6e20 6265 2075 7365 6420  hat can be used 
+00014f50: 6173 2061 6e20 6172 6775 6d65 6e74 2069  as an argument i
+00014f60: 6e20 4261 7463 6853 6f75 7263 650a 2020  n BatchSource.  
+00014f70: 2020 2020 2020 2020 2020 7265 6473 6869            redshi
+00014f80: 6674 5f64 735f 636f 6e66 6967 203d 2052  ft_ds_config = R
+00014f90: 6564 7368 6966 7443 6f6e 6669 6728 656e  edshiftConfig(en
+00014fa0: 6470 6f69 6e74 3d22 636c 7573 7465 722d  dpoint="cluster-
+00014fb0: 312e 7573 2d77 6573 742d 322e 7265 6473  1.us-west-2.reds
+00014fc0: 6869 6674 2e61 6d61 7a6f 6e61 7773 2e63  hift.amazonaws.c
+00014fd0: 6f6d 3a35 3433 392f 6465 7622 2c0a 2020  om:5439/dev",.  
+00014fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015010: 7175 6572 793d 2253 454c 4543 5420 7469  query="SELECT ti
+00015020: 6d65 7374 616d 7020 6173 2074 732c 2063  mestamp as ts, c
+00015030: 7265 6174 6564 2c20 7573 6572 5f69 642c  reated, user_id,
+00015040: 2061 645f 6964 2c20 6475 7261 7469 6f6e   ad_id, duration
+00015050: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00015060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015080: 2020 2020 2020 2020 2020 2246 524f 4d20            "FROM 
+00015090: 6164 5f73 6572 7669 6e67 5f66 6561 7475  ad_serving_featu
+000150a0: 7265 7322 290a 2020 2020 2020 2020 2222  res").        ""
+000150b0: 220a 2020 2020 2020 2020 7365 6c66 2e5f  ".        self._
+000150c0: 6172 6773 203d 2061 7267 7320 3d20 6461  args = args = da
+000150d0: 7461 5f73 6f75 7263 655f 7062 322e 5265  ta_source_pb2.Re
+000150e0: 6473 6869 6674 4461 7461 536f 7572 6365  dshiftDataSource
+000150f0: 4172 6773 2829 0a20 2020 2020 2020 2061  Args().        a
+00015100: 7267 732e 656e 6470 6f69 6e74 203d 2065  rgs.endpoint = e
+00015110: 6e64 706f 696e 740a 0a20 2020 2020 2020  ndpoint..       
+00015120: 2069 6620 7461 626c 6520 616e 6420 7175   if table and qu
+00015130: 6572 793a 0a20 2020 2020 2020 2020 2020  ery:.           
+00015140: 206d 7367 203d 2022 5368 6f75 6c64 206f   msg = "Should o
+00015150: 6e6c 7920 7370 6563 6966 7920 6f6e 6520  nly specify one 
+00015160: 6f66 2074 6162 6c65 2061 6e64 2071 7565  of table and que
+00015170: 7279 2073 6f75 7263 6573 2066 6f72 2072  ry sources for r
+00015180: 6564 7368 6966 7422 0a20 2020 2020 2020  edshift".       
+00015190: 2020 2020 2072 6169 7365 2041 7373 6572       raise Asser
+000151a0: 7469 6f6e 4572 726f 7228 6d73 6729 0a20  tionError(msg). 
+000151b0: 2020 2020 2020 2069 6620 6e6f 7420 7461         if not ta
+000151c0: 626c 6520 616e 6420 6e6f 7420 7175 6572  ble and not quer
+000151d0: 793a 0a20 2020 2020 2020 2020 2020 206d  y:.            m
+000151e0: 7367 203d 2022 4d69 7373 696e 6720 626f  sg = "Missing bo
+000151f0: 7468 2074 6162 6c65 2061 6e64 2071 7565  th table and que
+00015200: 7279 2073 6f75 7263 6573 2066 6f72 2072  ry sources for r
+00015210: 6564 7368 6966 742c 2065 7861 6374 6c79  edshift, exactly
+00015220: 206f 6e65 206d 7573 7420 6265 2070 7265   one must be pre
+00015230: 7365 6e74 220a 2020 2020 2020 2020 2020  sent".          
+00015240: 2020 7261 6973 6520 4173 7365 7274 696f    raise Assertio
+00015250: 6e45 7272 6f72 286d 7367 290a 0a20 2020  nError(msg)..   
+00015260: 2020 2020 2069 6620 7461 626c 653a 0a20       if table:. 
+00015270: 2020 2020 2020 2020 2020 2061 7267 732e             args.
+00015280: 7461 626c 6520 3d20 7461 626c 650a 2020  table = table.  
+00015290: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000152a0: 2020 2020 2020 2020 6172 6773 2e71 7565          args.que
+000152b0: 7279 203d 2071 7565 7279 0a0a 2020 2020  ry = query..    
+000152c0: 2020 2020 6966 2070 6f73 745f 7072 6f63      if post_proc
+000152d0: 6573 736f 7220 6973 206e 6f74 204e 6f6e  essor is not Non
+000152e0: 6520 616e 6420 6675 6e63 7469 6f6e 5f73  e and function_s
+000152f0: 6572 6961 6c69 7a61 7469 6f6e 2e73 686f  erialization.sho
+00015300: 756c 645f 7365 7269 616c 697a 655f 6675  uld_serialize_fu
+00015310: 6e63 7469 6f6e 2870 6f73 745f 7072 6f63  nction(post_proc
+00015320: 6573 736f 7229 3a0a 2020 2020 2020 2020  essor):.        
+00015330: 2020 2020 6172 6773 2e63 6f6d 6d6f 6e5f      args.common_
+00015340: 6172 6773 2e70 6f73 745f 7072 6f63 6573  args.post_proces
+00015350: 736f 722e 436f 7079 4672 6f6d 2866 756e  sor.CopyFrom(fun
+00015360: 6374 696f 6e5f 7365 7269 616c 697a 6174  ction_serializat
+00015370: 696f 6e2e 746f 5f70 726f 746f 2870 6f73  ion.to_proto(pos
+00015380: 745f 7072 6f63 6573 736f 7229 290a 2020  t_processor)).  
+00015390: 2020 2020 2020 6966 2074 696d 6573 7461        if timesta
+000153a0: 6d70 5f66 6965 6c64 3a0a 2020 2020 2020  mp_field:.      
+000153b0: 2020 2020 2020 6172 6773 2e63 6f6d 6d6f        args.commo
+000153c0: 6e5f 6172 6773 2e74 696d 6573 7461 6d70  n_args.timestamp
+000153d0: 5f66 6965 6c64 203d 2074 696d 6573 7461  _field = timesta
+000153e0: 6d70 5f66 6965 6c64 0a0a 2020 2020 2020  mp_field..      
+000153f0: 2020 6172 6773 2e63 6f6d 6d6f 6e5f 6172    args.common_ar
+00015400: 6773 2e64 6174 615f 6465 6c61 792e 4672  gs.data_delay.Fr
+00015410: 6f6d 5469 6d65 6465 6c74 6128 6461 7461  omTimedelta(data
+00015420: 5f64 656c 6179 290a 2020 2020 2020 2020  _delay).        
+00015430: 7365 6c66 2e5f 6461 7461 5f64 656c 6179  self._data_delay
+00015440: 203d 2064 6174 615f 6465 6c61 790a 2020   = data_delay.  
+00015450: 2020 2020 2020 7365 6c66 2e70 6f73 745f        self.post_
+00015460: 7072 6f63 6573 736f 7220 3d20 706f 7374  processor = post
+00015470: 5f70 726f 6365 7373 6f72 0a0a 2020 2020  _processor..    
+00015480: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00015490: 6620 6461 7461 5f64 656c 6179 2873 656c  f data_delay(sel
+000154a0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+000154b0: 726e 2073 656c 662e 5f64 6174 615f 6465  rn self._data_de
+000154c0: 6c61 790a 0a20 2020 2064 6566 205f 6d65  lay..    def _me
+000154d0: 7267 655f 6261 7463 685f 6172 6773 2873  rge_batch_args(s
+000154e0: 656c 662c 2064 6174 615f 736f 7572 6365  elf, data_source
+000154f0: 5f61 7267 733a 2076 6972 7475 616c 5f64  _args: virtual_d
+00015500: 6174 615f 736f 7572 6365 5f70 6232 2e56  ata_source_pb2.V
+00015510: 6972 7475 616c 4461 7461 536f 7572 6365  irtualDataSource
+00015520: 4172 6773 293a 0a20 2020 2020 2020 2064  Args):.        d
+00015530: 6174 615f 736f 7572 6365 5f61 7267 732e  ata_source_args.
+00015540: 7265 6473 6869 6674 5f64 735f 636f 6e66  redshift_ds_conf
+00015550: 6967 2e43 6f70 7946 726f 6d28 7365 6c66  ig.CopyFrom(self
+00015560: 2e5f 6172 6773 290a 0a0a 636c 6173 7320  ._args)...class 
+00015570: 5370 6172 6b42 6174 6368 436f 6e66 6967  SparkBatchConfig
+00015580: 2842 6173 6542 6174 6368 436f 6e66 6967  (BaseBatchConfig
+00015590: 293a 0a20 2020 2022 2222 0a20 2020 2043  ):.    """.    C
+000155a0: 6f6e 6669 6775 7261 7469 6f6e 2075 7365  onfiguration use
+000155b0: 6420 746f 2064 6566 696e 6520 6120 6261  d to define a ba
+000155c0: 7463 6820 736f 7572 6365 2075 7369 6e67  tch source using
+000155d0: 2061 2044 6174 6120 536f 7572 6365 2046   a Data Source F
+000155e0: 756e 6374 696f 6e2e 0a0a 2020 2020 5468  unction...    Th
+000155f0: 6520 6060 5370 6172 6b42 6174 6368 436f  e ``SparkBatchCo
+00015600: 6e66 6967 6060 2063 6c61 7373 2069 7320  nfig`` class is 
+00015610: 7573 6564 2074 6f20 636f 6e66 6967 7572  used to configur
+00015620: 6520 6120 6261 7463 6820 736f 7572 6365  e a batch source
+00015630: 2075 7369 6e67 2061 2075 7365 7220 6465   using a user de
+00015640: 6669 6e65 6420 4461 7461 2053 6f75 7263  fined Data Sourc
+00015650: 6520 4675 6e63 7469 6f6e 2e0a 0a20 2020  e Function...   
+00015660: 2054 6869 7320 636c 6173 7320 6973 2075   This class is u
+00015670: 7365 6420 6173 2061 6e20 696e 7075 7420  sed as an input 
+00015680: 746f 2061 203a 636c 6173 733a 6042 6174  to a :class:`Bat
+00015690: 6368 536f 7572 6365 6027 7320 7061 7261  chSource`'s para
+000156a0: 6d65 7465 7220 6060 6261 7463 685f 636f  meter ``batch_co
+000156b0: 6e66 6967 6060 2e20 4465 636c 6172 696e  nfig``. Declarin
+000156c0: 6720 7468 6973 2063 6f6e 6669 6775 7261  g this configura
+000156d0: 7469 6f6e 0a20 2020 2063 6c61 7373 2061  tion.    class a
+000156e0: 6c6f 6e65 2077 696c 6c20 6e6f 7420 7265  lone will not re
+000156f0: 6769 7374 6572 2061 2044 6174 6120 536f  gister a Data So
+00015700: 7572 6365 2e20 496e 7374 6561 642c 2064  urce. Instead, d
+00015710: 6563 6c61 7265 2061 7320 6120 7061 7274  eclare as a part
+00015720: 206f 6620 6060 4261 7463 6853 6f75 7263   of ``BatchSourc
+00015730: 6560 6020 7468 6174 2074 616b 6573 2074  e`` that takes t
+00015740: 6869 7320 636f 6e66 6967 7572 6174 696f  his configuratio
+00015750: 6e0a 2020 2020 636c 6173 7320 696e 7374  n.    class inst
+00015760: 616e 6365 2061 7320 6120 7061 7261 6d65  ance as a parame
+00015770: 7465 722e 0a0a 2020 2020 2a2a 446f 206e  ter...    **Do n
+00015780: 6f74 2069 6e73 7461 6e74 6961 7465 2074  ot instantiate t
+00015790: 6869 7320 636c 6173 7320 6469 7265 6374  his class direct
+000157a0: 6c79 2e2a 2a20 5573 6520 3a70 793a 6675  ly.** Use :py:fu
+000157b0: 6e63 3a60 7465 6374 6f6e 2e73 7061 726b  nc:`tecton.spark
+000157c0: 5f62 6174 6368 5f63 6f6e 6669 6760 2069  _batch_config` i
+000157d0: 6e73 7465 6164 2e0a 2020 2020 2222 220a  nstead..    """.
+000157e0: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+000157f0: 5f28 0a20 2020 2020 2020 2073 656c 662c  _(.        self,
+00015800: 0a20 2020 2020 2020 2064 6174 615f 736f  .        data_so
+00015810: 7572 6365 5f66 756e 6374 696f 6e3a 2055  urce_function: U
+00015820: 6e69 6f6e 5b0a 2020 2020 2020 2020 2020  nion[.          
+00015830: 2020 4361 6c6c 6162 6c65 5b5b 5370 6172    Callable[[Spar
+00015840: 6b53 6573 7369 6f6e 5d2c 2044 6174 6146  kSession], DataF
+00015850: 7261 6d65 5d2c 2043 616c 6c61 626c 655b  rame], Callable[
+00015860: 5b53 7061 726b 5365 7373 696f 6e2c 2046  [SparkSession, F
+00015870: 696c 7465 7243 6f6e 7465 7874 5d2c 2044  ilterContext], D
+00015880: 6174 6146 7261 6d65 5d0a 2020 2020 2020  ataFrame].      
+00015890: 2020 5d2c 0a20 2020 2020 2020 2064 6174    ],.        dat
+000158a0: 615f 6465 6c61 793a 2064 6174 6574 696d  a_delay: datetim
+000158b0: 652e 7469 6d65 6465 6c74 6120 3d20 6461  e.timedelta = da
+000158c0: 7465 7469 6d65 2e74 696d 6564 656c 7461  tetime.timedelta
+000158d0: 2873 6563 6f6e 6473 3d30 292c 0a20 2020  (seconds=0),.   
+000158e0: 2020 2020 2073 7570 706f 7274 735f 7469       supports_ti
+000158f0: 6d65 5f66 696c 7465 7269 6e67 3a20 626f  me_filtering: bo
+00015900: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+00015910: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00015920: 2020 2020 2020 2049 6e73 7461 6e74 6961         Instantia
+00015930: 7465 7320 6120 6e65 7720 5370 6172 6b42  tes a new SparkB
+00015940: 6174 6368 436f 6e66 6967 2e0a 0a20 2020  atchConfig...   
+00015950: 2020 2020 203a 7061 7261 6d20 6461 7461       :param data
+00015960: 5f73 6f75 7263 655f 6675 6e63 7469 6f6e  _source_function
+00015970: 3a20 5573 6572 2064 6566 696e 6564 2044  : User defined D
+00015980: 6174 6120 536f 7572 6365 2046 756e 6374  ata Source Funct
+00015990: 696f 6e20 7468 6174 2074 616b 6573 2069  ion that takes i
+000159a0: 6e20 6120 6060 5370 6172 6b53 6573 7369  n a ``SparkSessi
+000159b0: 6f6e 6060 2061 6e64 2061 6e20 6f70 7469  on`` and an opti
+000159c0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+000159d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000159e0: 2020 2020 2020 2020 203a 636c 6173 733a           :class:
+000159f0: 6074 6563 746f 6e2e 4669 6c74 6572 436f  `tecton.FilterCo
+00015a00: 6e74 6578 7460 2c20 6966 2060 6073 7570  ntext`, if ``sup
+00015a10: 706f 7274 735f 7469 6d65 5f66 696c 7465  ports_time_filte
+00015a20: 7269 6e67 3d54 7275 6560 602e 2052 6574  ring=True``. Ret
+00015a30: 7572 6e73 2061 2060 6044 6174 6146 7261  urns a ``DataFra
+00015a40: 6d65 6060 2e0a 2020 2020 2020 2020 3a70  me``..        :p
+00015a50: 6172 616d 2064 6174 615f 6465 6c61 793a  aram data_delay:
+00015a60: 2042 7920 6465 6661 756c 742c 2069 6e63   By default, inc
+00015a70: 7265 6d65 6e74 616c 206d 6174 6572 6961  remental materia
+00015a80: 6c69 7a61 7469 6f6e 206a 6f62 7320 7275  lization jobs ru
+00015a90: 6e20 696d 6d65 6469 6174 656c 7920 6174  n immediately at
+00015aa0: 2074 6865 2065 6e64 206f 6620 7468 650a   the end of the.
+00015ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ad0: 2020 2020 6261 7463 6820 7363 6865 6475      batch schedu
+00015ae0: 6c65 2070 6572 696f 642e 2054 6869 7320  le period. This 
+00015af0: 7061 7261 6d65 7465 7220 636f 6e66 6967  parameter config
+00015b00: 7572 6573 2068 6f77 206c 6f6e 6720 7468  ures how long th
+00015b10: 6579 2077 6169 7420 6166 7465 7220 7468  ey wait after th
+00015b20: 6520 656e 640a 2020 2020 2020 2020 2020  e end.          
+00015b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015b40: 2020 2020 2020 2020 2020 6f66 2074 6865            of the
+00015b50: 2070 6572 696f 6420 6265 666f 7265 2073   period before s
+00015b60: 7461 7274 696e 672c 2074 7970 6963 616c  tarting, typical
+00015b70: 6c79 2074 6f20 656e 7375 7265 2074 6861  ly to ensure tha
+00015b80: 7420 616c 6c20 6461 7461 2068 6173 206c  t all data has l
+00015b90: 616e 6465 642e 0a20 2020 2020 2020 2020  anded..         
+00015ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015bb0: 2020 2020 2020 2020 2020 2046 6f72 2065             For e
+00015bc0: 7861 6d70 6c65 2c20 6966 2061 2066 6561  xample, if a fea
+00015bd0: 7475 7265 2076 6965 7720 6861 7320 6120  ture view has a 
+00015be0: 6060 6261 7463 685f 7363 6865 6475 6c65  ``batch_schedule
+00015bf0: 6060 206f 6620 3120 6461 7920 616e 6420  `` of 1 day and 
+00015c00: 6f6e 6520 6f66 0a20 2020 2020 2020 2020  one of.         
+00015c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015c20: 2020 2020 2020 2020 2020 2074 6865 2064             the d
+00015c30: 6174 6120 736f 7572 6365 2069 6e70 7574  ata source input
+00015c40: 7320 6861 7320 6120 6060 6461 7461 5f64  s has a ``data_d
+00015c50: 656c 6179 6060 206f 6620 3120 686f 7572  elay`` of 1 hour
+00015c60: 2c20 7468 656e 0a20 2020 2020 2020 2020  , then.         
+00015c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015c80: 2020 2020 2020 2020 2020 2069 6e63 7265             incre
+00015c90: 6d65 6e74 616c 206d 6174 6572 6961 6c69  mental materiali
+00015ca0: 7a61 7469 6f6e 206a 6f62 7320 7769 6c6c  zation jobs will
+00015cb0: 2072 756e 2061 7420 6060 3031 3a30 3060   run at ``01:00`
+00015cc0: 6020 5554 432e 0a20 2020 2020 2020 203a  ` UTC..        :
+00015cd0: 7061 7261 6d20 7375 7070 6f72 7473 5f74  param supports_t
+00015ce0: 696d 655f 6669 6c74 6572 696e 673a 2057  ime_filtering: W
+00015cf0: 6865 6e20 7365 7420 746f 2060 6054 7275  hen set to ``Tru
+00015d00: 6560 602c 2074 6865 2044 6174 6120 536f  e``, the Data So
+00015d10: 7572 6365 2046 756e 6374 696f 6e20 6d75  urce Function mu
+00015d20: 7374 2074 616b 6520 7468 6520 6060 6669  st take the ``fi
+00015d30: 6c74 6572 5f63 6f6e 7465 7874 6060 0a20  lter_context``. 
+00015d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d60: 2020 2070 6172 616d 6574 6572 2061 6e64     parameter and
+00015d70: 2069 6d70 6c65 6d65 6e74 2074 696d 6520   implement time 
+00015d80: 6669 6c74 6572 696e 6720 6c6f 6769 632e  filtering logic.
+00015d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015db0: 2020 2020 2060 6073 7570 706f 7274 735f       ``supports_
+00015dc0: 7469 6d65 5f66 696c 7465 7269 6e67 6060  time_filtering``
+00015dd0: 206d 7573 7420 6265 2073 6574 2074 6f20   must be set to 
+00015de0: 6054 7275 6560 2069 6620 6060 3c64 6174  `True` if ``<dat
+00015df0: 6120 736f 7572 6365 3e2e 6765 745f 6461  a source>.get_da
+00015e00: 7461 6672 616d 6528 2960 6020 6973 2063  taframe()`` is c
+00015e10: 616c 6c65 6420 7769 7468 2060 6073 7461  alled with ``sta
+00015e20: 7274 5f74 696d 6560 600a 2020 2020 2020  rt_time``.      
 00015e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015e40: 2077 6974 6820 6120 4461 7461 2053 6f75   with a Data Sou
-00015e50: 7263 6520 7768 656e 2064 6566 696e 696e  rce when definin
-00015e60: 6720 6120 6060 4665 6174 7572 6556 6965  g a ``FeatureVie
-00015e70: 7760 602e 2054 6865 2060 6046 6561 7475  w``. The ``Featu
-00015e80: 7265 5669 6577 6060 2077 696c 6c20 6361  reView`` will ca
-00015e90: 6c6c 0a20 2020 2020 2020 2020 2020 2020  ll.             
-00015ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015eb0: 2020 2020 2020 2074 6865 2044 6174 6120         the Data 
-00015ec0: 536f 7572 6365 2046 756e 6374 696f 6e20  Source Function 
-00015ed0: 7769 7468 2074 6865 203a 636c 6173 733a  with the :class:
-00015ee0: 6074 6563 746f 6e2e 4669 6c74 6572 436f  `tecton.FilterCo
-00015ef0: 6e74 6578 7460 2c20 7768 6963 6820 6861  ntext`, which ha
-00015f00: 7320 7468 6520 6060 7374 6172 745f 7469  s the ``start_ti
-00015f10: 6d65 6060 2061 6e64 0a20 2020 2020 2020  me`` and.       
-00015f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015f30: 2020 2020 2020 2020 2020 2020 2060 6065               ``e
-00015f40: 6e64 5f74 696d 6560 6020 7365 742e 0a0a  nd_time`` set...
-00015f50: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-00015f60: 2041 2053 7061 726b 4261 7463 6843 6f6e   A SparkBatchCon
-00015f70: 6669 6720 636c 6173 7320 696e 7374 616e  fig class instan
-00015f80: 6365 2e0a 2020 2020 2020 2020 2222 220a  ce..        """.
-00015f90: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
-00015fa0: 206c 6973 7428 696e 7370 6563 742e 7369   list(inspect.si
-00015fb0: 676e 6174 7572 6528 6461 7461 5f73 6f75  gnature(data_sou
-00015fc0: 7263 655f 6675 6e63 7469 6f6e 292e 7061  rce_function).pa
-00015fd0: 7261 6d65 7465 7273 290a 2020 2020 2020  rameters).      
-00015fe0: 2020 6675 6e63 7469 6f6e 5f6e 616d 6520    function_name 
-00015ff0: 3d20 6461 7461 5f73 6f75 7263 655f 6675  = data_source_fu
-00016000: 6e63 7469 6f6e 2e5f 5f6e 616d 655f 5f0a  nction.__name__.
-00016010: 2020 2020 2020 2020 6966 2073 7570 706f          if suppo
-00016020: 7274 735f 7469 6d65 5f66 696c 7465 7269  rts_time_filteri
-00016030: 6e67 2061 6e64 2070 6172 616d 7320 213d  ng and params !=
-00016040: 205b 2273 7061 726b 222c 2022 6669 6c74   ["spark", "filt
-00016050: 6572 5f63 6f6e 7465 7874 225d 3a0a 2020  er_context"]:.  
-00016060: 2020 2020 2020 2020 2020 6d73 6720 3d20            msg = 
-00016070: 6622 4461 7461 2053 6f75 7263 6520 4675  f"Data Source Fu
-00016080: 6e63 7469 6f6e 207b 6675 6e63 7469 6f6e  nction {function
-00016090: 5f6e 616d 657d 2773 2072 6571 7569 7265  _name}'s require
-000160a0: 6420 7369 676e 6174 7572 6520 6973 2060  d signature is `
-000160b0: 7b66 756e 6374 696f 6e5f 6e61 6d65 7d28  {function_name}(
-000160c0: 7370 6172 6b2c 2066 696c 7465 725f 636f  spark, filter_co
-000160d0: 6e74 6578 7429 6020 7768 656e 2073 7570  ntext)` when sup
-000160e0: 706f 7274 735f 7469 6d65 5f66 696c 7465  ports_time_filte
-000160f0: 7269 6e67 2069 7320 5472 7565 220a 2020  ring is True".  
-00016100: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00016110: 4173 7365 7274 696f 6e45 7272 6f72 286d  AssertionError(m
-00016120: 7367 290a 2020 2020 2020 2020 656c 6966  sg).        elif
-00016130: 206e 6f74 2073 7570 706f 7274 735f 7469   not supports_ti
-00016140: 6d65 5f66 696c 7465 7269 6e67 2061 6e64  me_filtering and
-00016150: 2070 6172 616d 7320 213d 205b 2273 7061   params != ["spa
-00016160: 726b 225d 3a0a 2020 2020 2020 2020 2020  rk"]:.          
-00016170: 2020 6d73 6720 3d20 6622 4461 7461 2053    msg = f"Data S
-00016180: 6f75 7263 6520 4675 6e63 7469 6f6e 207b  ource Function {
-00016190: 6675 6e63 7469 6f6e 5f6e 616d 657d 2773  function_name}'s
-000161a0: 2072 6571 7569 7265 6420 7369 676e 6174   required signat
-000161b0: 7572 6520 6973 2060 7b66 756e 6374 696f  ure is `{functio
-000161c0: 6e5f 6e61 6d65 7d28 7370 6172 6b29 6022  n_name}(spark)`"
-000161d0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-000161e0: 7365 2041 7373 6572 7469 6f6e 4572 726f  se AssertionErro
-000161f0: 7228 6d73 6729 0a0a 2020 2020 2020 2020  r(msg)..        
-00016200: 7365 6c66 2e5f 6172 6773 203d 2064 6174  self._args = dat
-00016210: 615f 736f 7572 6365 5f70 6232 2e53 7061  a_source_pb2.Spa
-00016220: 726b 4261 7463 6843 6f6e 6669 6741 7267  rkBatchConfigArg
-00016230: 7328 290a 2020 2020 2020 2020 6966 2066  s().        if f
-00016240: 756e 6374 696f 6e5f 7365 7269 616c 697a  unction_serializ
-00016250: 6174 696f 6e2e 7368 6f75 6c64 5f73 6572  ation.should_ser
-00016260: 6961 6c69 7a65 5f66 756e 6374 696f 6e28  ialize_function(
-00016270: 6461 7461 5f73 6f75 7263 655f 6675 6e63  data_source_func
-00016280: 7469 6f6e 293a 0a20 2020 2020 2020 2020  tion):.         
-00016290: 2020 2073 656c 662e 5f61 7267 732e 6461     self._args.da
-000162a0: 7461 5f73 6f75 7263 655f 6675 6e63 7469  ta_source_functi
-000162b0: 6f6e 2e43 6f70 7946 726f 6d28 6675 6e63  on.CopyFrom(func
-000162c0: 7469 6f6e 5f73 6572 6961 6c69 7a61 7469  tion_serializati
-000162d0: 6f6e 2e74 6f5f 7072 6f74 6f28 6461 7461  on.to_proto(data
-000162e0: 5f73 6f75 7263 655f 6675 6e63 7469 6f6e  _source_function
-000162f0: 2929 0a20 2020 2020 2020 2073 656c 662e  )).        self.
-00016300: 5f61 7267 732e 6461 7461 5f64 656c 6179  _args.data_delay
-00016310: 2e46 726f 6d54 696d 6564 656c 7461 2864  .FromTimedelta(d
-00016320: 6174 615f 6465 6c61 7929 0a20 2020 2020  ata_delay).     
-00016330: 2020 2073 656c 662e 5f61 7267 732e 7375     self._args.su
-00016340: 7070 6f72 7473 5f74 696d 655f 6669 6c74  pports_time_filt
-00016350: 6572 696e 6720 3d20 7375 7070 6f72 7473  ering = supports
-00016360: 5f74 696d 655f 6669 6c74 6572 696e 670a  _time_filtering.
-00016370: 2020 2020 2020 2020 7365 6c66 2e5f 6461          self._da
-00016380: 7461 5f64 656c 6179 203d 2064 6174 615f  ta_delay = data_
-00016390: 6465 6c61 790a 2020 2020 2020 2020 7365  delay.        se
-000163a0: 6c66 2e64 6174 615f 736f 7572 6365 5f66  lf.data_source_f
-000163b0: 756e 6374 696f 6e20 3d20 6461 7461 5f73  unction = data_s
-000163c0: 6f75 7263 655f 6675 6e63 7469 6f6e 0a0a  ource_function..
-000163d0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-000163e0: 2020 6465 6620 6461 7461 5f64 656c 6179    def data_delay
-000163f0: 2873 656c 6629 202d 3e20 6461 7465 7469  (self) -> dateti
-00016400: 6d65 2e74 696d 6564 656c 7461 3a0a 2020  me.timedelta:.  
-00016410: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00016420: 662e 5f64 6174 615f 6465 6c61 790a 0a20  f._data_delay.. 
-00016430: 2020 2064 6566 205f 6d65 7267 655f 6261     def _merge_ba
-00016440: 7463 685f 6172 6773 2873 656c 662c 2064  tch_args(self, d
-00016450: 6174 615f 736f 7572 6365 5f61 7267 733a  ata_source_args:
-00016460: 2076 6972 7475 616c 5f64 6174 615f 736f   virtual_data_so
-00016470: 7572 6365 5f70 6232 2e56 6972 7475 616c  urce_pb2.Virtual
-00016480: 4461 7461 536f 7572 6365 4172 6773 293a  DataSourceArgs):
-00016490: 0a20 2020 2020 2020 2064 6174 615f 736f  .        data_so
-000164a0: 7572 6365 5f61 7267 732e 7370 6172 6b5f  urce_args.spark_
-000164b0: 6261 7463 685f 636f 6e66 6967 2e43 6f70  batch_config.Cop
-000164c0: 7946 726f 6d28 7365 6c66 2e5f 6172 6773  yFrom(self._args
-000164d0: 290a 0a20 2020 2064 6566 205f 5f63 616c  )..    def __cal
-000164e0: 6c5f 5f28 7365 6c66 2c20 2a61 7267 732c  l__(self, *args,
-000164f0: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-00016500: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00016510: 6461 7461 5f73 6f75 7263 655f 6675 6e63  data_source_func
-00016520: 7469 6f6e 282a 6172 6773 2c20 2a2a 6b77  tion(*args, **kw
-00016530: 6172 6773 290a 0a0a 4074 7970 6563 6865  args)...@typeche
-00016540: 636b 6564 0a64 6566 2073 7061 726b 5f62  cked.def spark_b
-00016550: 6174 6368 5f63 6f6e 6669 6728 0a20 2020  atch_config(.   
-00016560: 202a 2c0a 2020 2020 6461 7461 5f64 656c   *,.    data_del
-00016570: 6179 3a20 4f70 7469 6f6e 616c 5b64 6174  ay: Optional[dat
-00016580: 6574 696d 652e 7469 6d65 6465 6c74 615d  etime.timedelta]
-00016590: 203d 2064 6174 6574 696d 652e 7469 6d65   = datetime.time
-000165a0: 6465 6c74 6128 7365 636f 6e64 733d 3029  delta(seconds=0)
-000165b0: 2c0a 2020 2020 7375 7070 6f72 7473 5f74  ,.    supports_t
-000165c0: 696d 655f 6669 6c74 6572 696e 673a 204f  ime_filtering: O
-000165d0: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
-000165e0: 4661 6c73 652c 0a29 3a0a 2020 2020 2222  False,.):.    ""
-000165f0: 220a 2020 2020 4465 636c 6172 6520 6120  ".    Declare a 
-00016600: 3a63 6c61 7373 3a60 7465 6374 6f6e 2e53  :class:`tecton.S
-00016610: 7061 726b 4261 7463 6843 6f6e 6669 6760  parkBatchConfig`
-00016620: 2066 6f72 2063 6f6e 6669 6775 7269 6e67   for configuring
-00016630: 2061 2042 6174 6368 2053 6f75 7263 6520   a Batch Source 
-00016640: 7769 7468 2061 2044 6174 6120 536f 7572  with a Data Sour
-00016650: 6365 2046 756e 6374 696f 6e2e 0a20 2020  ce Function..   
-00016660: 2054 6865 2066 756e 6374 696f 6e20 7461   The function ta
-00016670: 6b65 7320 696e 2061 2060 6053 7061 726b  kes in a ``Spark
-00016680: 5365 7373 696f 6e60 6020 616e 6420 616e  Session`` and an
-00016690: 206f 7074 696f 6e61 6c20 3a63 6c61 7373   optional :class
-000166a0: 3a60 7465 6374 6f6e 2e46 696c 7465 7243  :`tecton.FilterC
-000166b0: 6f6e 7465 7874 602c 2069 6620 6060 7375  ontext`, if ``su
-000166c0: 7070 6f72 7473 5f74 696d 655f 6669 6c74  pports_time_filt
-000166d0: 6572 696e 673d 5472 7565 6060 2e20 5265  ering=True``. Re
-000166e0: 7475 726e 7320 6120 6060 4461 7461 4672  turns a ``DataFr
-000166f0: 616d 6560 602e 0a0a 2020 2020 3a70 6172  ame``...    :par
-00016700: 616d 2064 6174 615f 6465 6c61 793a 2042  am data_delay: B
-00016710: 7920 6465 6661 756c 742c 2069 6e63 7265  y default, incre
-00016720: 6d65 6e74 616c 206d 6174 6572 6961 6c69  mental materiali
-00016730: 7a61 7469 6f6e 206a 6f62 7320 7275 6e20  zation jobs run 
-00016740: 696d 6d65 6469 6174 656c 7920 6174 2074  immediately at t
-00016750: 6865 2065 6e64 206f 6620 7468 650a 2020  he end of the.  
-00016760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016770: 2020 2020 2020 2020 2020 2020 2020 6261                ba
-00016780: 7463 6820 7363 6865 6475 6c65 2070 6572  tch schedule per
-00016790: 696f 642e 2054 6869 7320 7061 7261 6d65  iod. This parame
-000167a0: 7465 7220 636f 6e66 6967 7572 6573 2068  ter configures h
-000167b0: 6f77 206c 6f6e 6720 7468 6579 2077 6169  ow long they wai
-000167c0: 7420 6166 7465 7220 7468 6520 656e 640a  t after the end.
-000167d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000167e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000167f0: 6f66 2074 6865 2070 6572 696f 6420 6265  of the period be
-00016800: 666f 7265 2073 7461 7274 696e 672c 2074  fore starting, t
-00016810: 7970 6963 616c 6c79 2074 6f20 656e 7375  ypically to ensu
-00016820: 7265 2074 6861 7420 616c 6c20 6461 7461  re that all data
-00016830: 2068 6173 206c 616e 6465 642e 0a20 2020   has landed..   
-00016840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016850: 2020 2020 2020 2020 2020 2020 2046 6f72               For
-00016860: 2065 7861 6d70 6c65 2c20 6966 2061 2066   example, if a f
-00016870: 6561 7475 7265 2076 6965 7720 6861 7320  eature view has 
-00016880: 6120 6060 6261 7463 685f 7363 6865 6475  a ``batch_schedu
-00016890: 6c65 6060 206f 6620 3120 6461 7920 616e  le`` of 1 day an
-000168a0: 6420 6f6e 6520 6f66 0a20 2020 2020 2020  d one of.       
-000168b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000168c0: 2020 2020 2020 2020 2074 6865 2064 6174           the dat
-000168d0: 6120 736f 7572 6365 2069 6e70 7574 7320  a source inputs 
-000168e0: 6861 7320 6060 6461 7461 5f64 656c 6179  has ``data_delay
-000168f0: 3d74 696d 6564 656c 7461 2868 6f75 7273  =timedelta(hours
-00016900: 3d31 2960 6020 7365 742c 2074 6865 6e0a  =1)`` set, then.
-00016910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016930: 696e 6372 656d 656e 7461 6c20 6d61 7465  incremental mate
-00016940: 7269 616c 697a 6174 696f 6e20 6a6f 6273  rialization jobs
-00016950: 2077 696c 6c20 7275 6e20 6174 2060 6030   will run at ``0
-00016960: 313a 3030 6060 2055 5443 2e0a 2020 2020  1:00`` UTC..    
-00016970: 3a70 6172 616d 2073 7570 706f 7274 735f  :param supports_
-00016980: 7469 6d65 5f66 696c 7465 7269 6e67 3a20  time_filtering: 
-00016990: 5768 656e 2073 6574 2074 6f20 6060 5472  When set to ``Tr
-000169a0: 7565 6060 2c20 7468 6520 4461 7461 2053  ue``, the Data S
-000169b0: 6f75 7263 6520 4675 6e63 7469 6f6e 206d  ource Function m
-000169c0: 7573 7420 7461 6b65 2074 6865 2060 6066  ust take the ``f
-000169d0: 696c 7465 725f 636f 6e74 6578 7460 600a  ilter_context``.
-000169e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000169f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a00: 2020 2020 7061 7261 6d65 7465 7220 616e      parameter an
-00016a10: 6420 696d 706c 656d 656e 7420 7469 6d65  d implement time
-00016a20: 2066 696c 7465 7269 6e67 206c 6f67 6963   filtering logic
-00016a30: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00016a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a50: 2020 2020 2020 6060 7375 7070 6f72 7473        ``supports
-00016a60: 5f74 696d 655f 6669 6c74 6572 696e 6760  _time_filtering`
-00016a70: 6020 6d75 7374 2062 6520 7365 7420 746f  ` must be set to
-00016a80: 2060 5472 7565 6020 6966 2060 603c 6461   `True` if ``<da
-00016a90: 7461 2073 6f75 7263 653e 2e67 6574 5f64  ta source>.get_d
-00016aa0: 6174 6166 7261 6d65 2829 6060 2069 7320  ataframe()`` is 
-00016ab0: 6361 6c6c 6564 2077 6974 6820 6060 7374  called with ``st
-00016ac0: 6172 745f 7469 6d65 6060 0a20 2020 2020  art_time``.     
-00016ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016ae0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00016af0: 7220 6060 656e 645f 7469 6d65 6060 2e20  r ``end_time``. 
-00016b00: 6060 7375 7070 6f72 7473 5f74 696d 655f  ``supports_time_
-00016b10: 6669 6c74 6572 696e 6760 6020 6d75 7374  filtering`` must
-00016b20: 2061 6c73 6f20 6265 2073 6574 2074 6f20   also be set to 
-00016b30: 6060 5472 7565 6060 2069 6620 7573 696e  ``True`` if usin
-00016b40: 6720 3a63 6c61 7373 3a60 7465 6374 6f6e  g :class:`tecton
-00016b50: 2e64 6563 6c61 7261 7469 7665 2e46 696c  .declarative.Fil
-00016b60: 7465 7265 6453 6f75 7263 6560 0a20 2020  teredSource`.   
-00016b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015e40: 2020 2020 2020 2020 2020 2020 2020 6f72                or
+00015e50: 2060 6065 6e64 5f74 696d 6560 602e 2060   ``end_time``. `
+00015e60: 6073 7570 706f 7274 735f 7469 6d65 5f66  `supports_time_f
+00015e70: 696c 7465 7269 6e67 6060 206d 7573 7420  iltering`` must 
+00015e80: 616c 736f 2062 6520 7365 7420 746f 2060  also be set to `
+00015e90: 6054 7275 6560 6020 6966 2075 7369 6e67  `True`` if using
+00015ea0: 203a 636c 6173 733a 6074 6563 746f 6e2e   :class:`tecton.
+00015eb0: 6465 636c 6172 6174 6976 652e 4669 6c74  declarative.Filt
+00015ec0: 6572 6564 536f 7572 6365 600a 2020 2020  eredSource`.    
+00015ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ef0: 7769 7468 2061 2044 6174 6120 536f 7572  with a Data Sour
+00015f00: 6365 2077 6865 6e20 6465 6669 6e69 6e67  ce when defining
+00015f10: 2061 2060 6046 6561 7475 7265 5669 6577   a ``FeatureView
+00015f20: 6060 2e20 5468 6520 6060 4665 6174 7572  ``. The ``Featur
+00015f30: 6556 6965 7760 6020 7769 6c6c 2063 616c  eView`` will cal
+00015f40: 6c0a 2020 2020 2020 2020 2020 2020 2020  l.              
+00015f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015f60: 2020 2020 2020 7468 6520 4461 7461 2053        the Data S
+00015f70: 6f75 7263 6520 4675 6e63 7469 6f6e 2077  ource Function w
+00015f80: 6974 6820 7468 6520 3a63 6c61 7373 3a60  ith the :class:`
+00015f90: 7465 6374 6f6e 2e46 696c 7465 7243 6f6e  tecton.FilterCon
+00015fa0: 7465 7874 602c 2077 6869 6368 2068 6173  text`, which has
+00015fb0: 2074 6865 2060 6073 7461 7274 5f74 696d   the ``start_tim
+00015fc0: 6560 6020 616e 640a 2020 2020 2020 2020  e`` and.        
+00015fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015fe0: 2020 2020 2020 2020 2020 2020 6060 656e              ``en
+00015ff0: 645f 7469 6d65 6060 2073 6574 2e0a 0a20  d_time`` set... 
+00016000: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+00016010: 4120 5370 6172 6b42 6174 6368 436f 6e66  A SparkBatchConf
+00016020: 6967 2063 6c61 7373 2069 6e73 7461 6e63  ig class instanc
+00016030: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
+00016040: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
+00016050: 6c69 7374 2869 6e73 7065 6374 2e73 6967  list(inspect.sig
+00016060: 6e61 7475 7265 2864 6174 615f 736f 7572  nature(data_sour
+00016070: 6365 5f66 756e 6374 696f 6e29 2e70 6172  ce_function).par
+00016080: 616d 6574 6572 7329 0a20 2020 2020 2020  ameters).       
+00016090: 2066 756e 6374 696f 6e5f 6e61 6d65 203d   function_name =
+000160a0: 2064 6174 615f 736f 7572 6365 5f66 756e   data_source_fun
+000160b0: 6374 696f 6e2e 5f5f 6e61 6d65 5f5f 0a20  ction.__name__. 
+000160c0: 2020 2020 2020 2069 6620 7375 7070 6f72         if suppor
+000160d0: 7473 5f74 696d 655f 6669 6c74 6572 696e  ts_time_filterin
+000160e0: 6720 616e 6420 7061 7261 6d73 2021 3d20  g and params != 
+000160f0: 5b22 7370 6172 6b22 2c20 2266 696c 7465  ["spark", "filte
+00016100: 725f 636f 6e74 6578 7422 5d3a 0a20 2020  r_context"]:.   
+00016110: 2020 2020 2020 2020 206d 7367 203d 2066           msg = f
+00016120: 2244 6174 6120 536f 7572 6365 2046 756e  "Data Source Fun
+00016130: 6374 696f 6e20 7b66 756e 6374 696f 6e5f  ction {function_
+00016140: 6e61 6d65 7d27 7320 7265 7175 6972 6564  name}'s required
+00016150: 2073 6967 6e61 7475 7265 2069 7320 607b   signature is `{
+00016160: 6675 6e63 7469 6f6e 5f6e 616d 657d 2873  function_name}(s
+00016170: 7061 726b 2c20 6669 6c74 6572 5f63 6f6e  park, filter_con
+00016180: 7465 7874 2960 2077 6865 6e20 7375 7070  text)` when supp
+00016190: 6f72 7473 5f74 696d 655f 6669 6c74 6572  orts_time_filter
+000161a0: 696e 6720 6973 2054 7275 6522 0a20 2020  ing is True".   
+000161b0: 2020 2020 2020 2020 2072 6169 7365 2041           raise A
+000161c0: 7373 6572 7469 6f6e 4572 726f 7228 6d73  ssertionError(ms
+000161d0: 6729 0a20 2020 2020 2020 2065 6c69 6620  g).        elif 
+000161e0: 6e6f 7420 7375 7070 6f72 7473 5f74 696d  not supports_tim
+000161f0: 655f 6669 6c74 6572 696e 6720 616e 6420  e_filtering and 
+00016200: 7061 7261 6d73 2021 3d20 5b22 7370 6172  params != ["spar
+00016210: 6b22 5d3a 0a20 2020 2020 2020 2020 2020  k"]:.           
+00016220: 206d 7367 203d 2066 2244 6174 6120 536f   msg = f"Data So
+00016230: 7572 6365 2046 756e 6374 696f 6e20 7b66  urce Function {f
+00016240: 756e 6374 696f 6e5f 6e61 6d65 7d27 7320  unction_name}'s 
+00016250: 7265 7175 6972 6564 2073 6967 6e61 7475  required signatu
+00016260: 7265 2069 7320 607b 6675 6e63 7469 6f6e  re is `{function
+00016270: 5f6e 616d 657d 2873 7061 726b 2960 220a  _name}(spark)`".
+00016280: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00016290: 6520 4173 7365 7274 696f 6e45 7272 6f72  e AssertionError
+000162a0: 286d 7367 290a 0a20 2020 2020 2020 2073  (msg)..        s
+000162b0: 656c 662e 5f61 7267 7320 3d20 6461 7461  elf._args = data
+000162c0: 5f73 6f75 7263 655f 7062 322e 5370 6172  _source_pb2.Spar
+000162d0: 6b42 6174 6368 436f 6e66 6967 4172 6773  kBatchConfigArgs
+000162e0: 2829 0a20 2020 2020 2020 2069 6620 6675  ().        if fu
+000162f0: 6e63 7469 6f6e 5f73 6572 6961 6c69 7a61  nction_serializa
+00016300: 7469 6f6e 2e73 686f 756c 645f 7365 7269  tion.should_seri
+00016310: 616c 697a 655f 6675 6e63 7469 6f6e 2864  alize_function(d
+00016320: 6174 615f 736f 7572 6365 5f66 756e 6374  ata_source_funct
+00016330: 696f 6e29 3a0a 2020 2020 2020 2020 2020  ion):.          
+00016340: 2020 7365 6c66 2e5f 6172 6773 2e64 6174    self._args.dat
+00016350: 615f 736f 7572 6365 5f66 756e 6374 696f  a_source_functio
+00016360: 6e2e 436f 7079 4672 6f6d 2866 756e 6374  n.CopyFrom(funct
+00016370: 696f 6e5f 7365 7269 616c 697a 6174 696f  ion_serializatio
+00016380: 6e2e 746f 5f70 726f 746f 2864 6174 615f  n.to_proto(data_
+00016390: 736f 7572 6365 5f66 756e 6374 696f 6e29  source_function)
+000163a0: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
+000163b0: 6172 6773 2e64 6174 615f 6465 6c61 792e  args.data_delay.
+000163c0: 4672 6f6d 5469 6d65 6465 6c74 6128 6461  FromTimedelta(da
+000163d0: 7461 5f64 656c 6179 290a 2020 2020 2020  ta_delay).      
+000163e0: 2020 7365 6c66 2e5f 6172 6773 2e73 7570    self._args.sup
+000163f0: 706f 7274 735f 7469 6d65 5f66 696c 7465  ports_time_filte
+00016400: 7269 6e67 203d 2073 7570 706f 7274 735f  ring = supports_
+00016410: 7469 6d65 5f66 696c 7465 7269 6e67 0a20  time_filtering. 
+00016420: 2020 2020 2020 2073 656c 662e 5f64 6174         self._dat
+00016430: 615f 6465 6c61 7920 3d20 6461 7461 5f64  a_delay = data_d
+00016440: 656c 6179 0a20 2020 2020 2020 2073 656c  elay.        sel
+00016450: 662e 6461 7461 5f73 6f75 7263 655f 6675  f.data_source_fu
+00016460: 6e63 7469 6f6e 203d 2064 6174 615f 736f  nction = data_so
+00016470: 7572 6365 5f66 756e 6374 696f 6e0a 0a20  urce_function.. 
+00016480: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00016490: 2064 6566 2064 6174 615f 6465 6c61 7928   def data_delay(
+000164a0: 7365 6c66 2920 2d3e 2064 6174 6574 696d  self) -> datetim
+000164b0: 652e 7469 6d65 6465 6c74 613a 0a20 2020  e.timedelta:.   
+000164c0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000164d0: 2e5f 6461 7461 5f64 656c 6179 0a0a 2020  ._data_delay..  
+000164e0: 2020 6465 6620 5f6d 6572 6765 5f62 6174    def _merge_bat
+000164f0: 6368 5f61 7267 7328 7365 6c66 2c20 6461  ch_args(self, da
+00016500: 7461 5f73 6f75 7263 655f 6172 6773 3a20  ta_source_args: 
+00016510: 7669 7274 7561 6c5f 6461 7461 5f73 6f75  virtual_data_sou
+00016520: 7263 655f 7062 322e 5669 7274 7561 6c44  rce_pb2.VirtualD
+00016530: 6174 6153 6f75 7263 6541 7267 7329 3a0a  ataSourceArgs):.
+00016540: 2020 2020 2020 2020 6461 7461 5f73 6f75          data_sou
+00016550: 7263 655f 6172 6773 2e73 7061 726b 5f62  rce_args.spark_b
+00016560: 6174 6368 5f63 6f6e 6669 672e 436f 7079  atch_config.Copy
+00016570: 4672 6f6d 2873 656c 662e 5f61 7267 7329  From(self._args)
+00016580: 0a0a 2020 2020 6465 6620 5f5f 6361 6c6c  ..    def __call
+00016590: 5f5f 2873 656c 662c 202a 6172 6773 2c20  __(self, *args, 
+000165a0: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+000165b0: 2020 2072 6574 7572 6e20 7365 6c66 2e64     return self.d
+000165c0: 6174 615f 736f 7572 6365 5f66 756e 6374  ata_source_funct
+000165d0: 696f 6e28 2a61 7267 732c 202a 2a6b 7761  ion(*args, **kwa
+000165e0: 7267 7329 0a0a 0a40 7479 7065 6368 6563  rgs)...@typechec
+000165f0: 6b65 640a 6465 6620 7370 6172 6b5f 6261  ked.def spark_ba
+00016600: 7463 685f 636f 6e66 6967 280a 2020 2020  tch_config(.    
+00016610: 2a2c 0a20 2020 2064 6174 615f 6465 6c61  *,.    data_dela
+00016620: 793a 204f 7074 696f 6e61 6c5b 6461 7465  y: Optional[date
+00016630: 7469 6d65 2e74 696d 6564 656c 7461 5d20  time.timedelta] 
+00016640: 3d20 6461 7465 7469 6d65 2e74 696d 6564  = datetime.timed
+00016650: 656c 7461 2873 6563 6f6e 6473 3d30 292c  elta(seconds=0),
+00016660: 0a20 2020 2073 7570 706f 7274 735f 7469  .    supports_ti
+00016670: 6d65 5f66 696c 7465 7269 6e67 3a20 4f70  me_filtering: Op
+00016680: 7469 6f6e 616c 5b62 6f6f 6c5d 203d 2046  tional[bool] = F
+00016690: 616c 7365 2c0a 293a 0a20 2020 2022 2222  alse,.):.    """
+000166a0: 0a20 2020 2044 6563 6c61 7265 2061 203a  .    Declare a :
+000166b0: 636c 6173 733a 6074 6563 746f 6e2e 5370  class:`tecton.Sp
+000166c0: 6172 6b42 6174 6368 436f 6e66 6967 6020  arkBatchConfig` 
+000166d0: 666f 7220 636f 6e66 6967 7572 696e 6720  for configuring 
+000166e0: 6120 4261 7463 6820 536f 7572 6365 2077  a Batch Source w
+000166f0: 6974 6820 6120 4461 7461 2053 6f75 7263  ith a Data Sourc
+00016700: 6520 4675 6e63 7469 6f6e 2e0a 2020 2020  e Function..    
+00016710: 5468 6520 6675 6e63 7469 6f6e 2074 616b  The function tak
+00016720: 6573 2069 6e20 6120 6060 5370 6172 6b53  es in a ``SparkS
+00016730: 6573 7369 6f6e 6060 2061 6e64 2061 6e20  ession`` and an 
+00016740: 6f70 7469 6f6e 616c 203a 636c 6173 733a  optional :class:
+00016750: 6074 6563 746f 6e2e 4669 6c74 6572 436f  `tecton.FilterCo
+00016760: 6e74 6578 7460 2c20 6966 2060 6073 7570  ntext`, if ``sup
+00016770: 706f 7274 735f 7469 6d65 5f66 696c 7465  ports_time_filte
+00016780: 7269 6e67 3d54 7275 6560 602e 2052 6574  ring=True``. Ret
+00016790: 7572 6e73 2061 2060 6044 6174 6146 7261  urns a ``DataFra
+000167a0: 6d65 6060 2e0a 0a20 2020 203a 7061 7261  me``...    :para
+000167b0: 6d20 6461 7461 5f64 656c 6179 3a20 4279  m data_delay: By
+000167c0: 2064 6566 6175 6c74 2c20 696e 6372 656d   default, increm
+000167d0: 656e 7461 6c20 6d61 7465 7269 616c 697a  ental materializ
+000167e0: 6174 696f 6e20 6a6f 6273 2072 756e 2069  ation jobs run i
+000167f0: 6d6d 6564 6961 7465 6c79 2061 7420 7468  mmediately at th
+00016800: 6520 656e 6420 6f66 2074 6865 0a20 2020  e end of the.   
+00016810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016820: 2020 2020 2020 2020 2020 2020 2062 6174               bat
+00016830: 6368 2073 6368 6564 756c 6520 7065 7269  ch schedule peri
+00016840: 6f64 2e20 5468 6973 2070 6172 616d 6574  od. This paramet
+00016850: 6572 2063 6f6e 6669 6775 7265 7320 686f  er configures ho
+00016860: 7720 6c6f 6e67 2074 6865 7920 7761 6974  w long they wait
+00016870: 2061 6674 6572 2074 6865 2065 6e64 0a20   after the end. 
+00016880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016890: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+000168a0: 6620 7468 6520 7065 7269 6f64 2062 6566  f the period bef
+000168b0: 6f72 6520 7374 6172 7469 6e67 2c20 7479  ore starting, ty
+000168c0: 7069 6361 6c6c 7920 746f 2065 6e73 7572  pically to ensur
+000168d0: 6520 7468 6174 2061 6c6c 2064 6174 6120  e that all data 
+000168e0: 6861 7320 6c61 6e64 6564 2e0a 2020 2020  has landed..    
+000168f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016900: 2020 2020 2020 2020 2020 2020 466f 7220              For 
+00016910: 6578 616d 706c 652c 2069 6620 6120 6665  example, if a fe
+00016920: 6174 7572 6520 7669 6577 2068 6173 2061  ature view has a
+00016930: 2060 6062 6174 6368 5f73 6368 6564 756c   ``batch_schedul
+00016940: 6560 6020 6f66 2031 2064 6179 2061 6e64  e`` of 1 day and
+00016950: 206f 6e65 206f 660a 2020 2020 2020 2020   one of.        
+00016960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016970: 2020 2020 2020 2020 7468 6520 6461 7461          the data
+00016980: 2073 6f75 7263 6520 696e 7075 7473 2068   source inputs h
+00016990: 6173 2060 6064 6174 615f 6465 6c61 793d  as ``data_delay=
+000169a0: 7469 6d65 6465 6c74 6128 686f 7572 733d  timedelta(hours=
+000169b0: 3129 6060 2073 6574 2c20 7468 656e 0a20  1)`` set, then. 
+000169c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000169d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000169e0: 6e63 7265 6d65 6e74 616c 206d 6174 6572  ncremental mater
+000169f0: 6961 6c69 7a61 7469 6f6e 206a 6f62 7320  ialization jobs 
+00016a00: 7769 6c6c 2072 756e 2061 7420 6060 3031  will run at ``01
+00016a10: 3a30 3060 6020 5554 432e 0a20 2020 203a  :00`` UTC..    :
+00016a20: 7061 7261 6d20 7375 7070 6f72 7473 5f74  param supports_t
+00016a30: 696d 655f 6669 6c74 6572 696e 673a 2057  ime_filtering: W
+00016a40: 6865 6e20 7365 7420 746f 2060 6054 7275  hen set to ``Tru
+00016a50: 6560 602c 2074 6865 2044 6174 6120 536f  e``, the Data So
+00016a60: 7572 6365 2046 756e 6374 696f 6e20 6d75  urce Function mu
+00016a70: 7374 2074 616b 6520 7468 6520 6060 6669  st take the ``fi
+00016a80: 6c74 6572 5f63 6f6e 7465 7874 6060 0a20  lter_context``. 
+00016a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ab0: 2020 2070 6172 616d 6574 6572 2061 6e64     parameter and
+00016ac0: 2069 6d70 6c65 6d65 6e74 2074 696d 6520   implement time 
+00016ad0: 6669 6c74 6572 696e 6720 6c6f 6769 632e  filtering logic.
+00016ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b00: 2020 2020 2060 6073 7570 706f 7274 735f       ``supports_
+00016b10: 7469 6d65 5f66 696c 7465 7269 6e67 6060  time_filtering``
+00016b20: 206d 7573 7420 6265 2073 6574 2074 6f20   must be set to 
+00016b30: 6054 7275 6560 2069 6620 6060 3c64 6174  `True` if ``<dat
+00016b40: 6120 736f 7572 6365 3e2e 6765 745f 6461  a source>.get_da
+00016b50: 7461 6672 616d 6528 2960 6020 6973 2063  taframe()`` is c
+00016b60: 616c 6c65 6420 7769 7468 2060 6073 7461  alled with ``sta
+00016b70: 7274 5f74 696d 6560 600a 2020 2020 2020  rt_time``.      
 00016b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b90: 2077 6974 6820 6120 4461 7461 2053 6f75   with a Data Sou
-00016ba0: 7263 6520 7768 656e 2064 6566 696e 696e  rce when definin
-00016bb0: 6720 6120 6060 4665 6174 7572 6556 6965  g a ``FeatureVie
-00016bc0: 7760 602e 2054 6865 2060 6046 6561 7475  w``. The ``Featu
-00016bd0: 7265 5669 6577 6060 2077 696c 6c20 6361  reView`` will ca
-00016be0: 6c6c 0a20 2020 2020 2020 2020 2020 2020  ll.             
-00016bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c00: 2020 2020 2020 2074 6865 2044 6174 6120         the Data 
-00016c10: 536f 7572 6365 2046 756e 6374 696f 6e20  Source Function 
-00016c20: 7769 7468 2074 6865 203a 636c 6173 733a  with the :class:
-00016c30: 6074 6563 746f 6e2e 4669 6c74 6572 436f  `tecton.FilterCo
-00016c40: 6e74 6578 7460 2c20 7768 6963 6820 6861  ntext`, which ha
-00016c50: 7320 7468 6520 6060 7374 6172 745f 7469  s the ``start_ti
-00016c60: 6d65 6060 2061 6e64 0a20 2020 2020 2020  me`` and.       
-00016c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c80: 2020 2020 2020 2020 2020 2020 2060 6065               ``e
-00016c90: 6e64 5f74 696d 6560 6020 7365 742e 0a0a  nd_time`` set...
-00016ca0: 2020 2020 4578 616d 706c 6520 6465 6669      Example defi
-00016cb0: 6e69 6e67 2061 2044 6174 6120 536f 7572  ning a Data Sour
-00016cc0: 6365 2046 756e 6374 696f 6e20 7573 696e  ce Function usin
-00016cd0: 6720 6060 7370 6172 6b5f 6261 7463 685f  g ``spark_batch_
-00016ce0: 636f 6e66 6967 6060 3a0a 0a20 2020 202e  config``:..    .
-00016cf0: 2e20 636f 6465 2d62 6c6f 636b 3a3a 2070  . code-block:: p
-00016d00: 7974 686f 6e0a 0a20 2020 2020 2020 2066  ython..        f
-00016d10: 726f 6d20 7465 6374 6f6e 2069 6d70 6f72  rom tecton impor
-00016d20: 7420 7370 6172 6b5f 6261 7463 685f 636f  t spark_batch_co
-00016d30: 6e66 6967 0a0a 2020 2020 2020 2020 4073  nfig..        @s
-00016d40: 7061 726b 5f62 6174 6368 5f63 6f6e 6669  park_batch_confi
-00016d50: 6728 7375 7070 6f72 7473 5f74 696d 655f  g(supports_time_
-00016d60: 6669 6c74 6572 696e 673d 5472 7565 290a  filtering=True).
-00016d70: 2020 2020 2020 2020 6465 6620 7265 6473          def reds
-00016d80: 6869 6674 5f64 6174 615f 736f 7572 6365  hift_data_source
-00016d90: 5f66 756e 6374 696f 6e28 7370 6172 6b2c  _function(spark,
-00016da0: 2066 696c 7465 725f 636f 6e74 6578 7429   filter_context)
-00016db0: 3a0a 2020 2020 2020 2020 2020 2020 7370  :.            sp
-00016dc0: 6172 6b5f 666f 726d 6174 203d 2022 636f  ark_format = "co
-00016dd0: 6d2e 6461 7461 6272 6963 6b73 2e73 7061  m.databricks.spa
-00016de0: 726b 2e72 6564 7368 6966 7422 0a20 2020  rk.redshift".   
-00016df0: 2020 2020 2020 2020 2070 6172 616d 7320           params 
-00016e00: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-00016e10: 2020 2020 2275 7365 7222 3a20 223c 7573      "user": "<us
-00016e20: 6572 206e 616d 653e 222c 0a20 2020 2020  er name>",.     
-00016e30: 2020 2020 2020 2020 2020 2022 7061 7373             "pass
-00016e40: 776f 7264 223a 206f 732e 656e 7669 726f  word": os.enviro
-00016e50: 6e5b 2272 6564 7368 6966 745f 7061 7373  n["redshift_pass
-00016e60: 776f 7264 225d 0a20 2020 2020 2020 2020  word"].         
-00016e70: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
-00016e80: 2065 6e64 706f 696e 7420 3d20 223c 7265   endpoint = "<re
-00016e90: 6473 6869 6674 2065 6e64 706f 696e 743e  dshift endpoint>
-00016ea0: 220a 2020 2020 2020 2020 2020 2020 6675  ".            fu
-00016eb0: 6c6c 5f63 6f6e 6e65 6374 696f 6e5f 7374  ll_connection_st
-00016ec0: 7269 6e67 203d 2066 226a 6462 633a 7265  ring = f"jdbc:re
-00016ed0: 6473 6869 6674 3a2f 2f7b 656e 6470 6f69  dshift://{endpoi
-00016ee0: 6e74 7d3b 7573 6572 3d7b 7061 7261 6d73  nt};user={params
-00016ef0: 5b27 7573 6572 275d 7d3b 7061 7373 776f  ['user']};passwo
-00016f00: 7264 3d7b 7061 7261 6d73 5b27 7061 7373  rd={params['pass
-00016f10: 776f 7264 275d 7d22 0a20 2020 2020 2020  word']}".       
-00016f20: 2020 2020 2064 665f 7265 6164 6572 203d       df_reader =
-00016f30: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-00016f40: 2020 2073 7061 726b 2e72 6561 642e 666f     spark.read.fo
-00016f50: 726d 6174 2873 7061 726b 5f66 6f72 6d61  rmat(spark_forma
-00016f60: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
-00016f70: 2020 202e 6f70 7469 6f6e 2822 7572 6c22     .option("url"
-00016f80: 2c20 6675 6c6c 5f63 6f6e 6e65 6374 696f  , full_connectio
-00016f90: 6e5f 7374 7269 6e67 290a 2020 2020 2020  n_string).      
-00016fa0: 2020 2020 2020 2020 2020 2e6f 7074 696f            .optio
-00016fb0: 6e28 2266 6f72 7761 7264 5f73 7061 726b  n("forward_spark
-00016fc0: 5f73 335f 6372 6564 656e 7469 616c 7322  _s3_credentials"
-00016fd0: 2c20 2274 7275 6522 290a 2020 2020 2020  , "true").      
-00016fe0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00016ff0: 2020 2020 6466 5f72 6561 6465 7220 3d20      df_reader = 
-00017000: 6466 5f72 6561 6465 722e 6f70 7469 6f6e  df_reader.option
-00017010: 2822 6462 7461 626c 6522 2c20 2279 6f75  ("dbtable", "you
-00017020: 725f 7461 626c 655f 6e61 6d65 2229 0a20  r_table_name"). 
-00017030: 2020 2020 2020 2020 2020 2064 6620 3d20             df = 
-00017040: 6466 5f72 6561 6465 725f 6c6f 6164 2829  df_reader_load()
-00017050: 0a20 2020 2020 2020 2020 2020 2074 735f  .            ts_
-00017060: 636f 6c75 6d6e 203d 2022 7469 6d65 7374  column = "timest
-00017070: 616d 7022 0a20 2020 2020 2020 2020 2020  amp".           
-00017080: 2064 6620 3d20 6466 2e77 6974 6843 6f6c   df = df.withCol
-00017090: 756d 6e28 7473 5f63 6f6c 756d 6e2c 2063  umn(ts_column, c
-000170a0: 6f6c 2874 735f 636f 6c75 6d6e 292e 6361  ol(ts_column).ca
-000170b0: 7374 2822 7469 6d65 7374 616d 7022 2929  st("timestamp"))
-000170c0: 0a20 2020 2020 2020 2020 2020 2023 2048  .            # H
-000170d0: 616e 646c 6520 7469 6d65 2066 696c 7465  andle time filte
-000170e0: 7269 6e67 0a20 2020 2020 2020 2020 2020  ring.           
-000170f0: 2069 6620 6669 6c74 6572 5f63 6f6e 7465   if filter_conte
-00017100: 7874 3a0a 2020 2020 2020 2020 2020 2020  xt:.            
-00017110: 2020 2020 6966 2066 696c 7465 725f 636f      if filter_co
-00017120: 6e74 6578 742e 7374 6172 745f 7469 6d65  ntext.start_time
-00017130: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00017140: 2020 2020 2020 6466 203d 2064 662e 7768        df = df.wh
-00017150: 6572 6528 636f 6c28 7473 5f63 6f6c 756d  ere(col(ts_colum
-00017160: 6e29 203e 3d20 6669 6c74 6572 5f63 6f6e  n) >= filter_con
-00017170: 7465 7874 2e73 7461 7274 5f74 696d 6529  text.start_time)
-00017180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017190: 2069 6620 6669 6c74 6572 5f63 6f6e 7465   if filter_conte
-000171a0: 7874 2e65 6e64 5f74 696d 653a 0a20 2020  xt.end_time:.   
-000171b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000171c0: 2064 6620 3d20 6466 2e77 6865 7265 2863   df = df.where(c
-000171d0: 6f6c 2874 735f 636f 6c75 6d6e 2920 3c20  ol(ts_column) < 
-000171e0: 6669 6c74 6572 5f63 6f6e 7465 7874 2e65  filter_context.e
-000171f0: 6e64 5f74 696d 6529 0a20 2020 2020 2020  nd_time).       
-00017200: 2020 2020 2072 6574 7572 6e20 6466 0a20       return df. 
-00017210: 2020 2022 2222 0a0a 2020 2020 6465 6620     """..    def 
-00017220: 6465 636f 7261 746f 7228 6461 7461 5f73  decorator(data_s
-00017230: 6f75 7263 655f 6675 6e63 7469 6f6e 293a  ource_function):
-00017240: 0a20 2020 2020 2020 2062 6174 6368 5f63  .        batch_c
-00017250: 6f6e 6669 6720 3d20 5370 6172 6b42 6174  onfig = SparkBat
-00017260: 6368 436f 6e66 6967 280a 2020 2020 2020  chConfig(.      
-00017270: 2020 2020 2020 6461 7461 5f73 6f75 7263        data_sourc
-00017280: 655f 6675 6e63 7469 6f6e 3d64 6174 615f  e_function=data_
-00017290: 736f 7572 6365 5f66 756e 6374 696f 6e2c  source_function,
-000172a0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-000172b0: 615f 6465 6c61 793d 6461 7461 5f64 656c  a_delay=data_del
-000172c0: 6179 2c0a 2020 2020 2020 2020 2020 2020  ay,.            
-000172d0: 7375 7070 6f72 7473 5f74 696d 655f 6669  supports_time_fi
-000172e0: 6c74 6572 696e 673d 7375 7070 6f72 7473  ltering=supports
-000172f0: 5f74 696d 655f 6669 6c74 6572 696e 672c  _time_filtering,
-00017300: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00017310: 2020 2066 756e 6374 6f6f 6c73 2e75 7064     functools.upd
-00017320: 6174 655f 7772 6170 7065 7228 7772 6170  ate_wrapper(wrap
-00017330: 7065 723d 6261 7463 685f 636f 6e66 6967  per=batch_config
-00017340: 2c20 7772 6170 7065 643d 6461 7461 5f73  , wrapped=data_s
-00017350: 6f75 7263 655f 6675 6e63 7469 6f6e 290a  ource_function).
-00017360: 2020 2020 2020 2020 7265 7475 726e 2062          return b
-00017370: 6174 6368 5f63 6f6e 6669 670a 0a20 2020  atch_config..   
-00017380: 2072 6574 7572 6e20 6465 636f 7261 746f   return decorato
-00017390: 720a 0a0a 636c 6173 7320 5370 6172 6b53  r...class SparkS
-000173a0: 7472 6561 6d43 6f6e 6669 6728 4261 7365  treamConfig(Base
-000173b0: 5374 7265 616d 436f 6e66 6967 293a 0a20  StreamConfig):. 
-000173c0: 2020 2022 2222 0a20 2020 2043 6f6e 6669     """.    Confi
-000173d0: 6775 7261 7469 6f6e 2075 7365 6420 746f  guration used to
-000173e0: 2064 6566 696e 6520 6120 7374 7265 616d   define a stream
-000173f0: 2073 6f75 7263 6520 7573 696e 6720 6120   source using a 
-00017400: 4461 7461 2053 6f75 7263 6520 4675 6e63  Data Source Func
-00017410: 7469 6f6e 2e0a 0a20 2020 2054 6865 2060  tion...    The `
-00017420: 6053 7061 726b 5374 7265 616d 436f 6e66  `SparkStreamConf
-00017430: 6967 6060 2063 6c61 7373 2069 7320 7573  ig`` class is us
-00017440: 6564 2074 6f20 636f 6e66 6967 7572 6520  ed to configure 
-00017450: 6120 7374 7265 616d 2073 6f75 7263 6520  a stream source 
-00017460: 7573 696e 6720 6120 7573 6572 2064 6566  using a user def
-00017470: 696e 6564 2044 6174 6120 536f 7572 6365  ined Data Source
-00017480: 2046 756e 6374 696f 6e2e 0a0a 2020 2020   Function...    
-00017490: 5468 6973 2063 6c61 7373 2069 7320 7573  This class is us
-000174a0: 6564 2061 7320 616e 2069 6e70 7574 2074  ed as an input t
-000174b0: 6f20 6120 3a63 6c61 7373 3a60 5374 7265  o a :class:`Stre
-000174c0: 616d 536f 7572 6365 6027 7320 7061 7261  amSource`'s para
-000174d0: 6d65 7465 7220 6060 7374 7265 616d 5f63  meter ``stream_c
-000174e0: 6f6e 6669 6760 602e 2044 6563 6c61 7269  onfig``. Declari
-000174f0: 6e67 2074 6869 7320 636f 6e66 6967 7572  ng this configur
-00017500: 6174 696f 6e0a 2020 2020 636c 6173 7320  ation.    class 
-00017510: 616c 6f6e 6520 7769 6c6c 206e 6f74 2072  alone will not r
-00017520: 6567 6973 7465 7220 6120 4461 7461 2053  egister a Data S
-00017530: 6f75 7263 652e 2049 6e73 7465 6164 2c20  ource. Instead, 
-00017540: 6465 636c 6172 6520 6173 2061 2070 6172  declare as a par
-00017550: 7420 6f66 2060 6053 7472 6561 6d53 6f75  t of ``StreamSou
-00017560: 7263 6560 6020 7468 6174 2074 616b 6573  rce`` that takes
-00017570: 2074 6869 7320 636f 6e66 6967 7572 6174   this configurat
-00017580: 696f 6e0a 2020 2020 636c 6173 7320 696e  ion.    class in
-00017590: 7374 616e 6365 2061 7320 6120 7061 7261  stance as a para
-000175a0: 6d65 7465 722e 0a0a 2020 2020 2a2a 446f  meter...    **Do
-000175b0: 206e 6f74 2069 6e73 7461 6e74 6961 7465   not instantiate
-000175c0: 2074 6869 7320 636c 6173 7320 6469 7265   this class dire
-000175d0: 6374 6c79 2e2a 2a20 5573 6520 3a70 793a  ctly.** Use :py:
-000175e0: 6675 6e63 3a60 7465 6374 6f6e 2e73 7061  func:`tecton.spa
-000175f0: 726b 5f73 7472 6561 6d5f 636f 6e66 6967  rk_stream_config
-00017600: 6020 696e 7374 6561 642e 0a20 2020 2022  ` instead..    "
-00017610: 2222 0a0a 2020 2020 6465 6620 5f5f 696e  ""..    def __in
-00017620: 6974 5f5f 2873 656c 662c 2064 6174 615f  it__(self, data_
-00017630: 736f 7572 6365 5f66 756e 6374 696f 6e3a  source_function:
-00017640: 2043 616c 6c61 626c 655b 5b53 7061 726b   Callable[[Spark
-00017650: 5365 7373 696f 6e5d 2c20 4461 7461 4672  Session], DataFr
-00017660: 616d 655d 293a 0a20 2020 2020 2020 2022  ame]):.        "
-00017670: 2222 0a20 2020 2020 2020 2049 6e73 7461  "".        Insta
-00017680: 6e74 6961 7465 7320 6120 6e65 7720 5370  ntiates a new Sp
-00017690: 6172 6b42 6174 6368 436f 6e66 6967 2e0a  arkBatchConfig..
-000176a0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000176b0: 6461 7461 5f73 6f75 7263 655f 6675 6e63  data_source_func
-000176c0: 7469 6f6e 3a20 5573 6572 2d64 6566 696e  tion: User-defin
-000176d0: 6564 2044 6174 6120 536f 7572 6365 2046  ed Data Source F
-000176e0: 756e 6374 696f 6e20 7468 6174 2074 616b  unction that tak
-000176f0: 6573 2069 6e20 6120 6060 5370 6172 6b53  es in a ``SparkS
-00017700: 6573 7369 6f6e 6060 2061 6e64 2072 6574  ession`` and ret
-00017710: 7572 6e73 0a20 2020 2020 2020 2020 2020  urns.           
-00017720: 2020 2020 2020 2020 2061 2073 7472 6561           a strea
-00017730: 6d69 6e67 2060 6044 6174 6146 7261 6d65  ming ``DataFrame
-00017740: 6060 2e0a 0a20 2020 2020 2020 203a 7265  ``...        :re
-00017750: 7475 726e 3a20 4120 5370 6172 6b53 7472  turn: A SparkStr
-00017760: 6561 6d43 6f6e 6669 6720 636c 6173 7320  eamConfig class 
-00017770: 696e 7374 616e 6365 2e0a 2020 2020 2020  instance..      
-00017780: 2020 2222 220a 2020 2020 2020 2020 7061    """.        pa
-00017790: 7261 6d73 203d 206c 6973 7428 696e 7370  rams = list(insp
-000177a0: 6563 742e 7369 676e 6174 7572 6528 6461  ect.signature(da
-000177b0: 7461 5f73 6f75 7263 655f 6675 6e63 7469  ta_source_functi
-000177c0: 6f6e 292e 7061 7261 6d65 7465 7273 290a  on).parameters).
-000177d0: 2020 2020 2020 2020 6675 6e63 7469 6f6e          function
-000177e0: 5f6e 616d 6520 3d20 6461 7461 5f73 6f75  _name = data_sou
-000177f0: 7263 655f 6675 6e63 7469 6f6e 2e5f 5f6e  rce_function.__n
-00017800: 616d 655f 5f0a 2020 2020 2020 2020 6966  ame__.        if
-00017810: 2070 6172 616d 7320 213d 205b 2273 7061   params != ["spa
-00017820: 726b 225d 3a0a 2020 2020 2020 2020 2020  rk"]:.          
-00017830: 2020 6d73 6720 3d20 6622 4461 7461 2053    msg = f"Data S
-00017840: 6f75 7263 6520 4675 6e63 7469 6f6e 207b  ource Function {
-00017850: 6675 6e63 7469 6f6e 5f6e 616d 657d 2773  function_name}'s
-00017860: 2072 6571 7569 7265 6420 7369 676e 6174   required signat
-00017870: 7572 6520 6973 2060 7b66 756e 6374 696f  ure is `{functio
-00017880: 6e5f 6e61 6d65 7d28 7370 6172 6b29 6022  n_name}(spark)`"
-00017890: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-000178a0: 7365 2041 7373 6572 7469 6f6e 4572 726f  se AssertionErro
-000178b0: 7228 6d73 6729 0a0a 2020 2020 2020 2020  r(msg)..        
-000178c0: 7365 6c66 2e5f 6172 6773 203d 2064 6174  self._args = dat
-000178d0: 615f 736f 7572 6365 5f70 6232 2e53 7061  a_source_pb2.Spa
-000178e0: 726b 5374 7265 616d 436f 6e66 6967 4172  rkStreamConfigAr
-000178f0: 6773 2829 0a20 2020 2020 2020 2069 6620  gs().        if 
-00017900: 6675 6e63 7469 6f6e 5f73 6572 6961 6c69  function_seriali
-00017910: 7a61 7469 6f6e 2e73 686f 756c 645f 7365  zation.should_se
-00017920: 7269 616c 697a 655f 6675 6e63 7469 6f6e  rialize_function
-00017930: 2864 6174 615f 736f 7572 6365 5f66 756e  (data_source_fun
-00017940: 6374 696f 6e29 3a0a 2020 2020 2020 2020  ction):.        
-00017950: 2020 2020 7365 6c66 2e5f 6172 6773 2e64      self._args.d
-00017960: 6174 615f 736f 7572 6365 5f66 756e 6374  ata_source_funct
-00017970: 696f 6e2e 436f 7079 4672 6f6d 2866 756e  ion.CopyFrom(fun
-00017980: 6374 696f 6e5f 7365 7269 616c 697a 6174  ction_serializat
-00017990: 696f 6e2e 746f 5f70 726f 746f 2864 6174  ion.to_proto(dat
-000179a0: 615f 736f 7572 6365 5f66 756e 6374 696f  a_source_functio
-000179b0: 6e29 290a 2020 2020 2020 2020 7365 6c66  n)).        self
-000179c0: 2e64 6174 615f 736f 7572 6365 5f66 756e  .data_source_fun
-000179d0: 6374 696f 6e20 3d20 6461 7461 5f73 6f75  ction = data_sou
-000179e0: 7263 655f 6675 6e63 7469 6f6e 0a0a 2020  rce_function..  
-000179f0: 2020 6465 6620 5f6d 6572 6765 5f73 7472    def _merge_str
-00017a00: 6561 6d5f 6172 6773 2873 656c 662c 2064  eam_args(self, d
-00017a10: 6174 615f 736f 7572 6365 5f61 7267 733a  ata_source_args:
-00017a20: 2076 6972 7475 616c 5f64 6174 615f 736f   virtual_data_so
-00017a30: 7572 6365 5f70 6232 2e56 6972 7475 616c  urce_pb2.Virtual
-00017a40: 4461 7461 536f 7572 6365 4172 6773 293a  DataSourceArgs):
-00017a50: 0a20 2020 2020 2020 2064 6174 615f 736f  .        data_so
-00017a60: 7572 6365 5f61 7267 732e 7370 6172 6b5f  urce_args.spark_
-00017a70: 7374 7265 616d 5f63 6f6e 6669 672e 436f  stream_config.Co
-00017a80: 7079 4672 6f6d 2873 656c 662e 5f61 7267  pyFrom(self._arg
-00017a90: 7329 0a0a 2020 2020 6465 6620 5f5f 6361  s)..    def __ca
-00017aa0: 6c6c 5f5f 2873 656c 662c 202a 6172 6773  ll__(self, *args
-00017ab0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00017ac0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00017ad0: 2e64 6174 615f 736f 7572 6365 5f66 756e  .data_source_fun
-00017ae0: 6374 696f 6e28 2a61 7267 732c 202a 2a6b  ction(*args, **k
-00017af0: 7761 7267 7329 0a0a 0a64 6566 2073 7061  wargs)...def spa
-00017b00: 726b 5f73 7472 6561 6d5f 636f 6e66 6967  rk_stream_config
-00017b10: 2829 3a0a 2020 2020 2222 220a 2020 2020  ():.    """.    
-00017b20: 4465 636c 6172 6520 6120 3a63 6c61 7373  Declare a :class
-00017b30: 3a60 7465 6374 6f6e 2e53 7061 726b 5374  :`tecton.SparkSt
-00017b40: 7265 616d 436f 6e66 6967 6020 666f 7220  reamConfig` for 
-00017b50: 636f 6e66 6967 7572 696e 6720 6120 5374  configuring a St
-00017b60: 7265 616d 2053 6f75 7263 6520 7769 7468  ream Source with
-00017b70: 2061 2044 6174 6120 536f 7572 6365 2046   a Data Source F
-00017b80: 756e 6374 696f 6e2e 2054 6865 2066 756e  unction. The fun
-00017b90: 6374 696f 6e20 7461 6b65 7320 696e 2061  ction takes in a
-00017ba0: 2060 6053 7061 726b 5365 7373 696f 6e60   ``SparkSession`
-00017bb0: 6020 7265 7475 726e 7320 6120 7374 7265  ` returns a stre
-00017bc0: 616d 696e 6720 6060 4461 7461 4672 616d  aming ``DataFram
-00017bd0: 6560 602e 0a0a 2020 2020 4578 616d 706c  e``...    Exampl
-00017be0: 6520 6465 6669 6e69 6e67 2061 2044 6174  e defining a Dat
-00017bf0: 6120 536f 7572 6365 2046 756e 6374 696f  a Source Functio
-00017c00: 6e20 7573 696e 6720 6060 7370 6172 6b5f  n using ``spark_
-00017c10: 7374 7265 616d 5f63 6f6e 6669 6760 603a  stream_config``:
-00017c20: 0a0a 2020 2020 2e2e 2063 6f64 652d 626c  ..    .. code-bl
-00017c30: 6f63 6b3a 3a20 7079 7468 6f6e 0a0a 2020  ock:: python..  
-00017c40: 2020 2020 2020 6672 6f6d 2074 6563 746f        from tecto
-00017c50: 6e20 696d 706f 7274 2073 7061 726b 5f73  n import spark_s
-00017c60: 7472 6561 6d5f 636f 6e66 6967 0a0a 2020  tream_config..  
-00017c70: 2020 2020 2020 6465 6620 7261 775f 6461        def raw_da
-00017c80: 7461 5f64 6573 6572 6961 6c69 7a61 7469  ta_deserializati
-00017c90: 6f6e 2864 6629 3a0a 2020 2020 2020 2020  on(df):.        
-00017ca0: 2020 2020 6672 6f6d 2070 7973 7061 726b      from pyspark
-00017cb0: 2e73 716c 2e66 756e 6374 696f 6e73 2069  .sql.functions i
-00017cc0: 6d70 6f72 7420 636f 6c2c 2066 726f 6d5f  mport col, from_
-00017cd0: 6a73 6f6e 2c20 6672 6f6d 5f75 7463 5f74  json, from_utc_t
-00017ce0: 696d 6573 7461 6d70 2c20 7768 656e 0a20  imestamp, when. 
-00017cf0: 2020 2020 2020 2020 2020 2066 726f 6d20             from 
-00017d00: 7079 7370 6172 6b2e 7371 6c2e 7479 7065  pyspark.sql.type
-00017d10: 7320 696d 706f 7274 2053 7472 7563 7454  s import StructT
-00017d20: 7970 652c 2053 7472 7563 7446 6965 6c64  ype, StructField
-00017d30: 2c20 5374 7269 6e67 5479 7065 2c20 446f  , StringType, Do
-00017d40: 7562 6c65 5479 7065 2c20 5469 6d65 7374  ubleType, Timest
-00017d50: 616d 7054 7970 652c 2042 6f6f 6c65 616e  ampType, Boolean
-00017d60: 5479 7065 2c20 496e 7465 6765 7254 7970  Type, IntegerTyp
-00017d70: 650a 2020 2020 2020 2020 2020 2020 7061  e.            pa
-00017d80: 796c 6f61 645f 7363 6865 6d61 203d 2053  yload_schema = S
-00017d90: 7472 7563 7454 7970 6528 5b0a 2020 2020  tructType([.    
-00017da0: 2020 2020 2020 2020 2020 2020 5374 7275              Stru
-00017db0: 6374 4669 656c 6428 2275 7365 725f 6964  ctField("user_id
-00017dc0: 222c 2053 7472 696e 6754 7970 6528 292c  ", StringType(),
-00017dd0: 2046 616c 7365 292c 0a20 2020 2020 2020   False),.       
-00017de0: 2020 2020 2020 2020 2053 7472 7563 7446           StructF
-00017df0: 6965 6c64 2822 7472 616e 7361 6374 696f  ield("transactio
-00017e00: 6e5f 6964 222c 2053 7472 696e 6754 7970  n_id", StringTyp
-00017e10: 6528 292c 2046 616c 7365 292c 0a20 2020  e(), False),.   
-00017e20: 2020 2020 2020 2020 2020 2020 2053 7472               Str
-00017e30: 7563 7446 6965 6c64 2822 6361 7465 676f  uctField("catego
-00017e40: 7279 222c 2053 7472 696e 6754 7970 6528  ry", StringType(
-00017e50: 292c 2046 616c 7365 292c 0a20 2020 2020  ), False),.     
-00017e60: 2020 2020 2020 2020 2020 2053 7472 7563             Struc
-00017e70: 7446 6965 6c64 2822 616d 7422 2c20 5374  tField("amt", St
-00017e80: 7269 6e67 5479 7065 2829 2c20 4661 6c73  ringType(), Fals
-00017e90: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
-00017ea0: 2020 2020 5374 7275 6374 4669 656c 6428      StructField(
-00017eb0: 2274 696d 6573 7461 6d70 222c 2053 7472  "timestamp", Str
-00017ec0: 696e 6754 7970 6528 292c 2046 616c 7365  ingType(), False
-00017ed0: 292c 0a20 2020 2020 2020 2020 2020 205d  ),.            ]
-00017ee0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00017ef0: 7475 726e 2028 0a20 2020 2020 2020 2020  turn (.         
-00017f00: 2020 2020 2020 2064 662e 7365 6c65 6374         df.select
-00017f10: 4578 7072 2822 6361 7374 2028 6461 7461  Expr("cast (data
-00017f20: 2061 7320 5354 5249 4e47 2920 6a73 6f6e   as STRING) json
-00017f30: 4461 7461 2229 0a20 2020 2020 2020 2020  Data").         
-00017f40: 2020 2020 2020 202e 7365 6c65 6374 2866         .select(f
-00017f50: 726f 6d5f 6a73 6f6e 2822 6a73 6f6e 4461  rom_json("jsonDa
-00017f60: 7461 222c 2070 6179 6c6f 6164 5f73 6368  ta", payload_sch
-00017f70: 656d 6129 2e61 6c69 6173 2822 7061 796c  ema).alias("payl
-00017f80: 6f61 6422 2929 0a20 2020 2020 2020 2020  oad")).         
-00017f90: 2020 2020 2020 202e 7365 6c65 6374 280a         .select(.
-00017fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017fb0: 2020 2020 636f 6c28 2270 6179 6c6f 6164      col("payload
-00017fc0: 2e75 7365 725f 6964 2229 2e61 6c69 6173  .user_id").alias
-00017fd0: 2822 7573 6572 5f69 6422 292c 0a20 2020  ("user_id"),.   
-00017fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017ff0: 2063 6f6c 2822 7061 796c 6f61 642e 7472   col("payload.tr
-00018000: 616e 7361 6374 696f 6e5f 6964 2229 2e61  ansaction_id").a
-00018010: 6c69 6173 2822 7472 616e 7361 6374 696f  lias("transactio
-00018020: 6e5f 6964 2229 2c0a 2020 2020 2020 2020  n_id"),.        
-00018030: 2020 2020 2020 2020 2020 2020 636f 6c28              col(
-00018040: 2270 6179 6c6f 6164 2e63 6174 6567 6f72  "payload.categor
-00018050: 7922 292e 616c 6961 7328 2263 6174 6567  y").alias("categ
-00018060: 6f72 7922 292c 0a20 2020 2020 2020 2020  ory"),.         
-00018070: 2020 2020 2020 2020 2020 2063 6f6c 2822             col("
-00018080: 7061 796c 6f61 642e 616d 7422 292e 6361  payload.amt").ca
-00018090: 7374 2822 646f 7562 6c65 2229 2e61 6c69  st("double").ali
-000180a0: 6173 2822 616d 7422 292c 0a20 2020 2020  as("amt"),.     
-000180b0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000180c0: 726f 6d5f 7574 635f 7469 6d65 7374 616d  rom_utc_timestam
-000180d0: 7028 2270 6179 6c6f 6164 2e74 696d 6573  p("payload.times
-000180e0: 7461 6d70 222c 2022 5554 4322 292e 616c  tamp", "UTC").al
-000180f0: 6961 7328 2274 696d 6573 7461 6d70 2229  ias("timestamp")
-00018100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018110: 2029 0a20 2020 2020 2020 2020 2020 2029   ).            )
-00018120: 0a0a 2020 2020 2020 2020 4073 7061 726b  ..        @spark
-00018130: 5f73 7472 6561 6d5f 636f 6e66 6967 2829  _stream_config()
-00018140: 0a20 2020 2020 2020 2064 6566 206b 696e  .        def kin
-00018150: 6573 6973 5f64 6174 615f 736f 7572 6365  esis_data_source
-00018160: 5f66 756e 6374 696f 6e28 7370 6172 6b29  _function(spark)
-00018170: 3a0a 2020 2020 2020 2020 2020 2020 6f70  :.            op
-00018180: 7469 6f6e 7320 3d20 7b0a 2020 2020 2020  tions = {.      
-00018190: 2020 2020 2020 2020 2020 2273 7472 6561            "strea
-000181a0: 6d4e 616d 6522 3a20 223c 7374 7265 616d  mName": "<stream
-000181b0: 206e 616d 653e 222c 0a20 2020 2020 2020   name>",.       
-000181c0: 2020 2020 2020 2020 2022 726f 6c65 4172           "roleAr
-000181d0: 6e22 3a20 223c 726f 6c65 2041 524e 3e22  n": "<role ARN>"
-000181e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000181f0: 2020 2272 6567 696f 6e22 3a20 223c 7265    "region": "<re
-00018200: 6769 6f6e 3e22 2c0a 2020 2020 2020 2020  gion>",.        
-00018210: 2020 2020 2020 2020 2273 6861 7264 4665          "shardFe
-00018220: 7463 6849 6e74 6572 7661 6c22 3a20 2233  tchInterval": "3
-00018230: 3073 222c 0a20 2020 2020 2020 2020 2020  0s",.           
-00018240: 2020 2020 2022 696e 6974 6961 6c50 6f73       "initialPos
-00018250: 6974 696f 6e22 3a20 226c 6174 6573 7422  ition": "latest"
-00018260: 0a20 2020 2020 2020 2020 2020 207d 0a20  .            }. 
-00018270: 2020 2020 2020 2020 2020 2072 6561 6465             reade
-00018280: 7220 3d20 7370 6172 6b2e 7265 6164 5374  r = spark.readSt
-00018290: 7265 616d 2e66 6f72 6d61 7428 226b 696e  ream.format("kin
-000182a0: 6573 6973 2229 2e6f 7074 696f 6e73 282a  esis").options(*
-000182b0: 2a6f 7074 696f 6e73 290a 2020 2020 2020  *options).      
-000182c0: 2020 2020 2020 6466 203d 2072 6561 6465        df = reade
-000182d0: 722e 6c6f 6164 2829 0a20 2020 2020 2020  r.load().       
-000182e0: 2020 2020 2064 6620 3d20 7261 775f 6461       df = raw_da
-000182f0: 7461 5f64 6573 6572 6961 6c69 7a61 7469  ta_deserializati
-00018300: 6f6e 2864 6629 0a20 2020 2020 2020 2020  on(df).         
-00018310: 2020 2077 6174 6572 6d61 726b 203d 2022     watermark = "
-00018320: 7b7d 2073 6563 6f6e 6473 222e 666f 726d  {} seconds".form
-00018330: 6174 2874 696d 6564 656c 7461 2868 6f75  at(timedelta(hou
-00018340: 7273 3d32 3429 2e73 6563 6f6e 6473 290a  rs=24).seconds).
-00018350: 2020 2020 2020 2020 2020 2020 6466 203d              df =
-00018360: 2064 662e 7769 7468 5761 7465 726d 6172   df.withWatermar
-00018370: 6b28 2274 696d 6573 7461 6d70 222c 2077  k("timestamp", w
-00018380: 6174 6572 6d61 726b 290a 2020 2020 2020  atermark).      
-00018390: 2020 2020 2020 7265 7475 726e 2064 660a        return df.
-000183a0: 2020 2020 2222 220a 0a20 2020 2064 6566      """..    def
-000183b0: 2064 6563 6f72 6174 6f72 2864 6174 615f   decorator(data_
-000183c0: 736f 7572 6365 5f66 756e 6374 696f 6e29  source_function)
-000183d0: 3a0a 2020 2020 2020 2020 7374 7265 616d  :.        stream
-000183e0: 5f63 6f6e 6669 6720 3d20 5370 6172 6b53  _config = SparkS
-000183f0: 7472 6561 6d43 6f6e 6669 6728 0a20 2020  treamConfig(.   
-00018400: 2020 2020 2020 2020 2064 6174 615f 736f           data_so
-00018410: 7572 6365 5f66 756e 6374 696f 6e3d 6461  urce_function=da
-00018420: 7461 5f73 6f75 7263 655f 6675 6e63 7469  ta_source_functi
-00018430: 6f6e 2c0a 2020 2020 2020 2020 290a 2020  on,.        ).  
-00018440: 2020 2020 2020 6675 6e63 746f 6f6c 732e        functools.
-00018450: 7570 6461 7465 5f77 7261 7070 6572 2877  update_wrapper(w
-00018460: 7261 7070 6572 3d73 7472 6561 6d5f 636f  rapper=stream_co
-00018470: 6e66 6967 2c20 7772 6170 7065 643d 6461  nfig, wrapped=da
-00018480: 7461 5f73 6f75 7263 655f 6675 6e63 7469  ta_source_functi
-00018490: 6f6e 290a 2020 2020 2020 2020 7265 7475  on).        retu
-000184a0: 726e 2073 7472 6561 6d5f 636f 6e66 6967  rn stream_config
-000184b0: 0a0a 2020 2020 7265 7475 726e 2064 6563  ..    return dec
-000184c0: 6f72 6174 6f72 0a0a 0a63 6c61 7373 2050  orator...class P
-000184d0: 616e 6461 7342 6174 6368 436f 6e66 6967  andasBatchConfig
-000184e0: 2842 6173 6542 6174 6368 436f 6e66 6967  (BaseBatchConfig
-000184f0: 293a 0a20 2020 2022 2222 0a20 2020 2043  ):.    """.    C
-00018500: 6f6e 6669 6775 7261 7469 6f6e 2075 7365  onfiguration use
-00018510: 6420 746f 2064 6566 696e 6520 6120 6261  d to define a ba
-00018520: 7463 6820 736f 7572 6365 2075 7369 6e67  tch source using
-00018530: 2061 2050 616e 6461 7320 4461 7461 2053   a Pandas Data S
-00018540: 6f75 7263 6520 4675 6e63 7469 6f6e 2e0a  ource Function..
-00018550: 2020 2020 5468 6520 6060 5061 6e64 6173      The ``Pandas
-00018560: 4261 7463 6843 6f6e 6669 6760 6020 636c  BatchConfig`` cl
-00018570: 6173 7320 6973 2075 7365 6420 746f 2063  ass is used to c
-00018580: 6f6e 6669 6775 7265 2061 2062 6174 6368  onfigure a batch
-00018590: 2073 6f75 7263 6520 7573 696e 6720 6120   source using a 
-000185a0: 7573 6572 2064 6566 696e 6564 2044 6174  user defined Dat
-000185b0: 6120 536f 7572 6365 2046 756e 6374 696f  a Source Functio
-000185c0: 6e2e 0a20 2020 2054 6869 7320 636c 6173  n..    This clas
-000185d0: 7320 6973 2075 7365 6420 6173 2061 6e20  s is used as an 
-000185e0: 696e 7075 7420 746f 2061 203a 636c 6173  input to a :clas
-000185f0: 733a 6042 6174 6368 536f 7572 6365 6027  s:`BatchSource`'
-00018600: 7320 7061 7261 6d65 7465 7220 6060 6261  s parameter ``ba
-00018610: 7463 685f 636f 6e66 6967 6060 2e20 4465  tch_config``. De
-00018620: 636c 6172 696e 6720 7468 6973 2063 6f6e  claring this con
-00018630: 6669 6775 7261 7469 6f6e 0a20 2020 2063  figuration.    c
-00018640: 6c61 7373 2061 6c6f 6e65 2077 696c 6c20  lass alone will 
-00018650: 6e6f 7420 7265 6769 7374 6572 2061 2044  not register a D
-00018660: 6174 6120 536f 7572 6365 2e20 496e 7374  ata Source. Inst
-00018670: 6561 642c 2064 6563 6c61 7265 2061 7320  ead, declare as 
-00018680: 6120 7061 7274 206f 6620 6060 4261 7463  a part of ``Batc
-00018690: 6853 6f75 7263 6560 6020 7468 6174 2074  hSource`` that t
-000186a0: 616b 6573 2074 6869 7320 636f 6e66 6967  akes this config
-000186b0: 7572 6174 696f 6e0a 2020 2020 636c 6173  uration.    clas
-000186c0: 7320 696e 7374 616e 6365 2061 7320 6120  s instance as a 
-000186d0: 7061 7261 6d65 7465 722e 0a20 2020 202a  parameter..    *
-000186e0: 2a44 6f20 6e6f 7420 696e 7374 616e 7469  *Do not instanti
-000186f0: 6174 6520 7468 6973 2063 6c61 7373 2064  ate this class d
-00018700: 6972 6563 746c 792e 2a2a 2055 7365 203a  irectly.** Use :
-00018710: 7079 3a66 756e 633a 6074 6563 746f 6e2e  py:func:`tecton.
-00018720: 7061 6e64 6173 5f62 6174 6368 5f63 6f6e  pandas_batch_con
-00018730: 6669 6760 2069 6e73 7465 6164 2e0a 2020  fig` instead..  
-00018740: 2020 2222 220a 0a20 2020 2063 6c61 7373    """..    class
-00018750: 2050 616e 6461 7344 6174 6153 6f75 7263   PandasDataSourc
-00018760: 6546 756e 6374 696f 6e54 7970 6531 2850  eFunctionType1(P
-00018770: 726f 746f 636f 6c29 3a0a 2020 2020 2020  rotocol):.      
-00018780: 2020 6465 6620 5f5f 6361 6c6c 5f5f 2873    def __call__(s
-00018790: 656c 6629 202d 3e20 4461 7461 4672 616d  elf) -> DataFram
-000187a0: 653a 202e 2e2e 0a0a 2020 2020 636c 6173  e: .....    clas
-000187b0: 7320 5061 6e64 6173 4461 7461 536f 7572  s PandasDataSour
-000187c0: 6365 4675 6e63 7469 6f6e 5479 7065 3228  ceFunctionType2(
-000187d0: 5072 6f74 6f63 6f6c 293a 0a20 2020 2020  Protocol):.     
-000187e0: 2020 2064 6566 205f 5f63 616c 6c5f 5f28     def __call__(
-000187f0: 7365 6c66 2c20 6669 6c74 6572 5f63 6f6e  self, filter_con
-00018800: 7465 7874 3a20 4669 6c74 6572 436f 6e74  text: FilterCont
-00018810: 6578 7429 202d 3e20 4461 7461 4672 616d  ext) -> DataFram
-00018820: 653a 202e 2e2e 0a0a 2020 2020 636c 6173  e: .....    clas
-00018830: 7320 5061 6e64 6173 4461 7461 536f 7572  s PandasDataSour
-00018840: 6365 4675 6e63 7469 6f6e 5479 7065 3328  ceFunctionType3(
-00018850: 5072 6f74 6f63 6f6c 293a 0a20 2020 2020  Protocol):.     
-00018860: 2020 2064 6566 205f 5f63 616c 6c5f 5f28     def __call__(
-00018870: 7365 6c66 2c20 7365 6372 6574 735f 636f  self, secrets_co
-00018880: 6e74 6578 743a 204d 6170 7069 6e67 5b73  ntext: Mapping[s
-00018890: 7472 2c20 7374 725d 2920 2d3e 2044 6174  tr, str]) -> Dat
-000188a0: 6146 7261 6d65 3a20 2e2e 2e0a 0a20 2020  aFrame: .....   
-000188b0: 2063 6c61 7373 2050 616e 6461 7344 6174   class PandasDat
-000188c0: 6153 6f75 7263 6546 756e 6374 696f 6e54  aSourceFunctionT
-000188d0: 7970 6534 2850 726f 746f 636f 6c29 3a0a  ype4(Protocol):.
-000188e0: 2020 2020 2020 2020 6465 6620 5f5f 6361          def __ca
-000188f0: 6c6c 5f5f 2873 656c 662c 2066 696c 7465  ll__(self, filte
-00018900: 725f 636f 6e74 6578 743a 2046 696c 7465  r_context: Filte
-00018910: 7243 6f6e 7465 7874 2c20 7365 6372 6574  rContext, secret
-00018920: 735f 636f 6e74 6578 743a 204d 6170 7069  s_context: Mappi
-00018930: 6e67 5b73 7472 2c20 7374 725d 2920 2d3e  ng[str, str]) ->
-00018940: 2044 6174 6146 7261 6d65 3a20 2e2e 2e0a   DataFrame: ....
-00018950: 0a20 2020 2050 616e 6461 7344 6174 6153  .    PandasDataS
-00018960: 6f75 7263 6546 756e 6374 696f 6e54 7970  ourceFunctionTyp
-00018970: 6520 3d20 556e 696f 6e5b 0a20 2020 2020  e = Union[.     
-00018980: 2020 2050 616e 6461 7344 6174 6153 6f75     PandasDataSou
-00018990: 7263 6546 756e 6374 696f 6e54 7970 6531  rceFunctionType1
-000189a0: 2c0a 2020 2020 2020 2020 5061 6e64 6173  ,.        Pandas
-000189b0: 4461 7461 536f 7572 6365 4675 6e63 7469  DataSourceFuncti
-000189c0: 6f6e 5479 7065 322c 0a20 2020 2020 2020  onType2,.       
-000189d0: 2050 616e 6461 7344 6174 6153 6f75 7263   PandasDataSourc
-000189e0: 6546 756e 6374 696f 6e54 7970 6533 2c0a  eFunctionType3,.
-000189f0: 2020 2020 2020 2020 5061 6e64 6173 4461          PandasDa
-00018a00: 7461 536f 7572 6365 4675 6e63 7469 6f6e  taSourceFunction
-00018a10: 5479 7065 342c 0a20 2020 205d 0a0a 2020  Type4,.    ]..  
-00018a20: 2020 6465 6620 5f5f 696e 6974 5f5f 280a    def __init__(.
-00018a30: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00018a40: 2020 2020 2020 6461 7461 5f73 6f75 7263        data_sourc
-00018a50: 655f 6675 6e63 7469 6f6e 3a20 5061 6e64  e_function: Pand
-00018a60: 6173 4461 7461 536f 7572 6365 4675 6e63  asDataSourceFunc
-00018a70: 7469 6f6e 5479 7065 2c0a 2020 2020 2020  tionType,.      
-00018a80: 2020 6461 7461 5f64 656c 6179 3a20 6461    data_delay: da
-00018a90: 7465 7469 6d65 2e74 696d 6564 656c 7461  tetime.timedelta
-00018aa0: 203d 2064 6174 6574 696d 652e 7469 6d65   = datetime.time
-00018ab0: 6465 6c74 6128 7365 636f 6e64 733d 3029  delta(seconds=0)
-00018ac0: 2c0a 2020 2020 2020 2020 7375 7070 6f72  ,.        suppor
-00018ad0: 7473 5f74 696d 655f 6669 6c74 6572 696e  ts_time_filterin
-00018ae0: 673a 2062 6f6f 6c20 3d20 4661 6c73 652c  g: bool = False,
-00018af0: 0a20 2020 2020 2020 2073 6563 7265 7473  .        secrets
-00018b00: 3a20 4f70 7469 6f6e 616c 5b44 6963 745b  : Optional[Dict[
-00018b10: 7374 722c 2055 6e69 6f6e 5b53 6563 7265  str, Union[Secre
-00018b20: 742c 2073 7472 5d5d 5d20 3d20 4e6f 6e65  t, str]]] = None
-00018b30: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-00018b40: 2022 2222 0a20 2020 2020 2020 2049 6e73   """.        Ins
-00018b50: 7461 6e74 6961 7465 7320 6120 6e65 7720  tantiates a new 
-00018b60: 5061 6e64 6173 4261 7463 6843 6f6e 6669  PandasBatchConfi
-00018b70: 672e 0a20 2020 2020 2020 203a 7061 7261  g..        :para
-00018b80: 6d20 6461 7461 5f73 6f75 7263 655f 6675  m data_source_fu
-00018b90: 6e63 7469 6f6e 3a20 5573 6572 2064 6566  nction: User def
-00018ba0: 696e 6564 2044 6174 6120 536f 7572 6365  ined Data Source
-00018bb0: 2046 756e 6374 696f 6e20 7468 6174 2074   Function that t
-00018bc0: 616b 6573 2069 6e20 616e 206f 7074 696f  akes in an optio
-00018bd0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00018be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018bf0: 2020 2020 2020 2020 3a63 6c61 7373 3a60          :class:`
-00018c00: 7465 6374 6f6e 2e46 696c 7465 7243 6f6e  tecton.FilterCon
-00018c10: 7465 7874 602c 2069 6620 6060 7375 7070  text`, if ``supp
-00018c20: 6f72 7473 5f74 696d 655f 6669 6c74 6572  orts_time_filter
-00018c30: 696e 673d 5472 7565 6060 2e20 5265 7475  ing=True``. Retu
-00018c40: 726e 7320 610a 2020 2020 2020 2020 2020  rns a.          
-00018c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018c60: 2020 2020 2020 2020 2020 6060 7061 6e64            ``pand
-00018c70: 6173 2e44 6174 6146 7261 6d65 6060 2e0a  as.DataFrame``..
-00018c80: 2020 2020 2020 2020 3a70 6172 616d 2064          :param d
-00018c90: 6174 615f 6465 6c61 793a 2042 7920 6465  ata_delay: By de
-00018ca0: 6661 756c 742c 2069 6e63 7265 6d65 6e74  fault, increment
-00018cb0: 616c 206d 6174 6572 6961 6c69 7a61 7469  al materializati
-00018cc0: 6f6e 206a 6f62 7320 7275 6e20 696d 6d65  on jobs run imme
-00018cd0: 6469 6174 656c 7920 6174 2074 6865 2065  diately at the e
-00018ce0: 6e64 206f 6620 7468 650a 2020 2020 2020  nd of the.      
-00018cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018d00: 2020 2020 2020 2020 2020 2020 2020 6261                ba
-00018d10: 7463 6820 7363 6865 6475 6c65 2070 6572  tch schedule per
-00018d20: 696f 642e 2054 6869 7320 7061 7261 6d65  iod. This parame
-00018d30: 7465 7220 636f 6e66 6967 7572 6573 2068  ter configures h
-00018d40: 6f77 206c 6f6e 6720 7468 6579 2077 6169  ow long they wai
-00018d50: 7420 6166 7465 7220 7468 6520 656e 640a  t after the end.
-00018d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018d80: 2020 2020 6f66 2074 6865 2070 6572 696f      of the perio
-00018d90: 6420 6265 666f 7265 2073 7461 7274 696e  d before startin
-00018da0: 672c 2074 7970 6963 616c 6c79 2074 6f20  g, typically to 
-00018db0: 656e 7375 7265 2074 6861 7420 616c 6c20  ensure that all 
-00018dc0: 6461 7461 2068 6173 206c 616e 6465 642e  data has landed.
-00018dd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018df0: 2020 2020 2046 6f72 2065 7861 6d70 6c65       For example
-00018e00: 2c20 6966 2061 2066 6561 7475 7265 2076  , if a feature v
-00018e10: 6965 7720 6861 7320 6120 6060 6261 7463  iew has a ``batc
-00018e20: 685f 7363 6865 6475 6c65 6060 206f 6620  h_schedule`` of 
-00018e30: 3120 6461 7920 616e 6420 6f6e 6520 6f66  1 day and one of
-00018e40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018e60: 2020 2020 2074 6865 2064 6174 6120 736f       the data so
-00018e70: 7572 6365 2069 6e70 7574 7320 6861 7320  urce inputs has 
-00018e80: 6120 6060 6461 7461 5f64 656c 6179 6060  a ``data_delay``
-00018e90: 206f 6620 3120 686f 7572 2c20 7468 656e   of 1 hour, then
-00018ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018ec0: 2020 2020 2069 6e63 7265 6d65 6e74 616c       incremental
-00018ed0: 206d 6174 6572 6961 6c69 7a61 7469 6f6e   materialization
-00018ee0: 206a 6f62 7320 7769 6c6c 2072 756e 2061   jobs will run a
-00018ef0: 7420 6060 3031 3a30 3060 6020 5554 432e  t ``01:00`` UTC.
-00018f00: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00018f10: 7375 7070 6f72 7473 5f74 696d 655f 6669  supports_time_fi
-00018f20: 6c74 6572 696e 673a 2057 6865 6e20 7365  ltering: When se
-00018f30: 7420 746f 2060 6054 7275 6560 602c 2074  t to ``True``, t
-00018f40: 6865 2044 6174 6120 536f 7572 6365 2046  he Data Source F
-00018f50: 756e 6374 696f 6e20 6d75 7374 2074 616b  unction must tak
-00018f60: 6520 7468 6520 6060 6669 6c74 6572 5f63  e the ``filter_c
-00018f70: 6f6e 7465 7874 6060 0a20 2020 2020 2020  ontext``.       
-00018f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018f90: 2020 2020 2020 2020 2020 2020 2070 6172               par
-00018fa0: 616d 6574 6572 2061 6e64 2069 6d70 6c65  ameter and imple
-00018fb0: 6d65 6e74 2074 696d 6520 6669 6c74 6572  ment time filter
-00018fc0: 696e 6720 6c6f 6769 632e 0a20 2020 2020  ing logic..     
-00018fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018fe0: 2020 2020 2020 2020 2020 2020 2020 2060                 `
-00018ff0: 6073 7570 706f 7274 735f 7469 6d65 5f66  `supports_time_f
-00019000: 696c 7465 7269 6e67 6060 206d 7573 7420  iltering`` must 
-00019010: 6265 2073 6574 2074 6f20 6054 7275 6560  be set to `True`
-00019020: 2069 6620 6060 3c64 6174 6120 736f 7572   if ``<data sour
-00019030: 6365 3e2e 6765 745f 6461 7461 6672 616d  ce>.get_datafram
-00019040: 6528 2960 6020 6973 2063 616c 6c65 6420  e()`` is called 
-00019050: 7769 7468 2060 6073 7461 7274 5f74 696d  with ``start_tim
-00019060: 6560 600a 2020 2020 2020 2020 2020 2020  e``.            
-00019070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019080: 2020 2020 2020 2020 6f72 2060 6065 6e64          or ``end
-00019090: 5f74 696d 6560 602e 2060 6073 7570 706f  _time``. ``suppo
-000190a0: 7274 735f 7469 6d65 5f66 696c 7465 7269  rts_time_filteri
-000190b0: 6e67 6060 206d 7573 7420 616c 736f 2062  ng`` must also b
-000190c0: 6520 7365 7420 746f 2060 6054 7275 6560  e set to ``True`
-000190d0: 6020 6966 2075 7369 6e67 203a 636c 6173  ` if using :clas
-000190e0: 733a 6074 6563 746f 6e2e 6465 636c 6172  s:`tecton.declar
-000190f0: 6174 6976 652e 4669 6c74 6572 6564 536f  ative.FilteredSo
-00019100: 7572 6365 600a 2020 2020 2020 2020 2020  urce`.          
-00019110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019120: 2020 2020 2020 2020 2020 7769 7468 2061            with a
-00019130: 2044 6174 6120 536f 7572 6365 2077 6865   Data Source whe
-00019140: 6e20 6465 6669 6e69 6e67 2061 2060 6046  n defining a ``F
-00019150: 6561 7475 7265 5669 6577 6060 2e20 5468  eatureView``. Th
-00019160: 6520 6060 4665 6174 7572 6556 6965 7760  e ``FeatureView`
-00019170: 6020 7769 6c6c 2063 616c 6c0a 2020 2020  ` will call.    
-00019180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000191a0: 7468 6520 4461 7461 2053 6f75 7263 6520  the Data Source 
-000191b0: 4675 6e63 7469 6f6e 2077 6974 6820 7468  Function with th
-000191c0: 6520 3a63 6c61 7373 3a60 7465 6374 6f6e  e :class:`tecton
-000191d0: 2e46 696c 7465 7243 6f6e 7465 7874 602c  .FilterContext`,
-000191e0: 2077 6869 6368 2068 6173 2074 6865 2060   which has the `
-000191f0: 6073 7461 7274 5f74 696d 6560 6020 616e  `start_time`` an
-00019200: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-00019210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019220: 2020 2020 2020 6060 656e 645f 7469 6d65        ``end_time
-00019230: 6060 2073 6574 2e0a 2020 2020 2020 2020  `` set..        
-00019240: 3a70 6172 616d 2073 6563 7265 7473 3a20  :param secrets: 
-00019250: 4120 6469 6374 696f 6e61 7279 206f 6620  A dictionary of 
-00019260: 5365 6372 6574 2072 6566 6572 656e 6365  Secret reference
-00019270: 7320 7468 6174 2077 696c 6c20 6265 2072  s that will be r
-00019280: 6573 6f6c 7665 6420 616e 6420 7072 6f76  esolved and prov
-00019290: 6964 6564 2074 6f20 7468 6520 4461 7461  ided to the Data
-000192a0: 2053 6f75 7263 6520 4675 6e63 7469 6f6e   Source Function
+00016b90: 2020 2020 2020 2020 2020 2020 2020 6f72                or
+00016ba0: 2060 6065 6e64 5f74 696d 6560 602e 2060   ``end_time``. `
+00016bb0: 6073 7570 706f 7274 735f 7469 6d65 5f66  `supports_time_f
+00016bc0: 696c 7465 7269 6e67 6060 206d 7573 7420  iltering`` must 
+00016bd0: 616c 736f 2062 6520 7365 7420 746f 2060  also be set to `
+00016be0: 6054 7275 6560 6020 6966 2075 7369 6e67  `True`` if using
+00016bf0: 203a 636c 6173 733a 6074 6563 746f 6e2e   :class:`tecton.
+00016c00: 6465 636c 6172 6174 6976 652e 4669 6c74  declarative.Filt
+00016c10: 6572 6564 536f 7572 6365 600a 2020 2020  eredSource`.    
+00016c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016c40: 7769 7468 2061 2044 6174 6120 536f 7572  with a Data Sour
+00016c50: 6365 2077 6865 6e20 6465 6669 6e69 6e67  ce when defining
+00016c60: 2061 2060 6046 6561 7475 7265 5669 6577   a ``FeatureView
+00016c70: 6060 2e20 5468 6520 6060 4665 6174 7572  ``. The ``Featur
+00016c80: 6556 6965 7760 6020 7769 6c6c 2063 616c  eView`` will cal
+00016c90: 6c0a 2020 2020 2020 2020 2020 2020 2020  l.              
+00016ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016cb0: 2020 2020 2020 7468 6520 4461 7461 2053        the Data S
+00016cc0: 6f75 7263 6520 4675 6e63 7469 6f6e 2077  ource Function w
+00016cd0: 6974 6820 7468 6520 3a63 6c61 7373 3a60  ith the :class:`
+00016ce0: 7465 6374 6f6e 2e46 696c 7465 7243 6f6e  tecton.FilterCon
+00016cf0: 7465 7874 602c 2077 6869 6368 2068 6173  text`, which has
+00016d00: 2074 6865 2060 6073 7461 7274 5f74 696d   the ``start_tim
+00016d10: 6560 6020 616e 640a 2020 2020 2020 2020  e`` and.        
+00016d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016d30: 2020 2020 2020 2020 2020 2020 6060 656e              ``en
+00016d40: 645f 7469 6d65 6060 2073 6574 2e0a 0a20  d_time`` set... 
+00016d50: 2020 2045 7861 6d70 6c65 2064 6566 696e     Example defin
+00016d60: 696e 6720 6120 4461 7461 2053 6f75 7263  ing a Data Sourc
+00016d70: 6520 4675 6e63 7469 6f6e 2075 7369 6e67  e Function using
+00016d80: 2060 6073 7061 726b 5f62 6174 6368 5f63   ``spark_batch_c
+00016d90: 6f6e 6669 6760 603a 0a0a 2020 2020 2e2e  onfig``:..    ..
+00016da0: 2063 6f64 652d 626c 6f63 6b3a 3a20 7079   code-block:: py
+00016db0: 7468 6f6e 0a0a 2020 2020 2020 2020 6672  thon..        fr
+00016dc0: 6f6d 2074 6563 746f 6e20 696d 706f 7274  om tecton import
+00016dd0: 2073 7061 726b 5f62 6174 6368 5f63 6f6e   spark_batch_con
+00016de0: 6669 670a 0a20 2020 2020 2020 2040 7370  fig..        @sp
+00016df0: 6172 6b5f 6261 7463 685f 636f 6e66 6967  ark_batch_config
+00016e00: 2873 7570 706f 7274 735f 7469 6d65 5f66  (supports_time_f
+00016e10: 696c 7465 7269 6e67 3d54 7275 6529 0a20  iltering=True). 
+00016e20: 2020 2020 2020 2064 6566 2072 6564 7368         def redsh
+00016e30: 6966 745f 6461 7461 5f73 6f75 7263 655f  ift_data_source_
+00016e40: 6675 6e63 7469 6f6e 2873 7061 726b 2c20  function(spark, 
+00016e50: 6669 6c74 6572 5f63 6f6e 7465 7874 293a  filter_context):
+00016e60: 0a20 2020 2020 2020 2020 2020 2073 7061  .            spa
+00016e70: 726b 5f66 6f72 6d61 7420 3d20 2263 6f6d  rk_format = "com
+00016e80: 2e64 6174 6162 7269 636b 732e 7370 6172  .databricks.spar
+00016e90: 6b2e 7265 6473 6869 6674 220a 2020 2020  k.redshift".    
+00016ea0: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+00016eb0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+00016ec0: 2020 2022 7573 6572 223a 2022 3c75 7365     "user": "<use
+00016ed0: 7220 6e61 6d65 3e22 2c0a 2020 2020 2020  r name>",.      
+00016ee0: 2020 2020 2020 2020 2020 2270 6173 7377            "passw
+00016ef0: 6f72 6422 3a20 6f73 2e65 6e76 6972 6f6e  ord": os.environ
+00016f00: 5b22 7265 6473 6869 6674 5f70 6173 7377  ["redshift_passw
+00016f10: 6f72 6422 5d0a 2020 2020 2020 2020 2020  ord"].          
+00016f20: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
+00016f30: 656e 6470 6f69 6e74 203d 2022 3c72 6564  endpoint = "<red
+00016f40: 7368 6966 7420 656e 6470 6f69 6e74 3e22  shift endpoint>"
+00016f50: 0a20 2020 2020 2020 2020 2020 2066 756c  .            ful
+00016f60: 6c5f 636f 6e6e 6563 7469 6f6e 5f73 7472  l_connection_str
+00016f70: 696e 6720 3d20 6622 6a64 6263 3a72 6564  ing = f"jdbc:red
+00016f80: 7368 6966 743a 2f2f 7b65 6e64 706f 696e  shift://{endpoin
+00016f90: 747d 3b75 7365 723d 7b70 6172 616d 735b  t};user={params[
+00016fa0: 2775 7365 7227 5d7d 3b70 6173 7377 6f72  'user']};passwor
+00016fb0: 643d 7b70 6172 616d 735b 2770 6173 7377  d={params['passw
+00016fc0: 6f72 6427 5d7d 220a 2020 2020 2020 2020  ord']}".        
+00016fd0: 2020 2020 6466 5f72 6561 6465 7220 3d20      df_reader = 
+00016fe0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00016ff0: 2020 7370 6172 6b2e 7265 6164 2e66 6f72    spark.read.for
+00017000: 6d61 7428 7370 6172 6b5f 666f 726d 6174  mat(spark_format
+00017010: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00017020: 2020 2e6f 7074 696f 6e28 2275 726c 222c    .option("url",
+00017030: 2066 756c 6c5f 636f 6e6e 6563 7469 6f6e   full_connection
+00017040: 5f73 7472 696e 6729 0a20 2020 2020 2020  _string).       
+00017050: 2020 2020 2020 2020 202e 6f70 7469 6f6e           .option
+00017060: 2822 666f 7277 6172 645f 7370 6172 6b5f  ("forward_spark_
+00017070: 7333 5f63 7265 6465 6e74 6961 6c73 222c  s3_credentials",
+00017080: 2022 7472 7565 2229 0a20 2020 2020 2020   "true").       
+00017090: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+000170a0: 2020 2064 665f 7265 6164 6572 203d 2064     df_reader = d
+000170b0: 665f 7265 6164 6572 2e6f 7074 696f 6e28  f_reader.option(
+000170c0: 2264 6274 6162 6c65 222c 2022 796f 7572  "dbtable", "your
+000170d0: 5f74 6162 6c65 5f6e 616d 6522 290a 2020  _table_name").  
+000170e0: 2020 2020 2020 2020 2020 6466 203d 2064            df = d
+000170f0: 665f 7265 6164 6572 5f6c 6f61 6428 290a  f_reader_load().
+00017100: 2020 2020 2020 2020 2020 2020 7473 5f63              ts_c
+00017110: 6f6c 756d 6e20 3d20 2274 696d 6573 7461  olumn = "timesta
+00017120: 6d70 220a 2020 2020 2020 2020 2020 2020  mp".            
+00017130: 6466 203d 2064 662e 7769 7468 436f 6c75  df = df.withColu
+00017140: 6d6e 2874 735f 636f 6c75 6d6e 2c20 636f  mn(ts_column, co
+00017150: 6c28 7473 5f63 6f6c 756d 6e29 2e63 6173  l(ts_column).cas
+00017160: 7428 2274 696d 6573 7461 6d70 2229 290a  t("timestamp")).
+00017170: 2020 2020 2020 2020 2020 2020 2320 4861              # Ha
+00017180: 6e64 6c65 2074 696d 6520 6669 6c74 6572  ndle time filter
+00017190: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
+000171a0: 6966 2066 696c 7465 725f 636f 6e74 6578  if filter_contex
+000171b0: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+000171c0: 2020 2069 6620 6669 6c74 6572 5f63 6f6e     if filter_con
+000171d0: 7465 7874 2e73 7461 7274 5f74 696d 653a  text.start_time:
+000171e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000171f0: 2020 2020 2064 6620 3d20 6466 2e77 6865       df = df.whe
+00017200: 7265 2863 6f6c 2874 735f 636f 6c75 6d6e  re(col(ts_column
+00017210: 2920 3e3d 2066 696c 7465 725f 636f 6e74  ) >= filter_cont
+00017220: 6578 742e 7374 6172 745f 7469 6d65 290a  ext.start_time).
+00017230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017240: 6966 2066 696c 7465 725f 636f 6e74 6578  if filter_contex
+00017250: 742e 656e 645f 7469 6d65 3a0a 2020 2020  t.end_time:.    
+00017260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017270: 6466 203d 2064 662e 7768 6572 6528 636f  df = df.where(co
+00017280: 6c28 7473 5f63 6f6c 756d 6e29 203c 2066  l(ts_column) < f
+00017290: 696c 7465 725f 636f 6e74 6578 742e 656e  ilter_context.en
+000172a0: 645f 7469 6d65 290a 2020 2020 2020 2020  d_time).        
+000172b0: 2020 2020 7265 7475 726e 2064 660a 2020      return df.  
+000172c0: 2020 2222 220a 0a20 2020 2064 6566 2064    """..    def d
+000172d0: 6563 6f72 6174 6f72 2864 6174 615f 736f  ecorator(data_so
+000172e0: 7572 6365 5f66 756e 6374 696f 6e29 3a0a  urce_function):.
+000172f0: 2020 2020 2020 2020 6261 7463 685f 636f          batch_co
+00017300: 6e66 6967 203d 2053 7061 726b 4261 7463  nfig = SparkBatc
+00017310: 6843 6f6e 6669 6728 0a20 2020 2020 2020  hConfig(.       
+00017320: 2020 2020 2064 6174 615f 736f 7572 6365       data_source
+00017330: 5f66 756e 6374 696f 6e3d 6461 7461 5f73  _function=data_s
+00017340: 6f75 7263 655f 6675 6e63 7469 6f6e 2c0a  ource_function,.
+00017350: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00017360: 5f64 656c 6179 3d64 6174 615f 6465 6c61  _delay=data_dela
+00017370: 792c 0a20 2020 2020 2020 2020 2020 2073  y,.            s
+00017380: 7570 706f 7274 735f 7469 6d65 5f66 696c  upports_time_fil
+00017390: 7465 7269 6e67 3d73 7570 706f 7274 735f  tering=supports_
+000173a0: 7469 6d65 5f66 696c 7465 7269 6e67 2c0a  time_filtering,.
+000173b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000173c0: 2020 6675 6e63 746f 6f6c 732e 7570 6461    functools.upda
+000173d0: 7465 5f77 7261 7070 6572 2877 7261 7070  te_wrapper(wrapp
+000173e0: 6572 3d62 6174 6368 5f63 6f6e 6669 672c  er=batch_config,
+000173f0: 2077 7261 7070 6564 3d64 6174 615f 736f   wrapped=data_so
+00017400: 7572 6365 5f66 756e 6374 696f 6e29 0a20  urce_function). 
+00017410: 2020 2020 2020 2072 6574 7572 6e20 6261         return ba
+00017420: 7463 685f 636f 6e66 6967 0a0a 2020 2020  tch_config..    
+00017430: 7265 7475 726e 2064 6563 6f72 6174 6f72  return decorator
+00017440: 0a0a 0a63 6c61 7373 2053 7061 726b 5374  ...class SparkSt
+00017450: 7265 616d 436f 6e66 6967 2842 6173 6553  reamConfig(BaseS
+00017460: 7472 6561 6d43 6f6e 6669 6729 3a0a 2020  treamConfig):.  
+00017470: 2020 2222 220a 2020 2020 436f 6e66 6967    """.    Config
+00017480: 7572 6174 696f 6e20 7573 6564 2074 6f20  uration used to 
+00017490: 6465 6669 6e65 2061 2073 7472 6561 6d20  define a stream 
+000174a0: 736f 7572 6365 2075 7369 6e67 2061 2044  source using a D
+000174b0: 6174 6120 536f 7572 6365 2046 756e 6374  ata Source Funct
+000174c0: 696f 6e2e 0a0a 2020 2020 5468 6520 6060  ion...    The ``
+000174d0: 5370 6172 6b53 7472 6561 6d43 6f6e 6669  SparkStreamConfi
+000174e0: 6760 6020 636c 6173 7320 6973 2075 7365  g`` class is use
+000174f0: 6420 746f 2063 6f6e 6669 6775 7265 2061  d to configure a
+00017500: 2073 7472 6561 6d20 736f 7572 6365 2075   stream source u
+00017510: 7369 6e67 2061 2075 7365 7220 6465 6669  sing a user defi
+00017520: 6e65 6420 4461 7461 2053 6f75 7263 6520  ned Data Source 
+00017530: 4675 6e63 7469 6f6e 2e0a 0a20 2020 2054  Function...    T
+00017540: 6869 7320 636c 6173 7320 6973 2075 7365  his class is use
+00017550: 6420 6173 2061 6e20 696e 7075 7420 746f  d as an input to
+00017560: 2061 203a 636c 6173 733a 6053 7472 6561   a :class:`Strea
+00017570: 6d53 6f75 7263 6560 2773 2070 6172 616d  mSource`'s param
+00017580: 6574 6572 2060 6073 7472 6561 6d5f 636f  eter ``stream_co
+00017590: 6e66 6967 6060 2e20 4465 636c 6172 696e  nfig``. Declarin
+000175a0: 6720 7468 6973 2063 6f6e 6669 6775 7261  g this configura
+000175b0: 7469 6f6e 0a20 2020 2063 6c61 7373 2061  tion.    class a
+000175c0: 6c6f 6e65 2077 696c 6c20 6e6f 7420 7265  lone will not re
+000175d0: 6769 7374 6572 2061 2044 6174 6120 536f  gister a Data So
+000175e0: 7572 6365 2e20 496e 7374 6561 642c 2064  urce. Instead, d
+000175f0: 6563 6c61 7265 2061 7320 6120 7061 7274  eclare as a part
+00017600: 206f 6620 6060 5374 7265 616d 536f 7572   of ``StreamSour
+00017610: 6365 6060 2074 6861 7420 7461 6b65 7320  ce`` that takes 
+00017620: 7468 6973 2063 6f6e 6669 6775 7261 7469  this configurati
+00017630: 6f6e 0a20 2020 2063 6c61 7373 2069 6e73  on.    class ins
+00017640: 7461 6e63 6520 6173 2061 2070 6172 616d  tance as a param
+00017650: 6574 6572 2e0a 0a20 2020 202a 2a44 6f20  eter...    **Do 
+00017660: 6e6f 7420 696e 7374 616e 7469 6174 6520  not instantiate 
+00017670: 7468 6973 2063 6c61 7373 2064 6972 6563  this class direc
+00017680: 746c 792e 2a2a 2055 7365 203a 7079 3a66  tly.** Use :py:f
+00017690: 756e 633a 6074 6563 746f 6e2e 7370 6172  unc:`tecton.spar
+000176a0: 6b5f 7374 7265 616d 5f63 6f6e 6669 6760  k_stream_config`
+000176b0: 2069 6e73 7465 6164 2e0a 2020 2020 2222   instead..    ""
+000176c0: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
+000176d0: 745f 5f28 7365 6c66 2c20 6461 7461 5f73  t__(self, data_s
+000176e0: 6f75 7263 655f 6675 6e63 7469 6f6e 3a20  ource_function: 
+000176f0: 4361 6c6c 6162 6c65 5b5b 5370 6172 6b53  Callable[[SparkS
+00017700: 6573 7369 6f6e 5d2c 2044 6174 6146 7261  ession], DataFra
+00017710: 6d65 5d29 3a0a 2020 2020 2020 2020 2222  me]):.        ""
+00017720: 220a 2020 2020 2020 2020 496e 7374 616e  ".        Instan
+00017730: 7469 6174 6573 2061 206e 6577 2053 7061  tiates a new Spa
+00017740: 726b 4261 7463 6843 6f6e 6669 672e 0a0a  rkBatchConfig...
+00017750: 2020 2020 2020 2020 3a70 6172 616d 2064          :param d
+00017760: 6174 615f 736f 7572 6365 5f66 756e 6374  ata_source_funct
+00017770: 696f 6e3a 2055 7365 722d 6465 6669 6e65  ion: User-define
+00017780: 6420 4461 7461 2053 6f75 7263 6520 4675  d Data Source Fu
+00017790: 6e63 7469 6f6e 2074 6861 7420 7461 6b65  nction that take
+000177a0: 7320 696e 2061 2060 6053 7061 726b 5365  s in a ``SparkSe
+000177b0: 7373 696f 6e60 6020 616e 6420 7265 7475  ssion`` and retu
+000177c0: 726e 730a 2020 2020 2020 2020 2020 2020  rns.            
+000177d0: 2020 2020 2020 2020 6120 7374 7265 616d          a stream
+000177e0: 696e 6720 6060 4461 7461 4672 616d 6560  ing ``DataFrame`
+000177f0: 602e 0a0a 2020 2020 2020 2020 3a72 6574  `...        :ret
+00017800: 7572 6e3a 2041 2053 7061 726b 5374 7265  urn: A SparkStre
+00017810: 616d 436f 6e66 6967 2063 6c61 7373 2069  amConfig class i
+00017820: 6e73 7461 6e63 652e 0a20 2020 2020 2020  nstance..       
+00017830: 2022 2222 0a20 2020 2020 2020 2070 6172   """.        par
+00017840: 616d 7320 3d20 6c69 7374 2869 6e73 7065  ams = list(inspe
+00017850: 6374 2e73 6967 6e61 7475 7265 2864 6174  ct.signature(dat
+00017860: 615f 736f 7572 6365 5f66 756e 6374 696f  a_source_functio
+00017870: 6e29 2e70 6172 616d 6574 6572 7329 0a20  n).parameters). 
+00017880: 2020 2020 2020 2066 756e 6374 696f 6e5f         function_
+00017890: 6e61 6d65 203d 2064 6174 615f 736f 7572  name = data_sour
+000178a0: 6365 5f66 756e 6374 696f 6e2e 5f5f 6e61  ce_function.__na
+000178b0: 6d65 5f5f 0a20 2020 2020 2020 2069 6620  me__.        if 
+000178c0: 7061 7261 6d73 2021 3d20 5b22 7370 6172  params != ["spar
+000178d0: 6b22 5d3a 0a20 2020 2020 2020 2020 2020  k"]:.           
+000178e0: 206d 7367 203d 2066 2244 6174 6120 536f   msg = f"Data So
+000178f0: 7572 6365 2046 756e 6374 696f 6e20 7b66  urce Function {f
+00017900: 756e 6374 696f 6e5f 6e61 6d65 7d27 7320  unction_name}'s 
+00017910: 7265 7175 6972 6564 2073 6967 6e61 7475  required signatu
+00017920: 7265 2069 7320 607b 6675 6e63 7469 6f6e  re is `{function
+00017930: 5f6e 616d 657d 2873 7061 726b 2960 220a  _name}(spark)`".
+00017940: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00017950: 6520 4173 7365 7274 696f 6e45 7272 6f72  e AssertionError
+00017960: 286d 7367 290a 0a20 2020 2020 2020 2073  (msg)..        s
+00017970: 656c 662e 5f61 7267 7320 3d20 6461 7461  elf._args = data
+00017980: 5f73 6f75 7263 655f 7062 322e 5370 6172  _source_pb2.Spar
+00017990: 6b53 7472 6561 6d43 6f6e 6669 6741 7267  kStreamConfigArg
+000179a0: 7328 290a 2020 2020 2020 2020 6966 2066  s().        if f
+000179b0: 756e 6374 696f 6e5f 7365 7269 616c 697a  unction_serializ
+000179c0: 6174 696f 6e2e 7368 6f75 6c64 5f73 6572  ation.should_ser
+000179d0: 6961 6c69 7a65 5f66 756e 6374 696f 6e28  ialize_function(
+000179e0: 6461 7461 5f73 6f75 7263 655f 6675 6e63  data_source_func
+000179f0: 7469 6f6e 293a 0a20 2020 2020 2020 2020  tion):.         
+00017a00: 2020 2073 656c 662e 5f61 7267 732e 6461     self._args.da
+00017a10: 7461 5f73 6f75 7263 655f 6675 6e63 7469  ta_source_functi
+00017a20: 6f6e 2e43 6f70 7946 726f 6d28 6675 6e63  on.CopyFrom(func
+00017a30: 7469 6f6e 5f73 6572 6961 6c69 7a61 7469  tion_serializati
+00017a40: 6f6e 2e74 6f5f 7072 6f74 6f28 6461 7461  on.to_proto(data
+00017a50: 5f73 6f75 7263 655f 6675 6e63 7469 6f6e  _source_function
+00017a60: 2929 0a20 2020 2020 2020 2073 656c 662e  )).        self.
+00017a70: 6461 7461 5f73 6f75 7263 655f 6675 6e63  data_source_func
+00017a80: 7469 6f6e 203d 2064 6174 615f 736f 7572  tion = data_sour
+00017a90: 6365 5f66 756e 6374 696f 6e0a 0a20 2020  ce_function..   
+00017aa0: 2064 6566 205f 6d65 7267 655f 7374 7265   def _merge_stre
+00017ab0: 616d 5f61 7267 7328 7365 6c66 2c20 6461  am_args(self, da
+00017ac0: 7461 5f73 6f75 7263 655f 6172 6773 3a20  ta_source_args: 
+00017ad0: 7669 7274 7561 6c5f 6461 7461 5f73 6f75  virtual_data_sou
+00017ae0: 7263 655f 7062 322e 5669 7274 7561 6c44  rce_pb2.VirtualD
+00017af0: 6174 6153 6f75 7263 6541 7267 7329 3a0a  ataSourceArgs):.
+00017b00: 2020 2020 2020 2020 6461 7461 5f73 6f75          data_sou
+00017b10: 7263 655f 6172 6773 2e73 7061 726b 5f73  rce_args.spark_s
+00017b20: 7472 6561 6d5f 636f 6e66 6967 2e43 6f70  tream_config.Cop
+00017b30: 7946 726f 6d28 7365 6c66 2e5f 6172 6773  yFrom(self._args
+00017b40: 290a 0a20 2020 2064 6566 205f 5f63 616c  )..    def __cal
+00017b50: 6c5f 5f28 7365 6c66 2c20 2a61 7267 732c  l__(self, *args,
+00017b60: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+00017b70: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00017b80: 6461 7461 5f73 6f75 7263 655f 6675 6e63  data_source_func
+00017b90: 7469 6f6e 282a 6172 6773 2c20 2a2a 6b77  tion(*args, **kw
+00017ba0: 6172 6773 290a 0a0a 6465 6620 7370 6172  args)...def spar
+00017bb0: 6b5f 7374 7265 616d 5f63 6f6e 6669 6728  k_stream_config(
+00017bc0: 293a 0a20 2020 2022 2222 0a20 2020 2044  ):.    """.    D
+00017bd0: 6563 6c61 7265 2061 203a 636c 6173 733a  eclare a :class:
+00017be0: 6074 6563 746f 6e2e 5370 6172 6b53 7472  `tecton.SparkStr
+00017bf0: 6561 6d43 6f6e 6669 6760 2066 6f72 2063  eamConfig` for c
+00017c00: 6f6e 6669 6775 7269 6e67 2061 2053 7472  onfiguring a Str
+00017c10: 6561 6d20 536f 7572 6365 2077 6974 6820  eam Source with 
+00017c20: 6120 4461 7461 2053 6f75 7263 6520 4675  a Data Source Fu
+00017c30: 6e63 7469 6f6e 2e20 5468 6520 6675 6e63  nction. The func
+00017c40: 7469 6f6e 2074 616b 6573 2069 6e20 6120  tion takes in a 
+00017c50: 6060 5370 6172 6b53 6573 7369 6f6e 6060  ``SparkSession``
+00017c60: 2072 6574 7572 6e73 2061 2073 7472 6561   returns a strea
+00017c70: 6d69 6e67 2060 6044 6174 6146 7261 6d65  ming ``DataFrame
+00017c80: 6060 2e0a 0a20 2020 2045 7861 6d70 6c65  ``...    Example
+00017c90: 2064 6566 696e 696e 6720 6120 4461 7461   defining a Data
+00017ca0: 2053 6f75 7263 6520 4675 6e63 7469 6f6e   Source Function
+00017cb0: 2075 7369 6e67 2060 6073 7061 726b 5f73   using ``spark_s
+00017cc0: 7472 6561 6d5f 636f 6e66 6967 6060 3a0a  tream_config``:.
+00017cd0: 0a20 2020 202e 2e20 636f 6465 2d62 6c6f  .    .. code-blo
+00017ce0: 636b 3a3a 2070 7974 686f 6e0a 0a20 2020  ck:: python..   
+00017cf0: 2020 2020 2066 726f 6d20 7465 6374 6f6e       from tecton
+00017d00: 2069 6d70 6f72 7420 7370 6172 6b5f 7374   import spark_st
+00017d10: 7265 616d 5f63 6f6e 6669 670a 0a20 2020  ream_config..   
+00017d20: 2020 2020 2064 6566 2072 6177 5f64 6174       def raw_dat
+00017d30: 615f 6465 7365 7269 616c 697a 6174 696f  a_deserializatio
+00017d40: 6e28 6466 293a 0a20 2020 2020 2020 2020  n(df):.         
+00017d50: 2020 2066 726f 6d20 7079 7370 6172 6b2e     from pyspark.
+00017d60: 7371 6c2e 6675 6e63 7469 6f6e 7320 696d  sql.functions im
+00017d70: 706f 7274 2063 6f6c 2c20 6672 6f6d 5f6a  port col, from_j
+00017d80: 736f 6e2c 2066 726f 6d5f 7574 635f 7469  son, from_utc_ti
+00017d90: 6d65 7374 616d 702c 2077 6865 6e0a 2020  mestamp, when.  
+00017da0: 2020 2020 2020 2020 2020 6672 6f6d 2070            from p
+00017db0: 7973 7061 726b 2e73 716c 2e74 7970 6573  yspark.sql.types
+00017dc0: 2069 6d70 6f72 7420 5374 7275 6374 5479   import StructTy
+00017dd0: 7065 2c20 5374 7275 6374 4669 656c 642c  pe, StructField,
+00017de0: 2053 7472 696e 6754 7970 652c 2044 6f75   StringType, Dou
+00017df0: 626c 6554 7970 652c 2054 696d 6573 7461  bleType, Timesta
+00017e00: 6d70 5479 7065 2c20 426f 6f6c 6561 6e54  mpType, BooleanT
+00017e10: 7970 652c 2049 6e74 6567 6572 5479 7065  ype, IntegerType
+00017e20: 0a20 2020 2020 2020 2020 2020 2070 6179  .            pay
+00017e30: 6c6f 6164 5f73 6368 656d 6120 3d20 5374  load_schema = St
+00017e40: 7275 6374 5479 7065 285b 0a20 2020 2020  ructType([.     
+00017e50: 2020 2020 2020 2020 2020 2053 7472 7563             Struc
+00017e60: 7446 6965 6c64 2822 7573 6572 5f69 6422  tField("user_id"
+00017e70: 2c20 5374 7269 6e67 5479 7065 2829 2c20  , StringType(), 
+00017e80: 4661 6c73 6529 2c0a 2020 2020 2020 2020  False),.        
+00017e90: 2020 2020 2020 2020 5374 7275 6374 4669          StructFi
+00017ea0: 656c 6428 2274 7261 6e73 6163 7469 6f6e  eld("transaction
+00017eb0: 5f69 6422 2c20 5374 7269 6e67 5479 7065  _id", StringType
+00017ec0: 2829 2c20 4661 6c73 6529 2c0a 2020 2020  (), False),.    
+00017ed0: 2020 2020 2020 2020 2020 2020 5374 7275              Stru
+00017ee0: 6374 4669 656c 6428 2263 6174 6567 6f72  ctField("categor
+00017ef0: 7922 2c20 5374 7269 6e67 5479 7065 2829  y", StringType()
+00017f00: 2c20 4661 6c73 6529 2c0a 2020 2020 2020  , False),.      
+00017f10: 2020 2020 2020 2020 2020 5374 7275 6374            Struct
+00017f20: 4669 656c 6428 2261 6d74 222c 2053 7472  Field("amt", Str
+00017f30: 696e 6754 7970 6528 292c 2046 616c 7365  ingType(), False
+00017f40: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00017f50: 2020 2053 7472 7563 7446 6965 6c64 2822     StructField("
+00017f60: 7469 6d65 7374 616d 7022 2c20 5374 7269  timestamp", Stri
+00017f70: 6e67 5479 7065 2829 2c20 4661 6c73 6529  ngType(), False)
+00017f80: 2c0a 2020 2020 2020 2020 2020 2020 5d29  ,.            ])
+00017f90: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00017fa0: 7572 6e20 280a 2020 2020 2020 2020 2020  urn (.          
+00017fb0: 2020 2020 2020 6466 2e73 656c 6563 7445        df.selectE
+00017fc0: 7870 7228 2263 6173 7420 2864 6174 6120  xpr("cast (data 
+00017fd0: 6173 2053 5452 494e 4729 206a 736f 6e44  as STRING) jsonD
+00017fe0: 6174 6122 290a 2020 2020 2020 2020 2020  ata").          
+00017ff0: 2020 2020 2020 2e73 656c 6563 7428 6672        .select(fr
+00018000: 6f6d 5f6a 736f 6e28 226a 736f 6e44 6174  om_json("jsonDat
+00018010: 6122 2c20 7061 796c 6f61 645f 7363 6865  a", payload_sche
+00018020: 6d61 292e 616c 6961 7328 2270 6179 6c6f  ma).alias("paylo
+00018030: 6164 2229 290a 2020 2020 2020 2020 2020  ad")).          
+00018040: 2020 2020 2020 2e73 656c 6563 7428 0a20        .select(. 
+00018050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018060: 2020 2063 6f6c 2822 7061 796c 6f61 642e     col("payload.
+00018070: 7573 6572 5f69 6422 292e 616c 6961 7328  user_id").alias(
+00018080: 2275 7365 725f 6964 2229 2c0a 2020 2020  "user_id"),.    
+00018090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000180a0: 636f 6c28 2270 6179 6c6f 6164 2e74 7261  col("payload.tra
+000180b0: 6e73 6163 7469 6f6e 5f69 6422 292e 616c  nsaction_id").al
+000180c0: 6961 7328 2274 7261 6e73 6163 7469 6f6e  ias("transaction
+000180d0: 5f69 6422 292c 0a20 2020 2020 2020 2020  _id"),.         
+000180e0: 2020 2020 2020 2020 2020 2063 6f6c 2822             col("
+000180f0: 7061 796c 6f61 642e 6361 7465 676f 7279  payload.category
+00018100: 2229 2e61 6c69 6173 2822 6361 7465 676f  ").alias("catego
+00018110: 7279 2229 2c0a 2020 2020 2020 2020 2020  ry"),.          
+00018120: 2020 2020 2020 2020 2020 636f 6c28 2270            col("p
+00018130: 6179 6c6f 6164 2e61 6d74 2229 2e63 6173  ayload.amt").cas
+00018140: 7428 2264 6f75 626c 6522 292e 616c 6961  t("double").alia
+00018150: 7328 2261 6d74 2229 2c0a 2020 2020 2020  s("amt"),.      
+00018160: 2020 2020 2020 2020 2020 2020 2020 6672                fr
+00018170: 6f6d 5f75 7463 5f74 696d 6573 7461 6d70  om_utc_timestamp
+00018180: 2822 7061 796c 6f61 642e 7469 6d65 7374  ("payload.timest
+00018190: 616d 7022 2c20 2255 5443 2229 2e61 6c69  amp", "UTC").ali
+000181a0: 6173 2822 7469 6d65 7374 616d 7022 290a  as("timestamp").
+000181b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000181c0: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
+000181d0: 0a20 2020 2020 2020 2040 7370 6172 6b5f  .        @spark_
+000181e0: 7374 7265 616d 5f63 6f6e 6669 6728 290a  stream_config().
+000181f0: 2020 2020 2020 2020 6465 6620 6b69 6e65          def kine
+00018200: 7369 735f 6461 7461 5f73 6f75 7263 655f  sis_data_source_
+00018210: 6675 6e63 7469 6f6e 2873 7061 726b 293a  function(spark):
+00018220: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
+00018230: 696f 6e73 203d 207b 0a20 2020 2020 2020  ions = {.       
+00018240: 2020 2020 2020 2020 2022 7374 7265 616d           "stream
+00018250: 4e61 6d65 223a 2022 3c73 7472 6561 6d20  Name": "<stream 
+00018260: 6e61 6d65 3e22 2c0a 2020 2020 2020 2020  name>",.        
+00018270: 2020 2020 2020 2020 2272 6f6c 6541 726e          "roleArn
+00018280: 223a 2022 3c72 6f6c 6520 4152 4e3e 222c  ": "<role ARN>",
+00018290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000182a0: 2022 7265 6769 6f6e 223a 2022 3c72 6567   "region": "<reg
+000182b0: 696f 6e3e 222c 0a20 2020 2020 2020 2020  ion>",.         
+000182c0: 2020 2020 2020 2022 7368 6172 6446 6574         "shardFet
+000182d0: 6368 496e 7465 7276 616c 223a 2022 3330  chInterval": "30
+000182e0: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
+000182f0: 2020 2020 2269 6e69 7469 616c 506f 7369      "initialPosi
+00018300: 7469 6f6e 223a 2022 6c61 7465 7374 220a  tion": "latest".
+00018310: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
+00018320: 2020 2020 2020 2020 2020 7265 6164 6572            reader
+00018330: 203d 2073 7061 726b 2e72 6561 6453 7472   = spark.readStr
+00018340: 6561 6d2e 666f 726d 6174 2822 6b69 6e65  eam.format("kine
+00018350: 7369 7322 292e 6f70 7469 6f6e 7328 2a2a  sis").options(**
+00018360: 6f70 7469 6f6e 7329 0a20 2020 2020 2020  options).       
+00018370: 2020 2020 2064 6620 3d20 7265 6164 6572       df = reader
+00018380: 2e6c 6f61 6428 290a 2020 2020 2020 2020  .load().        
+00018390: 2020 2020 6466 203d 2072 6177 5f64 6174      df = raw_dat
+000183a0: 615f 6465 7365 7269 616c 697a 6174 696f  a_deserializatio
+000183b0: 6e28 6466 290a 2020 2020 2020 2020 2020  n(df).          
+000183c0: 2020 7761 7465 726d 6172 6b20 3d20 227b    watermark = "{
+000183d0: 7d20 7365 636f 6e64 7322 2e66 6f72 6d61  } seconds".forma
+000183e0: 7428 7469 6d65 6465 6c74 6128 686f 7572  t(timedelta(hour
+000183f0: 733d 3234 292e 7365 636f 6e64 7329 0a20  s=24).seconds). 
+00018400: 2020 2020 2020 2020 2020 2064 6620 3d20             df = 
+00018410: 6466 2e77 6974 6857 6174 6572 6d61 726b  df.withWatermark
+00018420: 2822 7469 6d65 7374 616d 7022 2c20 7761  ("timestamp", wa
+00018430: 7465 726d 6172 6b29 0a20 2020 2020 2020  termark).       
+00018440: 2020 2020 2072 6574 7572 6e20 6466 0a20       return df. 
+00018450: 2020 2022 2222 0a0a 2020 2020 6465 6620     """..    def 
+00018460: 6465 636f 7261 746f 7228 6461 7461 5f73  decorator(data_s
+00018470: 6f75 7263 655f 6675 6e63 7469 6f6e 293a  ource_function):
+00018480: 0a20 2020 2020 2020 2073 7472 6561 6d5f  .        stream_
+00018490: 636f 6e66 6967 203d 2053 7061 726b 5374  config = SparkSt
+000184a0: 7265 616d 436f 6e66 6967 280a 2020 2020  reamConfig(.    
+000184b0: 2020 2020 2020 2020 6461 7461 5f73 6f75          data_sou
+000184c0: 7263 655f 6675 6e63 7469 6f6e 3d64 6174  rce_function=dat
+000184d0: 615f 736f 7572 6365 5f66 756e 6374 696f  a_source_functio
+000184e0: 6e2c 0a20 2020 2020 2020 2029 0a20 2020  n,.        ).   
+000184f0: 2020 2020 2066 756e 6374 6f6f 6c73 2e75       functools.u
+00018500: 7064 6174 655f 7772 6170 7065 7228 7772  pdate_wrapper(wr
+00018510: 6170 7065 723d 7374 7265 616d 5f63 6f6e  apper=stream_con
+00018520: 6669 672c 2077 7261 7070 6564 3d64 6174  fig, wrapped=dat
+00018530: 615f 736f 7572 6365 5f66 756e 6374 696f  a_source_functio
+00018540: 6e29 0a20 2020 2020 2020 2072 6574 7572  n).        retur
+00018550: 6e20 7374 7265 616d 5f63 6f6e 6669 670a  n stream_config.
+00018560: 0a20 2020 2072 6574 7572 6e20 6465 636f  .    return deco
+00018570: 7261 746f 720a 0a0a 636c 6173 7320 5061  rator...class Pa
+00018580: 6e64 6173 4261 7463 6843 6f6e 6669 6728  ndasBatchConfig(
+00018590: 4261 7365 4261 7463 6843 6f6e 6669 6729  BaseBatchConfig)
+000185a0: 3a0a 2020 2020 2222 220a 2020 2020 436f  :.    """.    Co
+000185b0: 6e66 6967 7572 6174 696f 6e20 7573 6564  nfiguration used
+000185c0: 2074 6f20 6465 6669 6e65 2061 2062 6174   to define a bat
+000185d0: 6368 2073 6f75 7263 6520 7573 696e 6720  ch source using 
+000185e0: 6120 5061 6e64 6173 2044 6174 6120 536f  a Pandas Data So
+000185f0: 7572 6365 2046 756e 6374 696f 6e2e 0a20  urce Function.. 
+00018600: 2020 2054 6865 2060 6050 616e 6461 7342     The ``PandasB
+00018610: 6174 6368 436f 6e66 6967 6060 2063 6c61  atchConfig`` cla
+00018620: 7373 2069 7320 7573 6564 2074 6f20 636f  ss is used to co
+00018630: 6e66 6967 7572 6520 6120 6261 7463 6820  nfigure a batch 
+00018640: 736f 7572 6365 2075 7369 6e67 2061 2075  source using a u
+00018650: 7365 7220 6465 6669 6e65 6420 4461 7461  ser defined Data
+00018660: 2053 6f75 7263 6520 4675 6e63 7469 6f6e   Source Function
+00018670: 2e0a 2020 2020 5468 6973 2063 6c61 7373  ..    This class
+00018680: 2069 7320 7573 6564 2061 7320 616e 2069   is used as an i
+00018690: 6e70 7574 2074 6f20 6120 3a63 6c61 7373  nput to a :class
+000186a0: 3a60 4261 7463 6853 6f75 7263 6560 2773  :`BatchSource`'s
+000186b0: 2070 6172 616d 6574 6572 2060 6062 6174   parameter ``bat
+000186c0: 6368 5f63 6f6e 6669 6760 602e 2044 6563  ch_config``. Dec
+000186d0: 6c61 7269 6e67 2074 6869 7320 636f 6e66  laring this conf
+000186e0: 6967 7572 6174 696f 6e0a 2020 2020 636c  iguration.    cl
+000186f0: 6173 7320 616c 6f6e 6520 7769 6c6c 206e  ass alone will n
+00018700: 6f74 2072 6567 6973 7465 7220 6120 4461  ot register a Da
+00018710: 7461 2053 6f75 7263 652e 2049 6e73 7465  ta Source. Inste
+00018720: 6164 2c20 6465 636c 6172 6520 6173 2061  ad, declare as a
+00018730: 2070 6172 7420 6f66 2060 6042 6174 6368   part of ``Batch
+00018740: 536f 7572 6365 6060 2074 6861 7420 7461  Source`` that ta
+00018750: 6b65 7320 7468 6973 2063 6f6e 6669 6775  kes this configu
+00018760: 7261 7469 6f6e 0a20 2020 2063 6c61 7373  ration.    class
+00018770: 2069 6e73 7461 6e63 6520 6173 2061 2070   instance as a p
+00018780: 6172 616d 6574 6572 2e0a 2020 2020 2a2a  arameter..    **
+00018790: 446f 206e 6f74 2069 6e73 7461 6e74 6961  Do not instantia
+000187a0: 7465 2074 6869 7320 636c 6173 7320 6469  te this class di
+000187b0: 7265 6374 6c79 2e2a 2a20 5573 6520 3a70  rectly.** Use :p
+000187c0: 793a 6675 6e63 3a60 7465 6374 6f6e 2e70  y:func:`tecton.p
+000187d0: 616e 6461 735f 6261 7463 685f 636f 6e66  andas_batch_conf
+000187e0: 6967 6020 696e 7374 6561 642e 0a20 2020  ig` instead..   
+000187f0: 2022 2222 0a0a 2020 2020 636c 6173 7320   """..    class 
+00018800: 5061 6e64 6173 4461 7461 536f 7572 6365  PandasDataSource
+00018810: 4675 6e63 7469 6f6e 5479 7065 3128 5072  FunctionType1(Pr
+00018820: 6f74 6f63 6f6c 293a 0a20 2020 2020 2020  otocol):.       
+00018830: 2064 6566 205f 5f63 616c 6c5f 5f28 7365   def __call__(se
+00018840: 6c66 2920 2d3e 2044 6174 6146 7261 6d65  lf) -> DataFrame
+00018850: 3a20 2e2e 2e0a 0a20 2020 2063 6c61 7373  : .....    class
+00018860: 2050 616e 6461 7344 6174 6153 6f75 7263   PandasDataSourc
+00018870: 6546 756e 6374 696f 6e54 7970 6532 2850  eFunctionType2(P
+00018880: 726f 746f 636f 6c29 3a0a 2020 2020 2020  rotocol):.      
+00018890: 2020 6465 6620 5f5f 6361 6c6c 5f5f 2873    def __call__(s
+000188a0: 656c 662c 2066 696c 7465 725f 636f 6e74  elf, filter_cont
+000188b0: 6578 743a 2046 696c 7465 7243 6f6e 7465  ext: FilterConte
+000188c0: 7874 2920 2d3e 2044 6174 6146 7261 6d65  xt) -> DataFrame
+000188d0: 3a20 2e2e 2e0a 0a20 2020 2063 6c61 7373  : .....    class
+000188e0: 2050 616e 6461 7344 6174 6153 6f75 7263   PandasDataSourc
+000188f0: 6546 756e 6374 696f 6e54 7970 6533 2850  eFunctionType3(P
+00018900: 726f 746f 636f 6c29 3a0a 2020 2020 2020  rotocol):.      
+00018910: 2020 6465 6620 5f5f 6361 6c6c 5f5f 2873    def __call__(s
+00018920: 656c 662c 2073 6563 7265 7473 5f63 6f6e  elf, secrets_con
+00018930: 7465 7874 3a20 4d61 7070 696e 675b 7374  text: Mapping[st
+00018940: 722c 2073 7472 5d29 202d 3e20 4461 7461  r, str]) -> Data
+00018950: 4672 616d 653a 202e 2e2e 0a0a 2020 2020  Frame: .....    
+00018960: 636c 6173 7320 5061 6e64 6173 4461 7461  class PandasData
+00018970: 536f 7572 6365 4675 6e63 7469 6f6e 5479  SourceFunctionTy
+00018980: 7065 3428 5072 6f74 6f63 6f6c 293a 0a20  pe4(Protocol):. 
+00018990: 2020 2020 2020 2064 6566 205f 5f63 616c         def __cal
+000189a0: 6c5f 5f28 7365 6c66 2c20 6669 6c74 6572  l__(self, filter
+000189b0: 5f63 6f6e 7465 7874 3a20 4669 6c74 6572  _context: Filter
+000189c0: 436f 6e74 6578 742c 2073 6563 7265 7473  Context, secrets
+000189d0: 5f63 6f6e 7465 7874 3a20 4d61 7070 696e  _context: Mappin
+000189e0: 675b 7374 722c 2073 7472 5d29 202d 3e20  g[str, str]) -> 
+000189f0: 4461 7461 4672 616d 653a 202e 2e2e 0a0a  DataFrame: .....
+00018a00: 2020 2020 5061 6e64 6173 4461 7461 536f      PandasDataSo
+00018a10: 7572 6365 4675 6e63 7469 6f6e 5479 7065  urceFunctionType
+00018a20: 203d 2055 6e69 6f6e 5b0a 2020 2020 2020   = Union[.      
+00018a30: 2020 5061 6e64 6173 4461 7461 536f 7572    PandasDataSour
+00018a40: 6365 4675 6e63 7469 6f6e 5479 7065 312c  ceFunctionType1,
+00018a50: 0a20 2020 2020 2020 2050 616e 6461 7344  .        PandasD
+00018a60: 6174 6153 6f75 7263 6546 756e 6374 696f  ataSourceFunctio
+00018a70: 6e54 7970 6532 2c0a 2020 2020 2020 2020  nType2,.        
+00018a80: 5061 6e64 6173 4461 7461 536f 7572 6365  PandasDataSource
+00018a90: 4675 6e63 7469 6f6e 5479 7065 332c 0a20  FunctionType3,. 
+00018aa0: 2020 2020 2020 2050 616e 6461 7344 6174         PandasDat
+00018ab0: 6153 6f75 7263 6546 756e 6374 696f 6e54  aSourceFunctionT
+00018ac0: 7970 6534 2c0a 2020 2020 5d0a 0a20 2020  ype4,.    ]..   
+00018ad0: 2064 6566 205f 5f69 6e69 745f 5f28 0a20   def __init__(. 
+00018ae0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00018af0: 2020 2020 2064 6174 615f 736f 7572 6365       data_source
+00018b00: 5f66 756e 6374 696f 6e3a 2050 616e 6461  _function: Panda
+00018b10: 7344 6174 6153 6f75 7263 6546 756e 6374  sDataSourceFunct
+00018b20: 696f 6e54 7970 652c 0a20 2020 2020 2020  ionType,.       
+00018b30: 2064 6174 615f 6465 6c61 793a 2064 6174   data_delay: dat
+00018b40: 6574 696d 652e 7469 6d65 6465 6c74 6120  etime.timedelta 
+00018b50: 3d20 6461 7465 7469 6d65 2e74 696d 6564  = datetime.timed
+00018b60: 656c 7461 2873 6563 6f6e 6473 3d30 292c  elta(seconds=0),
+00018b70: 0a20 2020 2020 2020 2073 7570 706f 7274  .        support
+00018b80: 735f 7469 6d65 5f66 696c 7465 7269 6e67  s_time_filtering
+00018b90: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
+00018ba0: 2020 2020 2020 2020 7365 6372 6574 733a          secrets:
+00018bb0: 204f 7074 696f 6e61 6c5b 4469 6374 5b73   Optional[Dict[s
+00018bc0: 7472 2c20 556e 696f 6e5b 5365 6372 6574  tr, Union[Secret
+00018bd0: 2c20 7374 725d 5d5d 203d 204e 6f6e 652c  , str]]] = None,
+00018be0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+00018bf0: 2222 220a 2020 2020 2020 2020 496e 7374  """.        Inst
+00018c00: 616e 7469 6174 6573 2061 206e 6577 2050  antiates a new P
+00018c10: 616e 6461 7342 6174 6368 436f 6e66 6967  andasBatchConfig
+00018c20: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00018c30: 2064 6174 615f 736f 7572 6365 5f66 756e   data_source_fun
+00018c40: 6374 696f 6e3a 2055 7365 7220 6465 6669  ction: User defi
+00018c50: 6e65 6420 4461 7461 2053 6f75 7263 6520  ned Data Source 
+00018c60: 4675 6e63 7469 6f6e 2074 6861 7420 7461  Function that ta
+00018c70: 6b65 7320 696e 2061 6e20 6f70 7469 6f6e  kes in an option
+00018c80: 616c 0a20 2020 2020 2020 2020 2020 2020  al.             
+00018c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018ca0: 2020 2020 2020 203a 636c 6173 733a 6074         :class:`t
+00018cb0: 6563 746f 6e2e 4669 6c74 6572 436f 6e74  ecton.FilterCont
+00018cc0: 6578 7460 2c20 6966 2060 6073 7570 706f  ext`, if ``suppo
+00018cd0: 7274 735f 7469 6d65 5f66 696c 7465 7269  rts_time_filteri
+00018ce0: 6e67 3d54 7275 6560 602e 2052 6574 7572  ng=True``. Retur
+00018cf0: 6e73 2061 0a20 2020 2020 2020 2020 2020  ns a.           
+00018d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018d10: 2020 2020 2020 2020 2060 6070 616e 6461           ``panda
+00018d20: 732e 4461 7461 4672 616d 6560 602e 0a20  s.DataFrame``.. 
+00018d30: 2020 2020 2020 203a 7061 7261 6d20 6461         :param da
+00018d40: 7461 5f64 656c 6179 3a20 4279 2064 6566  ta_delay: By def
+00018d50: 6175 6c74 2c20 696e 6372 656d 656e 7461  ault, incrementa
+00018d60: 6c20 6d61 7465 7269 616c 697a 6174 696f  l materializatio
+00018d70: 6e20 6a6f 6273 2072 756e 2069 6d6d 6564  n jobs run immed
+00018d80: 6961 7465 6c79 2061 7420 7468 6520 656e  iately at the en
+00018d90: 6420 6f66 2074 6865 0a20 2020 2020 2020  d of the.       
+00018da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018db0: 2020 2020 2020 2020 2020 2020 2062 6174               bat
+00018dc0: 6368 2073 6368 6564 756c 6520 7065 7269  ch schedule peri
+00018dd0: 6f64 2e20 5468 6973 2070 6172 616d 6574  od. This paramet
+00018de0: 6572 2063 6f6e 6669 6775 7265 7320 686f  er configures ho
+00018df0: 7720 6c6f 6e67 2074 6865 7920 7761 6974  w long they wait
+00018e00: 2061 6674 6572 2074 6865 2065 6e64 0a20   after the end. 
+00018e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018e30: 2020 206f 6620 7468 6520 7065 7269 6f64     of the period
+00018e40: 2062 6566 6f72 6520 7374 6172 7469 6e67   before starting
+00018e50: 2c20 7479 7069 6361 6c6c 7920 746f 2065  , typically to e
+00018e60: 6e73 7572 6520 7468 6174 2061 6c6c 2064  nsure that all d
+00018e70: 6174 6120 6861 7320 6c61 6e64 6564 2e0a  ata has landed..
+00018e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018ea0: 2020 2020 466f 7220 6578 616d 706c 652c      For example,
+00018eb0: 2069 6620 6120 6665 6174 7572 6520 7669   if a feature vi
+00018ec0: 6577 2068 6173 2061 2060 6062 6174 6368  ew has a ``batch
+00018ed0: 5f73 6368 6564 756c 6560 6020 6f66 2031  _schedule`` of 1
+00018ee0: 2064 6179 2061 6e64 206f 6e65 206f 660a   day and one of.
+00018ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018f10: 2020 2020 7468 6520 6461 7461 2073 6f75      the data sou
+00018f20: 7263 6520 696e 7075 7473 2068 6173 2061  rce inputs has a
+00018f30: 2060 6064 6174 615f 6465 6c61 7960 6020   ``data_delay`` 
+00018f40: 6f66 2031 2068 6f75 722c 2074 6865 6e0a  of 1 hour, then.
+00018f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018f70: 2020 2020 696e 6372 656d 656e 7461 6c20      incremental 
+00018f80: 6d61 7465 7269 616c 697a 6174 696f 6e20  materialization 
+00018f90: 6a6f 6273 2077 696c 6c20 7275 6e20 6174  jobs will run at
+00018fa0: 2060 6030 313a 3030 6060 2055 5443 2e0a   ``01:00`` UTC..
+00018fb0: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
+00018fc0: 7570 706f 7274 735f 7469 6d65 5f66 696c  upports_time_fil
+00018fd0: 7465 7269 6e67 3a20 5768 656e 2073 6574  tering: When set
+00018fe0: 2074 6f20 6060 5472 7565 6060 2c20 7468   to ``True``, th
+00018ff0: 6520 4461 7461 2053 6f75 7263 6520 4675  e Data Source Fu
+00019000: 6e63 7469 6f6e 206d 7573 7420 7461 6b65  nction must take
+00019010: 2074 6865 2060 6066 696c 7465 725f 636f   the ``filter_co
+00019020: 6e74 6578 7460 600a 2020 2020 2020 2020  ntext``.        
+00019030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019040: 2020 2020 2020 2020 2020 2020 7061 7261              para
+00019050: 6d65 7465 7220 616e 6420 696d 706c 656d  meter and implem
+00019060: 656e 7420 7469 6d65 2066 696c 7465 7269  ent time filteri
+00019070: 6e67 206c 6f67 6963 2e0a 2020 2020 2020  ng logic..      
+00019080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019090: 2020 2020 2020 2020 2020 2020 2020 6060                ``
+000190a0: 7375 7070 6f72 7473 5f74 696d 655f 6669  supports_time_fi
+000190b0: 6c74 6572 696e 6760 6020 6d75 7374 2062  ltering`` must b
+000190c0: 6520 7365 7420 746f 2060 5472 7565 6020  e set to `True` 
+000190d0: 6966 2060 603c 6461 7461 2073 6f75 7263  if ``<data sourc
+000190e0: 653e 2e67 6574 5f64 6174 6166 7261 6d65  e>.get_dataframe
+000190f0: 2829 6060 2069 7320 6361 6c6c 6564 2077  ()`` is called w
+00019100: 6974 6820 6060 7374 6172 745f 7469 6d65  ith ``start_time
+00019110: 6060 0a20 2020 2020 2020 2020 2020 2020  ``.             
+00019120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019130: 2020 2020 2020 206f 7220 6060 656e 645f         or ``end_
+00019140: 7469 6d65 6060 2e20 6060 7375 7070 6f72  time``. ``suppor
+00019150: 7473 5f74 696d 655f 6669 6c74 6572 696e  ts_time_filterin
+00019160: 6760 6020 6d75 7374 2061 6c73 6f20 6265  g`` must also be
+00019170: 2073 6574 2074 6f20 6060 5472 7565 6060   set to ``True``
+00019180: 2069 6620 7573 696e 6720 3a63 6c61 7373   if using :class
+00019190: 3a60 7465 6374 6f6e 2e64 6563 6c61 7261  :`tecton.declara
+000191a0: 7469 7665 2e46 696c 7465 7265 6453 6f75  tive.FilteredSou
+000191b0: 7263 6560 0a20 2020 2020 2020 2020 2020  rce`.           
+000191c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000191d0: 2020 2020 2020 2020 2077 6974 6820 6120           with a 
+000191e0: 4461 7461 2053 6f75 7263 6520 7768 656e  Data Source when
+000191f0: 2064 6566 696e 696e 6720 6120 6060 4665   defining a ``Fe
+00019200: 6174 7572 6556 6965 7760 602e 2054 6865  atureView``. The
+00019210: 2060 6046 6561 7475 7265 5669 6577 6060   ``FeatureView``
+00019220: 2077 696c 6c20 6361 6c6c 0a20 2020 2020   will call.     
+00019230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019240: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00019250: 6865 2044 6174 6120 536f 7572 6365 2046  he Data Source F
+00019260: 756e 6374 696f 6e20 7769 7468 2074 6865  unction with the
+00019270: 203a 636c 6173 733a 6074 6563 746f 6e2e   :class:`tecton.
+00019280: 4669 6c74 6572 436f 6e74 6578 7460 2c20  FilterContext`, 
+00019290: 7768 6963 6820 6861 7320 7468 6520 6060  which has the ``
+000192a0: 7374 6172 745f 7469 6d65 6060 2061 6e64  start_time`` and
 000192b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000192c0: 2020 2020 2020 2020 2061 7420 7275 6e74           at runt
-000192d0: 696d 652e 2044 7572 696e 6720 6c6f 6361  ime. During loca
-000192e0: 6c20 6465 7665 6c6f 706d 656e 7420 616e  l development an
-000192f0: 6420 7465 7374 696e 672c 2073 7472 696e  d testing, strin
-00019300: 6773 206d 6179 2062 6520 7573 6564 2069  gs may be used i
-00019310: 6e73 7465 6164 2053 6563 7265 7420 7265  nstead Secret re
-00019320: 6665 7265 6e63 6573 2e0a 2020 2020 2020  ferences..      
-00019330: 2020 3a72 6574 7572 6e3a 2041 2050 616e    :return: A Pan
-00019340: 6461 7342 6174 6368 436f 6e66 6967 2063  dasBatchConfig c
-00019350: 6c61 7373 2069 6e73 7461 6e63 652e 0a20  lass instance.. 
-00019360: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00019370: 2020 2073 656c 662e 5f63 6865 636b 5f66     self._check_f
-00019380: 756e 6374 696f 6e5f 7369 676e 6174 7572  unction_signatur
-00019390: 6528 6461 7461 5f73 6f75 7263 655f 6675  e(data_source_fu
-000193a0: 6e63 7469 6f6e 2c20 7375 7070 6f72 7473  nction, supports
-000193b0: 5f74 696d 655f 6669 6c74 6572 696e 672c  _time_filtering,
-000193c0: 2075 7365 5f73 6563 7265 7473 3d62 6f6f   use_secrets=boo
-000193d0: 6c28 7365 6372 6574 7329 290a 2020 2020  l(secrets)).    
-000193e0: 2020 2020 7365 6c66 2e5f 6172 6773 203d      self._args =
-000193f0: 2064 6174 615f 736f 7572 6365 5f70 6232   data_source_pb2
-00019400: 2e50 616e 6461 7342 6174 6368 436f 6e66  .PandasBatchConf
-00019410: 6967 4172 6773 2829 0a20 2020 2020 2020  igArgs().       
-00019420: 2069 6620 6675 6e63 7469 6f6e 5f73 6572   if function_ser
-00019430: 6961 6c69 7a61 7469 6f6e 2e73 686f 756c  ialization.shoul
-00019440: 645f 7365 7269 616c 697a 655f 6675 6e63  d_serialize_func
-00019450: 7469 6f6e 2864 6174 615f 736f 7572 6365  tion(data_source
-00019460: 5f66 756e 6374 696f 6e29 3a0a 2020 2020  _function):.    
-00019470: 2020 2020 2020 2020 7365 6c66 2e5f 6172          self._ar
-00019480: 6773 2e64 6174 615f 736f 7572 6365 5f66  gs.data_source_f
-00019490: 756e 6374 696f 6e2e 436f 7079 4672 6f6d  unction.CopyFrom
-000194a0: 2866 756e 6374 696f 6e5f 7365 7269 616c  (function_serial
-000194b0: 697a 6174 696f 6e2e 746f 5f70 726f 746f  ization.to_proto
-000194c0: 2864 6174 615f 736f 7572 6365 5f66 756e  (data_source_fun
-000194d0: 6374 696f 6e29 290a 2020 2020 2020 2020  ction)).        
-000194e0: 7365 6c66 2e5f 6172 6773 2e64 6174 615f  self._args.data_
-000194f0: 6465 6c61 792e 4672 6f6d 5469 6d65 6465  delay.FromTimede
-00019500: 6c74 6128 6461 7461 5f64 656c 6179 290a  lta(data_delay).
-00019510: 2020 2020 2020 2020 7365 6c66 2e5f 6172          self._ar
-00019520: 6773 2e73 7570 706f 7274 735f 7469 6d65  gs.supports_time
-00019530: 5f66 696c 7465 7269 6e67 203d 2073 7570  _filtering = sup
-00019540: 706f 7274 735f 7469 6d65 5f66 696c 7465  ports_time_filte
-00019550: 7269 6e67 0a20 2020 2020 2020 2069 6620  ring.        if 
-00019560: 7365 6372 6574 733a 0a20 2020 2020 2020  secrets:.       
-00019570: 2020 2020 2066 6f72 206e 616d 652c 2073       for name, s
-00019580: 6563 7265 7420 696e 2073 6563 7265 7473  ecret in secrets
-00019590: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
-000195a0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-000195b0: 6172 6773 2e73 6563 7265 7473 5b6e 616d  args.secrets[nam
-000195c0: 655d 2e43 6f70 7946 726f 6d28 5f63 6f6e  e].CopyFrom(_con
-000195d0: 7665 7274 5f73 6563 7265 745f 746f 5f73  vert_secret_to_s
-000195e0: 616e 6974 697a 6564 5f72 6566 6572 656e  anitized_referen
-000195f0: 6365 2873 6563 7265 7429 290a 2020 2020  ce(secret)).    
-00019600: 2020 2020 7365 6c66 2e5f 6461 7461 5f64      self._data_d
-00019610: 656c 6179 203d 2064 6174 615f 6465 6c61  elay = data_dela
-00019620: 790a 2020 2020 2020 2020 7365 6c66 2e64  y.        self.d
-00019630: 6174 615f 736f 7572 6365 5f66 756e 6374  ata_source_funct
-00019640: 696f 6e20 3d20 6461 7461 5f73 6f75 7263  ion = data_sourc
-00019650: 655f 6675 6e63 7469 6f6e 0a0a 2020 2020  e_function..    
-00019660: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00019670: 6620 6461 7461 5f64 656c 6179 2873 656c  f data_delay(sel
-00019680: 6629 202d 3e20 6461 7465 7469 6d65 2e74  f) -> datetime.t
-00019690: 696d 6564 656c 7461 3a0a 2020 2020 2020  imedelta:.      
-000196a0: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
-000196b0: 6174 615f 6465 6c61 790a 0a20 2020 2064  ata_delay..    d
-000196c0: 6566 205f 6d65 7267 655f 6261 7463 685f  ef _merge_batch_
-000196d0: 6172 6773 2873 656c 662c 2064 6174 615f  args(self, data_
-000196e0: 736f 7572 6365 5f61 7267 733a 2076 6972  source_args: vir
-000196f0: 7475 616c 5f64 6174 615f 736f 7572 6365  tual_data_source
-00019700: 5f70 6232 2e56 6972 7475 616c 4461 7461  _pb2.VirtualData
-00019710: 536f 7572 6365 4172 6773 293a 0a20 2020  SourceArgs):.   
-00019720: 2020 2020 2064 6174 615f 736f 7572 6365       data_source
-00019730: 5f61 7267 732e 7061 6e64 6173 5f62 6174  _args.pandas_bat
-00019740: 6368 5f63 6f6e 6669 672e 436f 7079 4672  ch_config.CopyFr
-00019750: 6f6d 2873 656c 662e 5f61 7267 7329 0a0a  om(self._args)..
-00019760: 2020 2020 6465 6620 5f5f 6361 6c6c 5f5f      def __call__
-00019770: 2873 656c 662c 202a 6172 6773 2c20 2a2a  (self, *args, **
-00019780: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
-00019790: 2072 6574 7572 6e20 7365 6c66 2e64 6174   return self.dat
-000197a0: 615f 736f 7572 6365 5f66 756e 6374 696f  a_source_functio
-000197b0: 6e28 2a61 7267 732c 202a 2a6b 7761 7267  n(*args, **kwarg
-000197c0: 7329 0a0a 2020 2020 4073 7461 7469 636d  s)..    @staticm
-000197d0: 6574 686f 640a 2020 2020 6465 6620 5f63  ethod.    def _c
-000197e0: 6865 636b 5f66 756e 6374 696f 6e5f 7369  heck_function_si
-000197f0: 676e 6174 7572 6528 6461 7461 5f73 6f75  gnature(data_sou
-00019800: 7263 655f 6675 6e63 7469 6f6e 3a20 4361  rce_function: Ca
-00019810: 6c6c 6162 6c65 2c20 7375 7070 6f72 7473  llable, supports
-00019820: 5f74 696d 655f 6669 6c74 6572 696e 673a  _time_filtering:
-00019830: 2062 6f6f 6c2c 2075 7365 5f73 6563 7265   bool, use_secre
-00019840: 7473 3a20 626f 6f6c 293a 0a20 2020 2020  ts: bool):.     
-00019850: 2020 2066 756e 6374 696f 6e5f 6e61 6d65     function_name
-00019860: 203d 2064 6174 615f 736f 7572 6365 5f66   = data_source_f
-00019870: 756e 6374 696f 6e2e 5f5f 6e61 6d65 5f5f  unction.__name__
-00019880: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
-00019890: 3d20 6c69 7374 2869 6e73 7065 6374 2e73  = list(inspect.s
-000198a0: 6967 6e61 7475 7265 2864 6174 615f 736f  ignature(data_so
-000198b0: 7572 6365 5f66 756e 6374 696f 6e29 2e70  urce_function).p
-000198c0: 6172 616d 6574 6572 7329 0a20 2020 2020  arameters).     
-000198d0: 2020 2069 6620 7375 7070 6f72 7473 5f74     if supports_t
-000198e0: 696d 655f 6669 6c74 6572 696e 6720 616e  ime_filtering an
-000198f0: 6420 7573 655f 7365 6372 6574 733a 0a20  d use_secrets:. 
-00019900: 2020 2020 2020 2020 2020 2069 6620 7061             if pa
-00019910: 7261 6d73 2021 3d20 5b22 6669 6c74 6572  rams != ["filter
-00019920: 5f63 6f6e 7465 7874 222c 2022 7365 6372  _context", "secr
-00019930: 6574 7322 5d3a 0a20 2020 2020 2020 2020  ets"]:.         
-00019940: 2020 2020 2020 206d 7367 203d 2066 2244         msg = f"D
-00019950: 6174 6120 536f 7572 6365 2046 756e 6374  ata Source Funct
-00019960: 696f 6e20 7b66 756e 6374 696f 6e5f 6e61  ion {function_na
-00019970: 6d65 7d27 7320 7265 7175 6972 6564 2073  me}'s required s
-00019980: 6967 6e61 7475 7265 2069 7320 607b 6675  ignature is `{fu
-00019990: 6e63 7469 6f6e 5f6e 616d 657d 2866 696c  nction_name}(fil
-000199a0: 7465 725f 636f 6e74 6578 742c 2073 6563  ter_context, sec
-000199b0: 7265 7473 2960 2077 6865 6e20 7375 7070  rets)` when supp
-000199c0: 6f72 7473 5f74 696d 655f 6669 6c74 6572  orts_time_filter
-000199d0: 696e 6720 6973 2054 7275 6520 616e 6420  ing is True and 
-000199e0: 7365 6372 6574 7320 6172 6520 7573 6564  secrets are used
-000199f0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00019a00: 2020 7261 6973 6520 4173 7365 7274 696f    raise Assertio
-00019a10: 6e45 7272 6f72 286d 7367 290a 2020 2020  nError(msg).    
-00019a20: 2020 2020 656c 6966 2073 7570 706f 7274      elif support
-00019a30: 735f 7469 6d65 5f66 696c 7465 7269 6e67  s_time_filtering
-00019a40: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00019a50: 2070 6172 616d 7320 213d 205b 2266 696c   params != ["fil
-00019a60: 7465 725f 636f 6e74 6578 7422 5d3a 0a20  ter_context"]:. 
-00019a70: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00019a80: 7367 203d 2066 2244 6174 6120 536f 7572  sg = f"Data Sour
-00019a90: 6365 2046 756e 6374 696f 6e20 7b66 756e  ce Function {fun
-00019aa0: 6374 696f 6e5f 6e61 6d65 7d27 7320 7265  ction_name}'s re
-00019ab0: 7175 6972 6564 2073 6967 6e61 7475 7265  quired signature
-00019ac0: 2069 7320 607b 6675 6e63 7469 6f6e 5f6e   is `{function_n
-00019ad0: 616d 657d 2866 696c 7465 725f 636f 6e74  ame}(filter_cont
-00019ae0: 6578 7429 6020 7768 656e 2073 7570 706f  ext)` when suppo
-00019af0: 7274 735f 7469 6d65 5f66 696c 7465 7269  rts_time_filteri
-00019b00: 6e67 2069 7320 5472 7565 220a 2020 2020  ng is True".    
-00019b10: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00019b20: 6520 4173 7365 7274 696f 6e45 7272 6f72  e AssertionError
-00019b30: 286d 7367 290a 2020 2020 2020 2020 656c  (msg).        el
-00019b40: 6966 2075 7365 5f73 6563 7265 7473 3a0a  if use_secrets:.
-00019b50: 2020 2020 2020 2020 2020 2020 6966 2070              if p
-00019b60: 6172 616d 7320 213d 205b 2273 6563 7265  arams != ["secre
-00019b70: 7473 225d 3a0a 2020 2020 2020 2020 2020  ts"]:.          
-00019b80: 2020 2020 2020 6d73 6720 3d20 6622 4461        msg = f"Da
-00019b90: 7461 2053 6f75 7263 6520 4675 6e63 7469  ta Source Functi
-00019ba0: 6f6e 207b 6675 6e63 7469 6f6e 5f6e 616d  on {function_nam
-00019bb0: 657d 2773 2072 6571 7569 7265 6420 7369  e}'s required si
-00019bc0: 676e 6174 7572 6520 6973 2060 7b66 756e  gnature is `{fun
-00019bd0: 6374 696f 6e5f 6e61 6d65 7d28 7365 6372  ction_name}(secr
-00019be0: 6574 7329 6020 7768 656e 2073 6563 7265  ets)` when secre
-00019bf0: 7473 2061 7265 2075 7365 6422 0a20 2020  ts are used".   
-00019c00: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00019c10: 7365 2041 7373 6572 7469 6f6e 4572 726f  se AssertionErro
-00019c20: 7228 6d73 6729 0a20 2020 2020 2020 2065  r(msg).        e
-00019c30: 6c69 6620 7061 7261 6d73 3a0a 2020 2020  lif params:.    
-00019c40: 2020 2020 2020 2020 6d73 6720 3d20 6622          msg = f"
-00019c50: 4461 7461 2053 6f75 7263 6520 4675 6e63  Data Source Func
-00019c60: 7469 6f6e 207b 6675 6e63 7469 6f6e 5f6e  tion {function_n
-00019c70: 616d 657d 2773 2072 6571 7569 7265 6420  ame}'s required 
-00019c80: 7369 676e 6174 7572 6520 6973 2060 7b66  signature is `{f
-00019c90: 756e 6374 696f 6e5f 6e61 6d65 7d28 2960  unction_name}()`
-00019ca0: 220a 2020 2020 2020 2020 2020 2020 7261  ".            ra
-00019cb0: 6973 6520 4173 7365 7274 696f 6e45 7272  ise AssertionErr
-00019cc0: 6f72 286d 7367 290a 0a0a 4074 7970 6563  or(msg)...@typec
-00019cd0: 6865 636b 6564 0a64 6566 2070 616e 6461  hecked.def panda
-00019ce0: 735f 6261 7463 685f 636f 6e66 6967 280a  s_batch_config(.
-00019cf0: 2020 2020 2a2c 0a20 2020 2064 6174 615f      *,.    data_
-00019d00: 6465 6c61 793a 204f 7074 696f 6e61 6c5b  delay: Optional[
-00019d10: 6461 7465 7469 6d65 2e74 696d 6564 656c  datetime.timedel
-00019d20: 7461 5d20 3d20 6461 7465 7469 6d65 2e74  ta] = datetime.t
-00019d30: 696d 6564 656c 7461 2873 6563 6f6e 6473  imedelta(seconds
-00019d40: 3d30 292c 0a20 2020 2073 7570 706f 7274  =0),.    support
-00019d50: 735f 7469 6d65 5f66 696c 7465 7269 6e67  s_time_filtering
-00019d60: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
-00019d70: 203d 2046 616c 7365 2c0a 2020 2020 7365   = False,.    se
-00019d80: 6372 6574 733a 204f 7074 696f 6e61 6c5b  crets: Optional[
-00019d90: 4469 6374 5b73 7472 2c20 556e 696f 6e5b  Dict[str, Union[
-00019da0: 5365 6372 6574 2c20 7374 725d 5d5d 203d  Secret, str]]] =
-00019db0: 204e 6f6e 652c 0a29 3a0a 2020 2020 2222   None,.):.    ""
-00019dc0: 220a 2020 2020 4465 636c 6172 6520 6120  ".    Declare a 
-00019dd0: 3a63 6c61 7373 3a60 7465 6374 6f6e 2e50  :class:`tecton.P
-00019de0: 616e 6461 7342 6174 6368 436f 6e66 6967  andasBatchConfig
-00019df0: 6020 666f 7220 636f 6e66 6967 7572 696e  ` for configurin
-00019e00: 6720 6120 4261 7463 6820 536f 7572 6365  g a Batch Source
-00019e10: 2077 6974 6820 6120 4461 7461 2053 6f75   with a Data Sou
-00019e20: 7263 6520 4675 6e63 7469 6f6e 2e0a 2020  rce Function..  
-00019e30: 2020 5468 6520 6675 6e63 7469 6f6e 2074    The function t
-00019e40: 616b 6573 2069 6e20 6120 616e 206f 7074  akes in a an opt
-00019e50: 696f 6e61 6c20 3a63 6c61 7373 3a60 7465  ional :class:`te
-00019e60: 6374 6f6e 2e46 696c 7465 7243 6f6e 7465  cton.FilterConte
-00019e70: 7874 602c 2069 6620 6060 7375 7070 6f72  xt`, if ``suppor
-00019e80: 7473 5f74 696d 655f 6669 6c74 6572 696e  ts_time_filterin
-00019e90: 673d 5472 7565 6060 2e20 5265 7475 726e  g=True``. Return
-00019ea0: 7320 6120 6060 7064 2e44 6174 6146 7261  s a ``pd.DataFra
-00019eb0: 6d65 6060 2e0a 2020 2020 3a70 6172 616d  me``..    :param
-00019ec0: 2064 6174 615f 6465 6c61 793a 2042 7920   data_delay: By 
-00019ed0: 6465 6661 756c 742c 2069 6e63 7265 6d65  default, increme
-00019ee0: 6e74 616c 206d 6174 6572 6961 6c69 7a61  ntal materializa
-00019ef0: 7469 6f6e 206a 6f62 7320 7275 6e20 696d  tion jobs run im
-00019f00: 6d65 6469 6174 656c 7920 6174 2074 6865  mediately at the
-00019f10: 2065 6e64 206f 6620 7468 650a 2020 2020   end of the.    
-00019f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019f30: 2020 2020 2020 2020 2020 2020 6261 7463              batc
-00019f40: 6820 7363 6865 6475 6c65 2070 6572 696f  h schedule perio
-00019f50: 642e 2054 6869 7320 7061 7261 6d65 7465  d. This paramete
-00019f60: 7220 636f 6e66 6967 7572 6573 2068 6f77  r configures how
-00019f70: 206c 6f6e 6720 7468 6579 2077 6169 7420   long they wait 
-00019f80: 6166 7465 7220 7468 6520 656e 640a 2020  after the end.  
-00019f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019fa0: 2020 2020 2020 2020 2020 2020 2020 6f66                of
-00019fb0: 2074 6865 2070 6572 696f 6420 6265 666f   the period befo
-00019fc0: 7265 2073 7461 7274 696e 672c 2074 7970  re starting, typ
-00019fd0: 6963 616c 6c79 2074 6f20 656e 7375 7265  ically to ensure
-00019fe0: 2074 6861 7420 616c 6c20 6461 7461 2068   that all data h
-00019ff0: 6173 206c 616e 6465 642e 0a20 2020 2020  as landed..     
-0001a000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a010: 2020 2020 2020 2020 2020 2046 6f72 2065             For e
-0001a020: 7861 6d70 6c65 2c20 6966 2061 2066 6561  xample, if a fea
-0001a030: 7475 7265 2076 6965 7720 6861 7320 6120  ture view has a 
-0001a040: 6060 6261 7463 685f 7363 6865 6475 6c65  ``batch_schedule
-0001a050: 6060 206f 6620 3120 6461 7920 616e 6420  `` of 1 day and 
-0001a060: 6f6e 6520 6f66 0a20 2020 2020 2020 2020  one of.         
-0001a070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a080: 2020 2020 2020 2074 6865 2064 6174 6120         the data 
-0001a090: 736f 7572 6365 2069 6e70 7574 7320 6861  source inputs ha
-0001a0a0: 7320 6060 6461 7461 5f64 656c 6179 3d74  s ``data_delay=t
-0001a0b0: 696d 6564 656c 7461 2868 6f75 7273 3d31  imedelta(hours=1
-0001a0c0: 2960 6020 7365 742c 2074 6865 6e0a 2020  )`` set, then.  
-0001a0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a0e0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-0001a0f0: 6372 656d 656e 7461 6c20 6d61 7465 7269  cremental materi
-0001a100: 616c 697a 6174 696f 6e20 6a6f 6273 2077  alization jobs w
-0001a110: 696c 6c20 7275 6e20 6174 2060 6030 313a  ill run at ``01:
-0001a120: 3030 6060 2055 5443 2e0a 2020 2020 3a70  00`` UTC..    :p
-0001a130: 6172 616d 2073 7570 706f 7274 735f 7469  aram supports_ti
-0001a140: 6d65 5f66 696c 7465 7269 6e67 3a20 5768  me_filtering: Wh
-0001a150: 656e 2073 6574 2074 6f20 6060 5472 7565  en set to ``True
-0001a160: 6060 2c20 7468 6520 4461 7461 2053 6f75  ``, the Data Sou
-0001a170: 7263 6520 4675 6e63 7469 6f6e 206d 7573  rce Function mus
-0001a180: 7420 7461 6b65 2074 6865 2060 6066 696c  t take the ``fil
-0001a190: 7465 725f 636f 6e74 6578 7460 600a 2020  ter_context``.  
-0001a1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a1c0: 2020 7061 7261 6d65 7465 7220 616e 6420    parameter and 
-0001a1d0: 696d 706c 656d 656e 7420 7469 6d65 2066  implement time f
-0001a1e0: 696c 7465 7269 6e67 206c 6f67 6963 2e0a  iltering logic..
-0001a1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a210: 2020 2020 6060 7375 7070 6f72 7473 5f74      ``supports_t
-0001a220: 696d 655f 6669 6c74 6572 696e 6760 6020  ime_filtering`` 
-0001a230: 6d75 7374 2062 6520 7365 7420 746f 2060  must be set to `
-0001a240: 5472 7565 6020 6966 2060 603c 6461 7461  True` if ``<data
-0001a250: 2073 6f75 7263 653e 2e67 6574 5f64 6174   source>.get_dat
-0001a260: 6166 7261 6d65 2829 6060 2069 7320 6361  aframe()`` is ca
-0001a270: 6c6c 6564 2077 6974 6820 6060 7374 6172  lled with ``star
-0001a280: 745f 7469 6d65 6060 0a20 2020 2020 2020  t_time``.       
-0001a290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a2a0: 2020 2020 2020 2020 2020 2020 206f 7220               or 
-0001a2b0: 6060 656e 645f 7469 6d65 6060 2e20 6060  ``end_time``. ``
-0001a2c0: 7375 7070 6f72 7473 5f74 696d 655f 6669  supports_time_fi
-0001a2d0: 6c74 6572 696e 6760 6020 6d75 7374 2061  ltering`` must a
-0001a2e0: 6c73 6f20 6265 2073 6574 2074 6f20 6060  lso be set to ``
-0001a2f0: 5472 7565 6060 2069 6620 7573 696e 6720  True`` if using 
-0001a300: 3a63 6c61 7373 3a60 7465 6374 6f6e 2e64  :class:`tecton.d
-0001a310: 6563 6c61 7261 7469 7665 2e46 696c 7465  eclarative.Filte
-0001a320: 7265 6453 6f75 7263 6560 0a20 2020 2020  redSource`.     
-0001a330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a340: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-0001a350: 6974 6820 6120 4461 7461 2053 6f75 7263  ith a Data Sourc
-0001a360: 6520 7768 656e 2064 6566 696e 696e 6720  e when defining 
-0001a370: 6120 6060 4665 6174 7572 6556 6965 7760  a ``FeatureView`
-0001a380: 602e 2054 6865 2060 6046 6561 7475 7265  `. The ``Feature
-0001a390: 5669 6577 6060 2077 696c 6c20 6361 6c6c  View`` will call
-0001a3a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a3c0: 2020 2020 2074 6865 2044 6174 6120 536f       the Data So
-0001a3d0: 7572 6365 2046 756e 6374 696f 6e20 7769  urce Function wi
-0001a3e0: 7468 2074 6865 203a 636c 6173 733a 6074  th the :class:`t
-0001a3f0: 6563 746f 6e2e 4669 6c74 6572 436f 6e74  ecton.FilterCont
-0001a400: 6578 7460 2c20 7768 6963 6820 6861 7320  ext`, which has 
-0001a410: 7468 6520 6060 7374 6172 745f 7469 6d65  the ``start_time
-0001a420: 6060 2061 6e64 0a20 2020 2020 2020 2020  `` and.         
-0001a430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a440: 2020 2020 2020 2020 2020 2060 6065 6e64             ``end
-0001a450: 5f74 696d 6560 6020 7365 742e 0a0a 2020  _time`` set...  
-0001a460: 2020 3a70 6172 616d 2073 6563 7265 7473    :param secrets
-0001a470: 3a20 4120 6469 6374 696f 6e61 7279 206f  : A dictionary o
-0001a480: 6620 5365 6372 6574 2072 6566 6572 656e  f Secret referen
-0001a490: 6365 7320 7468 6174 2077 696c 6c20 6265  ces that will be
-0001a4a0: 2072 6573 6f6c 7665 6420 616e 6420 7072   resolved and pr
-0001a4b0: 6f76 6964 6564 2074 6f20 7468 6520 4461  ovided to the Da
-0001a4c0: 7461 2053 6f75 7263 6520 4675 6e63 7469  ta Source Functi
-0001a4d0: 6f6e 0a20 2020 2020 2020 2020 2020 2020  on.             
-0001a4e0: 2020 2020 2020 2061 7420 7275 6e74 696d         at runtim
-0001a4f0: 652e 2044 7572 696e 6720 6c6f 6361 6c20  e. During local 
-0001a500: 6465 7665 6c6f 706d 656e 7420 616e 6420  development and 
-0001a510: 7465 7374 696e 672c 2073 7472 696e 6773  testing, strings
-0001a520: 206d 6179 2062 6520 7573 6564 2069 6e73   may be used ins
-0001a530: 7465 6164 2053 6563 7265 7420 7265 6665  tead Secret refe
-0001a540: 7265 6e63 6573 2e0a 2020 2020 4578 616d  rences..    Exam
-0001a550: 706c 6520 6465 6669 6e69 6e67 2061 2044  ple defining a D
-0001a560: 6174 6120 536f 7572 6365 2046 756e 6374  ata Source Funct
-0001a570: 696f 6e20 7573 696e 6720 6060 7061 6e64  ion using ``pand
-0001a580: 6173 5f62 6174 6368 5f63 6f6e 6669 6760  as_batch_config`
-0001a590: 603a 0a20 2020 202e 2e20 636f 6465 2d62  `:.    .. code-b
-0001a5a0: 6c6f 636b 3a3a 2070 7974 686f 6e0a 2020  lock:: python.  
-0001a5b0: 2020 2020 2020 6672 6f6d 2074 6563 746f        from tecto
-0001a5c0: 6e20 696d 706f 7274 2070 616e 6461 735f  n import pandas_
-0001a5d0: 6261 7463 685f 636f 6e66 6967 2c20 5365  batch_config, Se
-0001a5e0: 6372 6574 0a20 2020 2020 2020 2040 7061  cret.        @pa
-0001a5f0: 6e64 6173 5f62 6174 6368 5f63 6f6e 6669  ndas_batch_confi
-0001a600: 6728 0a20 2020 2020 2020 2020 2073 7570  g(.          sup
-0001a610: 706f 7274 735f 7469 6d65 5f66 696c 7465  ports_time_filte
-0001a620: 7269 6e67 3d54 7275 652c 0a20 2020 2020  ring=True,.     
-0001a630: 2020 2020 2073 6563 7265 7473 3d7b 2273       secrets={"s
-0001a640: 335f 6275 636b 6574 223a 2053 6563 7265  3_bucket": Secre
-0001a650: 7428 7363 6f70 653d 2264 6576 222c 206b  t(scope="dev", k
-0001a660: 6579 3d22 7573 6572 5f64 6174 615f 7333  ey="user_data_s3
-0001a670: 5f62 7563 6b65 7422 297d 0a20 2020 2020  _bucket")}.     
-0001a680: 2020 2029 0a20 2020 2020 2020 2064 6566     ).        def
-0001a690: 2070 6172 7175 6574 5f64 6174 615f 736f   parquet_data_so
-0001a6a0: 7572 6365 5f66 756e 6374 696f 6e28 6669  urce_function(fi
-0001a6b0: 6c74 6572 5f63 6f6e 7465 7874 2c20 7365  lter_context, se
-0001a6c0: 6372 6574 7329 3a0a 2020 2020 2020 2020  crets):.        
-0001a6d0: 2020 2020 696d 706f 7274 2070 7961 7272      import pyarr
-0001a6e0: 6f77 2e70 6172 7175 6574 2061 7320 7071  ow.parquet as pq
-0001a6f0: 0a20 2020 2020 2020 2020 2020 2066 726f  .            fro
-0001a700: 6d20 7079 6172 726f 772e 6673 2069 6d70  m pyarrow.fs imp
-0001a710: 6f72 7420 5333 4669 6c65 5379 7374 656d  ort S3FileSystem
-0001a720: 0a20 2020 2020 2020 2020 2020 2066 696c  .            fil
-0001a730: 7465 7273 3d4e 6f6e 650a 2020 2020 2020  ters=None.      
-0001a740: 2020 2020 2020 2320 4861 6e64 6c65 2074        # Handle t
-0001a750: 696d 6520 6669 6c74 6572 696e 672c 2069  ime filtering, i
-0001a760: 6465 616c 6c79 2075 7369 6e67 2070 6172  deally using par
-0001a770: 7469 7469 6f6e 206b 6579 730a 2020 2020  tition keys.    
-0001a780: 2020 2020 2020 2020 6966 2066 696c 7465          if filte
-0001a790: 725f 636f 6e74 6578 743a 0a20 2020 2020  r_context:.     
-0001a7a0: 2020 2020 2020 2020 2020 2066 696c 7465             filte
-0001a7b0: 7273 203d 205b 5d0a 2020 2020 2020 2020  rs = [].        
-0001a7c0: 2020 2020 2020 2020 6966 2066 696c 7465          if filte
-0001a7d0: 725f 636f 6e74 6578 742e 7374 6172 745f  r_context.start_
-0001a7e0: 7469 6d65 3a0a 2020 2020 2020 2020 2020  time:.          
-0001a7f0: 2020 2020 2020 2020 2020 6669 6c74 6572            filter
-0001a800: 732e 6170 7065 6e64 2828 2263 7265 6174  s.append(("creat
-0001a810: 6564 5f61 7422 2c20 223e 3d22 2c20 6669  ed_at", ">=", fi
-0001a820: 6c74 6572 5f63 6f6e 7465 7874 2e73 7461  lter_context.sta
-0001a830: 7274 5f74 696d 652e 7265 706c 6163 6528  rt_time.replace(
-0001a840: 747a 696e 666f 3d4e 6f6e 6529 2929 0a20  tzinfo=None))). 
-0001a850: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001a860: 6620 6669 6c74 6572 5f63 6f6e 7465 7874  f filter_context
-0001a870: 2e65 6e64 5f74 696d 653a 0a20 2020 2020  .end_time:.     
-0001a880: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0001a890: 696c 7465 7273 2e61 7070 656e 6428 2822  ilters.append(("
-0001a8a0: 6372 6561 7465 645f 6174 222c 2022 3c22  created_at", "<"
-0001a8b0: 2c20 6669 6c74 6572 5f63 6f6e 7465 7874  , filter_context
-0001a8c0: 2e65 6e64 5f74 696d 652e 7265 706c 6163  .end_time.replac
-0001a8d0: 6528 747a 696e 666f 3d4e 6f6e 6529 2929  e(tzinfo=None)))
-0001a8e0: 0a0a 2020 2020 2020 2020 2020 2020 7333  ..            s3
-0001a8f0: 5f62 7563 6b65 7420 3d20 7365 6372 6574  _bucket = secret
-0001a900: 735b 2273 335f 6275 636b 6574 225d 0a20  s["s3_bucket"]. 
-0001a910: 2020 2020 2020 2020 2020 2064 6174 6173             datas
-0001a920: 6574 203d 2070 712e 5061 7271 7565 7444  et = pq.ParquetD
-0001a930: 6174 6173 6574 280a 2020 2020 2020 2020  ataset(.        
-0001a940: 2020 2020 2020 2020 6622 7333 3a2f 2f7b          f"s3://{
-0001a950: 7333 5f62 7563 6b65 747d 2f70 6174 682f  s3_bucket}/path/
-0001a960: 746f 2f64 6174 612e 7071 222c 0a20 2020  to/data.pq",.   
-0001a970: 2020 2020 2020 2020 2020 2020 2066 696c               fil
-0001a980: 6573 7973 7465 6d3d 5333 4669 6c65 5379  esystem=S3FileSy
-0001a990: 7374 656d 2829 2c0a 2020 2020 2020 2020  stem(),.        
-0001a9a0: 2020 2020 2020 2020 7573 655f 6c65 6761          use_lega
-0001a9b0: 6379 5f64 6174 6173 6574 3d46 616c 7365  cy_dataset=False
-0001a9c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001a9d0: 2020 6669 6c74 6572 733d 6669 6c74 6572    filters=filter
-0001a9e0: 7320 6966 206c 656e 2866 696c 7465 7273  s if len(filters
-0001a9f0: 2920 3e20 3020 656c 7365 204e 6f6e 650a  ) > 0 else None.
-0001aa00: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0001aa10: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001aa20: 2064 6174 6173 6574 2e72 6561 645f 7061   dataset.read_pa
-0001aa30: 6e64 6173 2829 2e74 6f5f 7061 6e64 6173  ndas().to_pandas
-0001aa40: 2829 0a20 2020 2022 2222 0a0a 2020 2020  ().    """..    
-0001aa50: 6465 6620 6465 636f 7261 746f 7228 6461  def decorator(da
-0001aa60: 7461 5f73 6f75 7263 655f 6675 6e63 7469  ta_source_functi
-0001aa70: 6f6e 293a 0a20 2020 2020 2020 2062 6174  on):.        bat
-0001aa80: 6368 5f63 6f6e 6669 6720 3d20 5061 6e64  ch_config = Pand
-0001aa90: 6173 4261 7463 6843 6f6e 6669 6728 0a20  asBatchConfig(. 
-0001aaa0: 2020 2020 2020 2020 2020 2064 6174 615f             data_
-0001aab0: 736f 7572 6365 5f66 756e 6374 696f 6e3d  source_function=
-0001aac0: 6461 7461 5f73 6f75 7263 655f 6675 6e63  data_source_func
-0001aad0: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
-0001aae0: 2020 6461 7461 5f64 656c 6179 3d64 6174    data_delay=dat
-0001aaf0: 615f 6465 6c61 792c 0a20 2020 2020 2020  a_delay,.       
-0001ab00: 2020 2020 2073 7570 706f 7274 735f 7469       supports_ti
-0001ab10: 6d65 5f66 696c 7465 7269 6e67 3d73 7570  me_filtering=sup
-0001ab20: 706f 7274 735f 7469 6d65 5f66 696c 7465  ports_time_filte
-0001ab30: 7269 6e67 2c0a 2020 2020 2020 2020 2020  ring,.          
-0001ab40: 2020 7365 6372 6574 733d 7365 6372 6574    secrets=secret
-0001ab50: 732c 0a20 2020 2020 2020 2029 0a20 2020  s,.        ).   
-0001ab60: 2020 2020 2066 756e 6374 6f6f 6c73 2e75       functools.u
-0001ab70: 7064 6174 655f 7772 6170 7065 7228 7772  pdate_wrapper(wr
-0001ab80: 6170 7065 723d 6261 7463 685f 636f 6e66  apper=batch_conf
-0001ab90: 6967 2c20 7772 6170 7065 643d 6461 7461  ig, wrapped=data
-0001aba0: 5f73 6f75 7263 655f 6675 6e63 7469 6f6e  _source_function
-0001abb0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0001abc0: 2062 6174 6368 5f63 6f6e 6669 670a 0a20   batch_config.. 
-0001abd0: 2020 2072 6574 7572 6e20 6465 636f 7261     return decora
-0001abe0: 746f 720a 0a0a 636c 6173 7320 4c69 6665  tor...class Life
-0001abf0: 7469 6d65 5769 6e64 6f77 2853 7472 6963  timeWindow(Stric
-0001ac00: 744d 6f64 656c 293a 0a20 2020 2022 2222  tModel):.    """
-0001ac10: 436f 6e66 6967 7572 6573 2061 206c 6966  Configures a lif
-0001ac20: 6574 696d 6520 7769 6e64 6f77 2e0a 0a20  etime window... 
-0001ac30: 2020 2054 6869 7320 636c 6173 7320 6861     This class ha
-0001ac40: 7320 6e6f 2061 7474 7269 6275 7465 732e  s no attributes.
-0001ac50: 2057 6865 6e20 7573 6564 2c20 7468 6520   When used, the 
-0001ac60: 6167 6772 6567 6174 696f 6e20 7769 6c6c  aggregation will
-0001ac70: 2062 6520 7370 6563 6966 6965 6420 6672   be specified fr
-0001ac80: 6f6d 2074 6865 2060 6c69 6665 7469 6d65  om the `lifetime
-0001ac90: 5f73 7461 7274 5f74 696d 6560 2075 6e74  _start_time` unt
-0001aca0: 696c 2074 6865 2061 6767 7265 6761 7469  il the aggregati
-0001acb0: 6f6e 2072 6566 6572 656e 6365 2070 6f69  on reference poi
-0001acc0: 6e74 2e0a 2020 2020 2222 220a 0a20 2020  nt..    """..   
-0001acd0: 2064 6566 205f 746f 5f70 726f 746f 2873   def _to_proto(s
-0001ace0: 656c 6629 202d 3e20 7469 6d65 5f77 696e  elf) -> time_win
-0001acf0: 646f 775f 7062 322e 4c69 6665 7469 6d65  dow_pb2.Lifetime
-0001ad00: 5769 6e64 6f77 3a0a 2020 2020 2020 2020  Window:.        
-0001ad10: 7265 7475 726e 2074 696d 655f 7769 6e64  return time_wind
-0001ad20: 6f77 5f70 6232 2e4c 6966 6574 696d 6557  ow_pb2.LifetimeW
-0001ad30: 696e 646f 7728 290a 0a20 2020 2023 2054  indow()..    # T
-0001ad40: 4f44 4f28 6a61 6b65 293a 2054 6869 7320  ODO(jake): This 
-0001ad50: 6973 2061 6e20 756e 7573 7561 6c20 7061  is an unusual pa
-0001ad60: 7474 6572 6e20 746f 2063 6f6e 7665 7274  ttern to convert
-0001ad70: 2061 2063 6f6e 6669 6720 6f62 6a65 6374   a config object
-0001ad80: 2074 6f20 6120 7370 6563 206c 696b 652e   to a spec like.
-0001ad90: 2044 6f20 6e6f 7420 7265 706c 6963 6174   Do not replicat
-0001ada0: 6520 7769 7468 6f75 7420 6120 676f 6f64  e without a good
-0001adb0: 0a20 2020 2023 2072 6561 736f 6e2e 2054  .    # reason. T
-0001adc0: 6869 7320 6973 206e 6565 6465 6420 6265  his is needed be
-0001add0: 6361 7573 6520 4167 6772 6567 6174 696f  cause Aggregatio
-0001ade0: 6e73 2068 6176 6520 6e6f 7420 6265 656e  ns have not been
-0001adf0: 2066 756c 6c79 206d 6967 7261 7465 6420   fully migrated 
-0001ae00: 6f6e 746f 2073 7065 6373 2e0a 2020 2020  onto specs..    
-0001ae10: 6465 6620 5f74 6f5f 7370 6563 2873 656c  def _to_spec(sel
-0001ae20: 6629 202d 3e20 7370 6563 732e 4c69 6665  f) -> specs.Life
-0001ae30: 7469 6d65 5769 6e64 6f77 5370 6563 3a0a  timeWindowSpec:.
-0001ae40: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0001ae50: 7065 6373 2e4c 6966 6574 696d 6557 696e  pecs.LifetimeWin
-0001ae60: 646f 7753 7065 6328 290a 0a0a 636c 6173  dowSpec()...clas
-0001ae70: 7320 5469 6d65 5769 6e64 6f77 2853 7472  s TimeWindow(Str
-0001ae80: 6963 744d 6f64 656c 293a 0a20 2020 2022  ictModel):.    "
-0001ae90: 2222 436f 6e66 6967 7572 6174 696f 6e20  ""Configuration 
-0001aea0: 7573 6564 2074 6f20 7370 6563 6966 7920  used to specify 
-0001aeb0: 616e 2061 6767 7265 6761 7469 6f6e 2074  an aggregation t
-0001aec0: 696d 6520 7769 6e64 6f77 2e0a 0a20 2020  ime window...   
-0001aed0: 2054 6869 7320 636c 6173 7320 6465 7363   This class desc
-0001aee0: 7269 6265 7320 7468 6520 6174 7472 6962  ribes the attrib
-0001aef0: 7574 6573 206f 6620 6120 7469 6d65 2077  utes of a time w
-0001af00: 696e 646f 7720 746f 2061 6767 7265 6761  indow to aggrega
-0001af10: 7465 206f 7665 7220 7768 6963 6820 696e  te over which in
-0001af20: 636c 7564 6573 2074 6865 2073 697a 6520  cludes the size 
-0001af30: 6f66 2074 6865 2074 696d 6520 7769 6e64  of the time wind
-0001af40: 6f77 0a20 2020 2061 6e64 2074 6865 206f  ow.    and the o
-0001af50: 6666 7365 7420 6f66 2074 6865 2077 696e  ffset of the win
-0001af60: 646f 7727 7320 656e 6420 7469 6d65 2066  dow's end time f
-0001af70: 726f 6d20 6120 6769 7665 6e20 7265 6665  rom a given refe
-0001af80: 7265 6e63 6520 706f 696e 7428 656e 6420  rence point(end 
-0001af90: 6f66 2061 6767 7265 6761 7469 6f6e 2077  of aggregation w
-0001afa0: 696e 646f 772c 2073 7069 6e65 2074 696d  indow, spine tim
-0001afb0: 6573 7461 6d70 2c20 6f72 2074 6865 2063  estamp, or the c
-0001afc0: 7572 7265 6e74 2074 696d 6529 2e0a 0a20  urrent time)... 
-0001afd0: 2020 203a 7061 7261 6d20 7769 6e64 6f77     :param window
-0001afe0: 5f73 697a 653a 2054 6865 2073 697a 6520  _size: The size 
-0001aff0: 6f66 2074 6865 2077 696e 646f 7720 746f  of the window to
-0001b000: 2061 6767 7265 6761 7465 206f 7665 722c   aggregate over,
-0001b010: 2073 7065 6369 6669 6564 2061 7320 6120   specified as a 
-0001b020: 6461 7465 7469 6d65 2e74 696d 6564 656c  datetime.timedel
-0001b030: 7461 2e20 6060 6461 7465 7469 6d65 2e74  ta. ``datetime.t
-0001b040: 696d 6564 656c 7461 2864 6179 733d 3330  imedelta(days=30
-0001b050: 2960 600a 2020 2020 3a70 6172 616d 206f  )``.    :param o
-0001b060: 6666 7365 743a 2054 6865 206e 6567 6174  ffset: The negat
-0001b070: 6976 6520 6475 7261 7469 6f6e 206f 6620  ive duration of 
-0001b080: 686f 7720 6661 7220 6261 636b 2074 6865  how far back the
-0001b090: 2065 6e64 206f 6620 7468 6520 7769 6e64   end of the wind
-0001b0a0: 6f77 2077 696c 6c20 6265 2066 726f 6d20  ow will be from 
-0001b0b0: 6120 6769 7665 6e20 7265 6665 7265 6e63  a given referenc
-0001b0c0: 6520 706f 696e 7420 2861 6767 7265 6761  e point (aggrega
-0001b0d0: 7469 6f6e 2077 696e 646f 7720 2f20 e280  tion window / ..
-0001b0e0: 9c6e 6f77 e280 9d20 2f20 7370 696e 6520  .now... / spine 
-0001b0f0: 7469 6d65 2069 6e20 636f 6e74 696e 756f  time in continuo
-0001b100: 7573 206d 6f64 6529 0a20 2020 2022 2222  us mode).    """
-0001b110: 0a0a 2020 2020 7769 6e64 6f77 5f73 697a  ..    window_siz
-0001b120: 653a 2064 6174 6574 696d 652e 7469 6d65  e: datetime.time
-0001b130: 6465 6c74 610a 2020 2020 6f66 6673 6574  delta.    offset
-0001b140: 3a20 6461 7465 7469 6d65 2e74 696d 6564  : datetime.timed
-0001b150: 656c 7461 203d 2064 6174 6574 696d 652e  elta = datetime.
-0001b160: 7469 6d65 6465 6c74 6128 7365 636f 6e64  timedelta(second
-0001b170: 733d 3029 0a0a 2020 2020 6465 6620 5f74  s=0)..    def _t
-0001b180: 6f5f 7072 6f74 6f28 7365 6c66 2920 2d3e  o_proto(self) ->
-0001b190: 2066 6561 7475 7265 5f76 6965 775f 7062   feature_view_pb
-0001b1a0: 322e 5469 6d65 5769 6e64 6f77 3a0a 2020  2.TimeWindow:.  
-0001b1b0: 2020 2020 2020 7265 7475 726e 2066 6561        return fea
-0001b1c0: 7475 7265 5f76 6965 775f 7062 322e 5469  ture_view_pb2.Ti
-0001b1d0: 6d65 5769 6e64 6f77 280a 2020 2020 2020  meWindow(.      
-0001b1e0: 2020 2020 2020 7769 6e64 6f77 5f64 7572        window_dur
-0001b1f0: 6174 696f 6e3d 7469 6d65 5f75 7469 6c73  ation=time_utils
-0001b200: 2e74 696d 6564 656c 7461 5f74 6f5f 7072  .timedelta_to_pr
-0001b210: 6f74 6f28 7365 6c66 2e77 696e 646f 775f  oto(self.window_
-0001b220: 7369 7a65 292c 0a20 2020 2020 2020 2020  size),.         
-0001b230: 2020 206f 6666 7365 743d 7469 6d65 5f75     offset=time_u
-0001b240: 7469 6c73 2e74 696d 6564 656c 7461 5f74  tils.timedelta_t
-0001b250: 6f5f 7072 6f74 6f28 7365 6c66 2e6f 6666  o_proto(self.off
-0001b260: 7365 7429 2c0a 2020 2020 2020 2020 290a  set),.        ).
-0001b270: 0a20 2020 2023 2054 4f44 4f28 6a61 6b65  .    # TODO(jake
-0001b280: 293a 2054 6869 7320 6973 2061 6e20 756e  ): This is an un
-0001b290: 7573 7561 6c20 7061 7474 6572 6e20 746f  usual pattern to
-0001b2a0: 2063 6f6e 7665 7274 2061 2063 6f6e 6669   convert a confi
-0001b2b0: 6720 6f62 6a65 6374 2074 6f20 6120 7370  g object to a sp
-0001b2c0: 6563 206c 696b 652e 2044 6f20 6e6f 7420  ec like. Do not 
-0001b2d0: 7265 706c 6963 6174 6520 7769 7468 6f75  replicate withou
-0001b2e0: 7420 6120 676f 6f64 0a20 2020 2023 2072  t a good.    # r
-0001b2f0: 6561 736f 6e2e 2054 6869 7320 6973 206e  eason. This is n
-0001b300: 6565 6465 6420 6265 6361 7573 6520 4167  eeded because Ag
-0001b310: 6772 6567 6174 696f 6e73 2068 6176 6520  gregations have 
-0001b320: 6e6f 7420 6265 656e 2066 756c 6c79 206d  not been fully m
-0001b330: 6967 7261 7465 6420 6f6e 746f 2073 7065  igrated onto spe
-0001b340: 6373 2e0a 2020 2020 6465 6620 5f74 6f5f  cs..    def _to_
-0001b350: 7370 6563 2873 656c 6629 202d 3e20 7370  spec(self) -> sp
-0001b360: 6563 732e 5265 6c61 7469 7665 5469 6d65  ecs.RelativeTime
-0001b370: 5769 6e64 6f77 5370 6563 3a0a 2020 2020  WindowSpec:.    
-0001b380: 2020 2020 7265 7475 726e 2073 7065 6373      return specs
-0001b390: 2e52 656c 6174 6976 6554 696d 6557 696e  .RelativeTimeWin
-0001b3a0: 646f 7753 7065 632e 6672 6f6d 5f61 7267  dowSpec.from_arg
-0001b3b0: 735f 7072 6f74 6f28 7365 6c66 2e5f 746f  s_proto(self._to
-0001b3c0: 5f70 726f 746f 2829 290a 0a0a 636c 6173  _proto())...clas
-0001b3d0: 7320 5469 6d65 5769 6e64 6f77 5365 7269  s TimeWindowSeri
-0001b3e0: 6573 2853 7472 6963 744d 6f64 656c 293a  es(StrictModel):
-0001b3f0: 0a20 2020 2022 2222 436f 6e66 6967 7572  .    """Configur
-0001b400: 6174 696f 6e20 7573 6564 2074 6f20 7370  ation used to sp
-0001b410: 6563 6966 7920 616e 2061 6767 7265 6761  ecify an aggrega
-0001b420: 7469 6f6e 2074 696d 6520 7769 6e64 6f77  tion time window
-0001b430: 2073 6572 6965 732e 0a0a 2020 2020 5468   series...    Th
-0001b440: 6973 2063 6c61 7373 2064 6573 6372 6962  is class describ
-0001b450: 6573 2074 6865 2061 7474 7269 6275 7465  es the attribute
-0001b460: 7320 6f66 2061 2074 696d 6520 7769 6e64  s of a time wind
-0001b470: 6f77 2073 6572 6965 7320 6f66 206d 756c  ow series of mul
-0001b480: 7469 706c 6520 7469 6d65 2077 696e 646f  tiple time windo
-0001b490: 7773 2074 6f20 6167 6772 6567 6174 6520  ws to aggregate 
-0001b4a0: 6f76 6572 2e20 5468 6973 2069 6e63 6c75  over. This inclu
-0001b4b0: 6465 730a 2020 2020 7468 6520 7374 6172  des.    the star
-0001b4c0: 7420 6f66 2074 6865 2066 6972 7374 2074  t of the first t
-0001b4d0: 696d 6520 7769 6e64 6f77 2c20 7468 6520  ime window, the 
-0001b4e0: 7369 7a65 206f 6620 6561 6368 2074 696d  size of each tim
-0001b4f0: 6520 7769 6e64 6f77 2c20 7468 6520 7374  e window, the st
-0001b500: 6570 2073 697a 6520 6265 7477 6565 6e20  ep size between 
-0001b510: 6561 6368 2074 696d 6520 7769 6e64 6f77  each time window
-0001b520: 2073 7461 7274 2074 696d 652c 2061 6e64   start time, and
-0001b530: 0a20 2020 2074 6865 2065 6e64 206f 6620  .    the end of 
-0001b540: 7468 6520 6c61 7374 2074 696d 6520 7769  the last time wi
-0001b550: 6e64 6f77 2065 6e64 2e0a 0a20 2020 203a  ndow end...    :
-0001b560: 7061 7261 6d20 7769 6e64 6f77 5f73 697a  param window_siz
-0001b570: 653a 2054 6865 2073 697a 6520 6f66 2074  e: The size of t
-0001b580: 6865 2077 696e 646f 7720 746f 2061 6767  he window to agg
-0001b590: 7265 6761 7465 206f 7665 722c 2073 7065  regate over, spe
-0001b5a0: 6369 6669 6564 2061 7320 6120 6461 7465  cified as a date
-0001b5b0: 7469 6d65 2e74 696d 6564 656c 7461 2e20  time.timedelta. 
-0001b5c0: 6060 6461 7465 7469 6d65 2e74 696d 6564  ``datetime.timed
-0001b5d0: 656c 7461 2864 6179 733d 3330 2960 600a  elta(days=30)``.
-0001b5e0: 2020 2020 3a70 6172 616d 2073 7465 705f      :param step_
-0001b5f0: 7369 7a65 3a20 5468 6520 7374 6570 2073  size: The step s
-0001b600: 697a 6520 6265 7477 6565 6e20 6561 6368  ize between each
-0001b610: 2074 696d 6520 7769 6e64 6f77 2073 7461   time window sta
-0001b620: 7274 2074 696d 652c 2073 7065 6369 6669  rt time, specifi
-0001b630: 6564 2061 7320 6120 6461 7465 7469 6d65  ed as a datetime
-0001b640: 2e74 696d 6564 656c 7461 2e20 6060 6461  .timedelta. ``da
-0001b650: 7465 7469 6d65 2e74 696d 6564 656c 7461  tetime.timedelta
-0001b660: 2864 6179 733d 3129 6060 0a20 2020 203a  (days=1)``.    :
-0001b670: 7061 7261 6d20 7374 6172 743a 2054 6865  param start: The
-0001b680: 206e 6567 6174 6976 6520 7374 6172 7420   negative start 
-0001b690: 6f66 2074 6865 2066 6972 7374 2074 696d  of the first tim
-0001b6a0: 6520 7769 6e64 6f77 2069 6e20 7468 6520  e window in the 
-0001b6b0: 7365 7269 6573 2e0a 2020 2020 3a70 6172  series..    :par
-0001b6c0: 616d 2065 6e64 3a20 5468 6520 6e65 6761  am end: The nega
-0001b6d0: 7469 7665 2065 6e64 206f 6620 7468 6520  tive end of the 
-0001b6e0: 6c61 7374 2074 696d 6520 7769 6e64 6f77  last time window
-0001b6f0: 2065 6e64 2069 6e20 7468 6520 7365 7269   end in the seri
-0001b700: 6573 2e22 2222 0a0a 2020 2020 7365 7269  es."""..    seri
-0001b710: 6573 5f73 7461 7274 3a20 6461 7465 7469  es_start: dateti
-0001b720: 6d65 2e74 696d 6564 656c 7461 0a20 2020  me.timedelta.   
-0001b730: 2073 6572 6965 735f 656e 643a 2064 6174   series_end: dat
-0001b740: 6574 696d 652e 7469 6d65 6465 6c74 6120  etime.timedelta 
-0001b750: 3d20 6461 7465 7469 6d65 2e74 696d 6564  = datetime.timed
-0001b760: 656c 7461 2873 6563 6f6e 6473 3d30 290a  elta(seconds=0).
-0001b770: 2020 2020 7374 6570 5f73 697a 653a 204f      step_size: O
-0001b780: 7074 696f 6e61 6c5b 6461 7465 7469 6d65  ptional[datetime
-0001b790: 2e74 696d 6564 656c 7461 5d20 3d20 4e6f  .timedelta] = No
-0001b7a0: 6e65 0a20 2020 2077 696e 646f 775f 7369  ne.    window_si
-0001b7b0: 7a65 3a20 6461 7465 7469 6d65 2e74 696d  ze: datetime.tim
-0001b7c0: 6564 656c 7461 0a0a 2020 2020 6465 6620  edelta..    def 
-0001b7d0: 5f74 6f5f 7072 6f74 6f28 7365 6c66 2920  _to_proto(self) 
-0001b7e0: 2d3e 2066 6561 7475 7265 5f76 6965 775f  -> feature_view_
-0001b7f0: 7062 322e 5469 6d65 5769 6e64 6f77 5365  pb2.TimeWindowSe
-0001b800: 7269 6573 3a0a 2020 2020 2020 2020 7374  ries:.        st
-0001b810: 6570 5f73 697a 6520 3d20 7365 6c66 2e73  ep_size = self.s
-0001b820: 7465 705f 7369 7a65 0a20 2020 2020 2020  tep_size.       
-0001b830: 2069 6620 7374 6570 5f73 697a 6520 6973   if step_size is
-0001b840: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0001b850: 2020 2073 7465 705f 7369 7a65 203d 2073     step_size = s
-0001b860: 656c 662e 7769 6e64 6f77 5f73 697a 650a  elf.window_size.
-0001b870: 2020 2020 2020 2020 7265 7475 726e 2066          return f
-0001b880: 6561 7475 7265 5f76 6965 775f 7062 322e  eature_view_pb2.
-0001b890: 5469 6d65 5769 6e64 6f77 5365 7269 6573  TimeWindowSeries
-0001b8a0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-0001b8b0: 7269 6573 5f73 7461 7274 3d74 696d 655f  ries_start=time_
-0001b8c0: 7574 696c 732e 7469 6d65 6465 6c74 615f  utils.timedelta_
-0001b8d0: 746f 5f70 726f 746f 2873 656c 662e 7365  to_proto(self.se
-0001b8e0: 7269 6573 5f73 7461 7274 292c 0a20 2020  ries_start),.   
-0001b8f0: 2020 2020 2020 2020 2073 6572 6965 735f           series_
-0001b900: 656e 643d 7469 6d65 5f75 7469 6c73 2e74  end=time_utils.t
-0001b910: 696d 6564 656c 7461 5f74 6f5f 7072 6f74  imedelta_to_prot
-0001b920: 6f28 7365 6c66 2e73 6572 6965 735f 656e  o(self.series_en
-0001b930: 6429 2c0a 2020 2020 2020 2020 2020 2020  d),.            
-0001b940: 7374 6570 5f73 697a 653d 7469 6d65 5f75  step_size=time_u
-0001b950: 7469 6c73 2e74 696d 6564 656c 7461 5f74  tils.timedelta_t
-0001b960: 6f5f 7072 6f74 6f28 7374 6570 5f73 697a  o_proto(step_siz
-0001b970: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
-0001b980: 7769 6e64 6f77 5f64 7572 6174 696f 6e3d  window_duration=
-0001b990: 7469 6d65 5f75 7469 6c73 2e74 696d 6564  time_utils.timed
-0001b9a0: 656c 7461 5f74 6f5f 7072 6f74 6f28 7365  elta_to_proto(se
-0001b9b0: 6c66 2e77 696e 646f 775f 7369 7a65 292c  lf.window_size),
-0001b9c0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-0001b9d0: 2320 544f 444f 286a 616b 6529 3a20 5468  # TODO(jake): Th
-0001b9e0: 6973 2069 7320 616e 2075 6e75 7375 616c  is is an unusual
-0001b9f0: 2070 6174 7465 726e 2074 6f20 636f 6e76   pattern to conv
-0001ba00: 6572 7420 6120 636f 6e66 6967 206f 626a  ert a config obj
-0001ba10: 6563 7420 746f 2061 2073 7065 6320 6c69  ect to a spec li
-0001ba20: 6b65 2e20 446f 206e 6f74 2072 6570 6c69  ke. Do not repli
-0001ba30: 6361 7465 2077 6974 686f 7574 2061 2067  cate without a g
-0001ba40: 6f6f 640a 2020 2020 2320 7265 6173 6f6e  ood.    # reason
-0001ba50: 2e20 5468 6973 2069 7320 6e65 6564 6564  . This is needed
-0001ba60: 2062 6563 6175 7365 2041 6767 7265 6761   because Aggrega
-0001ba70: 7469 6f6e 7320 6861 7665 206e 6f74 2062  tions have not b
-0001ba80: 6565 6e20 6675 6c6c 7920 6d69 6772 6174  een fully migrat
-0001ba90: 6564 206f 6e74 6f20 7370 6563 732e 0a20  ed onto specs.. 
-0001baa0: 2020 2064 6566 205f 746f 5f73 7065 6328     def _to_spec(
-0001bab0: 7365 6c66 2920 2d3e 2073 7065 6373 2e54  self) -> specs.T
-0001bac0: 696d 6557 696e 646f 7753 6572 6965 7353  imeWindowSeriesS
-0001bad0: 7065 633a 0a20 2020 2020 2020 2072 6574  pec:.        ret
-0001bae0: 7572 6e20 7370 6563 732e 5469 6d65 5769  urn specs.TimeWi
-0001baf0: 6e64 6f77 5365 7269 6573 5370 6563 2e66  ndowSeriesSpec.f
-0001bb00: 726f 6d5f 6172 6773 5f70 726f 746f 2873  rom_args_proto(s
-0001bb10: 656c 662e 5f74 6f5f 7072 6f74 6f28 2929  elf._to_proto())
-0001bb20: 0a0a 0a63 6c61 7373 2043 6163 6865 436f  ...class CacheCo
-0001bb30: 6e66 6967 2853 7472 6963 744d 6f64 656c  nfig(StrictModel
-0001bb40: 293a 0a20 2020 2022 2222 436f 6e66 6967  ):.    """Config
-0001bb50: 7572 6174 696f 6e20 6f62 6a65 6374 2066  uration object f
-0001bb60: 6f72 2066 6561 7475 7265 2076 6965 7720  or feature view 
-0001bb70: 6f6e 6c69 6e65 2063 6163 6869 6e67 2e0a  online caching..
-0001bb80: 0a20 2020 203a 7061 7261 6d20 6d61 785f  .    :param max_
-0001bb90: 6167 655f 7365 636f 6e64 733a 2054 6865  age_seconds: The
-0001bba0: 206d 6178 696d 756d 2074 696d 6520 696e   maximum time in
-0001bbb0: 2073 6563 6f6e 6473 2074 6861 7420 6665   seconds that fe
-0001bbc0: 6174 7572 6573 2066 726f 6d20 7468 6973  atures from this
-0001bbd0: 2066 6561 7475 7265 2076 6965 7720 6361   feature view ca
-0001bbe0: 6e20 6265 2063 6163 6865 642e 204d 7573  n be cached. Mus
-0001bbf0: 7420 6265 0a20 2020 2020 2020 2062 6574  t be.        bet
-0001bc00: 7765 656e 206f 6e65 206d 696e 7574 6520  ween one minute 
-0001bc10: 2836 3073 2920 616e 6420 6f6e 6520 6461  (60s) and one da
-0001bc20: 7920 2838 365f 3430 3073 292e 0a20 2020  y (86_400s)..   
-0001bc30: 2022 2222 0a0a 2020 2020 6d61 785f 6167   """..    max_ag
-0001bc40: 655f 7365 636f 6e64 733a 2069 6e74 0a0a  e_seconds: int..
-0001bc50: 2020 2020 6465 6620 5f74 6f5f 7072 6f74      def _to_prot
-0001bc60: 6f28 7365 6c66 2920 2d3e 2066 6561 7475  o(self) -> featu
-0001bc70: 7265 5f76 6965 775f 7062 322e 4361 6368  re_view_pb2.Cach
-0001bc80: 6543 6f6e 6669 673a 0a20 2020 2020 2020  eConfig:.       
-0001bc90: 2072 6574 7572 6e20 6665 6174 7572 655f   return feature_
-0001bca0: 7669 6577 5f70 6232 2e43 6163 6865 436f  view_pb2.CacheCo
-0001bcb0: 6e66 6967 280a 2020 2020 2020 2020 2020  nfig(.          
-0001bcc0: 2020 6d61 785f 6167 655f 7365 636f 6e64    max_age_second
-0001bcd0: 733d 7365 6c66 2e6d 6178 5f61 6765 5f73  s=self.max_age_s
-0001bce0: 6563 6f6e 6473 2c0a 2020 2020 2020 2020  econds,.        
-0001bcf0: 290a 0a0a 636c 6173 7320 4167 6772 6567  )...class Aggreg
-0001bd00: 6174 696f 6e28 5374 7269 6374 4d6f 6465  ation(StrictMode
-0001bd10: 6c29 3a0a 2020 2020 2222 220a 2020 2020  l):.    """.    
-0001bd20: 5468 6973 2063 6c61 7373 2064 6573 6372  This class descr
-0001bd30: 6962 6573 2061 2073 696e 676c 6520 6167  ibes a single ag
-0001bd40: 6772 6567 6174 696f 6e20 7468 6174 2069  gregation that i
-0001bd50: 7320 6170 706c 6965 6420 696e 2061 2062  s applied in a b
-0001bd60: 6174 6368 206f 7220 7374 7265 616d 2066  atch or stream f
-0001bd70: 6561 7475 7265 2076 6965 772e 0a0a 2020  eature view...  
-0001bd80: 2020 3a70 6172 616d 2063 6f6c 756d 6e3a    :param column:
-0001bd90: 2043 6f6c 756d 6e20 6e61 6d65 206f 6620   Column name of 
-0001bda0: 7468 6520 6665 6174 7572 6520 7765 2061  the feature we a
-0001bdb0: 7265 2061 6767 7265 6761 7469 6e67 2e0a  re aggregating..
-0001bdc0: 2020 2020 3a74 7970 6520 636f 6c75 6d6e      :type column
-0001bdd0: 3a20 7374 720a 2020 2020 3a70 6172 616d  : str.    :param
-0001bde0: 2066 756e 6374 696f 6e3a 204f 6e65 206f   function: One o
-0001bdf0: 6620 7468 6520 6275 696c 742d 696e 2061  f the built-in a
-0001be00: 6767 7265 6761 7469 6f6e 2066 756e 6374  ggregation funct
-0001be10: 696f 6e73 2e0a 2020 2020 3a74 7970 6520  ions..    :type 
-0001be20: 6675 6e63 7469 6f6e 3a20 556e 696f 6e5b  function: Union[
-0001be30: 7374 722c 2041 6767 7265 6761 7469 6f6e  str, Aggregation
-0001be40: 4675 6e63 7469 6f6e 5d0a 2020 2020 3a70  Function].    :p
-0001be50: 6172 616d 2074 696d 655f 7769 6e64 6f77  aram time_window
-0001be60: 3a20 4475 7261 7469 6f6e 2074 6f20 6167  : Duration to ag
-0001be70: 6772 6567 6174 6520 6f76 6572 2e20 4578  gregate over. Ex
-0001be80: 616d 706c 653a 2060 6064 6174 6574 696d  ample: ``datetim
-0001be90: 652e 7469 6d65 6465 6c74 6128 6461 7973  e.timedelta(days
-0001bea0: 3d33 3029 6060 2e0a 2020 2020 3a74 7970  =30)``..    :typ
-0001beb0: 6520 7469 6d65 5f77 696e 646f 773a 2064  e time_window: d
-0001bec0: 6174 6574 696d 652e 7469 6d65 6465 6c74  atetime.timedelt
-0001bed0: 610a 2020 2020 3a70 6172 616d 206e 616d  a.    :param nam
-0001bee0: 653a 2054 6865 206e 616d 6520 6f66 2074  e: The name of t
-0001bef0: 6869 7320 6665 6174 7572 652e 2044 6566  his feature. Def
-0001bf00: 6175 6c74 7320 746f 2061 6e20 6175 746f  aults to an auto
-0001bf10: 6765 6e65 7261 7465 6420 6e61 6d65 2c20  generated name, 
-0001bf20: 652e 672e 2074 7261 6e73 6163 7469 6f6e  e.g. transaction
-0001bf30: 5f63 6f75 6e74 5f37 645f 3164 2e0a 2020  _count_7d_1d..  
-0001bf40: 2020 3a74 7970 6520 6e61 6d65 3a20 7374    :type name: st
-0001bf50: 720a 0a20 2020 2060 6675 6e63 7469 6f6e  r..    `function
-0001bf60: 6020 6361 6e20 6265 206f 6e65 206f 6620  ` can be one of 
-0001bf70: 7072 6564 6566 696e 6564 206e 756d 6572  predefined numer
-0001bf80: 6963 2061 6767 7265 6761 7469 6f6e 2066  ic aggregation f
-0001bf90: 756e 6374 696f 6e73 2c20 6e61 6d65 6c79  unctions, namely
-0001bfa0: 2060 6022 636f 756e 7422 6060 2c20 6060   ``"count"``, ``
-0001bfb0: 2273 756d 2260 602c 2060 6022 6d65 616e  "sum"``, ``"mean
-0001bfc0: 2260 602c 2060 6022 6d69 6e22 6060 2c20  "``, ``"min"``, 
-0001bfd0: 6060 226d 6178 2260 602c 2060 6022 7661  ``"max"``, ``"va
-0001bfe0: 725f 7361 6d70 2260 602c 2060 6022 7661  r_samp"``, ``"va
-0001bff0: 725f 706f 7022 6060 2c20 6060 2276 6172  r_pop"``, ``"var
-0001c000: 6961 6e63 6522 6060 202d 2061 6c69 6173  iance"`` - alias
-0001c010: 2066 6f72 2060 6022 7661 725f 7361 6d70   for ``"var_samp
-0001c020: 2260 602c 2060 6022 7374 6464 6576 5f73  "``, ``"stddev_s
-0001c030: 616d 7022 6060 2c20 6060 2273 7464 6465  amp"``, ``"stdde
-0001c040: 765f 706f 7022 6060 2c20 6060 2273 7464  v_pop"``, ``"std
-0001c050: 6465 7622 6060 202d 2061 6c69 6173 2066  dev"`` - alias f
-0001c060: 6f72 2060 6022 7374 6464 6576 5f73 616d  or ``"stddev_sam
-0001c070: 7022 6060 2e20 466f 720a 2020 2020 7468  p"``. For.    th
-0001c080: 6573 6520 6e75 6d65 7269 6320 6167 6772  ese numeric aggr
-0001c090: 6567 6174 696f 6e73 2c20 796f 7520 6361  egations, you ca
-0001c0a0: 6e20 7061 7373 2074 6865 206e 616d 6520  n pass the name 
-0001c0b0: 6f66 2069 7420 6173 2061 2073 7472 696e  of it as a strin
-0001c0c0: 672e 204e 756c 6c73 2061 7265 2068 616e  g. Nulls are han
-0001c0d0: 646c 6564 206c 696b 6520 5370 6172 6b20  dled like Spark 
-0001c0e0: 5351 4c20 6046 756e 6374 696f 6e28 636f  SQL `Function(co
-0001c0f0: 6c75 6d6e 2960 2c20 652e 672e 2053 554d  lumn)`, e.g. SUM
-0001c100: 2f4d 4541 4e2f 4d49 4e2f 4d41 582f 5641  /MEAN/MIN/MAX/VA
-0001c110: 525f 5341 4d50 2f56 4152 5f50 4f50 2f56  R_SAMP/VAR_POP/V
-0001c120: 4152 2f53 5444 4445 565f 5341 4d50 2f53  AR/STDDEV_SAMP/S
-0001c130: 5444 4445 565f 504f 502f 5354 4444 4556  TDDEV_POP/STDDEV
-0001c140: 206f 6620 616c 6c20 6e75 6c6c 7320 6973   of all nulls is
-0001c150: 206e 756c 6c20 616e 6420 434f 554e 5420   null and COUNT 
-0001c160: 6f66 2061 6c6c 206e 756c 6c73 2069 7320  of all nulls is 
-0001c170: 302e 0a0a 2020 2020 496e 2061 6464 6974  0...    In addit
-0001c180: 696f 6e20 746f 206e 756d 6572 6963 2061  ion to numeric a
-0001c190: 6767 7265 6761 7469 6f6e 732c 203a 636c  ggregations, :cl
-0001c1a0: 6173 733a 6041 6767 7265 6761 7469 6f6e  ass:`Aggregation
-0001c1b0: 6020 7375 7070 6f72 7473 2074 6865 206c  ` supports the l
-0001c1c0: 6173 7420 6e6f 6e2d 6469 7374 696e 6374  ast non-distinct
-0001c1d0: 2061 6e64 2064 6973 7469 6e63 7420 4e20   and distinct N 
-0001c1e0: 6167 6772 6567 6174 696f 6e20 7468 6174  aggregation that
-0001c1f0: 2077 696c 6c20 636f 6d70 7574 6520 7468   will compute th
-0001c200: 6520 6c61 7374 204e 206e 6f6e 2d64 6973  e last N non-dis
-0001c210: 7469 6e63 7420 616e 6420 6469 7374 696e  tinct and distin
-0001c220: 6374 2076 616c 7565 7320 666f 7220 7468  ct values for th
-0001c230: 6520 636f 6c75 6d6e 2062 7920 7469 6d65  e column by time
-0001c240: 7374 616d 702e 2052 6967 6874 206e 6f77  stamp. Right now
-0001c250: 206f 6e6c 7920 7374 7269 6e67 2063 6f6c   only string col
-0001c260: 756d 6e20 6973 2073 7570 706f 7274 6564  umn is supported
-0001c270: 2061 7320 696e 7075 7420 746f 2074 6869   as input to thi
-0001c280: 7320 6167 6772 6567 6174 696f 6e2c 2069  s aggregation, i
-0001c290: 2e65 2e2c 2074 6865 2072 6573 756c 7469  .e., the resulti
-0001c2a0: 6e67 2066 6561 7475 7265 2076 616c 7565  ng feature value
-0001c2b0: 2077 696c 6c20 6265 2061 206c 6973 7420   will be a list 
-0001c2c0: 6f66 2073 7472 696e 6773 2e20 5468 6520  of strings. The 
-0001c2d0: 6f72 6465 7220 6f66 2074 6865 2076 616c  order of the val
-0001c2e0: 7565 2069 6e20 7468 6520 6c69 7374 2069  ue in the list i
-0001c2f0: 7320 6173 6365 6e64 696e 6720 6261 7365  s ascending base
-0001c300: 6420 6f6e 2074 6865 2074 696d 6573 7461  d on the timesta
-0001c310: 6d70 2e20 4e75 6c6c 7320 6172 6520 6e6f  mp. Nulls are no
-0001c320: 7420 696e 636c 7564 6564 2069 6e20 7468  t included in th
-0001c330: 6520 6167 6772 6567 6174 6564 206c 6973  e aggregated lis
-0001c340: 742e 0a0a 2020 2020 596f 7520 6361 6e20  t...    You can 
-0001c350: 7573 6520 6974 2076 6961 2074 6865 2060  use it via the `
-0001c360: 6060 6c61 7374 2829 6060 6020 616e 6420  ``last()``` and 
-0001c370: 2060 606c 6173 745f 6469 7374 696e 6374   ``last_distinct
-0001c380: 2829 6060 2068 656c 7065 7220 6675 6e63  ()`` helper func
-0001c390: 7469 6f6e 206c 696b 6520 7468 6973 3a0a  tion like this:.
-0001c3a0: 0a20 2020 202e 2e20 636f 6465 2d62 6c6f  .    .. code-blo
-0001c3b0: 636b 3a3a 2070 7974 686f 6e0a 0a20 2020  ck:: python..   
-0001c3c0: 2020 2020 2066 726f 6d20 7465 6374 6f6e       from tecton
-0001c3d0: 2e61 6767 7265 6761 7469 6f6e 5f66 756e  .aggregation_fun
-0001c3e0: 6374 696f 6e73 2069 6d70 6f72 7420 6c61  ctions import la
-0001c3f0: 7374 5f64 6973 7469 6e63 742c 206c 6173  st_distinct, las
-0001c400: 740a 0a20 2020 2020 2020 2040 6261 7463  t..        @batc
-0001c410: 685f 6665 6174 7572 655f 7669 6577 280a  h_feature_view(.
-0001c420: 2020 2020 2020 2020 2e2e 2e0a 2020 2020          ....    
-0001c430: 2020 2020 6167 6772 6567 6174 696f 6e73      aggregations
-0001c440: 3d5b 0a20 2020 2020 2020 2020 2020 2041  =[.            A
-0001c450: 6767 7265 6761 7469 6f6e 280a 2020 2020  ggregation(.    
-0001c460: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
-0001c470: 6d6e 3d27 6d79 5f63 6f6c 756d 6e27 2c0a  mn='my_column',.
-0001c480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c490: 6675 6e63 7469 6f6e 3d6c 6173 745f 6469  function=last_di
-0001c4a0: 7374 696e 6374 2831 3529 2c0a 2020 2020  stinct(15),.    
-0001c4b0: 2020 2020 2020 2020 2020 2020 7469 6d65              time
-0001c4c0: 5f77 696e 646f 773d 6461 7465 7469 6d65  _window=datetime
-0001c4d0: 2e74 696d 6564 656c 7461 2864 6179 733d  .timedelta(days=
-0001c4e0: 3729 292c 0a20 2020 2020 2020 2020 2020  7)),.           
-0001c4f0: 2041 6767 7265 6761 7469 6f6e 280a 2020   Aggregation(.  
-0001c500: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0001c510: 6c75 6d6e 3d27 6d79 5f63 6f6c 756d 6e27  lumn='my_column'
-0001c520: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001c530: 2020 6675 6e63 7469 6f6e 3d6c 6173 7428    function=last(
-0001c540: 3135 292c 0a20 2020 2020 2020 2020 2020  15),.           
-0001c550: 2020 2020 2074 696d 655f 7769 6e64 6f77       time_window
-0001c560: 3d64 6174 6574 696d 652e 7469 6d65 6465  =datetime.timede
-0001c570: 6c74 6128 6461 7973 3d37 2929 2c0a 2020  lta(days=7)),.  
-0001c580: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
-0001c590: 2020 2020 202e 2e2e 0a20 2020 2020 2020       ....       
-0001c5a0: 2029 0a20 2020 2020 2020 2064 6566 206d   ).        def m
-0001c5b0: 795f 6676 2864 6174 615f 736f 7572 6365  y_fv(data_source
-0001c5c0: 293a 0a20 2020 2020 2020 2020 2020 2070  ):.            p
-0001c5d0: 6173 730a 0a20 2020 2022 2222 0a0a 2020  ass..    """..  
-0001c5e0: 2020 636f 6c75 6d6e 3a20 7374 720a 2020    column: str.  
-0001c5f0: 2020 6675 6e63 7469 6f6e 3a20 4167 6772    function: Aggr
-0001c600: 6567 6174 696f 6e46 756e 6374 696f 6e0a  egationFunction.
-0001c610: 2020 2020 7469 6d65 5f77 696e 646f 773a      time_window:
-0001c620: 2055 6e69 6f6e 5b4c 6966 6574 696d 6557   Union[LifetimeW
-0001c630: 696e 646f 772c 2054 696d 6557 696e 646f  indow, TimeWindo
-0001c640: 772c 2054 696d 6557 696e 646f 7753 6572  w, TimeWindowSer
-0001c650: 6965 735d 0a20 2020 206e 616d 653a 204f  ies].    name: O
-0001c660: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
-0001c670: 6f6e 650a 0a20 2020 2040 7079 6461 6e74  one..    @pydant
-0001c680: 6963 5f76 312e 7661 6c69 6461 746f 7228  ic_v1.validator(
-0001c690: 2274 696d 655f 7769 6e64 6f77 222c 2070  "time_window", p
-0001c6a0: 7265 3d54 7275 6529 0a20 2020 2064 6566  re=True).    def
-0001c6b0: 2074 696d 6564 656c 7461 5f74 6f5f 7469   timedelta_to_ti
-0001c6c0: 6d65 5f77 696e 646f 7728 636c 732c 2076  me_window(cls, v
-0001c6d0: 293a 0a20 2020 2020 2020 2069 6620 6973  ):.        if is
-0001c6e0: 696e 7374 616e 6365 2876 2c20 6461 7465  instance(v, date
-0001c6f0: 7469 6d65 2e74 696d 6564 656c 7461 293a  time.timedelta):
-0001c700: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001c710: 7572 6e20 5469 6d65 5769 6e64 6f77 2877  urn TimeWindow(w
-0001c720: 696e 646f 775f 7369 7a65 3d76 290a 2020  indow_size=v).  
-0001c730: 2020 2020 2020 7265 7475 726e 2076 0a0a        return v..
-0001c740: 2020 2020 4070 7964 616e 7469 635f 7631      @pydantic_v1
-0001c750: 2e76 616c 6964 6174 6f72 2822 6675 6e63  .validator("func
-0001c760: 7469 6f6e 222c 2070 7265 3d54 7275 6529  tion", pre=True)
-0001c770: 0a20 2020 2064 6566 2073 7472 5f74 6f5f  .    def str_to_
-0001c780: 6167 6772 6567 6174 696f 6e5f 6675 6e63  aggregation_func
-0001c790: 7469 6f6e 2863 6c73 2c20 7629 3a0a 2020  tion(cls, v):.  
-0001c7a0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0001c7b0: 6e63 6528 762c 2073 7472 293a 0a20 2020  nce(v, str):.   
-0001c7c0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0001c7d0: 4167 6772 6567 6174 696f 6e46 756e 6374  AggregationFunct
-0001c7e0: 696f 6e28 6261 7365 5f6e 616d 653d 762c  ion(base_name=v,
-0001c7f0: 2072 6573 6f6c 7665 645f 6e61 6d65 3d76   resolved_name=v
-0001c800: 2c20 7061 7261 6d73 3d4d 6170 7069 6e67  , params=Mapping
-0001c810: 5072 6f78 7954 7970 6528 7b7d 2929 0a20  ProxyType({})). 
-0001c820: 2020 2020 2020 2072 6574 7572 6e20 760a         return v.
-0001c830: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
-0001c840: 5f28 0a20 2020 2020 2020 2073 656c 662c  _(.        self,
-0001c850: 0a20 2020 2020 2020 2063 6f6c 756d 6e3a  .        column:
-0001c860: 2073 7472 2c0a 2020 2020 2020 2020 6675   str,.        fu
-0001c870: 6e63 7469 6f6e 3a20 556e 696f 6e5b 7374  nction: Union[st
-0001c880: 722c 2041 6767 7265 6761 7469 6f6e 4675  r, AggregationFu
-0001c890: 6e63 7469 6f6e 5d2c 0a20 2020 2020 2020  nction],.       
-0001c8a0: 2074 696d 655f 7769 6e64 6f77 3a20 556e   time_window: Un
-0001c8b0: 696f 6e5b 5469 6d65 5769 6e64 6f77 2c20  ion[TimeWindow, 
-0001c8c0: 4c69 6665 7469 6d65 5769 6e64 6f77 2c20  LifetimeWindow, 
-0001c8d0: 6461 7465 7469 6d65 2e74 696d 6564 656c  datetime.timedel
-0001c8e0: 7461 5d2c 0a20 2020 2020 2020 206e 616d  ta],.        nam
-0001c8f0: 653a 204f 7074 696f 6e61 6c5b 7374 725d  e: Optional[str]
-0001c900: 203d 204e 6f6e 652c 0a20 2020 2029 3a0a   = None,.    ):.
-0001c910: 2020 2020 2020 2020 7375 7065 7228 292e          super().
-0001c920: 5f5f 696e 6974 5f5f 2863 6f6c 756d 6e3d  __init__(column=
-0001c930: 636f 6c75 6d6e 2c20 6675 6e63 7469 6f6e  column, function
-0001c940: 3d66 756e 6374 696f 6e2c 2074 696d 655f  =function, time_
-0001c950: 7769 6e64 6f77 3d74 696d 655f 7769 6e64  window=time_wind
-0001c960: 6f77 2c20 6e61 6d65 3d6e 616d 6529 0a0a  ow, name=name)..
-0001c970: 2020 2020 6465 6620 5f74 6f5f 7072 6f74      def _to_prot
-0001c980: 6f28 0a20 2020 2020 2020 2073 656c 662c  o(.        self,
-0001c990: 2061 6767 7265 6761 7469 6f6e 5f69 6e74   aggregation_int
-0001c9a0: 6572 7661 6c3a 2064 6174 6574 696d 652e  erval: datetime.
-0001c9b0: 7469 6d65 6465 6c74 612c 2069 735f 636f  timedelta, is_co
-0001c9c0: 6e74 696e 756f 7573 3a20 626f 6f6c 2c20  ntinuous: bool, 
-0001c9d0: 636f 6d70 6163 7469 6f6e 5f65 6e61 626c  compaction_enabl
-0001c9e0: 6564 3a20 626f 6f6c 203d 2046 616c 7365  ed: bool = False
-0001c9f0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-0001ca00: 7072 6f74 6f20 3d20 6665 6174 7572 655f  proto = feature_
-0001ca10: 7669 6577 5f70 6232 2e46 6561 7475 7265  view_pb2.Feature
-0001ca20: 4167 6772 6567 6174 696f 6e28 0a20 2020  Aggregation(.   
-0001ca30: 2020 2020 2020 2020 206e 616d 653d 7365           name=se
-0001ca40: 6c66 2e6e 616d 650a 2020 2020 2020 2020  lf.name.        
-0001ca50: 2020 2020 6966 2073 656c 662e 6e61 6d65      if self.name
-0001ca60: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-0001ca70: 6520 7365 6c66 2e5f 6465 6661 756c 745f  e self._default_
-0001ca80: 6e61 6d65 2861 6767 7265 6761 7469 6f6e  name(aggregation
-0001ca90: 5f69 6e74 6572 7661 6c2c 2069 735f 636f  _interval, is_co
-0001caa0: 6e74 696e 756f 7573 2c20 636f 6d70 6163  ntinuous, compac
-0001cab0: 7469 6f6e 5f65 6e61 626c 6564 292c 0a20  tion_enabled),. 
-0001cac0: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
-0001cad0: 6e3d 7365 6c66 2e63 6f6c 756d 6e2c 0a20  n=self.column,. 
-0001cae0: 2020 2020 2020 2020 2020 2066 756e 6374             funct
-0001caf0: 696f 6e3d 7365 6c66 2e66 756e 6374 696f  ion=self.functio
-0001cb00: 6e2e 6261 7365 5f6e 616d 652c 0a20 2020  n.base_name,.   
-0001cb10: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0001cb20: 666f 7220 6b2c 2076 2069 6e20 7365 6c66  for k, v in self
-0001cb30: 2e66 756e 6374 696f 6e2e 7061 7261 6d73  .function.params
-0001cb40: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
-0001cb50: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0001cb60: 6e63 6528 762c 2069 6e74 293a 0a20 2020  nce(v, int):.   
-0001cb70: 2020 2020 2020 2020 2020 2020 2070 726f               pro
-0001cb80: 746f 2e66 756e 6374 696f 6e5f 7061 7261  to.function_para
-0001cb90: 6d73 5b6b 5d2e 436f 7079 4672 6f6d 2866  ms[k].CopyFrom(f
-0001cba0: 6561 7475 7265 5f76 6965 775f 7062 322e  eature_view_pb2.
-0001cbb0: 5061 7261 6d56 616c 7565 2869 6e74 3634  ParamValue(int64
-0001cbc0: 5f76 616c 7565 3d76 2929 0a20 2020 2020  _value=v)).     
-0001cbd0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0001cbe0: 2020 2020 2020 2020 2020 2020 2070 726f               pro
-0001cbf0: 746f 2e66 756e 6374 696f 6e5f 7061 7261  to.function_para
-0001cc00: 6d73 5b6b 5d2e 436f 7079 4672 6f6d 2866  ms[k].CopyFrom(f
-0001cc10: 6561 7475 7265 5f76 6965 775f 7062 322e  eature_view_pb2.
-0001cc20: 5061 7261 6d56 616c 7565 2864 6f75 626c  ParamValue(doubl
-0001cc30: 655f 7661 6c75 653d 7629 290a 0a20 2020  e_value=v))..   
-0001cc40: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-0001cc50: 6365 2873 656c 662e 7469 6d65 5f77 696e  ce(self.time_win
-0001cc60: 646f 772c 2054 696d 6557 696e 646f 7729  dow, TimeWindow)
-0001cc70: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
-0001cc80: 6f74 6f2e 7469 6d65 5f77 696e 646f 772e  oto.time_window.
-0001cc90: 436f 7079 4672 6f6d 2873 656c 662e 7469  CopyFrom(self.ti
-0001cca0: 6d65 5f77 696e 646f 772e 5f74 6f5f 7072  me_window._to_pr
-0001ccb0: 6f74 6f28 2929 0a20 2020 2020 2020 2065  oto()).        e
-0001ccc0: 6c69 6620 6973 696e 7374 616e 6365 2873  lif isinstance(s
-0001ccd0: 656c 662e 7469 6d65 5f77 696e 646f 772c  elf.time_window,
-0001cce0: 204c 6966 6574 696d 6557 696e 646f 7729   LifetimeWindow)
-0001ccf0: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
-0001cd00: 6f74 6f2e 6c69 6665 7469 6d65 5f77 696e  oto.lifetime_win
-0001cd10: 646f 772e 436f 7079 4672 6f6d 2873 656c  dow.CopyFrom(sel
-0001cd20: 662e 7469 6d65 5f77 696e 646f 772e 5f74  f.time_window._t
-0001cd30: 6f5f 7072 6f74 6f28 2929 0a20 2020 2020  o_proto()).     
-0001cd40: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
-0001cd50: 6365 2873 656c 662e 7469 6d65 5f77 696e  ce(self.time_win
-0001cd60: 646f 772c 2054 696d 6557 696e 646f 7753  dow, TimeWindowS
-0001cd70: 6572 6965 7329 3a0a 2020 2020 2020 2020  eries):.        
-0001cd80: 2020 2020 7072 6f74 6f2e 7469 6d65 5f77      proto.time_w
-0001cd90: 696e 646f 775f 7365 7269 6573 2e43 6f70  indow_series.Cop
-0001cda0: 7946 726f 6d28 7365 6c66 2e74 696d 655f  yFrom(self.time_
-0001cdb0: 7769 6e64 6f77 2e5f 746f 5f70 726f 746f  window._to_proto
-0001cdc0: 2829 290a 2020 2020 2020 2020 656c 7365  ()).        else
-0001cdd0: 3a0a 2020 2020 2020 2020 2020 2020 6d73  :.            ms
-0001cde0: 6720 3d20 6622 496e 7661 6c69 6420 7469  g = f"Invalid ti
-0001cdf0: 6d65 5f77 696e 646f 7720 7479 7065 3a20  me_window type: 
-0001ce00: 7b74 7970 6528 7365 6c66 2e74 696d 655f  {type(self.time_
-0001ce10: 7769 6e64 6f77 297d 220a 2020 2020 2020  window)}".      
-0001ce20: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-0001ce30: 4572 726f 7228 6d73 6729 0a0a 2020 2020  Error(msg)..    
-0001ce40: 2020 2020 7265 7475 726e 2070 726f 746f      return proto
-0001ce50: 0a0a 2020 2020 6465 6620 5f64 6566 6175  ..    def _defau
-0001ce60: 6c74 5f6e 616d 6528 0a20 2020 2020 2020  lt_name(.       
-0001ce70: 2073 656c 662c 2061 6767 7265 6761 7469   self, aggregati
-0001ce80: 6f6e 5f69 6e74 6572 7661 6c3a 2064 6174  on_interval: dat
-0001ce90: 6574 696d 652e 7469 6d65 6465 6c74 612c  etime.timedelta,
-0001cea0: 2069 735f 636f 6e74 696e 756f 7573 3a20   is_continuous: 
-0001ceb0: 626f 6f6c 2c20 636f 6d70 6163 7469 6f6e  bool, compaction
-0001cec0: 5f65 6e61 626c 6564 3a20 626f 6f6c 0a20  _enabled: bool. 
-0001ced0: 2020 2029 202d 3e20 7374 723a 0a20 2020     ) -> str:.   
-0001cee0: 2020 2020 2077 696e 646f 775f 7370 6563       window_spec
-0001cef0: 203d 2073 656c 662e 7469 6d65 5f77 696e   = self.time_win
-0001cf00: 646f 772e 5f74 6f5f 7370 6563 2829 0a20  dow._to_spec(). 
-0001cf10: 2020 2020 2020 2063 6f6c 756d 6e5f 6e61         column_na
-0001cf20: 6d65 203d 2066 227b 7365 6c66 2e63 6f6c  me = f"{self.col
-0001cf30: 756d 6e7d 5f7b 7365 6c66 2e66 756e 6374  umn}_{self.funct
-0001cf40: 696f 6e2e 7265 736f 6c76 6564 5f6e 616d  ion.resolved_nam
-0001cf50: 657d 5f7b 7769 6e64 6f77 5f73 7065 632e  e}_{window_spec.
-0001cf60: 7769 6e64 6f77 5f64 7572 6174 696f 6e5f  window_duration_
-0001cf70: 7374 7269 6e67 2829 7d22 0a0a 2020 2020  string()}"..    
-0001cf80: 2020 2020 6966 206e 6f74 2063 6f6d 7061      if not compa
-0001cf90: 6374 696f 6e5f 656e 6162 6c65 643a 0a20  ction_enabled:. 
-0001cfa0: 2020 2020 2020 2020 2020 2061 6767 5f69             agg_i
-0001cfb0: 6e74 6572 7661 6c5f 6e61 6d65 203d 2066  nterval_name = f
-0001cfc0: 6561 7475 7265 5f76 6965 775f 7574 696c  eature_view_util
-0001cfd0: 732e 636f 6e73 7472 7563 745f 6167 6772  s.construct_aggr
-0001cfe0: 6567 6174 696f 6e5f 696e 7465 7276 616c  egation_interval
-0001cff0: 5f6e 616d 6528 0a20 2020 2020 2020 2020  _name(.         
-0001d000: 2020 2020 2020 2074 696d 655f 7574 696c         time_util
-0001d010: 732e 7469 6d65 6465 6c74 615f 746f 5f70  s.timedelta_to_p
-0001d020: 726f 746f 2861 6767 7265 6761 7469 6f6e  roto(aggregation
-0001d030: 5f69 6e74 6572 7661 6c29 2c20 6973 5f63  _interval), is_c
-0001d040: 6f6e 7469 6e75 6f75 730a 2020 2020 2020  ontinuous.      
-0001d050: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0001d060: 2020 2020 636f 6c75 6d6e 5f6e 616d 6520      column_name 
-0001d070: 3d20 6622 7b63 6f6c 756d 6e5f 6e61 6d65  = f"{column_name
-0001d080: 7d5f 7b61 6767 5f69 6e74 6572 7661 6c5f  }_{agg_interval_
-0001d090: 6e61 6d65 7d22 0a0a 2020 2020 2020 2020  name}"..        
-0001d0a0: 6966 2069 7369 6e73 7461 6e63 6528 7365  if isinstance(se
-0001d0b0: 6c66 2e74 696d 655f 7769 6e64 6f77 2c20  lf.time_window, 
-0001d0c0: 5469 6d65 5769 6e64 6f77 5365 7269 6573  TimeWindowSeries
-0001d0d0: 293a 0a20 2020 2020 2020 2020 2020 2063  ):.            c
-0001d0e0: 6f6c 756d 6e5f 6e61 6d65 203d 2066 227b  olumn_name = f"{
-0001d0f0: 636f 6c75 6d6e 5f6e 616d 657d 5f73 6572  column_name}_ser
-0001d100: 6965 735f 7b77 696e 646f 775f 7370 6563  ies_{window_spec
-0001d110: 2e77 696e 646f 775f 7365 7269 6573 5f73  .window_series_s
-0001d120: 7461 7274 5f73 7472 696e 6728 297d 5f7b  tart_string()}_{
-0001d130: 7769 6e64 6f77 5f73 7065 632e 7769 6e64  window_spec.wind
-0001d140: 6f77 5f73 6572 6965 735f 656e 645f 7374  ow_series_end_st
-0001d150: 7269 6e67 2829 7d5f 7b77 696e 646f 775f  ring()}_{window_
-0001d160: 7370 6563 2e73 7465 705f 7369 7a65 5f73  spec.step_size_s
-0001d170: 7472 696e 6728 297d 220a 2020 2020 2020  tring()}".      
-0001d180: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0001d190: 2020 2020 6966 2077 696e 646f 775f 7370      if window_sp
-0001d1a0: 6563 2e6f 6666 7365 745f 7374 7269 6e67  ec.offset_string
-0001d1b0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-0001d1c0: 2020 2020 636f 6c75 6d6e 5f6e 616d 6520      column_name 
-0001d1d0: 3d20 6622 7b63 6f6c 756d 6e5f 6e61 6d65  = f"{column_name
-0001d1e0: 7d5f 7b77 696e 646f 775f 7370 6563 2e6f  }_{window_spec.o
-0001d1f0: 6666 7365 745f 7374 7269 6e67 2829 7d22  ffset_string()}"
-0001d200: 0a20 2020 2020 2020 2063 6f6c 756d 6e5f  .        column_
-0001d210: 6e61 6d65 203d 2063 6f6c 756d 6e5f 6e61  name = column_na
-0001d220: 6d65 2e72 6570 6c61 6365 2822 2022 2c20  me.replace(" ", 
-0001d230: 2222 290a 0a20 2020 2020 2020 2072 6574  "")..        ret
-0001d240: 7572 6e20 636f 6c75 6d6e 5f6e 616d 650a  urn column_name.
-0001d250: 0a0a 2320 436f 6d70 6f73 6974 6520 7479  ..# Composite ty
-0001d260: 7065 732e 0a4f 6e6c 696e 6553 746f 7265  pes..OnlineStore
-0001d270: 5479 7065 7320 3d20 556e 696f 6e5b 4479  Types = Union[Dy
-0001d280: 6e61 6d6f 436f 6e66 6967 2c20 5265 6469  namoConfig, Redi
-0001d290: 7343 6f6e 6669 672c 2042 6967 7461 626c  sConfig, Bigtabl
-0001d2a0: 6543 6f6e 6669 675d 0a43 6f6d 7075 7465  eConfig].Compute
-0001d2b0: 436f 6e66 6967 5479 7065 7320 3d20 556e  ConfigTypes = Un
-0001d2c0: 696f 6e5b 0a20 2020 205f 4465 6661 756c  ion[.    _Defaul
-0001d2d0: 7443 6c75 7374 6572 436f 6e66 6967 2c0a  tClusterConfig,.
-0001d2e0: 2020 2020 4461 7461 6272 6963 6b73 436c      DatabricksCl
-0001d2f0: 7573 7465 7243 6f6e 6669 672c 0a20 2020  usterConfig,.   
-0001d300: 2045 4d52 436c 7573 7465 7243 6f6e 6669   EMRClusterConfi
-0001d310: 672c 0a20 2020 2044 6174 6162 7269 636b  g,.    Databrick
-0001d320: 734a 736f 6e43 6c75 7374 6572 436f 6e66  sJsonClusterConf
-0001d330: 6967 2c0a 2020 2020 4461 7461 7072 6f63  ig,.    Dataproc
-0001d340: 4a73 6f6e 436c 7573 7465 7243 6f6e 6669  JsonClusterConfi
-0001d350: 672c 0a20 2020 2045 4d52 4a73 6f6e 436c  g,.    EMRJsonCl
-0001d360: 7573 7465 7243 6f6e 6669 672c 0a20 2020  usterConfig,.   
-0001d370: 2052 6966 7442 6174 6368 436f 6e66 6967   RiftBatchConfig
-0001d380: 2c0a 5d0a                                ,.].
+000192c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000192d0: 2020 2020 2060 6065 6e64 5f74 696d 6560       ``end_time`
+000192e0: 6020 7365 742e 0a20 2020 2020 2020 203a  ` set..        :
+000192f0: 7061 7261 6d20 7365 6372 6574 733a 2041  param secrets: A
+00019300: 2064 6963 7469 6f6e 6172 7920 6f66 2053   dictionary of S
+00019310: 6563 7265 7420 7265 6665 7265 6e63 6573  ecret references
+00019320: 2074 6861 7420 7769 6c6c 2062 6520 7265   that will be re
+00019330: 736f 6c76 6564 2061 6e64 2070 726f 7669  solved and provi
+00019340: 6465 6420 746f 2074 6865 2044 6174 6120  ded to the Data 
+00019350: 536f 7572 6365 2046 756e 6374 696f 6e0a  Source Function.
+00019360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019370: 2020 2020 2020 2020 6174 2072 756e 7469          at runti
+00019380: 6d65 2e20 4475 7269 6e67 206c 6f63 616c  me. During local
+00019390: 2064 6576 656c 6f70 6d65 6e74 2061 6e64   development and
+000193a0: 2074 6573 7469 6e67 2c20 7374 7269 6e67   testing, string
+000193b0: 7320 6d61 7920 6265 2075 7365 6420 696e  s may be used in
+000193c0: 7374 6561 6420 5365 6372 6574 2072 6566  stead Secret ref
+000193d0: 6572 656e 6365 732e 0a20 2020 2020 2020  erences..       
+000193e0: 203a 7265 7475 726e 3a20 4120 5061 6e64   :return: A Pand
+000193f0: 6173 4261 7463 6843 6f6e 6669 6720 636c  asBatchConfig cl
+00019400: 6173 7320 696e 7374 616e 6365 2e0a 2020  ass instance..  
+00019410: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00019420: 2020 7365 6c66 2e5f 6368 6563 6b5f 6675    self._check_fu
+00019430: 6e63 7469 6f6e 5f73 6967 6e61 7475 7265  nction_signature
+00019440: 2864 6174 615f 736f 7572 6365 5f66 756e  (data_source_fun
+00019450: 6374 696f 6e2c 2073 7570 706f 7274 735f  ction, supports_
+00019460: 7469 6d65 5f66 696c 7465 7269 6e67 2c20  time_filtering, 
+00019470: 7573 655f 7365 6372 6574 733d 626f 6f6c  use_secrets=bool
+00019480: 2873 6563 7265 7473 2929 0a20 2020 2020  (secrets)).     
+00019490: 2020 2073 656c 662e 5f61 7267 7320 3d20     self._args = 
+000194a0: 6461 7461 5f73 6f75 7263 655f 7062 322e  data_source_pb2.
+000194b0: 5061 6e64 6173 4261 7463 6843 6f6e 6669  PandasBatchConfi
+000194c0: 6741 7267 7328 290a 2020 2020 2020 2020  gArgs().        
+000194d0: 6966 2066 756e 6374 696f 6e5f 7365 7269  if function_seri
+000194e0: 616c 697a 6174 696f 6e2e 7368 6f75 6c64  alization.should
+000194f0: 5f73 6572 6961 6c69 7a65 5f66 756e 6374  _serialize_funct
+00019500: 696f 6e28 6461 7461 5f73 6f75 7263 655f  ion(data_source_
+00019510: 6675 6e63 7469 6f6e 293a 0a20 2020 2020  function):.     
+00019520: 2020 2020 2020 2073 656c 662e 5f61 7267         self._arg
+00019530: 732e 6461 7461 5f73 6f75 7263 655f 6675  s.data_source_fu
+00019540: 6e63 7469 6f6e 2e43 6f70 7946 726f 6d28  nction.CopyFrom(
+00019550: 6675 6e63 7469 6f6e 5f73 6572 6961 6c69  function_seriali
+00019560: 7a61 7469 6f6e 2e74 6f5f 7072 6f74 6f28  zation.to_proto(
+00019570: 6461 7461 5f73 6f75 7263 655f 6675 6e63  data_source_func
+00019580: 7469 6f6e 2929 0a20 2020 2020 2020 2073  tion)).        s
+00019590: 656c 662e 5f61 7267 732e 6461 7461 5f64  elf._args.data_d
+000195a0: 656c 6179 2e46 726f 6d54 696d 6564 656c  elay.FromTimedel
+000195b0: 7461 2864 6174 615f 6465 6c61 7929 0a20  ta(data_delay). 
+000195c0: 2020 2020 2020 2073 656c 662e 5f61 7267         self._arg
+000195d0: 732e 7375 7070 6f72 7473 5f74 696d 655f  s.supports_time_
+000195e0: 6669 6c74 6572 696e 6720 3d20 7375 7070  filtering = supp
+000195f0: 6f72 7473 5f74 696d 655f 6669 6c74 6572  orts_time_filter
+00019600: 696e 670a 2020 2020 2020 2020 6966 2073  ing.        if s
+00019610: 6563 7265 7473 3a0a 2020 2020 2020 2020  ecrets:.        
+00019620: 2020 2020 666f 7220 6e61 6d65 2c20 7365      for name, se
+00019630: 6372 6574 2069 6e20 7365 6372 6574 732e  cret in secrets.
+00019640: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
+00019650: 2020 2020 2020 2020 2073 656c 662e 5f61           self._a
+00019660: 7267 732e 7365 6372 6574 735b 6e61 6d65  rgs.secrets[name
+00019670: 5d2e 436f 7079 4672 6f6d 285f 636f 6e76  ].CopyFrom(_conv
+00019680: 6572 745f 7365 6372 6574 5f74 6f5f 7361  ert_secret_to_sa
+00019690: 6e69 7469 7a65 645f 7265 6665 7265 6e63  nitized_referenc
+000196a0: 6528 7365 6372 6574 2929 0a20 2020 2020  e(secret)).     
+000196b0: 2020 2073 656c 662e 5f64 6174 615f 6465     self._data_de
+000196c0: 6c61 7920 3d20 6461 7461 5f64 656c 6179  lay = data_delay
+000196d0: 0a20 2020 2020 2020 2073 656c 662e 6461  .        self.da
+000196e0: 7461 5f73 6f75 7263 655f 6675 6e63 7469  ta_source_functi
+000196f0: 6f6e 203d 2064 6174 615f 736f 7572 6365  on = data_source
+00019700: 5f66 756e 6374 696f 6e0a 0a20 2020 2040  _function..    @
+00019710: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00019720: 2064 6174 615f 6465 6c61 7928 7365 6c66   data_delay(self
+00019730: 2920 2d3e 2064 6174 6574 696d 652e 7469  ) -> datetime.ti
+00019740: 6d65 6465 6c74 613a 0a20 2020 2020 2020  medelta:.       
+00019750: 2072 6574 7572 6e20 7365 6c66 2e5f 6461   return self._da
+00019760: 7461 5f64 656c 6179 0a0a 2020 2020 6465  ta_delay..    de
+00019770: 6620 5f6d 6572 6765 5f62 6174 6368 5f61  f _merge_batch_a
+00019780: 7267 7328 7365 6c66 2c20 6461 7461 5f73  rgs(self, data_s
+00019790: 6f75 7263 655f 6172 6773 3a20 7669 7274  ource_args: virt
+000197a0: 7561 6c5f 6461 7461 5f73 6f75 7263 655f  ual_data_source_
+000197b0: 7062 322e 5669 7274 7561 6c44 6174 6153  pb2.VirtualDataS
+000197c0: 6f75 7263 6541 7267 7329 3a0a 2020 2020  ourceArgs):.    
+000197d0: 2020 2020 6461 7461 5f73 6f75 7263 655f      data_source_
+000197e0: 6172 6773 2e70 616e 6461 735f 6261 7463  args.pandas_batc
+000197f0: 685f 636f 6e66 6967 2e43 6f70 7946 726f  h_config.CopyFro
+00019800: 6d28 7365 6c66 2e5f 6172 6773 290a 0a20  m(self._args).. 
+00019810: 2020 2064 6566 205f 5f63 616c 6c5f 5f28     def __call__(
+00019820: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
+00019830: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+00019840: 7265 7475 726e 2073 656c 662e 6461 7461  return self.data
+00019850: 5f73 6f75 7263 655f 6675 6e63 7469 6f6e  _source_function
+00019860: 282a 6172 6773 2c20 2a2a 6b77 6172 6773  (*args, **kwargs
+00019870: 290a 0a20 2020 2040 7374 6174 6963 6d65  )..    @staticme
+00019880: 7468 6f64 0a20 2020 2064 6566 205f 6368  thod.    def _ch
+00019890: 6563 6b5f 6675 6e63 7469 6f6e 5f73 6967  eck_function_sig
+000198a0: 6e61 7475 7265 2864 6174 615f 736f 7572  nature(data_sour
+000198b0: 6365 5f66 756e 6374 696f 6e3a 2043 616c  ce_function: Cal
+000198c0: 6c61 626c 652c 2073 7570 706f 7274 735f  lable, supports_
+000198d0: 7469 6d65 5f66 696c 7465 7269 6e67 3a20  time_filtering: 
+000198e0: 626f 6f6c 2c20 7573 655f 7365 6372 6574  bool, use_secret
+000198f0: 733a 2062 6f6f 6c29 3a0a 2020 2020 2020  s: bool):.      
+00019900: 2020 6675 6e63 7469 6f6e 5f6e 616d 6520    function_name 
+00019910: 3d20 6461 7461 5f73 6f75 7263 655f 6675  = data_source_fu
+00019920: 6e63 7469 6f6e 2e5f 5f6e 616d 655f 5f0a  nction.__name__.
+00019930: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+00019940: 206c 6973 7428 696e 7370 6563 742e 7369   list(inspect.si
+00019950: 676e 6174 7572 6528 6461 7461 5f73 6f75  gnature(data_sou
+00019960: 7263 655f 6675 6e63 7469 6f6e 292e 7061  rce_function).pa
+00019970: 7261 6d65 7465 7273 290a 2020 2020 2020  rameters).      
+00019980: 2020 6966 2073 7570 706f 7274 735f 7469    if supports_ti
+00019990: 6d65 5f66 696c 7465 7269 6e67 2061 6e64  me_filtering and
+000199a0: 2075 7365 5f73 6563 7265 7473 3a0a 2020   use_secrets:.  
+000199b0: 2020 2020 2020 2020 2020 6966 2070 6172            if par
+000199c0: 616d 7320 213d 205b 2266 696c 7465 725f  ams != ["filter_
+000199d0: 636f 6e74 6578 7422 2c20 2273 6563 7265  context", "secre
+000199e0: 7473 225d 3a0a 2020 2020 2020 2020 2020  ts"]:.          
+000199f0: 2020 2020 2020 6d73 6720 3d20 6622 4461        msg = f"Da
+00019a00: 7461 2053 6f75 7263 6520 4675 6e63 7469  ta Source Functi
+00019a10: 6f6e 207b 6675 6e63 7469 6f6e 5f6e 616d  on {function_nam
+00019a20: 657d 2773 2072 6571 7569 7265 6420 7369  e}'s required si
+00019a30: 676e 6174 7572 6520 6973 2060 7b66 756e  gnature is `{fun
+00019a40: 6374 696f 6e5f 6e61 6d65 7d28 6669 6c74  ction_name}(filt
+00019a50: 6572 5f63 6f6e 7465 7874 2c20 7365 6372  er_context, secr
+00019a60: 6574 7329 6020 7768 656e 2073 7570 706f  ets)` when suppo
+00019a70: 7274 735f 7469 6d65 5f66 696c 7465 7269  rts_time_filteri
+00019a80: 6e67 2069 7320 5472 7565 2061 6e64 2073  ng is True and s
+00019a90: 6563 7265 7473 2061 7265 2075 7365 6422  ecrets are used"
+00019aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019ab0: 2072 6169 7365 2041 7373 6572 7469 6f6e   raise Assertion
+00019ac0: 4572 726f 7228 6d73 6729 0a20 2020 2020  Error(msg).     
+00019ad0: 2020 2065 6c69 6620 7375 7070 6f72 7473     elif supports
+00019ae0: 5f74 696d 655f 6669 6c74 6572 696e 673a  _time_filtering:
+00019af0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00019b00: 7061 7261 6d73 2021 3d20 5b22 6669 6c74  params != ["filt
+00019b10: 6572 5f63 6f6e 7465 7874 225d 3a0a 2020  er_context"]:.  
+00019b20: 2020 2020 2020 2020 2020 2020 2020 6d73                ms
+00019b30: 6720 3d20 6622 4461 7461 2053 6f75 7263  g = f"Data Sourc
+00019b40: 6520 4675 6e63 7469 6f6e 207b 6675 6e63  e Function {func
+00019b50: 7469 6f6e 5f6e 616d 657d 2773 2072 6571  tion_name}'s req
+00019b60: 7569 7265 6420 7369 676e 6174 7572 6520  uired signature 
+00019b70: 6973 2060 7b66 756e 6374 696f 6e5f 6e61  is `{function_na
+00019b80: 6d65 7d28 6669 6c74 6572 5f63 6f6e 7465  me}(filter_conte
+00019b90: 7874 2960 2077 6865 6e20 7375 7070 6f72  xt)` when suppor
+00019ba0: 7473 5f74 696d 655f 6669 6c74 6572 696e  ts_time_filterin
+00019bb0: 6720 6973 2054 7275 6522 0a20 2020 2020  g is True".     
+00019bc0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00019bd0: 2041 7373 6572 7469 6f6e 4572 726f 7228   AssertionError(
+00019be0: 6d73 6729 0a20 2020 2020 2020 2065 6c69  msg).        eli
+00019bf0: 6620 7573 655f 7365 6372 6574 733a 0a20  f use_secrets:. 
+00019c00: 2020 2020 2020 2020 2020 2069 6620 7061             if pa
+00019c10: 7261 6d73 2021 3d20 5b22 7365 6372 6574  rams != ["secret
+00019c20: 7322 5d3a 0a20 2020 2020 2020 2020 2020  s"]:.           
+00019c30: 2020 2020 206d 7367 203d 2066 2244 6174       msg = f"Dat
+00019c40: 6120 536f 7572 6365 2046 756e 6374 696f  a Source Functio
+00019c50: 6e20 7b66 756e 6374 696f 6e5f 6e61 6d65  n {function_name
+00019c60: 7d27 7320 7265 7175 6972 6564 2073 6967  }'s required sig
+00019c70: 6e61 7475 7265 2069 7320 607b 6675 6e63  nature is `{func
+00019c80: 7469 6f6e 5f6e 616d 657d 2873 6563 7265  tion_name}(secre
+00019c90: 7473 2960 2077 6865 6e20 7365 6372 6574  ts)` when secret
+00019ca0: 7320 6172 6520 7573 6564 220a 2020 2020  s are used".    
+00019cb0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00019cc0: 6520 4173 7365 7274 696f 6e45 7272 6f72  e AssertionError
+00019cd0: 286d 7367 290a 2020 2020 2020 2020 656c  (msg).        el
+00019ce0: 6966 2070 6172 616d 733a 0a20 2020 2020  if params:.     
+00019cf0: 2020 2020 2020 206d 7367 203d 2066 2244         msg = f"D
+00019d00: 6174 6120 536f 7572 6365 2046 756e 6374  ata Source Funct
+00019d10: 696f 6e20 7b66 756e 6374 696f 6e5f 6e61  ion {function_na
+00019d20: 6d65 7d27 7320 7265 7175 6972 6564 2073  me}'s required s
+00019d30: 6967 6e61 7475 7265 2069 7320 607b 6675  ignature is `{fu
+00019d40: 6e63 7469 6f6e 5f6e 616d 657d 2829 6022  nction_name}()`"
+00019d50: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00019d60: 7365 2041 7373 6572 7469 6f6e 4572 726f  se AssertionErro
+00019d70: 7228 6d73 6729 0a0a 0a40 7479 7065 6368  r(msg)...@typech
+00019d80: 6563 6b65 640a 6465 6620 7061 6e64 6173  ecked.def pandas
+00019d90: 5f62 6174 6368 5f63 6f6e 6669 6728 0a20  _batch_config(. 
+00019da0: 2020 202a 2c0a 2020 2020 6461 7461 5f64     *,.    data_d
+00019db0: 656c 6179 3a20 4f70 7469 6f6e 616c 5b64  elay: Optional[d
+00019dc0: 6174 6574 696d 652e 7469 6d65 6465 6c74  atetime.timedelt
+00019dd0: 615d 203d 2064 6174 6574 696d 652e 7469  a] = datetime.ti
+00019de0: 6d65 6465 6c74 6128 7365 636f 6e64 733d  medelta(seconds=
+00019df0: 3029 2c0a 2020 2020 7375 7070 6f72 7473  0),.    supports
+00019e00: 5f74 696d 655f 6669 6c74 6572 696e 673a  _time_filtering:
+00019e10: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
+00019e20: 3d20 4661 6c73 652c 0a20 2020 2073 6563  = False,.    sec
+00019e30: 7265 7473 3a20 4f70 7469 6f6e 616c 5b44  rets: Optional[D
+00019e40: 6963 745b 7374 722c 2055 6e69 6f6e 5b53  ict[str, Union[S
+00019e50: 6563 7265 742c 2073 7472 5d5d 5d20 3d20  ecret, str]]] = 
+00019e60: 4e6f 6e65 2c0a 293a 0a20 2020 2022 2222  None,.):.    """
+00019e70: 0a20 2020 2044 6563 6c61 7265 2061 203a  .    Declare a :
+00019e80: 636c 6173 733a 6074 6563 746f 6e2e 5061  class:`tecton.Pa
+00019e90: 6e64 6173 4261 7463 6843 6f6e 6669 6760  ndasBatchConfig`
+00019ea0: 2066 6f72 2063 6f6e 6669 6775 7269 6e67   for configuring
+00019eb0: 2061 2042 6174 6368 2053 6f75 7263 6520   a Batch Source 
+00019ec0: 7769 7468 2061 2044 6174 6120 536f 7572  with a Data Sour
+00019ed0: 6365 2046 756e 6374 696f 6e2e 0a20 2020  ce Function..   
+00019ee0: 2054 6865 2066 756e 6374 696f 6e20 7461   The function ta
+00019ef0: 6b65 7320 696e 2061 2061 6e20 6f70 7469  kes in a an opti
+00019f00: 6f6e 616c 203a 636c 6173 733a 6074 6563  onal :class:`tec
+00019f10: 746f 6e2e 4669 6c74 6572 436f 6e74 6578  ton.FilterContex
+00019f20: 7460 2c20 6966 2060 6073 7570 706f 7274  t`, if ``support
+00019f30: 735f 7469 6d65 5f66 696c 7465 7269 6e67  s_time_filtering
+00019f40: 3d54 7275 6560 602e 2052 6574 7572 6e73  =True``. Returns
+00019f50: 2061 2060 6070 642e 4461 7461 4672 616d   a ``pd.DataFram
+00019f60: 6560 602e 0a20 2020 203a 7061 7261 6d20  e``..    :param 
+00019f70: 6461 7461 5f64 656c 6179 3a20 4279 2064  data_delay: By d
+00019f80: 6566 6175 6c74 2c20 696e 6372 656d 656e  efault, incremen
+00019f90: 7461 6c20 6d61 7465 7269 616c 697a 6174  tal materializat
+00019fa0: 696f 6e20 6a6f 6273 2072 756e 2069 6d6d  ion jobs run imm
+00019fb0: 6564 6961 7465 6c79 2061 7420 7468 6520  ediately at the 
+00019fc0: 656e 6420 6f66 2074 6865 0a20 2020 2020  end of the.     
+00019fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019fe0: 2020 2020 2020 2020 2020 2062 6174 6368             batch
+00019ff0: 2073 6368 6564 756c 6520 7065 7269 6f64   schedule period
+0001a000: 2e20 5468 6973 2070 6172 616d 6574 6572  . This parameter
+0001a010: 2063 6f6e 6669 6775 7265 7320 686f 7720   configures how 
+0001a020: 6c6f 6e67 2074 6865 7920 7761 6974 2061  long they wait a
+0001a030: 6674 6572 2074 6865 2065 6e64 0a20 2020  fter the end.   
+0001a040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a050: 2020 2020 2020 2020 2020 2020 206f 6620               of 
+0001a060: 7468 6520 7065 7269 6f64 2062 6566 6f72  the period befor
+0001a070: 6520 7374 6172 7469 6e67 2c20 7479 7069  e starting, typi
+0001a080: 6361 6c6c 7920 746f 2065 6e73 7572 6520  cally to ensure 
+0001a090: 7468 6174 2061 6c6c 2064 6174 6120 6861  that all data ha
+0001a0a0: 7320 6c61 6e64 6564 2e0a 2020 2020 2020  s landed..      
+0001a0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a0c0: 2020 2020 2020 2020 2020 466f 7220 6578            For ex
+0001a0d0: 616d 706c 652c 2069 6620 6120 6665 6174  ample, if a feat
+0001a0e0: 7572 6520 7669 6577 2068 6173 2061 2060  ure view has a `
+0001a0f0: 6062 6174 6368 5f73 6368 6564 756c 6560  `batch_schedule`
+0001a100: 6020 6f66 2031 2064 6179 2061 6e64 206f  ` of 1 day and o
+0001a110: 6e65 206f 660a 2020 2020 2020 2020 2020  ne of.          
+0001a120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a130: 2020 2020 2020 7468 6520 6461 7461 2073        the data s
+0001a140: 6f75 7263 6520 696e 7075 7473 2068 6173  ource inputs has
+0001a150: 2060 6064 6174 615f 6465 6c61 793d 7469   ``data_delay=ti
+0001a160: 6d65 6465 6c74 6128 686f 7572 733d 3129  medelta(hours=1)
+0001a170: 6060 2073 6574 2c20 7468 656e 0a20 2020  `` set, then.   
+0001a180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a190: 2020 2020 2020 2020 2020 2020 2069 6e63               inc
+0001a1a0: 7265 6d65 6e74 616c 206d 6174 6572 6961  remental materia
+0001a1b0: 6c69 7a61 7469 6f6e 206a 6f62 7320 7769  lization jobs wi
+0001a1c0: 6c6c 2072 756e 2061 7420 6060 3031 3a30  ll run at ``01:0
+0001a1d0: 3060 6020 5554 432e 0a20 2020 203a 7061  0`` UTC..    :pa
+0001a1e0: 7261 6d20 7375 7070 6f72 7473 5f74 696d  ram supports_tim
+0001a1f0: 655f 6669 6c74 6572 696e 673a 2057 6865  e_filtering: Whe
+0001a200: 6e20 7365 7420 746f 2060 6054 7275 6560  n set to ``True`
+0001a210: 602c 2074 6865 2044 6174 6120 536f 7572  `, the Data Sour
+0001a220: 6365 2046 756e 6374 696f 6e20 6d75 7374  ce Function must
+0001a230: 2074 616b 6520 7468 6520 6060 6669 6c74   take the ``filt
+0001a240: 6572 5f63 6f6e 7465 7874 6060 0a20 2020  er_context``.   
+0001a250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a270: 2070 6172 616d 6574 6572 2061 6e64 2069   parameter and i
+0001a280: 6d70 6c65 6d65 6e74 2074 696d 6520 6669  mplement time fi
+0001a290: 6c74 6572 696e 6720 6c6f 6769 632e 0a20  ltering logic.. 
+0001a2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a2c0: 2020 2060 6073 7570 706f 7274 735f 7469     ``supports_ti
+0001a2d0: 6d65 5f66 696c 7465 7269 6e67 6060 206d  me_filtering`` m
+0001a2e0: 7573 7420 6265 2073 6574 2074 6f20 6054  ust be set to `T
+0001a2f0: 7275 6560 2069 6620 6060 3c64 6174 6120  rue` if ``<data 
+0001a300: 736f 7572 6365 3e2e 6765 745f 6461 7461  source>.get_data
+0001a310: 6672 616d 6528 2960 6020 6973 2063 616c  frame()`` is cal
+0001a320: 6c65 6420 7769 7468 2060 6073 7461 7274  led with ``start
+0001a330: 5f74 696d 6560 600a 2020 2020 2020 2020  _time``.        
+0001a340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a350: 2020 2020 2020 2020 2020 2020 6f72 2060              or `
+0001a360: 6065 6e64 5f74 696d 6560 602e 2060 6073  `end_time``. ``s
+0001a370: 7570 706f 7274 735f 7469 6d65 5f66 696c  upports_time_fil
+0001a380: 7465 7269 6e67 6060 206d 7573 7420 616c  tering`` must al
+0001a390: 736f 2062 6520 7365 7420 746f 2060 6054  so be set to ``T
+0001a3a0: 7275 6560 6020 6966 2075 7369 6e67 203a  rue`` if using :
+0001a3b0: 636c 6173 733a 6074 6563 746f 6e2e 6465  class:`tecton.de
+0001a3c0: 636c 6172 6174 6976 652e 4669 6c74 6572  clarative.Filter
+0001a3d0: 6564 536f 7572 6365 600a 2020 2020 2020  edSource`.      
+0001a3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a3f0: 2020 2020 2020 2020 2020 2020 2020 7769                wi
+0001a400: 7468 2061 2044 6174 6120 536f 7572 6365  th a Data Source
+0001a410: 2077 6865 6e20 6465 6669 6e69 6e67 2061   when defining a
+0001a420: 2060 6046 6561 7475 7265 5669 6577 6060   ``FeatureView``
+0001a430: 2e20 5468 6520 6060 4665 6174 7572 6556  . The ``FeatureV
+0001a440: 6965 7760 6020 7769 6c6c 2063 616c 6c0a  iew`` will call.
+0001a450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a470: 2020 2020 7468 6520 4461 7461 2053 6f75      the Data Sou
+0001a480: 7263 6520 4675 6e63 7469 6f6e 2077 6974  rce Function wit
+0001a490: 6820 7468 6520 3a63 6c61 7373 3a60 7465  h the :class:`te
+0001a4a0: 6374 6f6e 2e46 696c 7465 7243 6f6e 7465  cton.FilterConte
+0001a4b0: 7874 602c 2077 6869 6368 2068 6173 2074  xt`, which has t
+0001a4c0: 6865 2060 6073 7461 7274 5f74 696d 6560  he ``start_time`
+0001a4d0: 6020 616e 640a 2020 2020 2020 2020 2020  ` and.          
+0001a4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a4f0: 2020 2020 2020 2020 2020 6060 656e 645f            ``end_
+0001a500: 7469 6d65 6060 2073 6574 2e0a 0a20 2020  time`` set...   
+0001a510: 203a 7061 7261 6d20 7365 6372 6574 733a   :param secrets:
+0001a520: 2041 2064 6963 7469 6f6e 6172 7920 6f66   A dictionary of
+0001a530: 2053 6563 7265 7420 7265 6665 7265 6e63   Secret referenc
+0001a540: 6573 2074 6861 7420 7769 6c6c 2062 6520  es that will be 
+0001a550: 7265 736f 6c76 6564 2061 6e64 2070 726f  resolved and pro
+0001a560: 7669 6465 6420 746f 2074 6865 2044 6174  vided to the Dat
+0001a570: 6120 536f 7572 6365 2046 756e 6374 696f  a Source Functio
+0001a580: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
+0001a590: 2020 2020 2020 6174 2072 756e 7469 6d65        at runtime
+0001a5a0: 2e20 4475 7269 6e67 206c 6f63 616c 2064  . During local d
+0001a5b0: 6576 656c 6f70 6d65 6e74 2061 6e64 2074  evelopment and t
+0001a5c0: 6573 7469 6e67 2c20 7374 7269 6e67 7320  esting, strings 
+0001a5d0: 6d61 7920 6265 2075 7365 6420 696e 7374  may be used inst
+0001a5e0: 6561 6420 5365 6372 6574 2072 6566 6572  ead Secret refer
+0001a5f0: 656e 6365 732e 0a20 2020 2045 7861 6d70  ences..    Examp
+0001a600: 6c65 2064 6566 696e 696e 6720 6120 4461  le defining a Da
+0001a610: 7461 2053 6f75 7263 6520 4675 6e63 7469  ta Source Functi
+0001a620: 6f6e 2075 7369 6e67 2060 6070 616e 6461  on using ``panda
+0001a630: 735f 6261 7463 685f 636f 6e66 6967 6060  s_batch_config``
+0001a640: 3a0a 2020 2020 2e2e 2063 6f64 652d 626c  :.    .. code-bl
+0001a650: 6f63 6b3a 3a20 7079 7468 6f6e 0a20 2020  ock:: python.   
+0001a660: 2020 2020 2066 726f 6d20 7465 6374 6f6e       from tecton
+0001a670: 2069 6d70 6f72 7420 7061 6e64 6173 5f62   import pandas_b
+0001a680: 6174 6368 5f63 6f6e 6669 672c 2053 6563  atch_config, Sec
+0001a690: 7265 740a 2020 2020 2020 2020 4070 616e  ret.        @pan
+0001a6a0: 6461 735f 6261 7463 685f 636f 6e66 6967  das_batch_config
+0001a6b0: 280a 2020 2020 2020 2020 2020 7375 7070  (.          supp
+0001a6c0: 6f72 7473 5f74 696d 655f 6669 6c74 6572  orts_time_filter
+0001a6d0: 696e 673d 5472 7565 2c0a 2020 2020 2020  ing=True,.      
+0001a6e0: 2020 2020 7365 6372 6574 733d 7b22 7333      secrets={"s3
+0001a6f0: 5f62 7563 6b65 7422 3a20 5365 6372 6574  _bucket": Secret
+0001a700: 2873 636f 7065 3d22 6465 7622 2c20 6b65  (scope="dev", ke
+0001a710: 793d 2275 7365 725f 6461 7461 5f73 335f  y="user_data_s3_
+0001a720: 6275 636b 6574 2229 7d0a 2020 2020 2020  bucket")}.      
+0001a730: 2020 290a 2020 2020 2020 2020 6465 6620    ).        def 
+0001a740: 7061 7271 7565 745f 6461 7461 5f73 6f75  parquet_data_sou
+0001a750: 7263 655f 6675 6e63 7469 6f6e 2866 696c  rce_function(fil
+0001a760: 7465 725f 636f 6e74 6578 742c 2073 6563  ter_context, sec
+0001a770: 7265 7473 293a 0a20 2020 2020 2020 2020  rets):.         
+0001a780: 2020 2069 6d70 6f72 7420 7079 6172 726f     import pyarro
+0001a790: 772e 7061 7271 7565 7420 6173 2070 710a  w.parquet as pq.
+0001a7a0: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
+0001a7b0: 2070 7961 7272 6f77 2e66 7320 696d 706f   pyarrow.fs impo
+0001a7c0: 7274 2053 3346 696c 6553 7973 7465 6d0a  rt S3FileSystem.
+0001a7d0: 2020 2020 2020 2020 2020 2020 6669 6c74              filt
+0001a7e0: 6572 733d 4e6f 6e65 0a20 2020 2020 2020  ers=None.       
+0001a7f0: 2020 2020 2023 2048 616e 646c 6520 7469       # Handle ti
+0001a800: 6d65 2066 696c 7465 7269 6e67 2c20 6964  me filtering, id
+0001a810: 6561 6c6c 7920 7573 696e 6720 7061 7274  eally using part
+0001a820: 6974 696f 6e20 6b65 7973 0a20 2020 2020  ition keys.     
+0001a830: 2020 2020 2020 2069 6620 6669 6c74 6572         if filter
+0001a840: 5f63 6f6e 7465 7874 3a0a 2020 2020 2020  _context:.      
+0001a850: 2020 2020 2020 2020 2020 6669 6c74 6572            filter
+0001a860: 7320 3d20 5b5d 0a20 2020 2020 2020 2020  s = [].         
+0001a870: 2020 2020 2020 2069 6620 6669 6c74 6572         if filter
+0001a880: 5f63 6f6e 7465 7874 2e73 7461 7274 5f74  _context.start_t
+0001a890: 696d 653a 0a20 2020 2020 2020 2020 2020  ime:.           
+0001a8a0: 2020 2020 2020 2020 2066 696c 7465 7273           filters
+0001a8b0: 2e61 7070 656e 6428 2822 6372 6561 7465  .append(("create
+0001a8c0: 645f 6174 222c 2022 3e3d 222c 2066 696c  d_at", ">=", fil
+0001a8d0: 7465 725f 636f 6e74 6578 742e 7374 6172  ter_context.star
+0001a8e0: 745f 7469 6d65 2e72 6570 6c61 6365 2874  t_time.replace(t
+0001a8f0: 7a69 6e66 6f3d 4e6f 6e65 2929 290a 2020  zinfo=None))).  
+0001a900: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0001a910: 2066 696c 7465 725f 636f 6e74 6578 742e   filter_context.
+0001a920: 656e 645f 7469 6d65 3a0a 2020 2020 2020  end_time:.      
+0001a930: 2020 2020 2020 2020 2020 2020 2020 6669                fi
+0001a940: 6c74 6572 732e 6170 7065 6e64 2828 2263  lters.append(("c
+0001a950: 7265 6174 6564 5f61 7422 2c20 223c 222c  reated_at", "<",
+0001a960: 2066 696c 7465 725f 636f 6e74 6578 742e   filter_context.
+0001a970: 656e 645f 7469 6d65 2e72 6570 6c61 6365  end_time.replace
+0001a980: 2874 7a69 6e66 6f3d 4e6f 6e65 2929 290a  (tzinfo=None))).
+0001a990: 0a20 2020 2020 2020 2020 2020 2073 335f  .            s3_
+0001a9a0: 6275 636b 6574 203d 2073 6563 7265 7473  bucket = secrets
+0001a9b0: 5b22 7333 5f62 7563 6b65 7422 5d0a 2020  ["s3_bucket"].  
+0001a9c0: 2020 2020 2020 2020 2020 6461 7461 7365            datase
+0001a9d0: 7420 3d20 7071 2e50 6172 7175 6574 4461  t = pq.ParquetDa
+0001a9e0: 7461 7365 7428 0a20 2020 2020 2020 2020  taset(.         
+0001a9f0: 2020 2020 2020 2066 2273 333a 2f2f 7b73         f"s3://{s
+0001aa00: 335f 6275 636b 6574 7d2f 7061 7468 2f74  3_bucket}/path/t
+0001aa10: 6f2f 6461 7461 2e70 7122 2c0a 2020 2020  o/data.pq",.    
+0001aa20: 2020 2020 2020 2020 2020 2020 6669 6c65              file
+0001aa30: 7379 7374 656d 3d53 3346 696c 6553 7973  system=S3FileSys
+0001aa40: 7465 6d28 292c 0a20 2020 2020 2020 2020  tem(),.         
+0001aa50: 2020 2020 2020 2075 7365 5f6c 6567 6163         use_legac
+0001aa60: 795f 6461 7461 7365 743d 4661 6c73 652c  y_dataset=False,
+0001aa70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001aa80: 2066 696c 7465 7273 3d66 696c 7465 7273   filters=filters
+0001aa90: 2069 6620 6c65 6e28 6669 6c74 6572 7329   if len(filters)
+0001aaa0: 203e 2030 2065 6c73 6520 4e6f 6e65 0a20   > 0 else None. 
+0001aab0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0001aac0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0001aad0: 6461 7461 7365 742e 7265 6164 5f70 616e  dataset.read_pan
+0001aae0: 6461 7328 292e 746f 5f70 616e 6461 7328  das().to_pandas(
+0001aaf0: 290a 2020 2020 2222 220a 0a20 2020 2064  ).    """..    d
+0001ab00: 6566 2064 6563 6f72 6174 6f72 2864 6174  ef decorator(dat
+0001ab10: 615f 736f 7572 6365 5f66 756e 6374 696f  a_source_functio
+0001ab20: 6e29 3a0a 2020 2020 2020 2020 6261 7463  n):.        batc
+0001ab30: 685f 636f 6e66 6967 203d 2050 616e 6461  h_config = Panda
+0001ab40: 7342 6174 6368 436f 6e66 6967 280a 2020  sBatchConfig(.  
+0001ab50: 2020 2020 2020 2020 2020 6461 7461 5f73            data_s
+0001ab60: 6f75 7263 655f 6675 6e63 7469 6f6e 3d64  ource_function=d
+0001ab70: 6174 615f 736f 7572 6365 5f66 756e 6374  ata_source_funct
+0001ab80: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+0001ab90: 2064 6174 615f 6465 6c61 793d 6461 7461   data_delay=data
+0001aba0: 5f64 656c 6179 2c0a 2020 2020 2020 2020  _delay,.        
+0001abb0: 2020 2020 7375 7070 6f72 7473 5f74 696d      supports_tim
+0001abc0: 655f 6669 6c74 6572 696e 673d 7375 7070  e_filtering=supp
+0001abd0: 6f72 7473 5f74 696d 655f 6669 6c74 6572  orts_time_filter
+0001abe0: 696e 672c 0a20 2020 2020 2020 2020 2020  ing,.           
+0001abf0: 2073 6563 7265 7473 3d73 6563 7265 7473   secrets=secrets
+0001ac00: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+0001ac10: 2020 2020 6675 6e63 746f 6f6c 732e 7570      functools.up
+0001ac20: 6461 7465 5f77 7261 7070 6572 2877 7261  date_wrapper(wra
+0001ac30: 7070 6572 3d62 6174 6368 5f63 6f6e 6669  pper=batch_confi
+0001ac40: 672c 2077 7261 7070 6564 3d64 6174 615f  g, wrapped=data_
+0001ac50: 736f 7572 6365 5f66 756e 6374 696f 6e29  source_function)
+0001ac60: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001ac70: 6261 7463 685f 636f 6e66 6967 0a0a 2020  batch_config..  
+0001ac80: 2020 7265 7475 726e 2064 6563 6f72 6174    return decorat
+0001ac90: 6f72 0a0a 0a63 6c61 7373 204c 6966 6574  or...class Lifet
+0001aca0: 696d 6557 696e 646f 7728 5374 7269 6374  imeWindow(Strict
+0001acb0: 4d6f 6465 6c29 3a0a 2020 2020 2222 2243  Model):.    """C
+0001acc0: 6f6e 6669 6775 7265 7320 6120 6c69 6665  onfigures a life
+0001acd0: 7469 6d65 2077 696e 646f 772e 0a0a 2020  time window...  
+0001ace0: 2020 5468 6973 2063 6c61 7373 2068 6173    This class has
+0001acf0: 206e 6f20 6174 7472 6962 7574 6573 2e20   no attributes. 
+0001ad00: 5768 656e 2075 7365 642c 2074 6865 2061  When used, the a
+0001ad10: 6767 7265 6761 7469 6f6e 2077 696c 6c20  ggregation will 
+0001ad20: 6265 2073 7065 6369 6669 6564 2066 726f  be specified fro
+0001ad30: 6d20 7468 6520 606c 6966 6574 696d 655f  m the `lifetime_
+0001ad40: 7374 6172 745f 7469 6d65 6020 756e 7469  start_time` unti
+0001ad50: 6c20 7468 6520 6167 6772 6567 6174 696f  l the aggregatio
+0001ad60: 6e20 7265 6665 7265 6e63 6520 706f 696e  n reference poin
+0001ad70: 742e 0a20 2020 2022 2222 0a0a 2020 2020  t..    """..    
+0001ad80: 6465 6620 5f74 6f5f 7072 6f74 6f28 7365  def _to_proto(se
+0001ad90: 6c66 2920 2d3e 2074 696d 655f 7769 6e64  lf) -> time_wind
+0001ada0: 6f77 5f70 6232 2e4c 6966 6574 696d 6557  ow_pb2.LifetimeW
+0001adb0: 696e 646f 773a 0a20 2020 2020 2020 2072  indow:.        r
+0001adc0: 6574 7572 6e20 7469 6d65 5f77 696e 646f  eturn time_windo
+0001add0: 775f 7062 322e 4c69 6665 7469 6d65 5769  w_pb2.LifetimeWi
+0001ade0: 6e64 6f77 2829 0a0a 2020 2020 2320 544f  ndow()..    # TO
+0001adf0: 444f 286a 616b 6529 3a20 5468 6973 2069  DO(jake): This i
+0001ae00: 7320 616e 2075 6e75 7375 616c 2070 6174  s an unusual pat
+0001ae10: 7465 726e 2074 6f20 636f 6e76 6572 7420  tern to convert 
+0001ae20: 6120 636f 6e66 6967 206f 626a 6563 7420  a config object 
+0001ae30: 746f 2061 2073 7065 6320 6c69 6b65 2e20  to a spec like. 
+0001ae40: 446f 206e 6f74 2072 6570 6c69 6361 7465  Do not replicate
+0001ae50: 2077 6974 686f 7574 2061 2067 6f6f 640a   without a good.
+0001ae60: 2020 2020 2320 7265 6173 6f6e 2e20 5468      # reason. Th
+0001ae70: 6973 2069 7320 6e65 6564 6564 2062 6563  is is needed bec
+0001ae80: 6175 7365 2041 6767 7265 6761 7469 6f6e  ause Aggregation
+0001ae90: 7320 6861 7665 206e 6f74 2062 6565 6e20  s have not been 
+0001aea0: 6675 6c6c 7920 6d69 6772 6174 6564 206f  fully migrated o
+0001aeb0: 6e74 6f20 7370 6563 732e 0a20 2020 2064  nto specs..    d
+0001aec0: 6566 205f 746f 5f73 7065 6328 7365 6c66  ef _to_spec(self
+0001aed0: 2920 2d3e 2073 7065 6373 2e4c 6966 6574  ) -> specs.Lifet
+0001aee0: 696d 6557 696e 646f 7753 7065 633a 0a20  imeWindowSpec:. 
+0001aef0: 2020 2020 2020 2072 6574 7572 6e20 7370         return sp
+0001af00: 6563 732e 4c69 6665 7469 6d65 5769 6e64  ecs.LifetimeWind
+0001af10: 6f77 5370 6563 2829 0a0a 0a63 6c61 7373  owSpec()...class
+0001af20: 2054 696d 6557 696e 646f 7728 5374 7269   TimeWindow(Stri
+0001af30: 6374 4d6f 6465 6c29 3a0a 2020 2020 2222  ctModel):.    ""
+0001af40: 2243 6f6e 6669 6775 7261 7469 6f6e 2075  "Configuration u
+0001af50: 7365 6420 746f 2073 7065 6369 6679 2061  sed to specify a
+0001af60: 6e20 6167 6772 6567 6174 696f 6e20 7469  n aggregation ti
+0001af70: 6d65 2077 696e 646f 772e 0a0a 2020 2020  me window...    
+0001af80: 5468 6973 2063 6c61 7373 2064 6573 6372  This class descr
+0001af90: 6962 6573 2074 6865 2061 7474 7269 6275  ibes the attribu
+0001afa0: 7465 7320 6f66 2061 2074 696d 6520 7769  tes of a time wi
+0001afb0: 6e64 6f77 2074 6f20 6167 6772 6567 6174  ndow to aggregat
+0001afc0: 6520 6f76 6572 2077 6869 6368 2069 6e63  e over which inc
+0001afd0: 6c75 6465 7320 7468 6520 7369 7a65 206f  ludes the size o
+0001afe0: 6620 7468 6520 7469 6d65 2077 696e 646f  f the time windo
+0001aff0: 770a 2020 2020 616e 6420 7468 6520 6f66  w.    and the of
+0001b000: 6673 6574 206f 6620 7468 6520 7769 6e64  fset of the wind
+0001b010: 6f77 2773 2065 6e64 2074 696d 6520 6672  ow's end time fr
+0001b020: 6f6d 2061 2067 6976 656e 2072 6566 6572  om a given refer
+0001b030: 656e 6365 2070 6f69 6e74 2865 6e64 206f  ence point(end o
+0001b040: 6620 6167 6772 6567 6174 696f 6e20 7769  f aggregation wi
+0001b050: 6e64 6f77 2c20 7370 696e 6520 7469 6d65  ndow, spine time
+0001b060: 7374 616d 702c 206f 7220 7468 6520 6375  stamp, or the cu
+0001b070: 7272 656e 7420 7469 6d65 292e 0a0a 2020  rrent time)...  
+0001b080: 2020 3a70 6172 616d 2077 696e 646f 775f    :param window_
+0001b090: 7369 7a65 3a20 5468 6520 7369 7a65 206f  size: The size o
+0001b0a0: 6620 7468 6520 7769 6e64 6f77 2074 6f20  f the window to 
+0001b0b0: 6167 6772 6567 6174 6520 6f76 6572 2c20  aggregate over, 
+0001b0c0: 7370 6563 6966 6965 6420 6173 2061 2064  specified as a d
+0001b0d0: 6174 6574 696d 652e 7469 6d65 6465 6c74  atetime.timedelt
+0001b0e0: 612e 2060 6064 6174 6574 696d 652e 7469  a. ``datetime.ti
+0001b0f0: 6d65 6465 6c74 6128 6461 7973 3d33 3029  medelta(days=30)
+0001b100: 6060 0a20 2020 203a 7061 7261 6d20 6f66  ``.    :param of
+0001b110: 6673 6574 3a20 5468 6520 6e65 6761 7469  fset: The negati
+0001b120: 7665 2064 7572 6174 696f 6e20 6f66 2068  ve duration of h
+0001b130: 6f77 2066 6172 2062 6163 6b20 7468 6520  ow far back the 
+0001b140: 656e 6420 6f66 2074 6865 2077 696e 646f  end of the windo
+0001b150: 7720 7769 6c6c 2062 6520 6672 6f6d 2061  w will be from a
+0001b160: 2067 6976 656e 2072 6566 6572 656e 6365   given reference
+0001b170: 2070 6f69 6e74 2028 6167 6772 6567 6174   point (aggregat
+0001b180: 696f 6e20 7769 6e64 6f77 202f 20e2 809c  ion window / ...
+0001b190: 6e6f 77e2 809d 202f 2073 7069 6e65 2074  now... / spine t
+0001b1a0: 696d 6520 696e 2063 6f6e 7469 6e75 6f75  ime in continuou
+0001b1b0: 7320 6d6f 6465 290a 2020 2020 2222 220a  s mode).    """.
+0001b1c0: 0a20 2020 2077 696e 646f 775f 7369 7a65  .    window_size
+0001b1d0: 3a20 6461 7465 7469 6d65 2e74 696d 6564  : datetime.timed
+0001b1e0: 656c 7461 0a20 2020 206f 6666 7365 743a  elta.    offset:
+0001b1f0: 2064 6174 6574 696d 652e 7469 6d65 6465   datetime.timede
+0001b200: 6c74 6120 3d20 6461 7465 7469 6d65 2e74  lta = datetime.t
+0001b210: 696d 6564 656c 7461 2873 6563 6f6e 6473  imedelta(seconds
+0001b220: 3d30 290a 0a20 2020 2064 6566 205f 746f  =0)..    def _to
+0001b230: 5f70 726f 746f 2873 656c 6629 202d 3e20  _proto(self) -> 
+0001b240: 6665 6174 7572 655f 7669 6577 5f70 6232  feature_view_pb2
+0001b250: 2e54 696d 6557 696e 646f 773a 0a20 2020  .TimeWindow:.   
+0001b260: 2020 2020 2072 6574 7572 6e20 6665 6174       return feat
+0001b270: 7572 655f 7669 6577 5f70 6232 2e54 696d  ure_view_pb2.Tim
+0001b280: 6557 696e 646f 7728 0a20 2020 2020 2020  eWindow(.       
+0001b290: 2020 2020 2077 696e 646f 775f 6475 7261       window_dura
+0001b2a0: 7469 6f6e 3d74 696d 655f 7574 696c 732e  tion=time_utils.
+0001b2b0: 7469 6d65 6465 6c74 615f 746f 5f70 726f  timedelta_to_pro
+0001b2c0: 746f 2873 656c 662e 7769 6e64 6f77 5f73  to(self.window_s
+0001b2d0: 697a 6529 2c0a 2020 2020 2020 2020 2020  ize),.          
+0001b2e0: 2020 6f66 6673 6574 3d74 696d 655f 7574    offset=time_ut
+0001b2f0: 696c 732e 7469 6d65 6465 6c74 615f 746f  ils.timedelta_to
+0001b300: 5f70 726f 746f 2873 656c 662e 6f66 6673  _proto(self.offs
+0001b310: 6574 292c 0a20 2020 2020 2020 2029 0a0a  et),.        )..
+0001b320: 2020 2020 2320 544f 444f 286a 616b 6529      # TODO(jake)
+0001b330: 3a20 5468 6973 2069 7320 616e 2075 6e75  : This is an unu
+0001b340: 7375 616c 2070 6174 7465 726e 2074 6f20  sual pattern to 
+0001b350: 636f 6e76 6572 7420 6120 636f 6e66 6967  convert a config
+0001b360: 206f 626a 6563 7420 746f 2061 2073 7065   object to a spe
+0001b370: 6320 6c69 6b65 2e20 446f 206e 6f74 2072  c like. Do not r
+0001b380: 6570 6c69 6361 7465 2077 6974 686f 7574  eplicate without
+0001b390: 2061 2067 6f6f 640a 2020 2020 2320 7265   a good.    # re
+0001b3a0: 6173 6f6e 2e20 5468 6973 2069 7320 6e65  ason. This is ne
+0001b3b0: 6564 6564 2062 6563 6175 7365 2041 6767  eded because Agg
+0001b3c0: 7265 6761 7469 6f6e 7320 6861 7665 206e  regations have n
+0001b3d0: 6f74 2062 6565 6e20 6675 6c6c 7920 6d69  ot been fully mi
+0001b3e0: 6772 6174 6564 206f 6e74 6f20 7370 6563  grated onto spec
+0001b3f0: 732e 0a20 2020 2064 6566 205f 746f 5f73  s..    def _to_s
+0001b400: 7065 6328 7365 6c66 2920 2d3e 2073 7065  pec(self) -> spe
+0001b410: 6373 2e52 656c 6174 6976 6554 696d 6557  cs.RelativeTimeW
+0001b420: 696e 646f 7753 7065 633a 0a20 2020 2020  indowSpec:.     
+0001b430: 2020 2072 6574 7572 6e20 7370 6563 732e     return specs.
+0001b440: 5265 6c61 7469 7665 5469 6d65 5769 6e64  RelativeTimeWind
+0001b450: 6f77 5370 6563 2e66 726f 6d5f 6172 6773  owSpec.from_args
+0001b460: 5f70 726f 746f 2873 656c 662e 5f74 6f5f  _proto(self._to_
+0001b470: 7072 6f74 6f28 2929 0a0a 0a63 6c61 7373  proto())...class
+0001b480: 2054 696d 6557 696e 646f 7753 6572 6965   TimeWindowSerie
+0001b490: 7328 5374 7269 6374 4d6f 6465 6c29 3a0a  s(StrictModel):.
+0001b4a0: 2020 2020 2222 2243 6f6e 6669 6775 7261      """Configura
+0001b4b0: 7469 6f6e 2075 7365 6420 746f 2073 7065  tion used to spe
+0001b4c0: 6369 6679 2061 6e20 6167 6772 6567 6174  cify an aggregat
+0001b4d0: 696f 6e20 7469 6d65 2077 696e 646f 7720  ion time window 
+0001b4e0: 7365 7269 6573 2e0a 0a20 2020 2054 6869  series...    Thi
+0001b4f0: 7320 636c 6173 7320 6465 7363 7269 6265  s class describe
+0001b500: 7320 7468 6520 6174 7472 6962 7574 6573  s the attributes
+0001b510: 206f 6620 6120 7469 6d65 2077 696e 646f   of a time windo
+0001b520: 7720 7365 7269 6573 206f 6620 6d75 6c74  w series of mult
+0001b530: 6970 6c65 2074 696d 6520 7769 6e64 6f77  iple time window
+0001b540: 7320 746f 2061 6767 7265 6761 7465 206f  s to aggregate o
+0001b550: 7665 722e 2054 6869 7320 696e 636c 7564  ver. This includ
+0001b560: 6573 0a20 2020 2074 6865 2073 7461 7274  es.    the start
+0001b570: 206f 6620 7468 6520 6669 7273 7420 7469   of the first ti
+0001b580: 6d65 2077 696e 646f 772c 2074 6865 2073  me window, the s
+0001b590: 697a 6520 6f66 2065 6163 6820 7469 6d65  ize of each time
+0001b5a0: 2077 696e 646f 772c 2074 6865 2073 7465   window, the ste
+0001b5b0: 7020 7369 7a65 2062 6574 7765 656e 2065  p size between e
+0001b5c0: 6163 6820 7469 6d65 2077 696e 646f 7720  ach time window 
+0001b5d0: 7374 6172 7420 7469 6d65 2c20 616e 640a  start time, and.
+0001b5e0: 2020 2020 7468 6520 656e 6420 6f66 2074      the end of t
+0001b5f0: 6865 206c 6173 7420 7469 6d65 2077 696e  he last time win
+0001b600: 646f 7720 656e 642e 0a0a 2020 2020 3a70  dow end...    :p
+0001b610: 6172 616d 2077 696e 646f 775f 7369 7a65  aram window_size
+0001b620: 3a20 5468 6520 7369 7a65 206f 6620 7468  : The size of th
+0001b630: 6520 7769 6e64 6f77 2074 6f20 6167 6772  e window to aggr
+0001b640: 6567 6174 6520 6f76 6572 2c20 7370 6563  egate over, spec
+0001b650: 6966 6965 6420 6173 2061 2064 6174 6574  ified as a datet
+0001b660: 696d 652e 7469 6d65 6465 6c74 612e 2060  ime.timedelta. `
+0001b670: 6064 6174 6574 696d 652e 7469 6d65 6465  `datetime.timede
+0001b680: 6c74 6128 6461 7973 3d33 3029 6060 0a20  lta(days=30)``. 
+0001b690: 2020 203a 7061 7261 6d20 7374 6570 5f73     :param step_s
+0001b6a0: 697a 653a 2054 6865 2073 7465 7020 7369  ize: The step si
+0001b6b0: 7a65 2062 6574 7765 656e 2065 6163 6820  ze between each 
+0001b6c0: 7469 6d65 2077 696e 646f 7720 7374 6172  time window star
+0001b6d0: 7420 7469 6d65 2c20 7370 6563 6966 6965  t time, specifie
+0001b6e0: 6420 6173 2061 2064 6174 6574 696d 652e  d as a datetime.
+0001b6f0: 7469 6d65 6465 6c74 612e 2060 6064 6174  timedelta. ``dat
+0001b700: 6574 696d 652e 7469 6d65 6465 6c74 6128  etime.timedelta(
+0001b710: 6461 7973 3d31 2960 600a 2020 2020 3a70  days=1)``.    :p
+0001b720: 6172 616d 2073 7461 7274 3a20 5468 6520  aram start: The 
+0001b730: 6e65 6761 7469 7665 2073 7461 7274 206f  negative start o
+0001b740: 6620 7468 6520 6669 7273 7420 7469 6d65  f the first time
+0001b750: 2077 696e 646f 7720 696e 2074 6865 2073   window in the s
+0001b760: 6572 6965 732e 0a20 2020 203a 7061 7261  eries..    :para
+0001b770: 6d20 656e 643a 2054 6865 206e 6567 6174  m end: The negat
+0001b780: 6976 6520 656e 6420 6f66 2074 6865 206c  ive end of the l
+0001b790: 6173 7420 7469 6d65 2077 696e 646f 7720  ast time window 
+0001b7a0: 656e 6420 696e 2074 6865 2073 6572 6965  end in the serie
+0001b7b0: 732e 2222 220a 0a20 2020 2073 6572 6965  s."""..    serie
+0001b7c0: 735f 7374 6172 743a 2064 6174 6574 696d  s_start: datetim
+0001b7d0: 652e 7469 6d65 6465 6c74 610a 2020 2020  e.timedelta.    
+0001b7e0: 7365 7269 6573 5f65 6e64 3a20 6461 7465  series_end: date
+0001b7f0: 7469 6d65 2e74 696d 6564 656c 7461 203d  time.timedelta =
+0001b800: 2064 6174 6574 696d 652e 7469 6d65 6465   datetime.timede
+0001b810: 6c74 6128 7365 636f 6e64 733d 3029 0a20  lta(seconds=0). 
+0001b820: 2020 2073 7465 705f 7369 7a65 3a20 4f70     step_size: Op
+0001b830: 7469 6f6e 616c 5b64 6174 6574 696d 652e  tional[datetime.
+0001b840: 7469 6d65 6465 6c74 615d 203d 204e 6f6e  timedelta] = Non
+0001b850: 650a 2020 2020 7769 6e64 6f77 5f73 697a  e.    window_siz
+0001b860: 653a 2064 6174 6574 696d 652e 7469 6d65  e: datetime.time
+0001b870: 6465 6c74 610a 0a20 2020 2064 6566 205f  delta..    def _
+0001b880: 746f 5f70 726f 746f 2873 656c 6629 202d  to_proto(self) -
+0001b890: 3e20 6665 6174 7572 655f 7669 6577 5f70  > feature_view_p
+0001b8a0: 6232 2e54 696d 6557 696e 646f 7753 6572  b2.TimeWindowSer
+0001b8b0: 6965 733a 0a20 2020 2020 2020 2073 7465  ies:.        ste
+0001b8c0: 705f 7369 7a65 203d 2073 656c 662e 7374  p_size = self.st
+0001b8d0: 6570 5f73 697a 650a 2020 2020 2020 2020  ep_size.        
+0001b8e0: 6966 2073 7465 705f 7369 7a65 2069 7320  if step_size is 
+0001b8f0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0001b900: 2020 7374 6570 5f73 697a 6520 3d20 7365    step_size = se
+0001b910: 6c66 2e77 696e 646f 775f 7369 7a65 0a20  lf.window_size. 
+0001b920: 2020 2020 2020 2072 6574 7572 6e20 6665         return fe
+0001b930: 6174 7572 655f 7669 6577 5f70 6232 2e54  ature_view_pb2.T
+0001b940: 696d 6557 696e 646f 7753 6572 6965 7328  imeWindowSeries(
+0001b950: 0a20 2020 2020 2020 2020 2020 2073 6572  .            ser
+0001b960: 6965 735f 7374 6172 743d 7469 6d65 5f75  ies_start=time_u
+0001b970: 7469 6c73 2e74 696d 6564 656c 7461 5f74  tils.timedelta_t
+0001b980: 6f5f 7072 6f74 6f28 7365 6c66 2e73 6572  o_proto(self.ser
+0001b990: 6965 735f 7374 6172 7429 2c0a 2020 2020  ies_start),.    
+0001b9a0: 2020 2020 2020 2020 7365 7269 6573 5f65          series_e
+0001b9b0: 6e64 3d74 696d 655f 7574 696c 732e 7469  nd=time_utils.ti
+0001b9c0: 6d65 6465 6c74 615f 746f 5f70 726f 746f  medelta_to_proto
+0001b9d0: 2873 656c 662e 7365 7269 6573 5f65 6e64  (self.series_end
+0001b9e0: 292c 0a20 2020 2020 2020 2020 2020 2073  ),.            s
+0001b9f0: 7465 705f 7369 7a65 3d74 696d 655f 7574  tep_size=time_ut
+0001ba00: 696c 732e 7469 6d65 6465 6c74 615f 746f  ils.timedelta_to
+0001ba10: 5f70 726f 746f 2873 7465 705f 7369 7a65  _proto(step_size
+0001ba20: 292c 0a20 2020 2020 2020 2020 2020 2077  ),.            w
+0001ba30: 696e 646f 775f 6475 7261 7469 6f6e 3d74  indow_duration=t
+0001ba40: 696d 655f 7574 696c 732e 7469 6d65 6465  ime_utils.timede
+0001ba50: 6c74 615f 746f 5f70 726f 746f 2873 656c  lta_to_proto(sel
+0001ba60: 662e 7769 6e64 6f77 5f73 697a 6529 2c0a  f.window_size),.
+0001ba70: 2020 2020 2020 2020 290a 0a20 2020 2023          )..    #
+0001ba80: 2054 4f44 4f28 6a61 6b65 293a 2054 6869   TODO(jake): Thi
+0001ba90: 7320 6973 2061 6e20 756e 7573 7561 6c20  s is an unusual 
+0001baa0: 7061 7474 6572 6e20 746f 2063 6f6e 7665  pattern to conve
+0001bab0: 7274 2061 2063 6f6e 6669 6720 6f62 6a65  rt a config obje
+0001bac0: 6374 2074 6f20 6120 7370 6563 206c 696b  ct to a spec lik
+0001bad0: 652e 2044 6f20 6e6f 7420 7265 706c 6963  e. Do not replic
+0001bae0: 6174 6520 7769 7468 6f75 7420 6120 676f  ate without a go
+0001baf0: 6f64 0a20 2020 2023 2072 6561 736f 6e2e  od.    # reason.
+0001bb00: 2054 6869 7320 6973 206e 6565 6465 6420   This is needed 
+0001bb10: 6265 6361 7573 6520 4167 6772 6567 6174  because Aggregat
+0001bb20: 696f 6e73 2068 6176 6520 6e6f 7420 6265  ions have not be
+0001bb30: 656e 2066 756c 6c79 206d 6967 7261 7465  en fully migrate
+0001bb40: 6420 6f6e 746f 2073 7065 6373 2e0a 2020  d onto specs..  
+0001bb50: 2020 6465 6620 5f74 6f5f 7370 6563 2873    def _to_spec(s
+0001bb60: 656c 6629 202d 3e20 7370 6563 732e 5469  elf) -> specs.Ti
+0001bb70: 6d65 5769 6e64 6f77 5365 7269 6573 5370  meWindowSeriesSp
+0001bb80: 6563 3a0a 2020 2020 2020 2020 7265 7475  ec:.        retu
+0001bb90: 726e 2073 7065 6373 2e54 696d 6557 696e  rn specs.TimeWin
+0001bba0: 646f 7753 6572 6965 7353 7065 632e 6672  dowSeriesSpec.fr
+0001bbb0: 6f6d 5f61 7267 735f 7072 6f74 6f28 7365  om_args_proto(se
+0001bbc0: 6c66 2e5f 746f 5f70 726f 746f 2829 290a  lf._to_proto()).
+0001bbd0: 0a0a 636c 6173 7320 4361 6368 6543 6f6e  ..class CacheCon
+0001bbe0: 6669 6728 5374 7269 6374 4d6f 6465 6c29  fig(StrictModel)
+0001bbf0: 3a0a 2020 2020 2222 2243 6f6e 6669 6775  :.    """Configu
+0001bc00: 7261 7469 6f6e 206f 626a 6563 7420 666f  ration object fo
+0001bc10: 7220 6665 6174 7572 6520 7669 6577 206f  r feature view o
+0001bc20: 6e6c 696e 6520 6361 6368 696e 672e 0a0a  nline caching...
+0001bc30: 2020 2020 3a70 6172 616d 206d 6178 5f61      :param max_a
+0001bc40: 6765 5f73 6563 6f6e 6473 3a20 5468 6520  ge_seconds: The 
+0001bc50: 6d61 7869 6d75 6d20 7469 6d65 2069 6e20  maximum time in 
+0001bc60: 7365 636f 6e64 7320 7468 6174 2066 6561  seconds that fea
+0001bc70: 7475 7265 7320 6672 6f6d 2074 6869 7320  tures from this 
+0001bc80: 6665 6174 7572 6520 7669 6577 2063 616e  feature view can
+0001bc90: 2062 6520 6361 6368 6564 2e20 4d75 7374   be cached. Must
+0001bca0: 2062 650a 2020 2020 2020 2020 6265 7477   be.        betw
+0001bcb0: 6565 6e20 6f6e 6520 6d69 6e75 7465 2028  een one minute (
+0001bcc0: 3630 7329 2061 6e64 206f 6e65 2064 6179  60s) and one day
+0001bcd0: 2028 3836 5f34 3030 7329 2e0a 2020 2020   (86_400s)..    
+0001bce0: 2222 220a 0a20 2020 206d 6178 5f61 6765  """..    max_age
+0001bcf0: 5f73 6563 6f6e 6473 3a20 696e 740a 0a20  _seconds: int.. 
+0001bd00: 2020 2064 6566 205f 746f 5f70 726f 746f     def _to_proto
+0001bd10: 2873 656c 6629 202d 3e20 6665 6174 7572  (self) -> featur
+0001bd20: 655f 7669 6577 5f70 6232 2e43 6163 6865  e_view_pb2.Cache
+0001bd30: 436f 6e66 6967 3a0a 2020 2020 2020 2020  Config:.        
+0001bd40: 7265 7475 726e 2066 6561 7475 7265 5f76  return feature_v
+0001bd50: 6965 775f 7062 322e 4361 6368 6543 6f6e  iew_pb2.CacheCon
+0001bd60: 6669 6728 0a20 2020 2020 2020 2020 2020  fig(.           
+0001bd70: 206d 6178 5f61 6765 5f73 6563 6f6e 6473   max_age_seconds
+0001bd80: 3d73 656c 662e 6d61 785f 6167 655f 7365  =self.max_age_se
+0001bd90: 636f 6e64 732c 0a20 2020 2020 2020 2029  conds,.        )
+0001bda0: 0a0a 0a63 6c61 7373 2041 6767 7265 6761  ...class Aggrega
+0001bdb0: 7469 6f6e 2853 7472 6963 744d 6f64 656c  tion(StrictModel
+0001bdc0: 293a 0a20 2020 2022 2222 0a20 2020 2054  ):.    """.    T
+0001bdd0: 6869 7320 636c 6173 7320 6465 7363 7269  his class descri
+0001bde0: 6265 7320 6120 7369 6e67 6c65 2061 6767  bes a single agg
+0001bdf0: 7265 6761 7469 6f6e 2074 6861 7420 6973  regation that is
+0001be00: 2061 7070 6c69 6564 2069 6e20 6120 6261   applied in a ba
+0001be10: 7463 6820 6f72 2073 7472 6561 6d20 6665  tch or stream fe
+0001be20: 6174 7572 6520 7669 6577 2e0a 0a20 2020  ature view...   
+0001be30: 203a 7061 7261 6d20 636f 6c75 6d6e 3a20   :param column: 
+0001be40: 436f 6c75 6d6e 206e 616d 6520 6f66 2074  Column name of t
+0001be50: 6865 2066 6561 7475 7265 2077 6520 6172  he feature we ar
+0001be60: 6520 6167 6772 6567 6174 696e 672e 0a20  e aggregating.. 
+0001be70: 2020 203a 7479 7065 2063 6f6c 756d 6e3a     :type column:
+0001be80: 2073 7472 0a20 2020 203a 7061 7261 6d20   str.    :param 
+0001be90: 6675 6e63 7469 6f6e 3a20 4f6e 6520 6f66  function: One of
+0001bea0: 2074 6865 2062 7569 6c74 2d69 6e20 6167   the built-in ag
+0001beb0: 6772 6567 6174 696f 6e20 6675 6e63 7469  gregation functi
+0001bec0: 6f6e 732e 0a20 2020 203a 7479 7065 2066  ons..    :type f
+0001bed0: 756e 6374 696f 6e3a 2055 6e69 6f6e 5b73  unction: Union[s
+0001bee0: 7472 2c20 4167 6772 6567 6174 696f 6e46  tr, AggregationF
+0001bef0: 756e 6374 696f 6e5d 0a20 2020 203a 7061  unction].    :pa
+0001bf00: 7261 6d20 7469 6d65 5f77 696e 646f 773a  ram time_window:
+0001bf10: 2044 7572 6174 696f 6e20 746f 2061 6767   Duration to agg
+0001bf20: 7265 6761 7465 206f 7665 722e 2045 7861  regate over. Exa
+0001bf30: 6d70 6c65 3a20 6060 6461 7465 7469 6d65  mple: ``datetime
+0001bf40: 2e74 696d 6564 656c 7461 2864 6179 733d  .timedelta(days=
+0001bf50: 3330 2960 602e 0a20 2020 203a 7479 7065  30)``..    :type
+0001bf60: 2074 696d 655f 7769 6e64 6f77 3a20 6461   time_window: da
+0001bf70: 7465 7469 6d65 2e74 696d 6564 656c 7461  tetime.timedelta
+0001bf80: 0a20 2020 203a 7061 7261 6d20 6e61 6d65  .    :param name
+0001bf90: 3a20 5468 6520 6e61 6d65 206f 6620 7468  : The name of th
+0001bfa0: 6973 2066 6561 7475 7265 2e20 4465 6661  is feature. Defa
+0001bfb0: 756c 7473 2074 6f20 616e 2061 7574 6f67  ults to an autog
+0001bfc0: 656e 6572 6174 6564 206e 616d 652c 2065  enerated name, e
+0001bfd0: 2e67 2e20 7472 616e 7361 6374 696f 6e5f  .g. transaction_
+0001bfe0: 636f 756e 745f 3764 5f31 642e 0a20 2020  count_7d_1d..   
+0001bff0: 203a 7479 7065 206e 616d 653a 2073 7472   :type name: str
+0001c000: 0a0a 2020 2020 6066 756e 6374 696f 6e60  ..    `function`
+0001c010: 2063 616e 2062 6520 6f6e 6520 6f66 2070   can be one of p
+0001c020: 7265 6465 6669 6e65 6420 6e75 6d65 7269  redefined numeri
+0001c030: 6320 6167 6772 6567 6174 696f 6e20 6675  c aggregation fu
+0001c040: 6e63 7469 6f6e 732c 206e 616d 656c 7920  nctions, namely 
+0001c050: 6060 2263 6f75 6e74 2260 602c 2060 6022  ``"count"``, ``"
+0001c060: 7375 6d22 6060 2c20 6060 226d 6561 6e22  sum"``, ``"mean"
+0001c070: 6060 2c20 6060 226d 696e 2260 602c 2060  ``, ``"min"``, `
+0001c080: 6022 6d61 7822 6060 2c20 6060 2276 6172  `"max"``, ``"var
+0001c090: 5f73 616d 7022 6060 2c20 6060 2276 6172  _samp"``, ``"var
+0001c0a0: 5f70 6f70 2260 602c 2060 6022 7661 7269  _pop"``, ``"vari
+0001c0b0: 616e 6365 2260 6020 2d20 616c 6961 7320  ance"`` - alias 
+0001c0c0: 666f 7220 6060 2276 6172 5f73 616d 7022  for ``"var_samp"
+0001c0d0: 6060 2c20 6060 2273 7464 6465 765f 7361  ``, ``"stddev_sa
+0001c0e0: 6d70 2260 602c 2060 6022 7374 6464 6576  mp"``, ``"stddev
+0001c0f0: 5f70 6f70 2260 602c 2060 6022 7374 6464  _pop"``, ``"stdd
+0001c100: 6576 2260 6020 2d20 616c 6961 7320 666f  ev"`` - alias fo
+0001c110: 7220 6060 2273 7464 6465 765f 7361 6d70  r ``"stddev_samp
+0001c120: 2260 602e 2046 6f72 0a20 2020 2074 6865  "``. For.    the
+0001c130: 7365 206e 756d 6572 6963 2061 6767 7265  se numeric aggre
+0001c140: 6761 7469 6f6e 732c 2079 6f75 2063 616e  gations, you can
+0001c150: 2070 6173 7320 7468 6520 6e61 6d65 206f   pass the name o
+0001c160: 6620 6974 2061 7320 6120 7374 7269 6e67  f it as a string
+0001c170: 2e20 4e75 6c6c 7320 6172 6520 6861 6e64  . Nulls are hand
+0001c180: 6c65 6420 6c69 6b65 2053 7061 726b 2053  led like Spark S
+0001c190: 514c 2060 4675 6e63 7469 6f6e 2863 6f6c  QL `Function(col
+0001c1a0: 756d 6e29 602c 2065 2e67 2e20 5355 4d2f  umn)`, e.g. SUM/
+0001c1b0: 4d45 414e 2f4d 494e 2f4d 4158 2f56 4152  MEAN/MIN/MAX/VAR
+0001c1c0: 5f53 414d 502f 5641 525f 504f 502f 5641  _SAMP/VAR_POP/VA
+0001c1d0: 522f 5354 4444 4556 5f53 414d 502f 5354  R/STDDEV_SAMP/ST
+0001c1e0: 4444 4556 5f50 4f50 2f53 5444 4445 5620  DDEV_POP/STDDEV 
+0001c1f0: 6f66 2061 6c6c 206e 756c 6c73 2069 7320  of all nulls is 
+0001c200: 6e75 6c6c 2061 6e64 2043 4f55 4e54 206f  null and COUNT o
+0001c210: 6620 616c 6c20 6e75 6c6c 7320 6973 2030  f all nulls is 0
+0001c220: 2e0a 0a20 2020 2049 6e20 6164 6469 7469  ...    In additi
+0001c230: 6f6e 2074 6f20 6e75 6d65 7269 6320 6167  on to numeric ag
+0001c240: 6772 6567 6174 696f 6e73 2c20 3a63 6c61  gregations, :cla
+0001c250: 7373 3a60 4167 6772 6567 6174 696f 6e60  ss:`Aggregation`
+0001c260: 2073 7570 706f 7274 7320 7468 6520 6c61   supports the la
+0001c270: 7374 206e 6f6e 2d64 6973 7469 6e63 7420  st non-distinct 
+0001c280: 616e 6420 6469 7374 696e 6374 204e 2061  and distinct N a
+0001c290: 6767 7265 6761 7469 6f6e 2074 6861 7420  ggregation that 
+0001c2a0: 7769 6c6c 2063 6f6d 7075 7465 2074 6865  will compute the
+0001c2b0: 206c 6173 7420 4e20 6e6f 6e2d 6469 7374   last N non-dist
+0001c2c0: 696e 6374 2061 6e64 2064 6973 7469 6e63  inct and distinc
+0001c2d0: 7420 7661 6c75 6573 2066 6f72 2074 6865  t values for the
+0001c2e0: 2063 6f6c 756d 6e20 6279 2074 696d 6573   column by times
+0001c2f0: 7461 6d70 2e20 5269 6768 7420 6e6f 7720  tamp. Right now 
+0001c300: 6f6e 6c79 2073 7472 696e 6720 636f 6c75  only string colu
+0001c310: 6d6e 2069 7320 7375 7070 6f72 7465 6420  mn is supported 
+0001c320: 6173 2069 6e70 7574 2074 6f20 7468 6973  as input to this
+0001c330: 2061 6767 7265 6761 7469 6f6e 2c20 692e   aggregation, i.
+0001c340: 652e 2c20 7468 6520 7265 7375 6c74 696e  e., the resultin
+0001c350: 6720 6665 6174 7572 6520 7661 6c75 6520  g feature value 
+0001c360: 7769 6c6c 2062 6520 6120 6c69 7374 206f  will be a list o
+0001c370: 6620 7374 7269 6e67 732e 2054 6865 206f  f strings. The o
+0001c380: 7264 6572 206f 6620 7468 6520 7661 6c75  rder of the valu
+0001c390: 6520 696e 2074 6865 206c 6973 7420 6973  e in the list is
+0001c3a0: 2061 7363 656e 6469 6e67 2062 6173 6564   ascending based
+0001c3b0: 206f 6e20 7468 6520 7469 6d65 7374 616d   on the timestam
+0001c3c0: 702e 204e 756c 6c73 2061 7265 206e 6f74  p. Nulls are not
+0001c3d0: 2069 6e63 6c75 6465 6420 696e 2074 6865   included in the
+0001c3e0: 2061 6767 7265 6761 7465 6420 6c69 7374   aggregated list
+0001c3f0: 2e0a 0a20 2020 2059 6f75 2063 616e 2075  ...    You can u
+0001c400: 7365 2069 7420 7669 6120 7468 6520 6060  se it via the ``
+0001c410: 606c 6173 7428 2960 6060 2061 6e64 2020  `last()``` and  
+0001c420: 6060 6c61 7374 5f64 6973 7469 6e63 7428  ``last_distinct(
+0001c430: 2960 6020 6865 6c70 6572 2066 756e 6374  )`` helper funct
+0001c440: 696f 6e20 6c69 6b65 2074 6869 733a 0a0a  ion like this:..
+0001c450: 2020 2020 2e2e 2063 6f64 652d 626c 6f63      .. code-bloc
+0001c460: 6b3a 3a20 7079 7468 6f6e 0a0a 2020 2020  k:: python..    
+0001c470: 2020 2020 6672 6f6d 2074 6563 746f 6e2e      from tecton.
+0001c480: 6167 6772 6567 6174 696f 6e5f 6675 6e63  aggregation_func
+0001c490: 7469 6f6e 7320 696d 706f 7274 206c 6173  tions import las
+0001c4a0: 745f 6469 7374 696e 6374 2c20 6c61 7374  t_distinct, last
+0001c4b0: 0a0a 2020 2020 2020 2020 4062 6174 6368  ..        @batch
+0001c4c0: 5f66 6561 7475 7265 5f76 6965 7728 0a20  _feature_view(. 
+0001c4d0: 2020 2020 2020 202e 2e2e 0a20 2020 2020         ....     
+0001c4e0: 2020 2061 6767 7265 6761 7469 6f6e 733d     aggregations=
+0001c4f0: 5b0a 2020 2020 2020 2020 2020 2020 4167  [.            Ag
+0001c500: 6772 6567 6174 696f 6e28 0a20 2020 2020  gregation(.     
+0001c510: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+0001c520: 6e3d 276d 795f 636f 6c75 6d6e 272c 0a20  n='my_column',. 
+0001c530: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0001c540: 756e 6374 696f 6e3d 6c61 7374 5f64 6973  unction=last_dis
+0001c550: 7469 6e63 7428 3135 292c 0a20 2020 2020  tinct(15),.     
+0001c560: 2020 2020 2020 2020 2020 2074 696d 655f             time_
+0001c570: 7769 6e64 6f77 3d64 6174 6574 696d 652e  window=datetime.
+0001c580: 7469 6d65 6465 6c74 6128 6461 7973 3d37  timedelta(days=7
+0001c590: 2929 2c0a 2020 2020 2020 2020 2020 2020  )),.            
+0001c5a0: 4167 6772 6567 6174 696f 6e28 0a20 2020  Aggregation(.   
+0001c5b0: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
+0001c5c0: 756d 6e3d 276d 795f 636f 6c75 6d6e 272c  umn='my_column',
+0001c5d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c5e0: 2066 756e 6374 696f 6e3d 6c61 7374 2831   function=last(1
+0001c5f0: 3529 2c0a 2020 2020 2020 2020 2020 2020  5),.            
+0001c600: 2020 2020 7469 6d65 5f77 696e 646f 773d      time_window=
+0001c610: 6461 7465 7469 6d65 2e74 696d 6564 656c  datetime.timedel
+0001c620: 7461 2864 6179 733d 3729 292c 0a20 2020  ta(days=7)),.   
+0001c630: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+0001c640: 2020 2020 2e2e 2e0a 2020 2020 2020 2020      ....        
+0001c650: 290a 2020 2020 2020 2020 6465 6620 6d79  ).        def my
+0001c660: 5f66 7628 6461 7461 5f73 6f75 7263 6529  _fv(data_source)
+0001c670: 3a0a 2020 2020 2020 2020 2020 2020 7061  :.            pa
+0001c680: 7373 0a0a 2020 2020 2222 220a 0a20 2020  ss..    """..   
+0001c690: 2063 6f6c 756d 6e3a 2073 7472 0a20 2020   column: str.   
+0001c6a0: 2066 756e 6374 696f 6e3a 2041 6767 7265   function: Aggre
+0001c6b0: 6761 7469 6f6e 4675 6e63 7469 6f6e 0a20  gationFunction. 
+0001c6c0: 2020 2074 696d 655f 7769 6e64 6f77 3a20     time_window: 
+0001c6d0: 556e 696f 6e5b 4c69 6665 7469 6d65 5769  Union[LifetimeWi
+0001c6e0: 6e64 6f77 2c20 5469 6d65 5769 6e64 6f77  ndow, TimeWindow
+0001c6f0: 2c20 5469 6d65 5769 6e64 6f77 5365 7269  , TimeWindowSeri
+0001c700: 6573 5d0a 2020 2020 6e61 6d65 3a20 4f70  es].    name: Op
+0001c710: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
+0001c720: 6e65 0a0a 2020 2020 4070 7964 616e 7469  ne..    @pydanti
+0001c730: 635f 7631 2e76 616c 6964 6174 6f72 2822  c_v1.validator("
+0001c740: 7469 6d65 5f77 696e 646f 7722 2c20 7072  time_window", pr
+0001c750: 653d 5472 7565 290a 2020 2020 6465 6620  e=True).    def 
+0001c760: 7469 6d65 6465 6c74 615f 746f 5f74 696d  timedelta_to_tim
+0001c770: 655f 7769 6e64 6f77 2863 6c73 2c20 7629  e_window(cls, v)
+0001c780: 3a0a 2020 2020 2020 2020 6966 2069 7369  :.        if isi
+0001c790: 6e73 7461 6e63 6528 762c 2064 6174 6574  nstance(v, datet
+0001c7a0: 696d 652e 7469 6d65 6465 6c74 6129 3a0a  ime.timedelta):.
+0001c7b0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001c7c0: 726e 2054 696d 6557 696e 646f 7728 7769  rn TimeWindow(wi
+0001c7d0: 6e64 6f77 5f73 697a 653d 7629 0a20 2020  ndow_size=v).   
+0001c7e0: 2020 2020 2072 6574 7572 6e20 760a 0a20       return v.. 
+0001c7f0: 2020 2040 7079 6461 6e74 6963 5f76 312e     @pydantic_v1.
+0001c800: 7661 6c69 6461 746f 7228 2266 756e 6374  validator("funct
+0001c810: 696f 6e22 2c20 7072 653d 5472 7565 290a  ion", pre=True).
+0001c820: 2020 2020 6465 6620 7374 725f 746f 5f61      def str_to_a
+0001c830: 6767 7265 6761 7469 6f6e 5f66 756e 6374  ggregation_funct
+0001c840: 696f 6e28 636c 732c 2076 293a 0a20 2020  ion(cls, v):.   
+0001c850: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0001c860: 6365 2876 2c20 7374 7229 3a0a 2020 2020  ce(v, str):.    
+0001c870: 2020 2020 2020 2020 7265 7475 726e 2041          return A
+0001c880: 6767 7265 6761 7469 6f6e 4675 6e63 7469  ggregationFuncti
+0001c890: 6f6e 2862 6173 655f 6e61 6d65 3d76 2c20  on(base_name=v, 
+0001c8a0: 7265 736f 6c76 6564 5f6e 616d 653d 762c  resolved_name=v,
+0001c8b0: 2070 6172 616d 733d 4d61 7070 696e 6750   params=MappingP
+0001c8c0: 726f 7879 5479 7065 287b 7d29 290a 2020  roxyType({})).  
+0001c8d0: 2020 2020 2020 7265 7475 726e 2076 0a0a        return v..
+0001c8e0: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+0001c8f0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0001c900: 2020 2020 2020 2020 636f 6c75 6d6e 3a20          column: 
+0001c910: 7374 722c 0a20 2020 2020 2020 2066 756e  str,.        fun
+0001c920: 6374 696f 6e3a 2055 6e69 6f6e 5b73 7472  ction: Union[str
+0001c930: 2c20 4167 6772 6567 6174 696f 6e46 756e  , AggregationFun
+0001c940: 6374 696f 6e5d 2c0a 2020 2020 2020 2020  ction],.        
+0001c950: 7469 6d65 5f77 696e 646f 773a 2055 6e69  time_window: Uni
+0001c960: 6f6e 5b54 696d 6557 696e 646f 772c 204c  on[TimeWindow, L
+0001c970: 6966 6574 696d 6557 696e 646f 772c 2064  ifetimeWindow, d
+0001c980: 6174 6574 696d 652e 7469 6d65 6465 6c74  atetime.timedelt
+0001c990: 615d 2c0a 2020 2020 2020 2020 6e61 6d65  a],.        name
+0001c9a0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+0001c9b0: 3d20 4e6f 6e65 2c0a 2020 2020 293a 0a20  = None,.    ):. 
+0001c9c0: 2020 2020 2020 2073 7570 6572 2829 2e5f         super()._
+0001c9d0: 5f69 6e69 745f 5f28 636f 6c75 6d6e 3d63  _init__(column=c
+0001c9e0: 6f6c 756d 6e2c 2066 756e 6374 696f 6e3d  olumn, function=
+0001c9f0: 6675 6e63 7469 6f6e 2c20 7469 6d65 5f77  function, time_w
+0001ca00: 696e 646f 773d 7469 6d65 5f77 696e 646f  indow=time_windo
+0001ca10: 772c 206e 616d 653d 6e61 6d65 290a 0a20  w, name=name).. 
+0001ca20: 2020 2064 6566 205f 746f 5f70 726f 746f     def _to_proto
+0001ca30: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+0001ca40: 6167 6772 6567 6174 696f 6e5f 696e 7465  aggregation_inte
+0001ca50: 7276 616c 3a20 6461 7465 7469 6d65 2e74  rval: datetime.t
+0001ca60: 696d 6564 656c 7461 2c20 6973 5f63 6f6e  imedelta, is_con
+0001ca70: 7469 6e75 6f75 733a 2062 6f6f 6c2c 2063  tinuous: bool, c
+0001ca80: 6f6d 7061 6374 696f 6e5f 656e 6162 6c65  ompaction_enable
+0001ca90: 643a 2062 6f6f 6c20 3d20 4661 6c73 650a  d: bool = False.
+0001caa0: 2020 2020 293a 0a20 2020 2020 2020 2070      ):.        p
+0001cab0: 726f 746f 203d 2066 6561 7475 7265 5f76  roto = feature_v
+0001cac0: 6965 775f 7062 322e 4665 6174 7572 6541  iew_pb2.FeatureA
+0001cad0: 6767 7265 6761 7469 6f6e 280a 2020 2020  ggregation(.    
+0001cae0: 2020 2020 2020 2020 6e61 6d65 3d73 656c          name=sel
+0001caf0: 662e 6e61 6d65 0a20 2020 2020 2020 2020  f.name.         
+0001cb00: 2020 2069 6620 7365 6c66 2e6e 616d 650a     if self.name.
+0001cb10: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0001cb20: 2073 656c 662e 5f64 6566 6175 6c74 5f6e   self._default_n
+0001cb30: 616d 6528 6167 6772 6567 6174 696f 6e5f  ame(aggregation_
+0001cb40: 696e 7465 7276 616c 2c20 6973 5f63 6f6e  interval, is_con
+0001cb50: 7469 6e75 6f75 732c 2063 6f6d 7061 6374  tinuous, compact
+0001cb60: 696f 6e5f 656e 6162 6c65 6429 2c0a 2020  ion_enabled),.  
+0001cb70: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+0001cb80: 3d73 656c 662e 636f 6c75 6d6e 2c0a 2020  =self.column,.  
+0001cb90: 2020 2020 2020 2020 2020 6675 6e63 7469            functi
+0001cba0: 6f6e 3d73 656c 662e 6675 6e63 7469 6f6e  on=self.function
+0001cbb0: 2e62 6173 655f 6e61 6d65 2c0a 2020 2020  .base_name,.    
+0001cbc0: 2020 2020 290a 0a20 2020 2020 2020 2066      )..        f
+0001cbd0: 6f72 206b 2c20 7620 696e 2073 656c 662e  or k, v in self.
+0001cbe0: 6675 6e63 7469 6f6e 2e70 6172 616d 732e  function.params.
+0001cbf0: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
+0001cc00: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0001cc10: 6365 2876 2c20 696e 7429 3a0a 2020 2020  ce(v, int):.    
+0001cc20: 2020 2020 2020 2020 2020 2020 7072 6f74              prot
+0001cc30: 6f2e 6675 6e63 7469 6f6e 5f70 6172 616d  o.function_param
+0001cc40: 735b 6b5d 2e43 6f70 7946 726f 6d28 6665  s[k].CopyFrom(fe
+0001cc50: 6174 7572 655f 7669 6577 5f70 6232 2e50  ature_view_pb2.P
+0001cc60: 6172 616d 5661 6c75 6528 696e 7436 345f  aramValue(int64_
+0001cc70: 7661 6c75 653d 7629 290a 2020 2020 2020  value=v)).      
+0001cc80: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001cc90: 2020 2020 2020 2020 2020 2020 7072 6f74              prot
+0001cca0: 6f2e 6675 6e63 7469 6f6e 5f70 6172 616d  o.function_param
+0001ccb0: 735b 6b5d 2e43 6f70 7946 726f 6d28 6665  s[k].CopyFrom(fe
+0001ccc0: 6174 7572 655f 7669 6577 5f70 6232 2e50  ature_view_pb2.P
+0001ccd0: 6172 616d 5661 6c75 6528 646f 7562 6c65  aramValue(double
+0001cce0: 5f76 616c 7565 3d76 2929 0a0a 2020 2020  _value=v))..    
+0001ccf0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0001cd00: 6528 7365 6c66 2e74 696d 655f 7769 6e64  e(self.time_wind
+0001cd10: 6f77 2c20 5469 6d65 5769 6e64 6f77 293a  ow, TimeWindow):
+0001cd20: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
+0001cd30: 746f 2e74 696d 655f 7769 6e64 6f77 2e43  to.time_window.C
+0001cd40: 6f70 7946 726f 6d28 7365 6c66 2e74 696d  opyFrom(self.tim
+0001cd50: 655f 7769 6e64 6f77 2e5f 746f 5f70 726f  e_window._to_pro
+0001cd60: 746f 2829 290a 2020 2020 2020 2020 656c  to()).        el
+0001cd70: 6966 2069 7369 6e73 7461 6e63 6528 7365  if isinstance(se
+0001cd80: 6c66 2e74 696d 655f 7769 6e64 6f77 2c20  lf.time_window, 
+0001cd90: 4c69 6665 7469 6d65 5769 6e64 6f77 293a  LifetimeWindow):
+0001cda0: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
+0001cdb0: 746f 2e6c 6966 6574 696d 655f 7769 6e64  to.lifetime_wind
+0001cdc0: 6f77 2e43 6f70 7946 726f 6d28 7365 6c66  ow.CopyFrom(self
+0001cdd0: 2e74 696d 655f 7769 6e64 6f77 2e5f 746f  .time_window._to
+0001cde0: 5f70 726f 746f 2829 290a 2020 2020 2020  _proto()).      
+0001cdf0: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+0001ce00: 6528 7365 6c66 2e74 696d 655f 7769 6e64  e(self.time_wind
+0001ce10: 6f77 2c20 5469 6d65 5769 6e64 6f77 5365  ow, TimeWindowSe
+0001ce20: 7269 6573 293a 0a20 2020 2020 2020 2020  ries):.         
+0001ce30: 2020 2070 726f 746f 2e74 696d 655f 7769     proto.time_wi
+0001ce40: 6e64 6f77 5f73 6572 6965 732e 436f 7079  ndow_series.Copy
+0001ce50: 4672 6f6d 2873 656c 662e 7469 6d65 5f77  From(self.time_w
+0001ce60: 696e 646f 772e 5f74 6f5f 7072 6f74 6f28  indow._to_proto(
+0001ce70: 2929 0a20 2020 2020 2020 2065 6c73 653a  )).        else:
+0001ce80: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
+0001ce90: 203d 2066 2249 6e76 616c 6964 2074 696d   = f"Invalid tim
+0001cea0: 655f 7769 6e64 6f77 2074 7970 653a 207b  e_window type: {
+0001ceb0: 7479 7065 2873 656c 662e 7469 6d65 5f77  type(self.time_w
+0001cec0: 696e 646f 7729 7d22 0a20 2020 2020 2020  indow)}".       
+0001ced0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+0001cee0: 7272 6f72 286d 7367 290a 0a20 2020 2020  rror(msg)..     
+0001cef0: 2020 2072 6574 7572 6e20 7072 6f74 6f0a     return proto.
+0001cf00: 0a20 2020 2064 6566 205f 6465 6661 756c  .    def _defaul
+0001cf10: 745f 6e61 6d65 280a 2020 2020 2020 2020  t_name(.        
+0001cf20: 7365 6c66 2c20 6167 6772 6567 6174 696f  self, aggregatio
+0001cf30: 6e5f 696e 7465 7276 616c 3a20 6461 7465  n_interval: date
+0001cf40: 7469 6d65 2e74 696d 6564 656c 7461 2c20  time.timedelta, 
+0001cf50: 6973 5f63 6f6e 7469 6e75 6f75 733a 2062  is_continuous: b
+0001cf60: 6f6f 6c2c 2063 6f6d 7061 6374 696f 6e5f  ool, compaction_
+0001cf70: 656e 6162 6c65 643a 2062 6f6f 6c0a 2020  enabled: bool.  
+0001cf80: 2020 2920 2d3e 2073 7472 3a0a 2020 2020    ) -> str:.    
+0001cf90: 2020 2020 7769 6e64 6f77 5f73 7065 6320      window_spec 
+0001cfa0: 3d20 7365 6c66 2e74 696d 655f 7769 6e64  = self.time_wind
+0001cfb0: 6f77 2e5f 746f 5f73 7065 6328 290a 2020  ow._to_spec().  
+0001cfc0: 2020 2020 2020 636f 6c75 6d6e 5f6e 616d        column_nam
+0001cfd0: 6520 3d20 6622 7b73 656c 662e 636f 6c75  e = f"{self.colu
+0001cfe0: 6d6e 7d5f 7b73 656c 662e 6675 6e63 7469  mn}_{self.functi
+0001cff0: 6f6e 2e72 6573 6f6c 7665 645f 6e61 6d65  on.resolved_name
+0001d000: 7d5f 7b77 696e 646f 775f 7370 6563 2e77  }_{window_spec.w
+0001d010: 696e 646f 775f 6475 7261 7469 6f6e 5f73  indow_duration_s
+0001d020: 7472 696e 6728 297d 220a 0a20 2020 2020  tring()}"..     
+0001d030: 2020 2069 6620 6e6f 7420 636f 6d70 6163     if not compac
+0001d040: 7469 6f6e 5f65 6e61 626c 6564 3a0a 2020  tion_enabled:.  
+0001d050: 2020 2020 2020 2020 2020 6167 675f 696e            agg_in
+0001d060: 7465 7276 616c 5f6e 616d 6520 3d20 6665  terval_name = fe
+0001d070: 6174 7572 655f 7669 6577 5f75 7469 6c73  ature_view_utils
+0001d080: 2e63 6f6e 7374 7275 6374 5f61 6767 7265  .construct_aggre
+0001d090: 6761 7469 6f6e 5f69 6e74 6572 7661 6c5f  gation_interval_
+0001d0a0: 6e61 6d65 280a 2020 2020 2020 2020 2020  name(.          
+0001d0b0: 2020 2020 2020 7469 6d65 5f75 7469 6c73        time_utils
+0001d0c0: 2e74 696d 6564 656c 7461 5f74 6f5f 7072  .timedelta_to_pr
+0001d0d0: 6f74 6f28 6167 6772 6567 6174 696f 6e5f  oto(aggregation_
+0001d0e0: 696e 7465 7276 616c 292c 2069 735f 636f  interval), is_co
+0001d0f0: 6e74 696e 756f 7573 0a20 2020 2020 2020  ntinuous.       
+0001d100: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0001d110: 2020 2063 6f6c 756d 6e5f 6e61 6d65 203d     column_name =
+0001d120: 2066 227b 636f 6c75 6d6e 5f6e 616d 657d   f"{column_name}
+0001d130: 5f7b 6167 675f 696e 7465 7276 616c 5f6e  _{agg_interval_n
+0001d140: 616d 657d 220a 0a20 2020 2020 2020 2069  ame}"..        i
+0001d150: 6620 6973 696e 7374 616e 6365 2873 656c  f isinstance(sel
+0001d160: 662e 7469 6d65 5f77 696e 646f 772c 2054  f.time_window, T
+0001d170: 696d 6557 696e 646f 7753 6572 6965 7329  imeWindowSeries)
+0001d180: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
+0001d190: 6c75 6d6e 5f6e 616d 6520 3d20 6622 7b63  lumn_name = f"{c
+0001d1a0: 6f6c 756d 6e5f 6e61 6d65 7d5f 7365 7269  olumn_name}_seri
+0001d1b0: 6573 5f7b 7769 6e64 6f77 5f73 7065 632e  es_{window_spec.
+0001d1c0: 7769 6e64 6f77 5f73 6572 6965 735f 7374  window_series_st
+0001d1d0: 6172 745f 7374 7269 6e67 2829 7d5f 7b77  art_string()}_{w
+0001d1e0: 696e 646f 775f 7370 6563 2e77 696e 646f  indow_spec.windo
+0001d1f0: 775f 7365 7269 6573 5f65 6e64 5f73 7472  w_series_end_str
+0001d200: 696e 6728 297d 5f7b 7769 6e64 6f77 5f73  ing()}_{window_s
+0001d210: 7065 632e 7374 6570 5f73 697a 655f 7374  pec.step_size_st
+0001d220: 7269 6e67 2829 7d22 0a20 2020 2020 2020  ring()}".       
+0001d230: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0001d240: 2020 2069 6620 7769 6e64 6f77 5f73 7065     if window_spe
+0001d250: 632e 6f66 6673 6574 5f73 7472 696e 6728  c.offset_string(
+0001d260: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0001d270: 2020 2063 6f6c 756d 6e5f 6e61 6d65 203d     column_name =
+0001d280: 2066 227b 636f 6c75 6d6e 5f6e 616d 657d   f"{column_name}
+0001d290: 5f7b 7769 6e64 6f77 5f73 7065 632e 6f66  _{window_spec.of
+0001d2a0: 6673 6574 5f73 7472 696e 6728 297d 220a  fset_string()}".
+0001d2b0: 2020 2020 2020 2020 636f 6c75 6d6e 5f6e          column_n
+0001d2c0: 616d 6520 3d20 636f 6c75 6d6e 5f6e 616d  ame = column_nam
+0001d2d0: 652e 7265 706c 6163 6528 2220 222c 2022  e.replace(" ", "
+0001d2e0: 2229 0a0a 2020 2020 2020 2020 7265 7475  ")..        retu
+0001d2f0: 726e 2063 6f6c 756d 6e5f 6e61 6d65 0a0a  rn column_name..
+0001d300: 0a23 2043 6f6d 706f 7369 7465 2074 7970  .# Composite typ
+0001d310: 6573 2e0a 4f6e 6c69 6e65 5374 6f72 6554  es..OnlineStoreT
+0001d320: 7970 6573 203d 2055 6e69 6f6e 5b44 796e  ypes = Union[Dyn
+0001d330: 616d 6f43 6f6e 6669 672c 2052 6564 6973  amoConfig, Redis
+0001d340: 436f 6e66 6967 2c20 4269 6774 6162 6c65  Config, Bigtable
+0001d350: 436f 6e66 6967 5d0a 436f 6d70 7574 6543  Config].ComputeC
+0001d360: 6f6e 6669 6754 7970 6573 203d 2055 6e69  onfigTypes = Uni
+0001d370: 6f6e 5b0a 2020 2020 5f44 6566 6175 6c74  on[.    _Default
+0001d380: 436c 7573 7465 7243 6f6e 6669 672c 0a20  ClusterConfig,. 
+0001d390: 2020 2044 6174 6162 7269 636b 7343 6c75     DatabricksClu
+0001d3a0: 7374 6572 436f 6e66 6967 2c0a 2020 2020  sterConfig,.    
+0001d3b0: 454d 5243 6c75 7374 6572 436f 6e66 6967  EMRClusterConfig
+0001d3c0: 2c0a 2020 2020 4461 7461 6272 6963 6b73  ,.    Databricks
+0001d3d0: 4a73 6f6e 436c 7573 7465 7243 6f6e 6669  JsonClusterConfi
+0001d3e0: 672c 0a20 2020 2044 6174 6170 726f 634a  g,.    DataprocJ
+0001d3f0: 736f 6e43 6c75 7374 6572 436f 6e66 6967  sonClusterConfig
+0001d400: 2c0a 2020 2020 454d 524a 736f 6e43 6c75  ,.    EMRJsonClu
+0001d410: 7374 6572 436f 6e66 6967 2c0a 2020 2020  sterConfig,.    
+0001d420: 5269 6674 4261 7463 6843 6f6e 6669 672c  RiftBatchConfig,
+0001d430: 0a5d 0a                                  .].
```

### Comparing `tecton-0.9.2/tecton/framework/data_frame.py` & `tecton-0.9.3/tecton/framework/data_frame.py`

 * *Files 1% similar despite different names*

```diff
@@ -47,14 +47,16 @@
 from tecton_core.query.nodes import StagingNode
 from tecton_core.query.nodes import UserSpecifiedDataNode
 from tecton_core.query.pandas import node
 from tecton_core.schema import Schema
 from tecton_core.time_utils import convert_pandas_df_for_snowflake_upload
 from tecton_spark import schema_spark_utils
 from tecton_spark.query import translate
+from tecton_spark.type_annotations import PySparkDataFrame
+from tecton_spark.type_annotations import PySparkSession
 
 
 if typing.TYPE_CHECKING:
     import snowflake.snowpark
 
 logger = logging.getLogger(__name__)
 
@@ -154,15 +156,15 @@
 # NOTE: use repr=False to avoid printing out the underlying dataframes when used in REPL/notebook.
 @attrs.define(repr=False)
 class TectonDataFrame(DataframeWrapper):
     """
     A thin wrapper around Pandas, Spark, and Snowflake dataframes.
     """
 
-    _spark_df: Optional[pyspark.sql.DataFrame] = None
+    _spark_df: Optional[PySparkDataFrame] = None
     _pandas_df: Optional[pandas.DataFrame] = None
     # TODO: Change the type to snowflake.snowpark.DataFrame, currently it will
     # fail type checking for our auto generated doc.
     _snowflake_df: Optional[Any] = None
     # should already by optimized
     _querytree: Optional[NodeRef] = attrs.field(default=None, repr=lambda x: "TectonQueryTree")
 
@@ -196,15 +198,15 @@
                 msg = "Can only show columns if 'node_id' is True."
                 raise RuntimeError(msg)
             print(self._querytree.pretty_str(node_id=node_id, name=name, description=description, columns=columns))
         else:
             print("Explain is only available for TectonDataFrames backed by a query tree.")
 
     @sdk_public_method
-    def to_spark(self) -> pyspark.sql.DataFrame:
+    def to_spark(self) -> PySparkDataFrame:
         """Returns data as a Spark DataFrame.
 
         :return: A Spark DataFrame.
         """
         if self._spark_df is not None:
             return self._spark_df
         else:
@@ -282,15 +284,15 @@
             return output
 
     @property
     def _compute_mode(self):
         assert self._querytree is not None, "Must be called on a QueryTree DataFrame"
         return self._querytree.node.compute_mode
 
-    def _to_spark(self, spark: pyspark.sql.SparkSession) -> pyspark.sql.DataFrame:
+    def _to_spark(self, spark: PySparkSession) -> PySparkDataFrame:
         return translate.spark_convert(self._querytree, spark).to_dataframe(spark)
 
     def _to_pandas_from_duckdb(self, pretty_sql: bool) -> pandas.DataFrame:
         from tecton_core.query import query_tree_executor
 
         # TODO(danny): support pretty_sql
         fv_dialect = get_pipeline_dialect(self._querytree)
@@ -436,21 +438,21 @@
 
         assert self._pandas_df is not None
         return SnowflakeContext.get_instance().get_session().createDataFrame(self._pandas_df)
 
     @classmethod
     def _create(
         cls,
-        df: Union[pyspark.sql.DataFrame, pandas.DataFrame, NodeRef],
+        df: Union[PySparkDataFrame, pandas.DataFrame, NodeRef],
         rewrite: bool = True,
     ):
         """Creates a Tecton DataFrame from a Spark or Pandas DataFrame."""
         if isinstance(df, pandas.DataFrame):
             return cls(spark_df=None, pandas_df=df, snowflake_df=None)
-        elif isinstance(df, pyspark.sql.DataFrame):
+        elif isinstance(df, PySparkDataFrame):
             return cls(spark_df=df, pandas_df=None, snowflake_df=None)
         elif isinstance(df, NodeRef):
             if rewrite:
                 rewrite_tree_for_spine(df)
             return cls(spark_df=None, pandas_df=None, snowflake_df=None, querytree=df)
 
         msg = f"DataFrame must be of type pandas.DataFrame or pyspark.sql.Dataframe, not {type(df)}"
```

### Comparing `tecton-0.9.2/tecton/framework/data_source.py` & `tecton-0.9.3/tecton/framework/data_source.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/framework/dataset.py` & `tecton-0.9.3/tecton/framework/dataset.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/framework/entity.py` & `tecton-0.9.3/tecton/framework/entity.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/framework/feature.py` & `tecton-0.9.3/tecton/framework/feature.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/framework/feature_service.py` & `tecton-0.9.3/tecton/framework/feature_service.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/framework/feature_view.py` & `tecton-0.9.3/tecton/framework/feature_view.py`

 * *Files 1% similar despite different names*

```diff
@@ -708,14 +708,15 @@
         end_time: datetime.datetime,
         entities: Optional[Union[pyspark_dataframe.DataFrame, pandas.DataFrame, TectonDataFrame]] = None,
         max_lookback: Optional[datetime.timedelta] = None,
         from_source: Optional[bool] = None,
         mock_inputs: Optional[Dict[str, Union[pandas.DataFrame, pyspark_dataframe.DataFrame]]] = None,
         compute_mode: Optional[Union[ComputeMode, str]] = None,
     ) -> TectonDataFrame:
+        # TODO(ajeya): Add docstring for get_features_in_range
         compute_mode = offline_retrieval_compute_mode(compute_mode)
         if compute_mode != ComputeMode.SPARK and compute_mode != ComputeMode.RIFT:
             raise errors.GET_FEATURES_IN_RANGE_UNSUPPORTED
 
         if start_time >= end_time:
             raise core_errors.START_TIME_NOT_BEFORE_END_TIME(start_time, end_time)
 
@@ -753,16 +754,14 @@
             feature_definition=feature_definition,
             start_time=start_time,
             end_time=end_time,
             entities=entities,
             max_lookback=max_lookback,
             from_source=from_source,
             mock_data_sources=mock_data_sources,
-            save_as=None,
-            save=False,
         )
 
     @sdk_decorators.sdk_public_method(
         requires_validation=True,
         supports_skip_validation=True,
     )
     def get_features_for_events(
@@ -1144,20 +1143,23 @@
                 )
 
             if mock_inputs and feature_definition.is_incremental_backfill:
                 raise errors.FV_WITH_INC_BACKFILLS_GET_MATERIALIZED_FEATURES_MOCK_DATA(
                     self.name, self.get_partial_aggregates.__name__
                 )
 
-        if not self._feature_definition.is_temporal_aggregate:
+        if not feature_definition.is_temporal_aggregate:
             raise errors.GET_PARTIAL_AGGREGATES_UNSUPPORTED_NON_AGGREGATE()
 
-        if self._feature_definition.compaction_enabled:
+        if feature_definition.compaction_enabled:
             raise errors.GET_PARTIAL_AGGREGATES_UNSUPPORTED_COMPACTED()
 
+        if feature_definition.is_continuous:
+            raise errors.GET_PARTIAL_AGGREGATES_UNSUPPORTED_CONTINUOUS()
+
         if any(ds._data_source_type == DataSourceType.PUSH_NO_BATCH for ds in self.sources):
             msg = "The `get_partial_aggregates()` method is currently unsupported for Feature Views that are backed by a PushSource without a batch_config."
             raise TectonValidationError(msg)
 
         if entities is not None:
             if not isinstance(entities, TectonDataFrame):
                 entities = TectonDataFrame._create(entities)
@@ -3010,16 +3012,14 @@
     @sdk_decorators.assert_remote_object(error_message=errors.INVALID_USAGE_FOR_LOCAL_FEATURE_TABLE_OBJECT)
     def get_features_in_range(
         self,
         start_time: datetime.datetime,
         end_time: datetime.datetime,
         max_lookback: Optional[datetime.timedelta] = None,
         entities: Optional[Union[pyspark_dataframe.DataFrame, pandas.DataFrame, TectonDataFrame]] = None,
-        save: bool = False,
-        save_as: Optional[str] = None,
         compute_mode: Optional[Union[ComputeMode, str]] = None,
     ) -> TectonDataFrame:
         """Returns a Tecton :class:`TectonDataFrame` of historical values for this feature table.
 
         If no arguments are passed in, all feature values for this feature table will be returned in a TectonDataFrame.
         Note:
 
@@ -3068,16 +3068,14 @@
             compute_mode=compute_mode,
             feature_definition=self._feature_definition,
             start_time=start_time,
             end_time=end_time,
             max_lookback=max_lookback,
             entities=entities,
             from_source=False,
-            save=save,
-            save_as=save_as,
             mock_data_sources={},
         )
 
     # if spine is provided, then timestamp_key is optional, but start_time, end_time, and entities cannot be used
     @overload
     def get_historical_features(
         self,
@@ -3468,15 +3466,17 @@
     @sdk_decorators.assert_valid
     def _check_can_query_from_source(self, from_source: Optional[bool]) -> QuerySources:
         all_sources = QuerySources(on_demand_count=1)
         for fv in self._get_dependent_feature_views():
             all_sources += fv._check_can_query_from_source(from_source)
         return all_sources
 
-    @sdk_decorators.sdk_public_method(requires_validation=True, validation_error_message=errors.RUN_REQUIRES_VALIDATION)
+    @sdk_decorators.sdk_public_method(
+        requires_validation=True, validation_error_message=errors.RUN_REQUIRES_VALIDATION, supports_skip_validation=True
+    )
     def run_transformation(self, input_data: Dict[str, Any]) -> Union[Dict[str, Any], TectonDataFrame]:
         """Run the OnDemandFeatureView using mock inputs.
 
         :param input_data: Required. Dict with the same expected keys as the OnDemandFeatureView's inputs parameters.
             For the "python" mode, each value must be a Dictionary representing a single row.
             For the "pandas" mode, each value must be a DataFrame with all of them containing the
             same number of rows and matching row ordering.
@@ -3513,18 +3513,29 @@
             result = fv.run_transformation(input_data=input_data)
 
             print(result)
             # {'higher_than_average': False}
 
         :return: A `Dict` object for the "python" mode and a tecton DataFrame of the results for the "pandas" mode.
         """
-        # Snowflake compute uses the same code for run_ondemand as Spark.
-        return run_api.run_ondemand(self._feature_definition, self.info.name, input_data)
 
-    @sdk_decorators.sdk_public_method(requires_validation=True, validation_error_message=errors.RUN_REQUIRES_VALIDATION)
+        # unvalidated path for unit tests
+        # TODO (Mary): These unvalidated forks should be cleaned up as part of the new validation strategy
+        if self._feature_definition is None:
+            return run_api.run_realtime_unvalidated(
+                self.info.name, input_data, self.transformations, self._args.pipeline
+            )
+        # Snowflake compute uses the same code for run_realtime as Spark.
+        return run_api.run_ondemand(
+            self._feature_definition, self.info.name, input_data, self._feature_definition.transformation_mode
+        )
+
+    @sdk_decorators.sdk_public_method(
+        requires_validation=True, validation_error_message=errors.RUN_REQUIRES_VALIDATION, supports_skip_validation=True
+    )
     def run(
         self, **mock_inputs: Union[Dict[str, Any], pandas.DataFrame, pyspark_dataframe.DataFrame]
     ) -> Union[Dict[str, Any], TectonDataFrame]:
         """Run the OnDemandFeatureView using mock inputs.
 
         :param \*\*mock_inputs: Required. Keyword args with the same expected keys
             as the OnDemandFeatureView's inputs parameters.
@@ -3556,17 +3567,27 @@
             result = fv.run(request={'amt': 100}, user_metrics={'daily_average': 1000})
 
             print(result)
             # {'higher_than_average': False}
 
         :return: A `Dict` object for the "python" mode and a tecton DataFrame of the results for the "pandas" mode.
         """
-        # Snowflake compute uses the same code for run_ondemand as Spark.
+
+        # unvalidated path for unit tests
+        # TODO (Mary): These unvalidated forks should be cleaned up as part of the new validation strategy
+        if self._feature_definition is None:
+            return run_api.run_realtime_unvalidated(
+                self.info.name, mock_inputs, self.transformations, self._args.pipeline
+            )
+
+        # Snowflake compute uses the same code for run_realtime as Spark.
         logger.warning(errors.RUN_DEPRECATED_TRANSFORMATION)
-        return run_api.run_ondemand(self._feature_definition, self.info.name, mock_inputs)
+        return run_api.run_ondemand(
+            self._feature_definition, self.info.name, mock_inputs, self._feature_definition.transformation_mode
+        )
 
     @sdk_decorators.sdk_public_method
     @sdk_decorators.assert_local_object(error_message=errors.CANNOT_USE_LOCAL_RUN_ON_REMOTE_OBJECT)
     def test_run(
         self, **mock_inputs: Union[Dict[str, Any], pandas.DataFrame]
     ) -> Union[Dict[str, Any], pandas.DataFrame]:
         """Run the OnDemandFeatureView using mock sources.
@@ -3593,15 +3614,15 @@
 
                 # Test using `run` API.
                 result = transaction_amount_is_high.test_run(transaction_request={'amount': 100})
 
         :return: A `Dict` object for the "python" mode and a `pandas.DataFrame` object for the "pandas" mode".
         """
         # TODO(adchia): Validate batch feature inputs here against BFV schema
-        run_api.validate_ondemand_mock_inputs(mock_inputs, self._args.pipeline)
+        run_api.validate_ondemand_mock_inputs_match_expected_shape(mock_inputs, self._args.pipeline)
 
         transformation_specs = [transformation._create_unvalidated_spec() for transformation in self.transformations]
 
         return pipeline_helper.run_mock_odfv_pipeline(self._args.pipeline, transformation_specs, self.name, mock_inputs)
 
     @sdk_decorators.sdk_public_method(requires_validation=True)
     def get_features_for_events(
@@ -4542,14 +4563,14 @@
     aggregations: Optional[Sequence[configs.Aggregation]],
     compaction_enabled: bool,
     stream_tiling_enabled: Optional[bool] = None,
 ):
     if has_push_source:
         # Stream Feature Views with Push Sources default to continuous-mode only.
         return StreamProcessingMode.CONTINUOUS
-    elif compaction_enabled and not stream_tiling_enabled:
+    elif compaction_enabled:
         # This is a Compacted stream feature view. We set defaults here for compacted feature views. The actual validations
         # will be in the validation server.
-        return StreamProcessingMode.CONTINUOUS
+        return StreamProcessingMode.CONTINUOUS if not stream_tiling_enabled else None
     elif aggregations:
-        StreamProcessingMode.TIME_INTERVAL
+        return StreamProcessingMode.TIME_INTERVAL
     return None
```

### Comparing `tecton-0.9.2/tecton/framework/filtered_source.py` & `tecton-0.9.3/tecton/framework/filtered_source.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/framework/repo_config.py` & `tecton-0.9.3/tecton/framework/repo_config.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/framework/transformation.py` & `tecton-0.9.3/tecton/framework/transformation.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/framework/utils.py` & `tecton-0.9.3/tecton/framework/utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/framework/validation_mode.py` & `tecton-0.9.3/tecton/framework/validation_mode.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/framework/workspace.py` & `tecton-0.9.3/tecton/framework/workspace.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/identities/api_keys.py` & `tecton-0.9.3/tecton/identities/api_keys.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/identities/credentials.py` & `tecton-0.9.3/tecton/identities/credentials.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/identities/okta.py` & `tecton-0.9.3/tecton/identities/okta.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/pytest_tecton.py` & `tecton-0.9.3/tecton/pytest_tecton.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/snowflake_context.py` & `tecton-0.9.3/tecton/snowflake_context.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/tecton_context.py` & `tecton-0.9.3/tecton/tecton_context.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/types.py` & `tecton-0.9.3/tecton/types.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/dill/dill/__diff.py` & `tecton-0.9.3/tecton/vendor/dill/dill/__diff.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/dill/dill/__init__.py` & `tecton-0.9.3/tecton/vendor/dill/dill/__init__.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/dill/dill/_dill.py` & `tecton-0.9.3/tecton/vendor/dill/dill/_dill.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/dill/dill/_objects.py` & `tecton-0.9.3/tecton/vendor/dill/dill/_objects.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/dill/dill/detect.py` & `tecton-0.9.3/tecton/vendor/dill/dill/detect.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/dill/dill/info.py` & `tecton-0.9.3/tecton/vendor/dill/dill/info.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/dill/dill/objtypes.py` & `tecton-0.9.3/tecton/vendor/dill/dill/objtypes.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/dill/dill/pointers.py` & `tecton-0.9.3/tecton/vendor/dill/dill/pointers.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/dill/dill/settings.py` & `tecton-0.9.3/tecton/vendor/dill/dill/settings.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/dill/dill/source.py` & `tecton-0.9.3/tecton/vendor/dill/dill/source.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/dill/dill/temp.py` & `tecton-0.9.3/tecton/vendor/dill/dill/temp.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/py4j/clientserver.py` & `tecton-0.9.3/tecton/vendor/pyspark/py4j/clientserver.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/py4j/compat.py` & `tecton-0.9.3/tecton/vendor/pyspark/py4j/compat.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/py4j/finalizer.py` & `tecton-0.9.3/tecton/vendor/pyspark/py4j/finalizer.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/py4j/java_collections.py` & `tecton-0.9.3/tecton/vendor/pyspark/py4j/java_collections.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/py4j/java_gateway.py` & `tecton-0.9.3/tecton/vendor/pyspark/py4j/java_gateway.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/py4j/protocol.py` & `tecton-0.9.3/tecton/vendor/pyspark/py4j/protocol.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/py4j/signals.py` & `tecton-0.9.3/tecton/vendor/pyspark/py4j/signals.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/__init__.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/__init__.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/_globals.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/_globals.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/accumulators.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/accumulators.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/broadcast.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/broadcast.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/cloudpickle/cloudpickle.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/cloudpickle/cloudpickle.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/cloudpickle/cloudpickle_fast.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/cloudpickle/cloudpickle_fast.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/conf.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/conf.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/context.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/context.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/daemon.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/daemon.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/files.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/files.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/find_spark_home.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/find_spark_home.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/install.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/install.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/java_gateway.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/java_gateway.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/join.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/join.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/__init__.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/__init__.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/base.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/base.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/classification.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/classification.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/clustering.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/clustering.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/common.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/common.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/evaluation.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/evaluation.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/feature.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/feature.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/fpm.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/fpm.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/functions.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/functions.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/image.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/image.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/linalg/__init__.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/linalg/__init__.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/param/__init__.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/param/__init__.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/param/_shared_params_code_gen.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/param/_shared_params_code_gen.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/param/shared.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/param/shared.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/pipeline.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/pipeline.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/recommendation.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/recommendation.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/regression.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/regression.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/stat.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/stat.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/tree.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/tree.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/tuning.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/tuning.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/util.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/util.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/ml/wrapper.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/ml/wrapper.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/__init__.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/__init__.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/classification.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/classification.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/clustering.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/clustering.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/common.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/common.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/evaluation.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/evaluation.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/feature.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/feature.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/fpm.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/fpm.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/linalg/__init__.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/linalg/__init__.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/linalg/distributed.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/linalg/distributed.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/random.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/random.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/recommendation.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/recommendation.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/regression.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/regression.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/stat/KernelDensity.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/stat/KernelDensity.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/stat/__init__.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/stat/__init__.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/stat/_statistics.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/stat/_statistics.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/stat/distribution.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/stat/distribution.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/stat/test.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/stat/test.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/tree.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/tree.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/mllib/util.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/mllib/util.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/profiler.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/profiler.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/python/pyspark/shell.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/python/pyspark/shell.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/rdd.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/rdd.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/rddsampler.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/rddsampler.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/resource/__init__.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/resource/__init__.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/resource/information.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/resource/information.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/resource/profile.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/resource/profile.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/resource/requests.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/resource/requests.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/resultiterable.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/resultiterable.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/serializers.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/serializers.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/shell.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/shell.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/shuffle.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/shuffle.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/__init__.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/__init__.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/avro/__init__.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/avro/__init__.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/avro/functions.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/avro/functions.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/catalog.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/catalog.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/column.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/column.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/conf.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/conf.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/context.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/context.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/dataframe.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/dataframe.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/functions.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/functions.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/group.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/group.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/pandas/__init__.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/pandas/__init__.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/pandas/conversion.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/pandas/conversion.py`

 * *Files 5% similar despite different names*

```diff
@@ -50,17 +50,17 @@
         Examples
         --------
         >>> df.toPandas()  # doctest: +SKIP
            age   name
         0    2  Alice
         1    5    Bob
         """
-        from pyspark.sql.dataframe import DataFrame
+        from tecton_spark.type_annotations import PySparkDataFrame
 
-        assert isinstance(self, DataFrame)
+        assert isinstance(self, PySparkDataFrame)
 
         from pyspark.sql.pandas.utils import require_minimum_pandas_version
         require_minimum_pandas_version()
 
         import numpy as np
         import pandas as pd
 
@@ -227,17 +227,17 @@
 
     def _collect_as_arrow(self):
         """
         Returns all records as a list of ArrowRecordBatches, pyarrow must be installed
         and available on driver and worker Python environments.
         This is an experimental feature.
         """
-        from pyspark.sql.dataframe import DataFrame
+        from tecton_spark.type_annotations import PySparkDataFrame
 
-        assert isinstance(self, DataFrame)
+        assert isinstance(self, PySparkDataFrame)
 
         with SCCallSiteSync(self._sc):
             port, auth_secret, jsocket_auth_server = self._jdf.collectAsArrowToPython()
 
         # Collect list of un-ordered batches where last element is a list of correct order indices
         try:
             results = list(_load_from_socket((port, auth_secret), ArrowCollectSerializer()))
@@ -255,17 +255,17 @@
 
 class SparkConversionMixin(object):
     """
     Min-in for the conversion from pandas to Spark. Currently, only :class:`SparkSession`
     can use this class.
     """
     def createDataFrame(self, data, schema=None, samplingRatio=None, verifySchema=True):
-        from pyspark.sql import SparkSession
+        from tecton_spark.type_annotations import PySparkSession
 
-        assert isinstance(self, SparkSession)
+        assert isinstance(self, PySparkSession)
 
         from pyspark.sql.pandas.utils import require_minimum_pandas_version
         require_minimum_pandas_version()
 
         timezone = self._wrapped._conf.sessionLocalTimeZone()
 
         # If no schema supplied by user then get the names of columns only
@@ -383,18 +383,18 @@
 
     def _create_from_pandas_with_arrow(self, pdf, schema, timezone):
         """
         Create a DataFrame from a given pandas.DataFrame by slicing it into partitions, converting
         to Arrow data, then sending to the JVM to parallelize. If a schema is passed in, the
         data types will be used to coerce the data in Pandas to Arrow conversion.
         """
-        from pyspark.sql import SparkSession
+        from tecton_spark.type_annotations import PySparkSession
         from pyspark.sql.dataframe import DataFrame
 
-        assert isinstance(self, SparkSession)
+        assert isinstance(self, PySparkSession)
 
         from pyspark.sql.pandas.serializers import ArrowStreamPandasSerializer
         from pyspark.sql.types import TimestampType
         from pyspark.sql.pandas.types import from_arrow_type, to_arrow_type
         from pyspark.sql.pandas.utils import require_minimum_pandas_version, \
             require_minimum_pyarrow_version
```

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/pandas/functions.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/pandas/functions.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/pandas/group_ops.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/pandas/group_ops.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/pandas/map_ops.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/pandas/map_ops.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/pandas/serializers.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/pandas/serializers.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/pandas/typehints.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/pandas/typehints.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/pandas/types.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/pandas/types.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/pandas/utils.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/pandas/utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/readwriter.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/readwriter.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/session.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/session.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/streaming.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/streaming.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/types.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/types.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/udf.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/udf.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/utils.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/sql/window.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/sql/window.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/statcounter.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/statcounter.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/status.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/status.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/storagelevel.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/storagelevel.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/streaming/__init__.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/streaming/__init__.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/streaming/context.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/streaming/context.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/streaming/dstream.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/streaming/dstream.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/streaming/kinesis.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/streaming/kinesis.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/streaming/listener.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/streaming/listener.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/streaming/util.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/streaming/util.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/taskcontext.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/taskcontext.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/traceback_utils.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/traceback_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/util.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/util.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/pyspark/pyspark/worker.py` & `tecton-0.9.3/tecton/vendor/pyspark/pyspark/worker.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/vendor_dill.py` & `tecton-0.9.3/tecton/vendor/vendor_dill.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/vendor/vendor_pyspark.py` & `tecton-0.9.3/tecton/vendor/vendor_pyspark.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton/version.py` & `tecton-0.9.3/tecton/version.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton.egg-info/PKG-INFO` & `tecton-0.9.3/tecton.egg-info/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: tecton
-Version: 0.9.2
+Version: 0.9.3
 Summary: Tecton Python SDK
 Home-page: https://tecton.ai
 Author: Tecton, Inc.
 Author-email: support@tecton.ai
 License: Tecton Proprietary
 Classifier: Programming Language :: Python :: 3
 Classifier: Operating System :: OS Independent
```

### Comparing `tecton-0.9.2/tecton.egg-info/SOURCES.txt` & `tecton-0.9.3/tecton.egg-info/SOURCES.txt`

 * *Files 0% similar despite different names*

```diff
@@ -568,14 +568,15 @@
 tecton_spark/partial_aggregations.py
 tecton_spark/pipeline_helper.py
 tecton_spark/schema_derivation_utils.py
 tecton_spark/schema_spark_utils.py
 tecton_spark/spark_helper.py
 tecton_spark/spark_schema_wrapper.py
 tecton_spark/time_utils.py
+tecton_spark/type_annotations.py
 tecton_spark/udf_jar.py
 tecton_spark/udfs.py
 tecton_spark/jars/__init__.py
 tecton_spark/jars/class_loader.py
 tecton_spark/jars/tecton-udfs-spark-3.jar
 tecton_spark/query/__init__.py
 tecton_spark/query/data_source.py
```

### Comparing `tecton-0.9.2/tecton.egg-info/requires.txt` & `tecton-0.9.3/tecton.egg-info/requires.txt`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_athena/athena_session.py` & `tecton-0.9.3/tecton_athena/athena_session.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_athena/data_catalog_helper.py` & `tecton-0.9.3/tecton_athena/data_catalog_helper.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_athena/odfv_helper.py` & `tecton-0.9.3/tecton_athena/odfv_helper.py`

 * *Files 3% similar despite different names*

```diff
@@ -66,24 +66,22 @@
 
         odfv_invocation_inputs[input_name] = input_df
 
     return odfv_invocation_inputs
 
 
 def _run_odfv(data_df: pandas.DataFrame, odfv: FeatureDefinitionWrapper) -> pandas.DataFrame:
-    transformation_mode = odfv.transformations[0].transformation_mode
-
     odfv_pipeline = pipeline_helper.build_odfv_execution_pipeline(
         pipeline=odfv.pipeline, transformations=odfv.transformations, name=odfv.name
     )
-    if transformation_mode == TransformationMode.TRANSFORMATION_MODE_PANDAS:
+    if odfv.transformation_mode == TransformationMode.TRANSFORMATION_MODE_PANDAS:
         odfv_inputs = _extract_inputs_for_odfv_from_data(data_df, odfv)
         odfv_result_df = odfv_pipeline.execute_with_inputs(odfv_inputs)
         return odfv_result_df
-    elif transformation_mode == TransformationMode.TRANSFORMATION_MODE_PYTHON:
+    elif odfv.transformation_mode == TransformationMode.TRANSFORMATION_MODE_PYTHON:
         odfv_inputs = _extract_inputs_for_odfv_from_data(data_df, odfv)
 
         # The inputs are currently a mapping of input_name to pandas DF
         # We need turn the ODFV inputs from a pandas DF to a list of dictionaries
         # Then we need to iterate through all rows of the input data set, pass the input dicts into the ODFV
         # And finally convert the resulting list of dicts into a pandas DF
         for input_name in odfv_inputs.keys():
@@ -104,15 +102,15 @@
             for input_name in odfv_inputs.keys():
                 row_odfv_inputs[input_name] = odfv_inputs[input_name][row_index]
 
             odfv_result_dict = odfv_pipeline.execute_with_inputs(row_odfv_inputs)
             odfv_result_list.append(odfv_result_dict)
         return pandas.DataFrame.from_dict(odfv_result_list)
     else:
-        msg = f"ODFV {odfv.name} has an unexpected transformation mode: {transformation_mode}"
+        msg = f"ODFV {odfv.name} has an unexpected transformation mode: {odfv.transformation_mode}"
         raise TectonValidationError(msg)
 
 
 def run_and_append_on_demand_features_to_historical_data(
     data_df: pandas.DataFrame, odfvs: List[FeatureDefinitionWrapper]
 ):
     for odfv in odfvs:
```

### Comparing `tecton-0.9.2/tecton_athena/query/translate.py` & `tecton-0.9.3/tecton_athena/query/translate.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_athena/sql_helper.py` & `tecton-0.9.3/tecton_athena/sql_helper.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_athena/templates/create_table.sql` & `tecton-0.9.3/tecton_athena/templates/create_table.sql`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_athena/templates/historical_features.sql` & `tecton-0.9.3/tecton_athena/templates/historical_features.sql`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_athena/templates/materialization_tile.sql` & `tecton-0.9.3/tecton_athena/templates/materialization_tile.sql`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_athena/templates/run_full_aggregation.sql` & `tecton-0.9.3/tecton_athena/templates/run_full_aggregation.sql`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_athena/templates/time_limit.sql` & `tecton-0.9.3/tecton_athena/templates/time_limit.sql`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_athena/templates_utils.py` & `tecton-0.9.3/tecton_athena/templates_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/aggregation_utils.py` & `tecton-0.9.3/tecton_core/aggregation_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/arrow.py` & `tecton-0.9.3/tecton_core/arrow.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/aws_credentials.py` & `tecton-0.9.3/tecton_core/aws_credentials.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/compute_mode.py` & `tecton-0.9.3/tecton_core/compute_mode.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/conf.py` & `tecton-0.9.3/tecton_core/conf.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/data_types.py` & `tecton-0.9.3/tecton_core/data_types.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/duckdb_context.py` & `tecton-0.9.3/tecton_core/duckdb_context.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/errors.py` & `tecton-0.9.3/tecton_core/errors.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/fco_container.py` & `tecton-0.9.3/tecton_core/fco_container.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/feature_definition_wrapper.py` & `tecton-0.9.3/tecton_core/feature_definition_wrapper.py`

 * *Files 2% similar despite different names*

```diff
@@ -26,14 +26,15 @@
 from tecton_core.specs import create_time_window_spec_from_data_proto
 from tecton_core.specs import utils
 from tecton_core.time_utils import convert_timedelta_for_version
 from tecton_proto.args.feature_view_pb2 import OfflineFeatureStoreConfig
 from tecton_proto.args.pipeline_pb2 import DataSourceNode
 from tecton_proto.args.pipeline_pb2 import Pipeline
 from tecton_proto.args.pipeline_pb2 import PipelineNode
+from tecton_proto.args.transformation_pb2 import TransformationMode
 from tecton_proto.common import data_source_type_pb2
 from tecton_proto.common import schema_pb2
 from tecton_proto.common.framework_version_pb2 import FrameworkVersion as FrameworkVersionProto
 from tecton_proto.data import feature_view_pb2
 from tecton_proto.data.feature_view_pb2 import OfflineStoreParams
 
 
@@ -518,14 +519,22 @@
         if self.pipeline is None:
             return []
 
         transformation_ids = pipeline_to_transformation_ids(self.pipeline)
         return self.fco_container.get_by_ids(transformation_ids)
 
     @property
+    def transformation_mode(self) -> Optional[TransformationMode.ValueType]:
+        if len(self.transformations) == 0:
+            return None
+
+        # TODO: Strengthen validation here. Feature views besides pipeline mode should only have one value
+        return self.transformations[0].transformation_mode
+
+    @property
     def entities(self) -> List[specs.EntitySpec]:
         return self.fco_container.get_by_ids(self.fv_spec.entity_ids)
 
     @property
     def trailing_time_window_aggregation(self) -> Optional[feature_view_pb2.TrailingTimeWindowAggregation]:
         if not self.is_temporal_aggregate:
             return None
```

### Comparing `tecton-0.9.2/tecton_core/feature_set_config.py` & `tecton-0.9.3/tecton_core/feature_set_config.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/feature_view_utils.py` & `tecton-0.9.3/tecton_core/feature_view_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/function_deserialization.py` & `tecton-0.9.3/tecton_core/function_deserialization.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/http.py` & `tecton-0.9.3/tecton_core/http.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/id_helper.py` & `tecton-0.9.3/tecton_core/id_helper.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/iterators.py` & `tecton-0.9.3/tecton_core/iterators.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/materialization_context.py` & `tecton-0.9.3/tecton_core/materialization_context.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/metadata_service_impl/error_lib.py` & `tecton-0.9.3/tecton_core/metadata_service_impl/error_lib.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/metadata_service_impl/http_client.py` & `tecton-0.9.3/tecton_core/metadata_service_impl/http_client.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/metadata_service_impl/providers.py` & `tecton-0.9.3/tecton_core/metadata_service_impl/providers.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/metadata_service_impl/response.py` & `tecton-0.9.3/tecton_core/metadata_service_impl/response.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/metadata_service_impl/service_calls.py` & `tecton-0.9.3/tecton_core/metadata_service_impl/service_calls.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/offline_store.py` & `tecton-0.9.3/tecton_core/offline_store.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/online_serving_index.py` & `tecton-0.9.3/tecton_core/online_serving_index.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/pipeline_common.py` & `tecton-0.9.3/tecton_core/pipeline_common.py`

 * *Files 7% similar despite different names*

```diff
@@ -31,17 +31,24 @@
         "pandas": pandas.DataFrame,
         "python": Dict,
         "pipeline": PipelineNode,
         "spark_sql": str,
         "snowflake_sql": str,
     }
     try:
-        import pyspark.sql
+        # The `pyspark.sql.connect.*` classes are the default for the Notebooks on Databricks Shared Access Mode
+        # Clusters of Version 14.3 or higher. That's why we need to support them.
+        from pyspark.sql import DataFrame
 
-        lookup["pyspark"] = pyspark.sql.DataFrame
+        try:
+            from pyspark.sql.connect.session import DataFrame as ConnectDataFrame
+        except ImportError:
+            ConnectDataFrame = DataFrame
+
+        lookup["pyspark"] = (DataFrame, ConnectDataFrame)
     except ImportError:
         pass
     try:
         import snowflake.snowpark
 
         lookup["snowpark"] = snowflake.snowpark.DataFrame
     except ImportError:
```

### Comparing `tecton-0.9.2/tecton_core/query/aggregation_plans.py` & `tecton-0.9.3/tecton_core/query/aggregation_plans.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/builder.py` & `tecton-0.9.3/tecton_core/query/builder.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/compaction_utils.py` & `tecton-0.9.3/tecton_core/query/compaction_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/duckdb/compute.py` & `tecton-0.9.3/tecton_core/query/duckdb/compute.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/duckdb/nodes.py` & `tecton-0.9.3/tecton_core/query/duckdb/nodes.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/duckdb/rewrite.py` & `tecton-0.9.3/tecton_core/query/duckdb/rewrite.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/errors.py` & `tecton-0.9.3/tecton_core/query/errors.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/executor_params.py` & `tecton-0.9.3/tecton_core/query/executor_params.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/executor_utils.py` & `tecton-0.9.3/tecton_core/query/executor_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/node_interface.py` & `tecton-0.9.3/tecton_core/query/node_interface.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/node_utils.py` & `tecton-0.9.3/tecton_core/query/node_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/nodes.py` & `tecton-0.9.3/tecton_core/query/nodes.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/pandas/compute.py` & `tecton-0.9.3/tecton_core/query/pandas/compute.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/pandas/node.py` & `tecton-0.9.3/tecton_core/query/pandas/node.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/pandas/nodes.py` & `tecton-0.9.3/tecton_core/query/pandas/nodes.py`

 * *Files 1% similar despite different names*

```diff
@@ -355,29 +355,27 @@
             if datatype in PRIMITIVE_TECTON_DATA_TYPE_TO_PANDAS_DATA_TYPE:
                 datatypes[mapped_name] = PRIMITIVE_TECTON_DATA_TYPE_TO_PANDAS_DATA_TYPE[datatype]
         odfv_result_df = odfv_result_df.rename(columns=rename_map)[[*rename_map.values()]].astype(datatypes)
         data_df = input_df.merge(odfv_result_df, left_index=True, right_index=True)
         return data_df
 
     def _run_odfv(self, data_df: pandas.DataFrame, odfv: FeatureDefinitionWrapper) -> pandas.DataFrame:
-        transformation_mode = odfv.transformations[0].transformation_mode
-
         odfv_pipeline = pipeline_helper.build_odfv_execution_pipeline(
             pipeline=odfv.pipeline, transformations=odfv.transformations, name=odfv.name
         )
 
         odfv_transformation_node = odfv.pipeline.root.transformation_node
         odfv_inputs = self._extract_inputs_for_odfv_from_data(
             transformation_node=odfv_transformation_node, data_df=data_df, odfv_invocation_inputs={}, odfv=odfv
         )
 
-        if transformation_mode == TransformationMode.TRANSFORMATION_MODE_PANDAS:
+        if odfv.transformation_mode == TransformationMode.TRANSFORMATION_MODE_PANDAS:
             odfv_result_df = odfv_pipeline.execute_with_inputs(odfv_inputs)
             return odfv_result_df
-        elif transformation_mode == TransformationMode.TRANSFORMATION_MODE_PYTHON:
+        elif odfv.transformation_mode == TransformationMode.TRANSFORMATION_MODE_PYTHON:
             # The inputs are currently a mapping of input_name to pandas DF
             # We need turn the ODFV inputs from a pandas DF to a list of dictionaries
             # Then we need to iterate through all rows of the input data set, pass the input dicts into the ODFV
             # And finally convert the resulting list of dicts into a pandas DF
             for input_name in odfv_inputs.keys():
                 # Map pandas DFs to List of dicts (one dict per row)
                 odfv_inputs[input_name] = odfv_inputs[input_name].to_dict("records")
@@ -390,15 +388,15 @@
                 for input_name in odfv_inputs.keys():
                     row_odfv_inputs[input_name] = odfv_inputs[input_name][row_index]
 
                 odfv_result_dict = odfv_pipeline.execute_with_inputs(row_odfv_inputs)
                 odfv_result_list.append(odfv_result_dict)
             return pandas.DataFrame.from_dict(odfv_result_list)
         else:
-            msg = f"ODFV {odfv.name} has an unexpected transformation mode: {transformation_mode}"
+            msg = f"ODFV {odfv.name} has an unexpected transformation mode: {odfv.transformation_mode}"
             raise TectonValidationError(msg)
 
     def _extract_inputs_for_odfv_from_data(
         self,
         transformation_node: TransformationNode,
         data_df: pandas.DataFrame,
         odfv_invocation_inputs: Dict[str, pandas.DataFrame],
```

### Comparing `tecton-0.9.2/tecton_core/query/pandas/pipeline_helper.py` & `tecton-0.9.3/tecton_core/query/pandas/pipeline_helper.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/pandas/rewrite.py` & `tecton-0.9.3/tecton_core/query/pandas/rewrite.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/pandas/translate.py` & `tecton-0.9.3/tecton_core/query/pandas/translate.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/pipeline_sql_builder.py` & `tecton-0.9.3/tecton_core/query/pipeline_sql_builder.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/prefixed_uri_resolver.py` & `tecton-0.9.3/tecton_core/query/prefixed_uri_resolver.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/query_tree_compute.py` & `tecton-0.9.3/tecton_core/query/query_tree_compute.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/query_tree_executor.py` & `tecton-0.9.3/tecton_core/query/query_tree_executor.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/snowflake/compute.py` & `tecton-0.9.3/tecton_core/query/snowflake/compute.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query/sql_compat.py` & `tecton-0.9.3/tecton_core/query/sql_compat.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/query_consts.py` & `tecton-0.9.3/tecton_core/query_consts.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/repo_file_handler.py` & `tecton-0.9.3/tecton_core/repo_file_handler.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/request_context.py` & `tecton-0.9.3/tecton_core/request_context.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/schema.py` & `tecton-0.9.3/tecton_core/schema.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/schema_derivation_utils.py` & `tecton-0.9.3/tecton_core/schema_derivation_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/schema_validation.py` & `tecton-0.9.3/tecton_core/schema_validation.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/secrets.py` & `tecton-0.9.3/tecton_core/secrets.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/snowflake_context.py` & `tecton-0.9.3/tecton_core/snowflake_context.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/specs/__init__.py` & `tecton-0.9.3/tecton_core/specs/__init__.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/specs/data_source_spec.py` & `tecton-0.9.3/tecton_core/specs/data_source_spec.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/specs/entity_spec.py` & `tecton-0.9.3/tecton_core/specs/entity_spec.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/specs/feature_service_spec.py` & `tecton-0.9.3/tecton_core/specs/feature_service_spec.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/specs/feature_view_spec.py` & `tecton-0.9.3/tecton_core/specs/feature_view_spec.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/specs/tecton_object_spec.py` & `tecton-0.9.3/tecton_core/specs/tecton_object_spec.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/specs/time_window_spec.py` & `tecton-0.9.3/tecton_core/specs/time_window_spec.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/specs/transformation_spec.py` & `tecton-0.9.3/tecton_core/specs/transformation_spec.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/specs/utils.py` & `tecton-0.9.3/tecton_core/specs/utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/time_utils.py` & `tecton-0.9.3/tecton_core/time_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/vendor/queue.py` & `tecton-0.9.3/tecton_core/vendor/queue.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/vendor/treelib/__init__.py` & `tecton-0.9.3/tecton_core/vendor/treelib/__init__.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/vendor/treelib/exceptions.py` & `tecton-0.9.3/tecton_core/vendor/treelib/exceptions.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/vendor/treelib/misc.py` & `tecton-0.9.3/tecton_core/vendor/treelib/misc.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/vendor/treelib/node.py` & `tecton-0.9.3/tecton_core/vendor/treelib/node.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/vendor/treelib/plugins.py` & `tecton-0.9.3/tecton_core/vendor/treelib/plugins.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/vendor/treelib/tree.py` & `tecton-0.9.3/tecton_core/vendor/treelib/tree.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_core/vendor/vendor_treelib.py` & `tecton-0.9.3/tecton_core/vendor/vendor_treelib.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/__init__.py` & `tecton-0.9.3/tecton_materialization/__init__.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/batch_materialization.py` & `tecton-0.9.3/tecton_materialization/batch_materialization.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/common/job_metadata.py` & `tecton-0.9.3/tecton_materialization/common/job_metadata.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/common/job_metadata_aws.py` & `tecton-0.9.3/tecton_materialization/common/job_metadata_aws.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/common/job_metadata_gcp.py` & `tecton-0.9.3/tecton_materialization/common/job_metadata_gcp.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/common/task_params.py` & `tecton-0.9.3/tecton_materialization/common/task_params.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/consumption.py` & `tecton-0.9.3/tecton_materialization/consumption.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/delta_maintenance.py` & `tecton-0.9.3/tecton_materialization/delta_maintenance.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/entity_deletion.py` & `tecton-0.9.3/tecton_materialization/entity_deletion.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/feature_export.py` & `tecton-0.9.3/tecton_materialization/feature_export.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/ingest_materialization.py` & `tecton-0.9.3/tecton_materialization/ingest_materialization.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/job_metadata.py` & `tecton-0.9.3/tecton_materialization/job_metadata.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/materialization.py` & `tecton-0.9.3/tecton_materialization/materialization.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/materialization_utils.py` & `tecton-0.9.3/tecton_materialization/materialization_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/ray/batch_materialization.py` & `tecton-0.9.3/tecton_materialization/ray/batch_materialization.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/ray/delta.py` & `tecton-0.9.3/tecton_materialization/ray/delta.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/ray/feature_export.py` & `tecton-0.9.3/tecton_materialization/ray/feature_export.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/ray/ingest_materialization.py` & `tecton-0.9.3/tecton_materialization/ray/ingest_materialization.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/ray/job_status.py` & `tecton-0.9.3/tecton_materialization/ray/job_status.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/ray/materialization.py` & `tecton-0.9.3/tecton_materialization/ray/materialization.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/ray/materialization_utils.py` & `tecton-0.9.3/tecton_materialization/ray/materialization_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/ray/nodes.py` & `tecton-0.9.3/tecton_materialization/ray/nodes.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/remote_host/pyspark_remote_host.py` & `tecton-0.9.3/tecton_materialization/remote_host/pyspark_remote_host.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/secrets.py` & `tecton-0.9.3/tecton_materialization/secrets.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_materialization/stream_materialization.py` & `tecton-0.9.3/tecton_materialization/stream_materialization.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/amplitude/amplitude_pb2.py` & `tecton-0.9.3/tecton_proto/amplitude/amplitude_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/amplitude/client_logging_pb2.py` & `tecton-0.9.3/tecton_proto/amplitude/client_logging_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/api/featureservice/feature_service_pb2.py` & `tecton-0.9.3/tecton_proto/api/featureservice/feature_service_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/api/featureservice/feature_service_request_pb2.py` & `tecton-0.9.3/tecton_proto/api/featureservice/feature_service_request_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/args/basic_info_pb2.py` & `tecton-0.9.3/tecton_proto/args/basic_info_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/args/data_source_config_pb2.py` & `tecton-0.9.3/tecton_proto/args/data_source_config_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/args/data_source_pb2.py` & `tecton-0.9.3/tecton_proto/args/data_source_pb2.py`

 * *Files 1% similar despite different names*

```diff
@@ -18,15 +18,15 @@
 from tecton_proto.args import user_defined_function_pb2 as tecton__proto_dot_args_dot_user__defined__function__pb2
 from tecton_proto.args import version_constraints_pb2 as tecton__proto_dot_args_dot_version__constraints__pb2
 from tecton_proto.common import schema_pb2 as tecton__proto_dot_common_dot_schema__pb2
 from tecton_proto.common import secret_pb2 as tecton__proto_dot_common_dot_secret__pb2
 from tecton_proto.common import spark_schema_pb2 as tecton__proto_dot_common_dot_spark__schema__pb2
 
 
-DESCRIPTOR = _descriptor_pool.Default().AddSerializedFile(b'\n#tecton_proto/args/data_source.proto\x12\x11tecton_proto.args\x1a\x1egoogle/protobuf/duration.proto\x1a*tecton_proto/args/data_source_config.proto\x1a$tecton_proto/args/diff_options.proto\x1a&tecton_proto/args/transformation.proto\x1a-tecton_proto/args/user_defined_function.proto\x1a+tecton_proto/args/version_constraints.proto\x1a tecton_proto/common/schema.proto\x1a tecton_proto/common/secret.proto\x1a&tecton_proto/common/spark_schema.proto\"\xa0\x01\n\x1b\x44\x61tetimePartitionColumnArgs\x12\x1f\n\x0b\x63olumn_name\x18\x01 \x01(\tR\ncolumnName\x12\x1a\n\x08\x64\x61tepart\x18\x02 \x01(\tR\x08\x64\x61tepart\x12\x1f\n\x0bzero_padded\x18\x03 \x01(\x08R\nzeroPadded\x12#\n\rformat_string\x18\x04 \x01(\tR\x0c\x66ormatString\"\xcd\x01\n\x19\x42\x61tchDataSourceCommonArgs\x12\'\n\x0ftimestamp_field\x18\x01 \x01(\tR\x0etimestampField\x12M\n\x0epost_processor\x18\x02 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionR\rpostProcessor\x12\x38\n\ndata_delay\x18\x03 \x01(\x0b\x32\x19.google.protobuf.DurationR\tdataDelay\"\xae\x02\n\x1aStreamDataSourceCommonArgs\x12\'\n\x0ftimestamp_field\x18\x01 \x01(\tR\x0etimestampField\x12\\\n\x19watermark_delay_threshold\x18\x02 \x01(\x0b\x32\x19.google.protobuf.DurationB\x05\x92M\x02\x08\x08R\x17watermarkDelayThreshold\x12T\n\x0epost_processor\x18\x03 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionB\x05\x92M\x02\x08\x08R\rpostProcessor\x12\x33\n\x15\x64\x65\x64uplication_columns\x18\x04 \x03(\tR\x14\x64\x65\x64uplicationColumns\"\x98\x04\n\x12HiveDataSourceArgs\x12\x14\n\x05table\x18\x01 \x01(\tR\x05table\x12\x1a\n\x08\x64\x61tabase\x18\x02 \x01(\tR\x08\x64\x61tabase\x12\x39\n\x15\x64\x61te_partition_column\x18\x03 \x01(\tB\x05\x82}\x02\x10\x03R\x13\x64\x61tePartitionColumn\x12\x39\n\x15timestamp_column_name\x18\x04 \x01(\tB\x05\x82}\x02\x10\x03R\x13timestampColumnName\x12)\n\x10timestamp_format\x18\x05 \x01(\tR\x0ftimestampFormat\x12l\n\x1a\x64\x61tetime_partition_columns\x18\x07 \x03(\x0b\x32..tecton_proto.args.DatetimePartitionColumnArgsR\x18\x64\x61tetimePartitionColumns\x12_\n\x14raw_batch_translator\x18\t \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionB\x05\x82}\x02\x10\x03R\x12rawBatchTranslator\x12T\n\x0b\x63ommon_args\x18\n \x01(\x0b\x32,.tecton_proto.args.BatchDataSourceCommonArgsB\x05\x82}\x02\x08\x05R\ncommonArgsJ\x04\x08\x06\x10\x07J\x04\x08\x08\x10\t\"\x98\x03\n\x13UnityDataSourceArgs\x12\x18\n\x07\x63\x61talog\x18\x01 \x01(\tR\x07\x63\x61talog\x12\x16\n\x06schema\x18\x02 \x01(\tR\x06schema\x12\x14\n\x05table\x18\x03 \x01(\tR\x05table\x12M\n\x0b\x63ommon_args\x18\x04 \x01(\x0b\x32,.tecton_proto.args.BatchDataSourceCommonArgsR\ncommonArgs\x12)\n\x10timestamp_format\x18\x05 \x01(\tR\x0ftimestampFormat\x12l\n\x1a\x64\x61tetime_partition_columns\x18\x06 \x03(\x0b\x32..tecton_proto.args.DatetimePartitionColumnArgsR\x18\x64\x61tetimePartitionColumns\x12Q\n\x0b\x61\x63\x63\x65ss_mode\x18\x07 \x01(\x0e\x32).tecton_proto.args.UnityCatalogAccessModeB\x05\x92M\x02 \x0eR\naccessMode\"\x95\x04\n\x12\x46ileDataSourceArgs\x12\x10\n\x03uri\x18\x01 \x01(\tR\x03uri\x12\x1f\n\x0b\x66ile_format\x18\x02 \x01(\tR\nfileFormat\x12\x33\n\x16\x63onvert_to_glue_format\x18\x03 \x01(\x08R\x13\x63onvertToGlueFormat\x12_\n\x14raw_batch_translator\x18\x04 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionB\x05\x82}\x02\x10\x03R\x12rawBatchTranslator\x12$\n\nschema_uri\x18\x05 \x01(\tB\x05\x92M\x02\x08\x01R\tschemaUri\x12\x39\n\x15timestamp_column_name\x18\x06 \x01(\tB\x05\x82}\x02\x10\x03R\x13timestampColumnName\x12)\n\x10timestamp_format\x18\x07 \x01(\tR\x0ftimestampFormat\x12I\n\x0fschema_override\x18\t \x01(\x0b\x32 .tecton_proto.common.SparkSchemaR\x0eschemaOverride\x12Y\n\x0b\x63ommon_args\x18\n \x01(\x0b\x32,.tecton_proto.args.BatchDataSourceCommonArgsB\n\x82}\x02\x08\x05\x92M\x02\x10\x01R\ncommonArgsJ\x04\x08\x08\x10\t\"7\n\x06Option\x12\x10\n\x03key\x18\x01 \x01(\tR\x03key\x12\x1b\n\x05value\x18\x02 \x01(\tB\x05\x92M\x02 \x02R\x05value\"\x94\x06\n\x15KinesisDataSourceArgs\x12\x1f\n\x0bstream_name\x18\x01 \x01(\tR\nstreamName\x12\x16\n\x06region\x18\x02 \x01(\tR\x06region\x12\x66\n\x15raw_stream_translator\x18\x03 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionB\n\x82}\x02\x10\x03\x92M\x02\x08\x08R\x13rawStreamTranslator\x12*\n\rtimestamp_key\x18\x04 \x01(\tB\x05\x82}\x02\x10\x03R\x0ctimestampKey\x12{\n\x1f\x64\x65\x66\x61ult_initial_stream_position\x18\x05 \x01(\x0e\x32(.tecton_proto.args.InitialStreamPositionB\n\x82}\x02\x10\x03\x92M\x02\x08\x08R\x1c\x64\x65\x66\x61ultInitialStreamPosition\x12l\n\x17initial_stream_position\x18\x0b \x01(\x0e\x32(.tecton_proto.args.InitialStreamPositionB\n\x82}\x02\x08\x05\x92M\x02\x08\x08R\x15initialStreamPosition\x12p\n!default_watermark_delay_threshold\x18\x06 \x01(\x0b\x32\x19.google.protobuf.DurationB\n\x82}\x02\x10\x03\x92M\x02\x08\x08R\x1e\x64\x65\x66\x61ultWatermarkDelayThreshold\x12:\n\x15\x64\x65\x64uplication_columns\x18\x07 \x03(\tB\x05\x82}\x02\x10\x03R\x14\x64\x65\x64uplicationColumns\x12\x33\n\x07options\x18\x08 \x03(\x0b\x32\x19.tecton_proto.args.OptionR\x07options\x12Z\n\x0b\x63ommon_args\x18\n \x01(\x0b\x32-.tecton_proto.args.StreamDataSourceCommonArgsB\n\x82}\x02\x08\x05\x92M\x02\x10\x01R\ncommonArgsJ\x04\x08\t\x10\n\"\xc8\x06\n\x13KafkaDataSourceArgs\x12\x36\n\x17kafka_bootstrap_servers\x18\x01 \x01(\tR\x15kafkaBootstrapServers\x12\x16\n\x06topics\x18\x02 \x01(\tR\x06topics\x12\x66\n\x15raw_stream_translator\x18\x03 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionB\n\x82}\x02\x10\x03\x92M\x02\x08\x08R\x13rawStreamTranslator\x12*\n\rtimestamp_key\x18\x04 \x01(\tB\x05\x82}\x02\x10\x03R\x0ctimestampKey\x12p\n!default_watermark_delay_threshold\x18\x05 \x01(\x0b\x32\x19.google.protobuf.DurationB\n\x82}\x02\x10\x03\x92M\x02\x08\x08R\x1e\x64\x65\x66\x61ultWatermarkDelayThreshold\x12\x33\n\x07options\x18\x06 \x03(\x0b\x32\x19.tecton_proto.args.OptionR\x07options\x12\x39\n\x15ssl_keystore_location\x18\x07 \x01(\tB\x05\x92M\x02\x08\x01R\x13sslKeystoreLocation\x12K\n\x1fssl_keystore_password_secret_id\x18\x08 \x01(\tB\x05\x92M\x02\x08\x01R\x1bsslKeystorePasswordSecretId\x12=\n\x17ssl_truststore_location\x18\t \x01(\tB\x05\x92M\x02\x08\x01R\x15sslTruststoreLocation\x12O\n!ssl_truststore_password_secret_id\x18\n \x01(\tB\x05\x92M\x02\x08\x01R\x1dsslTruststorePasswordSecretId\x12\x32\n\x11security_protocol\x18\x0b \x01(\tB\x05\x92M\x02\x08\x01R\x10securityProtocol\x12Z\n\x0b\x63ommon_args\x18\x0c \x01(\x0b\x32-.tecton_proto.args.StreamDataSourceCommonArgsB\n\x82}\x02\x08\x05\x92M\x02\x10\x01R\ncommonArgs\"\xac\x02\n\x0ePushSourceArgs\x12\x1f\n\x0blog_offline\x18\x01 \x01(\x08R\nlogOffline\x12T\n\x0epost_processor\x18\x02 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionB\x05\x92M\x02\x08\x06R\rpostProcessor\x12\x45\n\x0cinput_schema\x18\x03 \x01(\x0b\x32\x1b.tecton_proto.common.SchemaB\x05\x92M\x02\x08\x06R\x0binputSchema\x12\\\n\x13post_processor_mode\x18\x04 \x01(\x0e\x32%.tecton_proto.args.TransformationModeB\x05\x92M\x02\x08\x06R\x11postProcessorMode\"\xe3\x02\n\x16RedshiftDataSourceArgs\x12\x1a\n\x08\x65ndpoint\x18\x01 \x01(\tR\x08\x65ndpoint\x12\x16\n\x05table\x18\x02 \x01(\tH\x00R\x05table\x12\x1d\n\x05query\x18\x05 \x01(\tB\x05\x92M\x02\x18\x03H\x00R\x05query\x12_\n\x14raw_batch_translator\x18\x03 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionB\x05\x82}\x02\x10\x03R\x12rawBatchTranslator\x12*\n\rtimestamp_key\x18\x06 \x01(\tB\x05\x82}\x02\x10\x03R\x0ctimestampKey\x12Y\n\x0b\x63ommon_args\x18\x07 \x01(\x0b\x32,.tecton_proto.args.BatchDataSourceCommonArgsB\n\x82}\x02\x08\x05\x92M\x02\x10\x01R\ncommonArgsB\x08\n\x06sourceJ\x04\x08\x04\x10\x05\"\xd2\x04\n\x17SnowflakeDataSourceArgs\x12\x10\n\x03url\x18\x01 \x01(\tR\x03url\x12\x19\n\x04role\x18\x02 \x01(\tB\x05\x92M\x02\x08\x01R\x04role\x12\x1a\n\x08\x64\x61tabase\x18\x03 \x01(\tR\x08\x64\x61tabase\x12\x16\n\x06schema\x18\x04 \x01(\tR\x06schema\x12#\n\twarehouse\x18\x05 \x01(\tB\x05\x92M\x02\x08\x01R\twarehouse\x12\x16\n\x05table\x18\x06 \x01(\tH\x00R\x05table\x12\x1d\n\x05query\x18\x07 \x01(\tB\x05\x92M\x02\x18\x03H\x00R\x05query\x12_\n\x14raw_batch_translator\x18\x08 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionB\x05\x82}\x02\x10\x03R\x12rawBatchTranslator\x12*\n\rtimestamp_key\x18\t \x01(\tB\x05\x82}\x02\x10\x03R\x0ctimestampKey\x12Y\n\x0b\x63ommon_args\x18\x0c \x01(\x0b\x32,.tecton_proto.args.BatchDataSourceCommonArgsB\n\x82}\x02\x08\x05\x92M\x02\x10\x01R\ncommonArgs\x12?\n\x04user\x18\r \x01(\x0b\x32$.tecton_proto.common.SecretReferenceB\x05\x92M\x02\x08\x01R\x04user\x12G\n\x08password\x18\x0e \x01(\x0b\x32$.tecton_proto.common.SecretReferenceB\x05\x92M\x02\x08\x01R\x08passwordB\x08\n\x06source\"\xe2\x01\n\x14SparkBatchConfigArgs\x12X\n\x14\x64\x61ta_source_function\x18\x01 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionR\x12\x64\x61taSourceFunction\x12\x38\n\ndata_delay\x18\x02 \x01(\x0b\x32\x19.google.protobuf.DurationR\tdataDelay\x12\x36\n\x17supports_time_filtering\x18\x03 \x01(\x08R\x15supportsTimeFiltering\"q\n\x15SparkStreamConfigArgs\x12X\n\x14\x64\x61ta_source_function\x18\x01 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionR\x12\x64\x61taSourceFunction\"\xa9\x03\n\x15PandasBatchConfigArgs\x12X\n\x14\x64\x61ta_source_function\x18\x01 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionR\x12\x64\x61taSourceFunction\x12\x38\n\ndata_delay\x18\x02 \x01(\x0b\x32\x19.google.protobuf.DurationR\tdataDelay\x12\x36\n\x17supports_time_filtering\x18\x03 \x01(\x08R\x15supportsTimeFiltering\x12V\n\x07secrets\x18\x06 \x03(\x0b\x32\x35.tecton_proto.args.PandasBatchConfigArgs.SecretsEntryB\x05\x92M\x02\x08\x01R\x07secrets\x1a`\n\x0cSecretsEntry\x12\x10\n\x03key\x18\x01 \x01(\tR\x03key\x12:\n\x05value\x18\x02 \x01(\x0b\x32$.tecton_proto.common.SecretReferenceR\x05value:\x02\x38\x01J\x04\x08\x04\x10\x05J\x04\x08\x05\x10\x06*\x94\x01\n\x16UnityCatalogAccessMode\x12)\n%UNITY_CATALOG_ACCESS_MODE_UNSPECIFIED\x10\x00\x12)\n%UNITY_CATALOG_ACCESS_MODE_SINGLE_USER\x10\x01\x12$\n UNITY_CATALOG_ACCESS_MODE_SHARED\x10\x02\x42\x13\n\x0f\x63om.tecton.argsP\x01')
+DESCRIPTOR = _descriptor_pool.Default().AddSerializedFile(b'\n#tecton_proto/args/data_source.proto\x12\x11tecton_proto.args\x1a\x1egoogle/protobuf/duration.proto\x1a*tecton_proto/args/data_source_config.proto\x1a$tecton_proto/args/diff_options.proto\x1a&tecton_proto/args/transformation.proto\x1a-tecton_proto/args/user_defined_function.proto\x1a+tecton_proto/args/version_constraints.proto\x1a tecton_proto/common/schema.proto\x1a tecton_proto/common/secret.proto\x1a&tecton_proto/common/spark_schema.proto\"\xa0\x01\n\x1b\x44\x61tetimePartitionColumnArgs\x12\x1f\n\x0b\x63olumn_name\x18\x01 \x01(\tR\ncolumnName\x12\x1a\n\x08\x64\x61tepart\x18\x02 \x01(\tR\x08\x64\x61tepart\x12\x1f\n\x0bzero_padded\x18\x03 \x01(\x08R\nzeroPadded\x12#\n\rformat_string\x18\x04 \x01(\tR\x0c\x66ormatString\"\xcd\x01\n\x19\x42\x61tchDataSourceCommonArgs\x12\'\n\x0ftimestamp_field\x18\x01 \x01(\tR\x0etimestampField\x12M\n\x0epost_processor\x18\x02 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionR\rpostProcessor\x12\x38\n\ndata_delay\x18\x03 \x01(\x0b\x32\x19.google.protobuf.DurationR\tdataDelay\"\xae\x02\n\x1aStreamDataSourceCommonArgs\x12\'\n\x0ftimestamp_field\x18\x01 \x01(\tR\x0etimestampField\x12\\\n\x19watermark_delay_threshold\x18\x02 \x01(\x0b\x32\x19.google.protobuf.DurationB\x05\x92M\x02\x08\x08R\x17watermarkDelayThreshold\x12T\n\x0epost_processor\x18\x03 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionB\x05\x92M\x02\x08\x08R\rpostProcessor\x12\x33\n\x15\x64\x65\x64uplication_columns\x18\x04 \x03(\tR\x14\x64\x65\x64uplicationColumns\"\x98\x04\n\x12HiveDataSourceArgs\x12\x14\n\x05table\x18\x01 \x01(\tR\x05table\x12\x1a\n\x08\x64\x61tabase\x18\x02 \x01(\tR\x08\x64\x61tabase\x12\x39\n\x15\x64\x61te_partition_column\x18\x03 \x01(\tB\x05\x82}\x02\x10\x03R\x13\x64\x61tePartitionColumn\x12\x39\n\x15timestamp_column_name\x18\x04 \x01(\tB\x05\x82}\x02\x10\x03R\x13timestampColumnName\x12)\n\x10timestamp_format\x18\x05 \x01(\tR\x0ftimestampFormat\x12l\n\x1a\x64\x61tetime_partition_columns\x18\x07 \x03(\x0b\x32..tecton_proto.args.DatetimePartitionColumnArgsR\x18\x64\x61tetimePartitionColumns\x12_\n\x14raw_batch_translator\x18\t \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionB\x05\x82}\x02\x10\x03R\x12rawBatchTranslator\x12T\n\x0b\x63ommon_args\x18\n \x01(\x0b\x32,.tecton_proto.args.BatchDataSourceCommonArgsB\x05\x82}\x02\x08\x05R\ncommonArgsJ\x04\x08\x06\x10\x07J\x04\x08\x08\x10\t\"\x98\x03\n\x13UnityDataSourceArgs\x12\x18\n\x07\x63\x61talog\x18\x01 \x01(\tR\x07\x63\x61talog\x12\x16\n\x06schema\x18\x02 \x01(\tR\x06schema\x12\x14\n\x05table\x18\x03 \x01(\tR\x05table\x12M\n\x0b\x63ommon_args\x18\x04 \x01(\x0b\x32,.tecton_proto.args.BatchDataSourceCommonArgsR\ncommonArgs\x12)\n\x10timestamp_format\x18\x05 \x01(\tR\x0ftimestampFormat\x12l\n\x1a\x64\x61tetime_partition_columns\x18\x06 \x03(\x0b\x32..tecton_proto.args.DatetimePartitionColumnArgsR\x18\x64\x61tetimePartitionColumns\x12Q\n\x0b\x61\x63\x63\x65ss_mode\x18\x07 \x01(\x0e\x32).tecton_proto.args.UnityCatalogAccessModeB\x05\x92M\x02 \x0eR\naccessMode\"\x95\x04\n\x12\x46ileDataSourceArgs\x12\x10\n\x03uri\x18\x01 \x01(\tR\x03uri\x12\x1f\n\x0b\x66ile_format\x18\x02 \x01(\tR\nfileFormat\x12\x33\n\x16\x63onvert_to_glue_format\x18\x03 \x01(\x08R\x13\x63onvertToGlueFormat\x12_\n\x14raw_batch_translator\x18\x04 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionB\x05\x82}\x02\x10\x03R\x12rawBatchTranslator\x12$\n\nschema_uri\x18\x05 \x01(\tB\x05\x92M\x02\x08\x01R\tschemaUri\x12\x39\n\x15timestamp_column_name\x18\x06 \x01(\tB\x05\x82}\x02\x10\x03R\x13timestampColumnName\x12)\n\x10timestamp_format\x18\x07 \x01(\tR\x0ftimestampFormat\x12I\n\x0fschema_override\x18\t \x01(\x0b\x32 .tecton_proto.common.SparkSchemaR\x0eschemaOverride\x12Y\n\x0b\x63ommon_args\x18\n \x01(\x0b\x32,.tecton_proto.args.BatchDataSourceCommonArgsB\n\x82}\x02\x08\x05\x92M\x02\x10\x01R\ncommonArgsJ\x04\x08\x08\x10\t\"7\n\x06Option\x12\x10\n\x03key\x18\x01 \x01(\tR\x03key\x12\x1b\n\x05value\x18\x02 \x01(\tB\x05\x92M\x02 \x02R\x05value\"\x94\x06\n\x15KinesisDataSourceArgs\x12\x1f\n\x0bstream_name\x18\x01 \x01(\tR\nstreamName\x12\x16\n\x06region\x18\x02 \x01(\tR\x06region\x12\x66\n\x15raw_stream_translator\x18\x03 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionB\n\x82}\x02\x10\x03\x92M\x02\x08\x08R\x13rawStreamTranslator\x12*\n\rtimestamp_key\x18\x04 \x01(\tB\x05\x82}\x02\x10\x03R\x0ctimestampKey\x12{\n\x1f\x64\x65\x66\x61ult_initial_stream_position\x18\x05 \x01(\x0e\x32(.tecton_proto.args.InitialStreamPositionB\n\x82}\x02\x10\x03\x92M\x02\x08\x08R\x1c\x64\x65\x66\x61ultInitialStreamPosition\x12l\n\x17initial_stream_position\x18\x0b \x01(\x0e\x32(.tecton_proto.args.InitialStreamPositionB\n\x82}\x02\x08\x05\x92M\x02\x08\x08R\x15initialStreamPosition\x12p\n!default_watermark_delay_threshold\x18\x06 \x01(\x0b\x32\x19.google.protobuf.DurationB\n\x82}\x02\x10\x03\x92M\x02\x08\x08R\x1e\x64\x65\x66\x61ultWatermarkDelayThreshold\x12:\n\x15\x64\x65\x64uplication_columns\x18\x07 \x03(\tB\x05\x82}\x02\x10\x03R\x14\x64\x65\x64uplicationColumns\x12\x33\n\x07options\x18\x08 \x03(\x0b\x32\x19.tecton_proto.args.OptionR\x07options\x12Z\n\x0b\x63ommon_args\x18\n \x01(\x0b\x32-.tecton_proto.args.StreamDataSourceCommonArgsB\n\x82}\x02\x08\x05\x92M\x02\x10\x01R\ncommonArgsJ\x04\x08\t\x10\n\"\xc8\x06\n\x13KafkaDataSourceArgs\x12\x36\n\x17kafka_bootstrap_servers\x18\x01 \x01(\tR\x15kafkaBootstrapServers\x12\x16\n\x06topics\x18\x02 \x01(\tR\x06topics\x12\x66\n\x15raw_stream_translator\x18\x03 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionB\n\x82}\x02\x10\x03\x92M\x02\x08\x08R\x13rawStreamTranslator\x12*\n\rtimestamp_key\x18\x04 \x01(\tB\x05\x82}\x02\x10\x03R\x0ctimestampKey\x12p\n!default_watermark_delay_threshold\x18\x05 \x01(\x0b\x32\x19.google.protobuf.DurationB\n\x82}\x02\x10\x03\x92M\x02\x08\x08R\x1e\x64\x65\x66\x61ultWatermarkDelayThreshold\x12\x33\n\x07options\x18\x06 \x03(\x0b\x32\x19.tecton_proto.args.OptionR\x07options\x12\x39\n\x15ssl_keystore_location\x18\x07 \x01(\tB\x05\x92M\x02\x08\x01R\x13sslKeystoreLocation\x12K\n\x1fssl_keystore_password_secret_id\x18\x08 \x01(\tB\x05\x92M\x02\x08\x01R\x1bsslKeystorePasswordSecretId\x12=\n\x17ssl_truststore_location\x18\t \x01(\tB\x05\x92M\x02\x08\x01R\x15sslTruststoreLocation\x12O\n!ssl_truststore_password_secret_id\x18\n \x01(\tB\x05\x92M\x02\x08\x01R\x1dsslTruststorePasswordSecretId\x12\x32\n\x11security_protocol\x18\x0b \x01(\tB\x05\x92M\x02\x08\x01R\x10securityProtocol\x12Z\n\x0b\x63ommon_args\x18\x0c \x01(\x0b\x32-.tecton_proto.args.StreamDataSourceCommonArgsB\n\x82}\x02\x08\x05\x92M\x02\x10\x01R\ncommonArgs\"\xac\x02\n\x0ePushSourceArgs\x12\x1f\n\x0blog_offline\x18\x01 \x01(\x08R\nlogOffline\x12T\n\x0epost_processor\x18\x02 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionB\x05\x92M\x02\x08\x06R\rpostProcessor\x12\x45\n\x0cinput_schema\x18\x03 \x01(\x0b\x32\x1b.tecton_proto.common.SchemaB\x05\x92M\x02\x08\x06R\x0binputSchema\x12\\\n\x13post_processor_mode\x18\x04 \x01(\x0e\x32%.tecton_proto.args.TransformationModeB\x05\x92M\x02\x08\x06R\x11postProcessorMode\"\xe3\x02\n\x16RedshiftDataSourceArgs\x12\x1a\n\x08\x65ndpoint\x18\x01 \x01(\tR\x08\x65ndpoint\x12\x16\n\x05table\x18\x02 \x01(\tH\x00R\x05table\x12\x1d\n\x05query\x18\x05 \x01(\tB\x05\x92M\x02\x18\x03H\x00R\x05query\x12_\n\x14raw_batch_translator\x18\x03 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionB\x05\x82}\x02\x10\x03R\x12rawBatchTranslator\x12*\n\rtimestamp_key\x18\x06 \x01(\tB\x05\x82}\x02\x10\x03R\x0ctimestampKey\x12Y\n\x0b\x63ommon_args\x18\x07 \x01(\x0b\x32,.tecton_proto.args.BatchDataSourceCommonArgsB\n\x82}\x02\x08\x05\x92M\x02\x10\x01R\ncommonArgsB\x08\n\x06sourceJ\x04\x08\x04\x10\x05\"\xd2\x04\n\x17SnowflakeDataSourceArgs\x12\x10\n\x03url\x18\x01 \x01(\tR\x03url\x12\x19\n\x04role\x18\x02 \x01(\tB\x05\x92M\x02\x08\x01R\x04role\x12\x1a\n\x08\x64\x61tabase\x18\x03 \x01(\tR\x08\x64\x61tabase\x12\x16\n\x06schema\x18\x04 \x01(\tR\x06schema\x12#\n\twarehouse\x18\x05 \x01(\tB\x05\x92M\x02\x08\x01R\twarehouse\x12\x16\n\x05table\x18\x06 \x01(\tH\x00R\x05table\x12\x1d\n\x05query\x18\x07 \x01(\tB\x05\x92M\x02\x18\x03H\x00R\x05query\x12_\n\x14raw_batch_translator\x18\x08 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionB\x05\x82}\x02\x10\x03R\x12rawBatchTranslator\x12*\n\rtimestamp_key\x18\t \x01(\tB\x05\x82}\x02\x10\x03R\x0ctimestampKey\x12Y\n\x0b\x63ommon_args\x18\x0c \x01(\x0b\x32,.tecton_proto.args.BatchDataSourceCommonArgsB\n\x82}\x02\x08\x05\x92M\x02\x10\x01R\ncommonArgs\x12?\n\x04user\x18\r \x01(\x0b\x32$.tecton_proto.common.SecretReferenceB\x05\x92M\x02\x08\x01R\x04user\x12G\n\x08password\x18\x0e \x01(\x0b\x32$.tecton_proto.common.SecretReferenceB\x05\x92M\x02\x08\x01R\x08passwordB\x08\n\x06source\"\xe2\x01\n\x14SparkBatchConfigArgs\x12X\n\x14\x64\x61ta_source_function\x18\x01 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionR\x12\x64\x61taSourceFunction\x12\x38\n\ndata_delay\x18\x02 \x01(\x0b\x32\x19.google.protobuf.DurationR\tdataDelay\x12\x36\n\x17supports_time_filtering\x18\x03 \x01(\x08R\x15supportsTimeFiltering\"q\n\x15SparkStreamConfigArgs\x12X\n\x14\x64\x61ta_source_function\x18\x01 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionR\x12\x64\x61taSourceFunction\"\xa9\x03\n\x15PandasBatchConfigArgs\x12X\n\x14\x64\x61ta_source_function\x18\x01 \x01(\x0b\x32&.tecton_proto.args.UserDefinedFunctionR\x12\x64\x61taSourceFunction\x12\x38\n\ndata_delay\x18\x02 \x01(\x0b\x32\x19.google.protobuf.DurationR\tdataDelay\x12\x36\n\x17supports_time_filtering\x18\x03 \x01(\x08R\x15supportsTimeFiltering\x12V\n\x07secrets\x18\x06 \x03(\x0b\x32\x35.tecton_proto.args.PandasBatchConfigArgs.SecretsEntryB\x05\x92M\x02\x08\x01R\x07secrets\x1a`\n\x0cSecretsEntry\x12\x10\n\x03key\x18\x01 \x01(\tR\x03key\x12:\n\x05value\x18\x02 \x01(\x0b\x32$.tecton_proto.common.SecretReferenceR\x05value:\x02\x38\x01J\x04\x08\x04\x10\x05J\x04\x08\x05\x10\x06*\xc9\x01\n\x16UnityCatalogAccessMode\x12)\n%UNITY_CATALOG_ACCESS_MODE_UNSPECIFIED\x10\x00\x12)\n%UNITY_CATALOG_ACCESS_MODE_SINGLE_USER\x10\x01\x12\x33\n/UNITY_CATALOG_ACCESS_MODE_SINGLE_USER_WITH_FGAC\x10\x03\x12$\n UNITY_CATALOG_ACCESS_MODE_SHARED\x10\x02\x42\x13\n\x0f\x63om.tecton.argsP\x01')
 
 _builder.BuildMessageAndEnumDescriptors(DESCRIPTOR, globals())
 _builder.BuildTopDescriptorsAndMessages(DESCRIPTOR, 'tecton_proto.args.data_source_pb2', globals())
 if _descriptor._USE_C_DESCRIPTORS == False:
 
   DESCRIPTOR._options = None
   DESCRIPTOR._serialized_options = b'\n\017com.tecton.argsP\001'
@@ -117,15 +117,15 @@
   _SNOWFLAKEDATASOURCEARGS.fields_by_name['password']._options = None
   _SNOWFLAKEDATASOURCEARGS.fields_by_name['password']._serialized_options = b'\222M\002\010\001'
   _PANDASBATCHCONFIGARGS_SECRETSENTRY._options = None
   _PANDASBATCHCONFIGARGS_SECRETSENTRY._serialized_options = b'8\001'
   _PANDASBATCHCONFIGARGS.fields_by_name['secrets']._options = None
   _PANDASBATCHCONFIGARGS.fields_by_name['secrets']._serialized_options = b'\222M\002\010\001'
   _UNITYCATALOGACCESSMODE._serialized_start=6296
-  _UNITYCATALOGACCESSMODE._serialized_end=6444
+  _UNITYCATALOGACCESSMODE._serialized_end=6497
   _DATETIMEPARTITIONCOLUMNARGS._serialized_start=413
   _DATETIMEPARTITIONCOLUMNARGS._serialized_end=573
   _BATCHDATASOURCECOMMONARGS._serialized_start=576
   _BATCHDATASOURCECOMMONARGS._serialized_end=781
   _STREAMDATASOURCECOMMONARGS._serialized_start=784
   _STREAMDATASOURCECOMMONARGS._serialized_end=1086
   _HIVEDATASOURCEARGS._serialized_start=1089
```

### Comparing `tecton-0.9.2/tecton_proto/args/diff_options_pb2.py` & `tecton-0.9.3/tecton_proto/args/diff_options_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/args/diff_test_pb2.py` & `tecton-0.9.3/tecton_proto/args/diff_test_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/args/entity_pb2.py` & `tecton-0.9.3/tecton_proto/args/entity_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/args/fco_args_pb2.py` & `tecton-0.9.3/tecton_proto/args/fco_args_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/args/feature_service_pb2.py` & `tecton-0.9.3/tecton_proto/args/feature_service_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/args/feature_view_pb2.py` & `tecton-0.9.3/tecton_proto/args/feature_view_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/args/pipeline_pb2.py` & `tecton-0.9.3/tecton_proto/args/pipeline_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/args/repo_metadata_pb2.py` & `tecton-0.9.3/tecton_proto/args/repo_metadata_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/args/transformation_pb2.py` & `tecton-0.9.3/tecton_proto/args/transformation_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/args/user_defined_function_pb2.py` & `tecton-0.9.3/tecton_proto/args/user_defined_function_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/args/version_constraints_pb2.py` & `tecton-0.9.3/tecton_proto/args/version_constraints_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/args/virtual_data_source_pb2.py` & `tecton-0.9.3/tecton_proto/args/virtual_data_source_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/auditlog/metadata_pb2.py` & `tecton-0.9.3/tecton_proto/auditlog/metadata_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/auth/acl_pb2.py` & `tecton-0.9.3/tecton_proto/auth/acl_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/auth/authorization_service_pb2.py` & `tecton-0.9.3/tecton_proto/auth/authorization_service_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/auth/principal_pb2.py` & `tecton-0.9.3/tecton_proto/auth/principal_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/auth/resource_pb2.py` & `tecton-0.9.3/tecton_proto/auth/resource_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/auth/resource_role_assignments_pb2.py` & `tecton-0.9.3/tecton_proto/auth/resource_role_assignments_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/auth/service_pb2.py` & `tecton-0.9.3/tecton_proto/auth/service_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/canary/type_pb2.py` & `tecton-0.9.3/tecton_proto/canary/type_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/canary/update_pb2.py` & `tecton-0.9.3/tecton_proto/canary/update_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/cli/repo_diff_pb2.py` & `tecton-0.9.3/tecton_proto/cli/repo_diff_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/common/aggregation_function_pb2.py` & `tecton-0.9.3/tecton_proto/common/aggregation_function_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/common/analytics_options_pb2.py` & `tecton-0.9.3/tecton_proto/common/analytics_options_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/common/aws_credentials_pb2.py` & `tecton-0.9.3/tecton_proto/common/aws_credentials_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/common/column_type_pb2.py` & `tecton-0.9.3/tecton_proto/common/column_type_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/common/compute_mode_pb2.py` & `tecton-0.9.3/tecton_proto/common/compute_mode_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/common/container_image_pb2.py` & `tecton-0.9.3/tecton_proto/common/container_image_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/common/data_source_type_pb2.py` & `tecton-0.9.3/tecton_proto/common/data_source_type_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/common/data_type_pb2.py` & `tecton-0.9.3/tecton_proto/common/data_type_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/common/fco_locator_pb2.py` & `tecton-0.9.3/tecton_proto/common/fco_locator_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/common/framework_version_pb2.py` & `tecton-0.9.3/tecton_proto/common/framework_version_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/common/id_pb2.py` & `tecton-0.9.3/tecton_proto/common/id_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/common/pair_pb2.py` & `tecton-0.9.3/tecton_proto/common/pair_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/common/schema_container_pb2.py` & `tecton-0.9.3/tecton_proto/common/schema_container_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/common/schema_pb2.py` & `tecton-0.9.3/tecton_proto/common/schema_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/common/secret_pb2.py` & `tecton-0.9.3/tecton_proto/common/secret_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/common/spark_schema_pb2.py` & `tecton-0.9.3/tecton_proto/common/spark_schema_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/common/time_window_pb2.py` & `tecton-0.9.3/tecton_proto/common/time_window_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/consumption/consumption_pb2.py` & `tecton-0.9.3/tecton_proto/consumption/consumption_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/batch_data_source_pb2.py` & `tecton-0.9.3/tecton_proto/data/batch_data_source_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/entity_pb2.py` & `tecton-0.9.3/tecton_proto/data/entity_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/fco_metadata_pb2.py` & `tecton-0.9.3/tecton_proto/data/fco_metadata_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/fco_pb2.py` & `tecton-0.9.3/tecton_proto/data/fco_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/feature_service_pb2.py` & `tecton-0.9.3/tecton_proto/data/feature_service_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/feature_store_pb2.py` & `tecton-0.9.3/tecton_proto/data/feature_store_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/feature_view_pb2.py` & `tecton-0.9.3/tecton_proto/data/feature_view_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/freshness_status_pb2.py` & `tecton-0.9.3/tecton_proto/data/freshness_status_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/fv_materialization_pb2.py` & `tecton-0.9.3/tecton_proto/data/fv_materialization_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/hive_metastore_pb2.py` & `tecton-0.9.3/tecton_proto/data/hive_metastore_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/internal_spark_cluster_status_pb2.py` & `tecton-0.9.3/tecton_proto/data/internal_spark_cluster_status_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/materialization_roles_allowlists_pb2.py` & `tecton-0.9.3/tecton_proto/data/materialization_roles_allowlists_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/materialization_status_pb2.py` & `tecton-0.9.3/tecton_proto/data/materialization_status_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/odfv_compute_pb2.py` & `tecton-0.9.3/tecton_proto/data/odfv_compute_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/onboarding_pb2.py` & `tecton-0.9.3/tecton_proto/data/onboarding_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/principal_group_pb2.py` & `tecton-0.9.3/tecton_proto/data/principal_group_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/remote_compute_environment_pb2.py` & `tecton-0.9.3/tecton_proto/data/remote_compute_environment_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/remote_spark_pb2.py` & `tecton-0.9.3/tecton_proto/data/remote_spark_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/saved_feature_data_frame_pb2.py` & `tecton-0.9.3/tecton_proto/data/saved_feature_data_frame_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/serving_status_pb2.py` & `tecton-0.9.3/tecton_proto/data/serving_status_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/state_update_pb2.py` & `tecton-0.9.3/tecton_proto/data/state_update_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/stream_data_source_pb2.py` & `tecton-0.9.3/tecton_proto/data/stream_data_source_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/summary_pb2.py` & `tecton-0.9.3/tecton_proto/data/summary_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/tecton_api_key_pb2.py` & `tecton-0.9.3/tecton_proto/data/tecton_api_key_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/transformation_pb2.py` & `tecton-0.9.3/tecton_proto/data/transformation_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/user_deployment_settings_pb2.py` & `tecton-0.9.3/tecton_proto/data/user_deployment_settings_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/user_pb2.py` & `tecton-0.9.3/tecton_proto/data/user_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/virtual_data_source_pb2.py` & `tecton-0.9.3/tecton_proto/data/virtual_data_source_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/data/workspace_pb2.py` & `tecton-0.9.3/tecton_proto/data/workspace_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/databricks_api/clusters_pb2.py` & `tecton-0.9.3/tecton_proto/databricks_api/clusters_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/databricks_api/dbfs_pb2.py` & `tecton-0.9.3/tecton_proto/databricks_api/dbfs_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/databricks_api/error_pb2.py` & `tecton-0.9.3/tecton_proto/databricks_api/error_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/databricks_api/execution_pb2.py` & `tecton-0.9.3/tecton_proto/databricks_api/execution_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/databricks_api/instance_profiles_pb2.py` & `tecton-0.9.3/tecton_proto/databricks_api/instance_profiles_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/databricks_api/jobs_pb2.py` & `tecton-0.9.3/tecton_proto/databricks_api/jobs_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/databricks_api/libraries_pb2.py` & `tecton-0.9.3/tecton_proto/databricks_api/libraries_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/databricks_api/permissions_pb2.py` & `tecton-0.9.3/tecton_proto/databricks_api/permissions_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/databricks_api/scim_pb2.py` & `tecton-0.9.3/tecton_proto/databricks_api/scim_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/databricks_api/secrets_pb2.py` & `tecton-0.9.3/tecton_proto/databricks_api/secrets_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/databricks_api/workspace_pb2.py` & `tecton-0.9.3/tecton_proto/databricks_api/workspace_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/dataobs/config_pb2.py` & `tecton-0.9.3/tecton_proto/dataobs/config_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/dataobs/expectation_pb2.py` & `tecton-0.9.3/tecton_proto/dataobs/expectation_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/dataobs/metric_pb2.py` & `tecton-0.9.3/tecton_proto/dataobs/metric_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/dataobs/validation_pb2.py` & `tecton-0.9.3/tecton_proto/dataobs/validation_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/dataobs/validation_task_params_pb2.py` & `tecton-0.9.3/tecton_proto/dataobs/validation_task_params_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/dataobs/validation_task_pb2.py` & `tecton-0.9.3/tecton_proto/dataobs/validation_task_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/feature_server/configuration/feature_server_configuration_pb2.py` & `tecton-0.9.3/tecton_proto/feature_server/configuration/feature_server_configuration_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/materialization/job_metadata_pb2.py` & `tecton-0.9.3/tecton_proto/materialization/job_metadata_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/materialization/materialization_states_pb2.py` & `tecton-0.9.3/tecton_proto/materialization/materialization_states_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/materialization/materialization_task_pb2.py` & `tecton-0.9.3/tecton_proto/materialization/materialization_task_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/materialization/params_pb2.py` & `tecton-0.9.3/tecton_proto/materialization/params_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/materialization/spark_cluster_pb2.py` & `tecton-0.9.3/tecton_proto/materialization/spark_cluster_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/materializationjobservice/materialization_job_service_pb2.py` & `tecton-0.9.3/tecton_proto/materializationjobservice/materialization_job_service_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/metadataservice/http_over_grpc_pb2.py` & `tecton-0.9.3/tecton_proto/metadataservice/http_over_grpc_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/metadataservice/metadata_service_pb2.py` & `tecton-0.9.3/tecton_proto/metadataservice/metadata_service_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/offlinestore/delta/metadata_pb2.py` & `tecton-0.9.3/tecton_proto/offlinestore/delta/metadata_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/offlinestore/delta/transaction_writer_pb2.py` & `tecton-0.9.3/tecton_proto/offlinestore/delta/transaction_writer_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/online_store/feature_value_pb2.py` & `tecton-0.9.3/tecton_proto/online_store/feature_value_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/online_store/status_entry_pb2.py` & `tecton-0.9.3/tecton_proto/online_store/status_entry_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/online_store_writer/config_pb2.py` & `tecton-0.9.3/tecton_proto/online_store_writer/config_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/online_store_writer/copier_pb2.py` & `tecton-0.9.3/tecton_proto/online_store_writer/copier_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/remoteenvironmentservice/remote_environment_service_pb2.py` & `tecton-0.9.3/tecton_proto/remoteenvironmentservice/remote_environment_service_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/secrets/secrets_service_pb2.py` & `tecton-0.9.3/tecton_proto/secrets/secrets_service_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/snowflake/location_pb2.py` & `tecton-0.9.3/tecton_proto/snowflake/location_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/snowflake/snowflake_credentials_pb2.py` & `tecton-0.9.3/tecton_proto/snowflake/snowflake_credentials_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/spark_api/error_pb2.py` & `tecton-0.9.3/tecton_proto/spark_api/error_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/spark_api/jobs_pb2.py` & `tecton-0.9.3/tecton_proto/spark_api/jobs_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/spark_common/clusters_pb2.py` & `tecton-0.9.3/tecton_proto/spark_common/clusters_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/spark_common/libraries_pb2.py` & `tecton-0.9.3/tecton_proto/spark_common/libraries_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/testhelperservice/test_helper_service_pb2.py` & `tecton-0.9.3/tecton_proto/testhelperservice/test_helper_service_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_proto/validation/validator_pb2.py` & `tecton-0.9.3/tecton_proto/validation/validator_pb2.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/pipeline_helper.py` & `tecton-0.9.3/tecton_snowflake/pipeline_helper.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/query/aggregation_plans.py` & `tecton-0.9.3/tecton_snowflake/query/aggregation_plans.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/query/dataframe_helper.py` & `tecton-0.9.3/tecton_snowflake/query/dataframe_helper.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/query/nodes.py` & `tecton-0.9.3/tecton_snowflake/query/nodes.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/query/queries.py` & `tecton-0.9.3/tecton_snowflake/query/queries.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/query/rewrite.py` & `tecton-0.9.3/tecton_snowflake/query/rewrite.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/query/translate.py` & `tecton-0.9.3/tecton_snowflake/query/translate.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/schema_derivation_utils.py` & `tecton-0.9.3/tecton_snowflake/schema_derivation_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/snowflake_type_utils.py` & `tecton-0.9.3/tecton_snowflake/snowflake_type_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/sql_helper.py` & `tecton-0.9.3/tecton_snowflake/sql_helper.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/templates/copier_macro.sql` & `tecton-0.9.3/tecton_snowflake/templates/copier_macro.sql`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/templates/delete_orphaned_schemas.sql` & `tecton-0.9.3/tecton_snowflake/templates/delete_orphaned_schemas.sql`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/templates/delete_staged_files.sql` & `tecton-0.9.3/tecton_snowflake/templates/delete_staged_files.sql`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/templates/historical_features.sql` & `tecton-0.9.3/tecton_snowflake/templates/historical_features.sql`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/templates/historical_features_macros.sql` & `tecton-0.9.3/tecton_snowflake/templates/historical_features_macros.sql`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/templates/materialization_tile.sql` & `tecton-0.9.3/tecton_snowflake/templates/materialization_tile.sql`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/templates/materialized_feature_view.sql` & `tecton-0.9.3/tecton_snowflake/templates/materialized_feature_view.sql`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/templates/offline_materialization_macros.sql` & `tecton-0.9.3/tecton_snowflake/templates/offline_materialization_macros.sql`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/templates/run_full_aggregation.sql` & `tecton-0.9.3/tecton_snowflake/templates/run_full_aggregation.sql`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/templates/run_partial_aggregation.sql` & `tecton-0.9.3/tecton_snowflake/templates/run_partial_aggregation.sql`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/templates/time_limit.sql` & `tecton-0.9.3/tecton_snowflake/templates/time_limit.sql`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_snowflake/templates_utils.py` & `tecton-0.9.3/tecton_snowflake/templates_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_spark/__init__.py` & `tecton-0.9.3/tecton_spark/__init__.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_spark/aggregation_plans.py` & `tecton-0.9.3/tecton_spark/aggregation_plans.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_spark/data_observability.py` & `tecton-0.9.3/tecton_spark/data_observability.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_spark/data_source_credentials.py` & `tecton-0.9.3/tecton_spark/data_source_credentials.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_spark/data_source_helper.py` & `tecton-0.9.3/tecton_spark/data_source_helper.py`

 * *Files 2% similar despite different names*

```diff
@@ -9,17 +9,14 @@
 from datetime import datetime
 from typing import Any
 from typing import Dict
 from typing import Optional
 from typing import Union
 
 import pendulum
-from pyspark.sql import Column
-from pyspark.sql import DataFrame
-from pyspark.sql import SparkSession
 from pyspark.sql import functions
 from pyspark.sql.functions import coalesce
 from pyspark.sql.functions import to_timestamp
 from pyspark.sql.types import ArrayType
 from pyspark.sql.types import DataType
 from pyspark.sql.types import DateType
 from pyspark.sql.types import MapType
@@ -35,14 +32,17 @@
 from tecton_proto.args.data_source_config_pb2 import INITIAL_STREAM_POSITION_LATEST
 from tecton_proto.args.data_source_config_pb2 import INITIAL_STREAM_POSITION_TRIM_HORIZON
 from tecton_proto.args.data_source_config_pb2 import INITIAL_STREAM_POSITION_UNSPECIFIED
 from tecton_proto.common.data_source_type_pb2 import DataSourceType
 from tecton_proto.data.batch_data_source_pb2 import FileDataSourceFormat
 from tecton_spark.data_source_credentials import get_kafka_secrets
 from tecton_spark.spark_schema_wrapper import SparkSchemaWrapper
+from tecton_spark.type_annotations import PySparkColumn
+from tecton_spark.type_annotations import PySparkDataFrame
+from tecton_spark.type_annotations import PySparkSession
 
 
 INITIAL_STREAM_POSITION_STR_TO_ENUM = {
     "latest": INITIAL_STREAM_POSITION_LATEST,
     "trim_horizon": INITIAL_STREAM_POSITION_TRIM_HORIZON,
 }
 
@@ -73,35 +73,37 @@
     return (
         "EMR_RELEASE_LABEL" in os.environ
         or os.environ.get("TECTON_RUNTIME_ENV") == "EMR"
         or conf.get_or_none("TECTON_RUNTIME_ENV") == "EMR"
     )
 
 
-def _get_raw_hive_table_dataframe(spark: SparkSession, database: str, table: str) -> DataFrame:
+def _get_raw_hive_table_dataframe(spark: PySparkSession, database: str, table: str) -> PySparkDataFrame:
     spark.sql("USE {}".format(database))
     return spark.table(table)
 
 
-def _get_raw_unity_table_dataframe(spark: SparkSession, catalog: str, schema: str, table: str) -> DataFrame:
+def _get_raw_unity_table_dataframe(spark: PySparkSession, catalog: str, schema: str, table: str) -> PySparkDataFrame:
     # USE CATALOG is only supported in databricks sql but not local pyspark
     # so we'd have to tweak for local integration tests to use "USE" sql statement
     # this means customers won't be able to use a unity catalog named "TECTON_LOCAL_INTEGRATION_TEST_ONLY_UNITY_CATALOG"
     if catalog == TEST_ONLY_UNITY_CATALOG_NAME:
         spark.sql(f"USE {catalog}")
     else:
         spark.sql(f"USE CATALOG {catalog}")
     spark.sql(f"USE {schema}")
     return spark.table(table)
 
 
 @typechecked
 def get_non_dsf_raw_dataframe(
-    spark: SparkSession, data_source: specs.BatchSourceSpec, called_for_schema_computation: bool = False
-) -> DataFrame:
+    spark: PySparkSession,
+    data_source: specs.BatchSourceSpec,
+    called_for_schema_computation: bool = False,
+) -> PySparkDataFrame:
     """Returns a DataFrame of the raw, untranslated data defined by the given BatchDataSource proto.
 
     :param spark: Spark session.
     :param data_source: BatchDataSource proto. BatchDataSource must not be a data source function (spark_batch_config).
     :param called_for_schema_computation: If set, optimizations are applied for faster schema computations.
                                           i.e. FileDSConfig.schema_uri is used to avoid expensive partition discovery.
 
@@ -178,16 +180,18 @@
         raise ValueError(msg)
 
     return df
 
 
 @typechecked
 def get_table_dataframe(
-    spark: SparkSession, data_source: specs.BatchSourceSpec, called_for_schema_computation: bool = False
-) -> DataFrame:
+    spark: PySparkSession,
+    data_source: specs.BatchSourceSpec,
+    called_for_schema_computation: bool = False,
+) -> PySparkDataFrame:
     """Returns a DataFrame for a table defined by given BatchDataSource proto.
 
     :param spark: Spark session.
     :param data_source: BatchDataSource proto. BatchDataSource must not be a data source function (spark_batch_config).
     :param called_for_schema_computation: If set, optimizations are applied for faster schema computations.
                                           i.e. FileDSConfig.schema_uri is used to avoid expensive partition discovery.
 
@@ -203,16 +207,16 @@
     if data_source.timestamp_field:
         df = apply_timestamp_column(df, data_source.timestamp_field, data_source.timestamp_format)
 
     return df
 
 
 def get_redshift_dataframe(
-    spark: SparkSession, endpoint: str, temp_s3: str, table: Optional[str] = None, query: Optional[str] = None
-) -> DataFrame:
+    spark: PySparkSession, endpoint: str, temp_s3: str, table: Optional[str] = None, query: Optional[str] = None
+) -> PySparkDataFrame:
     """Returns a DataFrame for a Redshift table defined by given RedshiftDataSource proto.
 
     :param table: The table name in redshift
     :param temp_s3: The s3 URI for temp data
     :param endpoint: The connection endpoint for redshift (without user or password)
     :param spark: Spark session.
 
@@ -247,24 +251,24 @@
         df_reader = df_reader.option("query", query)
 
     df = df_reader.load()
     return df
 
 
 def get_snowflake_dataframe(
-    spark: SparkSession,
+    spark: PySparkSession,
     url: str,
     database: str,
     schema: str,
     warehouse: str,
     role: Optional[str] = None,
     table: Optional[str] = None,
     query: Optional[str] = None,
     spark_schema: Optional[StructType] = None,
-) -> DataFrame:
+) -> PySparkDataFrame:
     """Returns a Spark DataFrame from a Snowflake table or query.
 
     Casts the DataFrame to match spark_schema if it is specified.
 
     Requires the Spark-Snowflake connector JAR to be installed. See https://docs.snowflake.com/en/user-guide/spark-connector.
     """
 
@@ -301,15 +305,15 @@
     df = df_reader.load()
     if spark_schema is not None:
         for field in spark_schema:
             df = df.withColumn(field.name, functions.col(field.name).cast(field.dataType))
     return df
 
 
-def apply_timestamp_column(df: DataFrame, ts_column: str, ts_format: Optional[str]) -> DataFrame:
+def apply_timestamp_column(df: PySparkDataFrame, ts_column: str, ts_format: Optional[str]) -> PySparkDataFrame:
     # Verify the raw source's timestamp column is of type "string"
     column_names = df.schema.names
     if ts_column not in column_names:
         msg = f"Timestamp Column '{ts_column}' not found in schema. Found: {column_names}"
         raise AssertionError(msg)
 
     ts_type = df.schema[ts_column].dataType.jsonValue()
@@ -327,19 +331,19 @@
         df = df.withColumn(ts_column, coalesce(to_timestamp(df[ts_column], ts_format), to_timestamp(df[ts_column])))
 
     return df
 
 
 @typechecked
 def apply_partition_and_timestamp_filter(
-    df: DataFrame,
+    df: PySparkDataFrame,
     batch_source: specs.BatchSourceSpec,
     start_time: Optional[Union[pendulum.DateTime, datetime]] = None,
     end_time: Optional[Union[pendulum.DateTime, datetime]] = None,
-) -> DataFrame:
+) -> PySparkDataFrame:
     """Applies a partition and timestamp filters if the respective column names are set.
 
     :return: The DataFrame with filter applied.
     """
 
     # add datetime partition filters
     if isinstance(batch_source, specs.HiveSourceSpec) and batch_source.datetime_partition_columns:
@@ -372,15 +376,15 @@
 #  --> (y = start.year & m = start.month & d >= start.day & d <= end.day)
 # (B)Time range: 2019 Dec 21 10:00:00 AM - 2020 Jan 10 5:00:00 AM
 #  --> ((y = start.year & m = start.month & d >= start.day) | (y = end.year & m = end.month & d <= end.day))
 def _build_partition_filter(
     datetime_partition_columns: specs.DatetimePartitionColumnSpec,
     start_time: Optional[Union[pendulum.DateTime, datetime]] = None,
     end_time: Optional[Union[pendulum.DateTime, datetime]] = None,
-) -> Column:
+) -> PySparkColumn:
     if not start_time and not end_time:
         return None
 
     range_duration = end_time - start_time if start_time and end_time else None
 
     # Filters relating to start_time and end_time
     start_filters = []
@@ -453,18 +457,18 @@
     else:
         from functools import reduce
 
         return reduce(lambda x, y: x & y, filter_list)
 
 
 def create_kinesis_stream_reader(
-    spark: SparkSession,
+    spark: PySparkSession,
     stream_source: specs.KinesisSourceSpec,
     option_overrides: Optional[Dict[str, str]],
-) -> DataFrame:
+) -> PySparkDataFrame:
     """
     Returns a DataFrame representing a Kinesis stream reader.
 
     :param option_overrides: Spark options that should override options set implicitly (e.g. ``stream_name``) or
         explicitly  (e.g. ``options``) by the data source definition.
     """
     options = {"streamName": stream_source.stream_name}
@@ -501,18 +505,18 @@
         options.update(option_overrides)
 
     reader = spark.readStream.format("kinesis").options(**options)
     return reader.load()
 
 
 def create_kafka_stream_reader(
-    spark: SparkSession,
+    spark: PySparkSession,
     stream_source: specs.KafkaSourceSpec,
     option_overrides: Optional[Dict[str, str]],
-) -> DataFrame:
+) -> PySparkDataFrame:
     """Returns a Kafka stream reader.
 
     :param data_source_options: Spark options specified in the data source definition.
     :param option_overrides: Spark options that should override options set implicitly (e.g. ``topics``) or explicitly
         (e.g. ``options``) by the data source definition.
     """
     options = {o.key: o.value for o in stream_source.options}
@@ -595,16 +599,16 @@
         starting_offsets_by_ts = {topic_name: ts_per_partition for topic_name in topic_names}
         kafka_options["startingOffsetsByTimestamp"] = json.dumps(starting_offsets_by_ts)
 
     return kafka_options
 
 
 def get_non_dsf_raw_stream_dataframe(
-    spark: SparkSession, stream_data_source: specs.StreamSourceSpec, option_overrides: Optional[Dict[str, str]] = None
-) -> DataFrame:
+    spark: PySparkSession, stream_data_source: specs.StreamSourceSpec, option_overrides: Optional[Dict[str, str]] = None
+) -> PySparkDataFrame:
     """Returns a DataFrame representing the raw stream data.
 
     :param spark: Spark session.
     :param stream_data_source: StreamDataSource proto. StreamDataSource must not be a data source function (spark_stream_config).
     :param option_overrides: A dictionary of Spark readStream options that will override any readStream options set by
         the data source.
 
@@ -625,16 +629,16 @@
     else:
         msg = f"Unknown stream data source type: {stream_data_source}"
         raise ValueError(msg)
     return df
 
 
 def get_stream_dataframe(
-    spark: SparkSession, stream_data_source: specs.StreamSourceSpec, option_overrides: Optional[Dict[str, str]] = None
-) -> DataFrame:
+    spark: PySparkSession, stream_data_source: specs.StreamSourceSpec, option_overrides: Optional[Dict[str, str]] = None
+) -> PySparkDataFrame:
     """Returns a DataFrame representing a stream data source *without* any options specified.
     Use get_stream_dataframe_with_options to get a DataFrame with stream-specific options.
 
     :param spark: Spark session.
     :param stream_data_source: StreamDataSource proto. StreamDataSource must not be a data source function (spark_stream_config).
     :param option_overrides: A dictionary of Spark readStream options that will override any readStream options set by
         the data source.
@@ -646,16 +650,16 @@
     ), "get_stream_dataframe can not be used with data source function (spark_stream_config)."
 
     df = get_non_dsf_raw_stream_dataframe(spark, stream_data_source, option_overrides)
     return stream_data_source.post_processor(df)
 
 
 def get_stream_dataframe_with_options(
-    spark: SparkSession, stream_data_source: specs.StreamSourceSpec, option_overrides: Optional[Dict[str, str]] = None
-) -> DataFrame:
+    spark: PySparkSession, stream_data_source: specs.StreamSourceSpec, option_overrides: Optional[Dict[str, str]] = None
+) -> PySparkDataFrame:
     """Returns a DataFrame representing a stream data source with additional options:
         - drop duplicate column names
         - initial stream position
 
     :param spark: Spark session.
     :param stream_data_source: StreamDataSource proto. StreamDataSource must not be a data source function (spark_stream_config).
     :param option_overrides: A dictionary of Spark readStream options that will override any readStream options set by
@@ -687,22 +691,22 @@
         return INITIAL_STREAM_POSITION_ENUM_TO_STR[stream_data_source.initial_stream_position]
     else:
         return None
 
 
 @typechecked
 def get_ds_dataframe(
-    spark: SparkSession,
+    spark: PySparkSession,
     data_source: specs.DataSourceSpec,
     consume_streaming_data_source: bool,
     start_time: Optional[Union[pendulum.DateTime, datetime]] = None,
     end_time: Optional[Union[pendulum.DateTime, datetime]] = None,
     called_for_schema_computation: bool = False,
     stream_option_overrides: Optional[Dict[str, str]] = None,
-) -> DataFrame:
+) -> PySparkDataFrame:
     if consume_streaming_data_source and (start_time or end_time):
         msg = "Can't specify start or end time when consuming streaming data source"
         raise AssertionError(msg)
 
     if consume_streaming_data_source:
         assert (
             data_source.stream_source
@@ -734,15 +738,15 @@
             schema = data_source.schema.tecton_schema
             cols = [f"`{c.name}`" for c in schema.columns]
             df = df.select(*cols)
 
     return df
 
 
-def convert_json_like_schema_to_glue_format(spark: SparkSession, df: DataFrame) -> DataFrame:
+def convert_json_like_schema_to_glue_format(spark: PySparkSession, df: PySparkDataFrame) -> PySparkDataFrame:
     """
     Converts a DataFrame schema to lowercase. This assumes JSON so
     MapTypes or Arrays of non-StructTypes are not allowed.
 
     :param spark: Spark session.
     :param df: DataFrame input.
     :return: DataFrame with lowercase schema.
@@ -788,16 +792,16 @@
             new_fields.append(functions.col(col.name).cast(StringType()).alias(col.name.lower()))
         else:
             new_fields.append(functions.col(col.name).alias(col.name.lower()))
     return df.select(new_fields)
 
 
 def get_data_source_function_batch_dataframe(
-    spark: SparkSession,
+    spark: PySparkSession,
     data_source: specs.SparkBatchSourceSpec,
     start_time: Optional[datetime],
     end_time: Optional[datetime],
-) -> DataFrame:
+) -> PySparkDataFrame:
     if data_source.supports_time_filtering:
         filter_context = FilterContext(start_time, end_time)
         return data_source.function(spark, filter_context)
     return data_source.function(spark)
```

### Comparing `tecton-0.9.2/tecton_spark/feature_view_spark_utils.py` & `tecton-0.9.3/tecton_spark/feature_view_spark_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_spark/jars/class_loader.py` & `tecton-0.9.3/tecton_spark/jars/class_loader.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_spark/jars/tecton-udfs-spark-3.jar` & `tecton-0.9.3/tecton_spark/jars/tecton-udfs-spark-3.jar`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_spark/materialization_plan.py` & `tecton-0.9.3/tecton_spark/materialization_plan.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_spark/offline_store.py` & `tecton-0.9.3/tecton_spark/offline_store.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_spark/partial_aggregations.py` & `tecton-0.9.3/tecton_spark/partial_aggregations.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_spark/pipeline_helper.py` & `tecton-0.9.3/tecton_spark/pipeline_helper.py`

 * *Files 2% similar despite different names*

```diff
@@ -10,16 +10,14 @@
 from typing import Tuple
 from typing import Union
 
 import numpy as np
 import pandas
 import pandas as pd
 import pendulum
-from pyspark.sql import DataFrame
-from pyspark.sql import SparkSession
 from pyspark.sql.column import Column
 from pyspark.sql.types import ArrayType
 from pyspark.sql.types import MapType
 from pyspark.sql.types import StringType
 from pyspark.sql.types import StructType
 
 from tecton_core import conf
@@ -43,14 +41,16 @@
 from tecton_proto.args.pipeline_pb2 import PipelineNode
 from tecton_proto.args.pipeline_pb2 import TransformationNode
 from tecton_proto.args.transformation_pb2 import TransformationMode
 from tecton_proto.common.data_source_type_pb2 import DataSourceType
 from tecton_spark import feature_view_spark_utils
 from tecton_spark.schema_spark_utils import schema_to_spark
 from tecton_spark.spark_schema_wrapper import SparkSchemaWrapper
+from tecton_spark.type_annotations import PySparkDataFrame
+from tecton_spark.type_annotations import PySparkSession
 
 
 MAX_INT64 = (2**63) - 1
 
 # TODO(TEC-8978): remove \. from namespace regex when FWv3 FVs are no longer supported.
 _NAMESPACE_SEPARATOR_REGEX = re.compile(r"__|\.")
 
@@ -67,15 +67,15 @@
     if len(spl) == 2:
         return spl[1]
 
     return namespaced_feature_name.split(".")[1]
 
 
 def build_odfv_udf_col(
-    input_df: DataFrame, fdw: FeatureDefinitionWrapper, namespace: str, use_namespace_feature_prefix: bool = True
+    input_df: PySparkDataFrame, fdw: FeatureDefinitionWrapper, namespace: str, use_namespace_feature_prefix: bool = True
 ) -> Tuple[Column, List[Column]]:
     """
     Builds a Spark udf for executing a specific ODFV. This runs an ODFV,
     which outputs a single temporary object (dict/map for python mode, json for
     pandas mode). We then deserialize this to get the feature columns.
 
     We use this function in two phases in parallel across multiple ODFVs:
@@ -163,22 +163,22 @@
         output_schema=None,
         passed_in_inputs=mock_inputs,
     )
     return builder._udf_node_to_value(pipeline.root)
 
 
 def pipeline_to_dataframe(
-    spark: SparkSession,
+    spark: PySparkSession,
     pipeline: Pipeline,
     consume_streaming_data_sources: bool,
     data_sources: List[specs.DataSourceSpec],
     transformations: List[specs.TransformationSpec],
     schedule_interval: Optional[pendulum.Duration] = None,
-    passed_in_inputs: Optional[Dict[str, DataFrame]] = None,
-) -> DataFrame:
+    passed_in_inputs: Optional[Dict[str, PySparkDataFrame]] = None,
+) -> PySparkDataFrame:
     return _PipelineBuilder(
         spark,
         pipeline,
         consume_streaming_data_sources,
         data_sources,
         transformations,
         schedule_interval=schedule_interval,
@@ -228,26 +228,26 @@
 
 
 # Constructs empty data frames matching schema of DS inputs for the purpose of
 # schema-validating the transformation pipeline.
 def populate_empty_passed_in_inputs(
     node: PipelineNode,
     ds_map: Dict[str, specs.DataSourceSpec],
-    spark: SparkSession,
-) -> Dict[str, DataFrame]:
+    spark: PySparkSession,
+) -> Dict[str, PySparkDataFrame]:
     empty_passed_in_inputs = {}
     _populate_empty_passed_in_inputs_helper(node, empty_passed_in_inputs, ds_map, spark)
     return empty_passed_in_inputs
 
 
 def _populate_empty_passed_in_inputs_helper(
     node: PipelineNode,
-    empty_passed_in_inputs: Dict[str, DataFrame],
+    empty_passed_in_inputs: Dict[str, PySparkDataFrame],
     ds_map: Dict[str, specs.DataSourceSpec],
-    spark: SparkSession,
+    spark: PySparkSession,
 ) -> None:
     if node.HasField("data_source_node"):
         ds_id = IdHelper.to_string(node.data_source_node.virtual_data_source_id)
         ds_spec = ds_map[ds_id]
         assert (
             ds_spec.type != DataSourceType.PUSH_NO_BATCH
         ), "This utility does not support FeatureView with PushSources that do not have a batch_config"
@@ -259,30 +259,30 @@
         for child in node.transformation_node.inputs:
             _populate_empty_passed_in_inputs_helper(child.node, empty_passed_in_inputs, ds_map, spark)
 
 
 # This class is for Spark pipelines
 class _PipelineBuilder:
     # The value of internal nodes in the tree
-    _VALUE_TYPE = Union[DataFrame, CONSTANT_TYPE, BaseMaterializationContext]
+    _VALUE_TYPE = Union[PySparkDataFrame, CONSTANT_TYPE, BaseMaterializationContext]
 
     def __init__(
         self,
-        spark: SparkSession,
+        spark: PySparkSession,
         pipeline: Pipeline,
         consume_streaming_data_sources: bool,
         data_sources: List[specs.DataSourceSpec],
         # we only use mode and name from these
         transformations: List[specs.TransformationSpec],
         # Feature time limits are only used to control the materialization context. No filtering is performed.
         feature_time_limits: Optional[pendulum.Period] = None,
         schedule_interval: Optional[pendulum.Duration] = None,
         # If None, we will compute inputs from raw data sources and apply time filtering.
         # Otherwise we will prefer these inputs instead
-        passed_in_inputs: Optional[Dict[str, DataFrame]] = None,
+        passed_in_inputs: Optional[Dict[str, PySparkDataFrame]] = None,
         # output_schema is only used by python/pandas transformations during backfills.
         # Specifically, it applies for Stream feature views with push sources and batch config, during
         # the batch materialization jobs.
         output_schema: Optional[StructType] = None,
     ) -> None:
         self._spark = spark
         self._pipeline = pipeline
@@ -293,27 +293,27 @@
         self._id_to_transformation = {t.id: t for t in transformations}
 
         self._registered_temp_view_names: List[str] = []
         self._schedule_interval = schedule_interval
 
         self._passed_in_inputs = passed_in_inputs
 
-    def get_dataframe(self) -> DataFrame:
+    def get_dataframe(self) -> PySparkDataFrame:
         df = self._node_to_value(self._pipeline.root)
         # Cleanup any temporary tables created during the process
         for temp_name in self._registered_temp_view_names:
             # DROP VIEW/DROP TABLE sql syntax is invalidated when spark_catalog is set to DeltaCatalog on EMR clusters
             if (
                 self._spark.conf.get("spark.sql.catalog.spark_catalog", "")
                 == "org.apache.spark.sql.delta.catalog.DeltaCatalog"
             ):
                 self._spark.catalog.dropTempView(temp_name)
             else:
                 self._spark.sql(f"DROP VIEW IF EXISTS {temp_name}")
-        assert isinstance(df, DataFrame)
+        assert isinstance(df, PySparkDataFrame)
         return df
 
     def _node_to_value(self, pipeline_node: PipelineNode) -> _VALUE_TYPE:
         if pipeline_node.HasField("transformation_node"):
             return self._transformation_node_to_dataframe(pipeline_node.transformation_node)
         elif pipeline_node.HasField("data_source_node"):
             data_source_node = pipeline_node.data_source_node
@@ -339,17 +339,17 @@
         elif pipeline_node.HasField("feature_view_node"):
             msg = "Dependent FeatureViews are not supported in Spark pipelines"
             raise ValueError(msg)
         else:
             msg = f"Unknown PipelineNode type: {pipeline_node}"
             raise KeyError(msg)
 
-    def _transformation_node_to_dataframe(self, transformation_node: TransformationNode) -> DataFrame:
+    def _transformation_node_to_dataframe(self, transformation_node: TransformationNode) -> PySparkDataFrame:
         """Recursively translates inputs to values and then passes them to the transformation."""
-        args: List[Union[DataFrame, str, int, float, bool]] = []
+        args: List[Union[PySparkDataFrame, str, int, float, bool]] = []
         kwargs = {}
         for transformation_input in transformation_node.inputs:
             node_value = self._node_to_value(transformation_input.node)
             if transformation_input.HasField("arg_index"):
                 assert len(args) == transformation_input.arg_index
                 args.append(node_value)
             elif transformation_input.HasField("arg_name"):
@@ -358,15 +358,15 @@
                 msg = f"Unknown argument type for Input node: {transformation_input}"
                 raise KeyError(msg)
 
         return self._apply_transformation_function(transformation_node, args, kwargs)
 
     def _apply_transformation_function(
         self, transformation_node: TransformationNode, args: List[Any], kwargs: Dict[str, Any]
-    ) -> Union[Dict[str, Any], pd.DataFrame, DataFrame]:
+    ) -> Union[Dict[str, Any], pd.DataFrame, PySparkDataFrame]:
         """For the given transformation node, returns the corresponding DataFrame transformation.
 
         If needed, resulted function is wrapped with a function that translates mode-specific input/output types to DataFrames.
         """
         transformation = self._id_to_transformation[IdHelper.to_string(transformation_node.transformation_id)]
         user_function = transformation.user_function
 
@@ -435,15 +435,15 @@
                 raise UDF_ERROR(e)
         else:
             msg = f"unknown transformation mode({transformation.transformation_mode})"
             raise KeyError(msg)
 
     def _wrap_sql_function(
         self, transformation_node: TransformationNode, user_function: Callable[..., str]
-    ) -> Callable[..., DataFrame]:
+    ) -> Callable[..., PySparkDataFrame]:
         def wrapped(*args, **kwargs):
             wrapped_args = []
             for arg, node_input in zip(args, positional_inputs(transformation_node)):
                 wrapped_args.append(self._wrap_node_inputvalue(node_input, arg))
             keyword_inputs = get_keyword_inputs(transformation_node)
             wrapped_kwargs = {}
             for k, v in kwargs.items():
@@ -464,15 +464,15 @@
         if node_input.node.HasField("constant_node"):
             assert value is None or isinstance(value, CONSTANT_TYPE_OBJECTS)
             return value
         elif node_input.node.HasField("materialization_context_node"):
             assert isinstance(value, BoundMaterializationContext)
             return value
         else:
-            assert isinstance(value, DataFrame)
+            assert isinstance(value, PySparkDataFrame)
             return self._register_temp_table(self._node_name(node_input.node), value)
 
     def _node_name(self, node: PipelineNode) -> str:
         """Returns a human-readable name for the node."""
         if node.HasField("transformation_node"):
             name = self._id_to_transformation[IdHelper.to_string(node.transformation_node.transformation_id)].name
             return f"transformation_{name}_output"
@@ -482,15 +482,15 @@
             # TODO(TEC-5076): remove this legacy code, since input_name will always be set
             name = self._id_to_ds[IdHelper.to_string(node.data_source_node.virtual_data_source_id)].fco_metadata.name
             return f"data_source_{name}_output"
         else:
             msg = f"Expected transformation or data source node: {node}"
             raise Exception(msg)
 
-    def _register_temp_table(self, name: str, df: DataFrame) -> str:
+    def _register_temp_table(self, name: str, df: PySparkDataFrame) -> str:
         """Registers a Dataframe as a temp table and returns its name."""
         unique_name = name + self._random_suffix()
         self._registered_temp_view_names.append(unique_name)
         df.createOrReplaceTempView(unique_name)
         return unique_name
 
     def _random_suffix(self) -> str:
@@ -589,15 +589,15 @@
             output_strs.append(json.dumps(row._asdict()))
         return pd.Series(output_strs)
 
     def _transformation_node_to_online_dataframe(
         self, transformation_node: TransformationNode
     ) -> Union[Dict[str, Any], pd.DataFrame]:
         """Recursively translates inputs to values and then passes them to the transformation."""
-        args: List[Union[DataFrame, str, int, float, bool]] = []
+        args: List[Union[PySparkDataFrame, str, int, float, bool]] = []
         kwargs = {}
         for transformation_input in transformation_node.inputs:
             node_value = self._udf_node_to_value(transformation_input.node)
             if transformation_input.HasField("arg_index"):
                 assert len(args) == transformation_input.arg_index
                 args.append(node_value)
             elif transformation_input.HasField("arg_name"):
@@ -607,15 +607,15 @@
                 raise KeyError(msg)
 
         return self._apply_transformation_function(transformation_node, args, kwargs)
 
     # evaluate a node in the Pipeline
     def _udf_node_to_value(
         self, pipeline_node: PipelineNode
-    ) -> Union[str, int, float, bool, None, Dict[str, Any], pd.DataFrame, DataFrame, pd.Series]:
+    ) -> Union[str, int, float, bool, None, Dict[str, Any], pd.DataFrame, PySparkDataFrame, pd.Series]:
         if pipeline_node.HasField("constant_node"):
             return constant_node_to_value(pipeline_node.constant_node)
         elif pipeline_node.HasField("feature_view_node"):
             if self._passed_in_inputs is not None:
                 return self._passed_in_inputs[pipeline_node.feature_view_node.input_name]
             elif self.mode == "python":
                 fields_dict = {}
```

### Comparing `tecton-0.9.2/tecton_spark/query/data_source.py` & `tecton-0.9.3/tecton_spark/query/data_source.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_spark/query/filter.py` & `tecton-0.9.3/tecton_spark/query/filter.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_spark/query/join.py` & `tecton-0.9.3/tecton_spark/query/join.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_spark/query/node.py` & `tecton-0.9.3/tecton_spark/query/node.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_spark/query/pipeline.py` & `tecton-0.9.3/tecton_spark/query/pipeline.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_spark/query/projection.py` & `tecton-0.9.3/tecton_spark/query/projection.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_spark/query/translate.py` & `tecton-0.9.3/tecton_spark/query/translate.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_spark/schema_derivation_utils.py` & `tecton-0.9.3/tecton_spark/schema_derivation_utils.py`

 * *Files 3% similar despite different names*

```diff
@@ -20,19 +20,21 @@
 from tecton_proto.common import spark_schema_pb2
 from tecton_proto.common.data_source_type_pb2 import DataSourceType
 from tecton_spark import data_source_helper
 from tecton_spark import errors_spark
 from tecton_spark import pipeline_helper
 from tecton_spark import schema_spark_utils
 from tecton_spark import spark_schema_wrapper
+from tecton_spark.type_annotations import PySparkDataFrame
+from tecton_spark.type_annotations import PySparkSession
 
 
 @typechecked
 def get_hive_table_schema(
-    spark: pyspark.sql.SparkSession,
+    spark: PySparkSession,
     database: str,
     table: str,
     post_processor: Optional[Callable],
     timestamp_field: str,
     timestamp_format: str,
 ) -> spark_schema_pb2.SparkSchema:
     df = data_source_helper._get_raw_hive_table_dataframe(spark, database, table)
@@ -43,15 +45,15 @@
         if timestamp_format:
             ts_format = timestamp_format
         df = data_source_helper.apply_timestamp_column(df, timestamp_field, ts_format)
     return spark_schema_wrapper.SparkSchemaWrapper.from_spark_schema(df.schema)
 
 
 def get_unity_table_schema(
-    spark: pyspark.sql.SparkSession,
+    spark: PySparkSession,
     catalog: str,
     schema: str,
     table: str,
     post_processor: Optional[Callable],
     timestamp_field: str,
     timestamp_format: str,
 ) -> spark_schema_pb2.SparkSchema:
@@ -64,30 +66,30 @@
             ts_format = timestamp_format
         df = data_source_helper.apply_timestamp_column(df, timestamp_field, ts_format)
     return spark_schema_wrapper.SparkSchemaWrapper.from_spark_schema(df.schema)
 
 
 @typechecked
 def get_redshift_table_schema(
-    spark: pyspark.sql.SparkSession,
+    spark: PySparkSession,
     endpoint: str,
     table: str,
     query: str,
     temp_s3: str,
     post_processor: Optional[Callable],
 ) -> spark_schema_pb2.SparkSchema:
     df = data_source_helper.get_redshift_dataframe(spark, endpoint, temp_s3, table=table, query=query)
     if post_processor is not None:
         df = post_processor(df)
     return spark_schema_wrapper.SparkSchemaWrapper.from_spark_schema(df.schema)
 
 
 @typechecked
 def get_snowflake_schema(
-    spark: pyspark.sql.SparkSession,
+    spark: PySparkSession,
     url: str,
     database: str,
     schema: str,
     warehouse: str,
     role: Optional[str],
     table: Optional[str],
     query: Optional[str],
@@ -108,15 +110,15 @@
     if post_processor is not None:
         df = post_processor(df)
     return spark_schema_wrapper.SparkSchemaWrapper.from_spark_schema(df.schema)
 
 
 @typechecked
 def get_batch_data_source_function_schema(
-    spark: pyspark.sql.SparkSession, data_source_function: Callable, supports_time_filtering: bool
+    spark: PySparkSession, data_source_function: Callable, supports_time_filtering: bool
 ) -> spark_schema_pb2.SparkSchema:
     if supports_time_filtering:
         df_fc_none = data_source_function(spark=spark, filter_context=None)
         df_fc_none_start_none_end = data_source_function(
             spark=spark, filter_context=filter_context.FilterContext(None, None)
         )
         df_fc_none_end = data_source_function(
@@ -134,20 +136,20 @@
         assert all(
             df.schema == schema for df in [df_fc_none_start_none_end, df_fc_none_end, df_fc_none_start]
         ), filter_context_error_message
 
         df = df_fc_none
     else:
         df = data_source_function(spark=spark)
-    assert isinstance(df, pyspark.sql.dataframe.DataFrame), "Data Source Function must return a Spark DataFrame"
+    assert isinstance(df, PySparkDataFrame), "Data Source Function must return a Spark DataFrame"
     return spark_schema_wrapper.SparkSchemaWrapper.from_spark_schema(df.schema)
 
 
 def get_file_source_schema(
-    spark: pyspark.sql.SparkSession,
+    spark: PySparkSession,
     file_format: str,
     file_uri: str,
     convert_to_glue: bool,
     schema_uri: Optional[str],
     schema_override: Optional[spark_schema_wrapper.SparkSchemaWrapper],
     post_processor: Optional[Callable],
     timestamp_col: Optional[str],
@@ -196,15 +198,15 @@
         df = data_source_helper.apply_timestamp_column(df, timestamp_col, timestmap_format)
 
     return spark_schema_wrapper.SparkSchemaWrapper.from_spark_schema(df.schema)
 
 
 @typechecked
 def get_kinesis_schema(
-    spark: pyspark.sql.SparkSession, stream_name: str, post_processor: Callable
+    spark: PySparkSession, stream_name: str, post_processor: Callable
 ) -> spark_schema_pb2.SparkSchema:
     """Compute the Kinesis schema using mock Kinesis data.
 
     Creates a mocked DataFrame for this stream, without actually creating a stream reader.
     This method returns a message in the Kinesis message format (below) with mocked contents.
 
     |-- approximateArrivalTimestamp: timestamp
@@ -238,36 +240,36 @@
         pyspark_types.StructField("timestamp", pyspark_types.TimestampType(), True),
         pyspark_types.StructField("timestampType", pyspark_types.IntegerType(), True),
     ]
 )
 
 
 @typechecked
-def get_kafka_schema(spark: pyspark.sql.SparkSession, post_processor: Callable) -> spark_schema_pb2.SparkSchema:
+def get_kafka_schema(spark: PySparkSession, post_processor: Callable) -> spark_schema_pb2.SparkSchema:
     """Compute the Kafka schema using mock Kafka data."""
     df = spark.createDataFrame([], KAFKA_SCHEMA)
     df = post_processor(df)
     return spark_schema_wrapper.SparkSchemaWrapper.from_spark_schema(df.schema)
 
 
 @typechecked
 def get_stream_data_source_function_schema(
-    spark: pyspark.sql.SparkSession, data_source_fn: Callable
+    spark: PySparkSession, data_source_fn: Callable
 ) -> spark_schema_pb2.SparkSchema:
     """Compute the Kafka schema using mock Kafka data."""
     df = data_source_fn(spark=spark)
     assert (
-        isinstance(df, pyspark.sql.dataframe.DataFrame) and df.isStreaming
+        isinstance(df, PySparkDataFrame) and df.isStreaming
     ), "Data Source Function must return a streaming Spark DataFrame"
     return spark_schema_wrapper.SparkSchemaWrapper.from_spark_schema(df.schema)
 
 
 @typechecked
 def get_feature_view_view_schema(
-    spark: pyspark.sql.SparkSession,
+    spark: PySparkSession,
     feature_view: feature_view_pb2.FeatureViewArgs,
     transformations: Sequence[specs.TransformationSpec],
     data_sources: Sequence[specs.DataSourceSpec],
 ) -> schema_pb2.Schema:
     """Compute the Feature View view schema."""
     has_push_source = False
     for data_source in data_sources:
@@ -279,19 +281,19 @@
         return feature_view.materialized_feature_view_args.schema
     df = get_feature_view_empty_view_df(spark, feature_view, transformations, data_sources)
     return schema_spark_utils.schema_from_spark(df.schema).to_proto()
 
 
 @typechecked
 def get_feature_view_empty_view_df(
-    spark: pyspark.sql.SparkSession,
+    spark: PySparkSession,
     feature_view: feature_view_pb2.FeatureViewArgs,
     transformations: Sequence[specs.TransformationSpec],
     data_sources: Sequence[specs.DataSourceSpec],
-) -> pyspark.sql.DataFrame:
+) -> PySparkDataFrame:
     """Return a pyspark dataframe for the feature view "view" (i.e. before agggregations) using mock/empty data."""
     # Create empty data frames for each DS input matching the DS schema.
     id_to_ds = {ds.id: ds for ds in data_sources}
     empty_mock_inputs = pipeline_helper.populate_empty_passed_in_inputs(feature_view.pipeline.root, id_to_ds, spark)
 
     return pipeline_helper.pipeline_to_dataframe(
         spark,
@@ -312,15 +314,15 @@
     elif feature_view.HasField("materialized_feature_view_args"):
         return pendulum.Duration(seconds=feature_view.materialized_feature_view_args.batch_schedule.ToSeconds())
     else:
         return None
 
 
 def derive_batch_schema(
-    spark: pyspark.sql.SparkSession,
+    spark: PySparkSession,
     ds_args: virtual_data_source__args_pb2.VirtualDataSourceArgs,
     batch_post_processor: Optional[Callable],
     batch_data_source_function: Optional[Callable],
 ) -> spark_schema_pb2.SparkSchema:
     if ds_args.HasField("hive_ds_config"):
         return get_hive_table_schema(
             spark=spark,
@@ -420,15 +422,15 @@
         )
     else:
         msg = f"Invalid batch source args: {ds_args}"
         raise ValueError(msg)
 
 
 def derive_stream_schema(
-    spark: pyspark.sql.SparkSession,
+    spark: PySparkSession,
     ds_args: virtual_data_source__args_pb2.VirtualDataSourceArgs,
     stream_post_processor: Optional[Callable],
     stream_data_source_function: Optional[Callable],
 ) -> spark_schema_pb2.SparkSchema:
     if ds_args.HasField("kinesis_ds_config"):
         return get_kinesis_schema(spark, ds_args.kinesis_ds_config.stream_name, stream_post_processor)
     elif ds_args.HasField("kafka_ds_config"):
```

### Comparing `tecton-0.9.2/tecton_spark/schema_spark_utils.py` & `tecton-0.9.3/tecton_spark/schema_spark_utils.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_spark/spark_helper.py` & `tecton-0.9.3/tecton_spark/spark_helper.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_spark/spark_schema_wrapper.py` & `tecton-0.9.3/tecton_spark/spark_schema_wrapper.py`

 * *Files identical despite different names*

### Comparing `tecton-0.9.2/tecton_spark/time_utils.py` & `tecton-0.9.3/tecton_spark/time_utils.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,20 +1,20 @@
 import datetime
 from typing import Union
 
 import pendulum
 import pytimeparse
-from pyspark.sql import Column
 from pyspark.sql import functions
 from pyspark.sql.functions import expr
 
 from tecton_core.errors import TectonValidationError
 from tecton_core.time_utils import nanos_to_seconds
 from tecton_core.time_utils import strict_pytimeparse
 from tecton_proto.data.feature_store_pb2 import FeatureStoreFormatVersion
+from tecton_spark.type_annotations import PySparkColumn
 
 
 WINDOW_UNBOUNDED_PRECEDING = "unbounded_preceding"
 
 
 def assert_valid_time_string(time_str: str, allow_unbounded: bool = False) -> None:
     if allow_unbounded:
@@ -22,49 +22,51 @@
             msg = f"Time string {time_str} must either be `tecton.WINDOW_UNBOUNDED_PRECEDING` or a valid time string."
             raise TectonValidationError(msg)
     else:
         strict_pytimeparse(time_str)
 
 
 def subtract_seconds_from_timestamp(
-    timestamp: Union[Column, datetime.datetime], delta_seconds: int
-) -> Union[Column, datetime.datetime]:
+    timestamp: Union[PySparkColumn, datetime.datetime], delta_seconds: int
+) -> Union[PySparkColumn, datetime.datetime]:
     """
     Subtract seconds from timestamp
     Timestamp can be in Column[Timestamp] or just Timestamp
     :param timestamp: seconds
     :param delta_seconds: seconds
     :return:
     """
     td = datetime.timedelta(seconds=delta_seconds)
-    if isinstance(timestamp, Column):
+    if isinstance(timestamp, PySparkColumn):
         return timestamp - expr(f"INTERVAL {td.days} DAYS") - expr(f"INTERVAL {td.seconds} SECONDS")
     else:
         return timestamp - td
 
 
 def add_seconds_to_timestamp(
-    timestamp: Union[Column, datetime.datetime], delta_seconds: int
-) -> Union[Column, datetime.datetime]:
+    timestamp: Union[PySparkColumn, datetime.datetime], delta_seconds: int
+) -> Union[PySparkColumn, datetime.datetime]:
     """
     Add seconds to timestamp
     Timestamp can be in Column[Timestamp] or just Timestamp
     :param timestamp:  seconds
     :param delta_seconds: seconds
     :return:
     """
-    if isinstance(timestamp, Column):
+    if isinstance(timestamp, PySparkColumn):
         td = datetime.timedelta(seconds=delta_seconds)
         return timestamp + expr(f"INTERVAL {td.days} DAYS") + expr(f"INTERVAL {td.seconds} SECONDS")
     else:
         td = datetime.timedelta(seconds=delta_seconds)
         return timestamp + td
 
 
-def convert_timestamp_to_epoch(timestamp: Union[Column, datetime.datetime], version: int) -> Union[Column, int]:
+def convert_timestamp_to_epoch(
+    timestamp: Union[PySparkColumn, datetime.datetime], version: int
+) -> Union[PySparkColumn, int]:
     """
     Convert timestamp to epoch
     Timestamp can be in Column[Timestamp] or just Timestamp
     V0 Return Epoch in seconds
     V1 Return Epoch in nanoseconds
     :param timestamp: Datetime / Datetime column
     :param version: Feature Store Format Version
@@ -72,62 +74,64 @@
     """
     if version == FeatureStoreFormatVersion.FEATURE_STORE_FORMAT_VERSION_DEFAULT:
         return get_timestamp_in_seconds(timestamp)
     else:
         return get_timestamp_in_nanos(timestamp)
 
 
-def convert_epoch_to_datetime(epoch: Union[Column, int], version: int) -> Union[Column, pendulum.datetime]:
+def convert_epoch_to_datetime(
+    epoch: Union[PySparkColumn, int], version: int
+) -> Union[PySparkColumn, pendulum.datetime]:
     """
     Convert epoch to datetime
     V0 epoch is in seconds
     V1 epoch is in nanoseconds -> convert to seconds
     :param epoch: Epoch based on version
     :param version: Feature Store Format Version
     :return:
     """
-    if isinstance(epoch, Column):
+    if isinstance(epoch, PySparkColumn):
         return convert_epoch_to_timestamp_column(epoch, version)
     else:
         epoch_float = float(epoch)
         if version >= FeatureStoreFormatVersion.FEATURE_STORE_FORMAT_VERSION_TIME_NANOSECONDS:
             epoch_float = nanos_to_seconds(epoch)
         return pendulum.from_timestamp(epoch_float)
 
 
-def get_timestamp_in_seconds(timestamp: Union[Column, datetime.datetime]) -> Union[Column, int]:
+def get_timestamp_in_seconds(timestamp: Union[PySparkColumn, datetime.datetime]) -> Union[PySparkColumn, int]:
     """
     Converts a given timestamp to epoch total seconds
     Timestamp can be in Column[Timestamp] or just Timestamp
     If its a column we need to use a UDF.
     :param timestamp: Datetime / Datetime column
     :return: Timestamp / Timestamp column
     """
-    if isinstance(timestamp, Column):
+    if isinstance(timestamp, PySparkColumn):
         return timestamp.cast("int")
     else:
         return int(timestamp.timestamp())
 
 
-def get_timestamp_in_nanos(timestamp: Union[Column, datetime.datetime]) -> Union[Column, int]:
+def get_timestamp_in_nanos(timestamp: Union[PySparkColumn, datetime.datetime]) -> Union[PySparkColumn, int]:
     """
     Converts a given timestamp to epoch total nano seconds
     Timestamp could be a column of timestamp type or
     an actual timestamp. If its a column we need to use
     a UDF.
     :param timestamp: Datetime / Datetime column
     :return: Timestamp / Timestamp column
     """
-    if isinstance(timestamp, Column):
+    if isinstance(timestamp, PySparkColumn):
         return ((timestamp.cast("double") * 1e6).cast("long")) * 1000
     else:
         return (int(timestamp.timestamp() * 1e6)) * 1000
 
 
-def convert_epoch_to_timestamp_column(epoch: Column, version: int) -> Column:
+def convert_epoch_to_timestamp_column(epoch: PySparkColumn, version: int) -> PySparkColumn:
     """
     Converts an epoch column to a timestamp column
     :param epoch: Epoch Column [V0 : Seconds, V1 : Nanoseconds]
     :param version: Feature Store Format Version
     :return:
     """
     if version == FeatureStoreFormatVersion.FEATURE_STORE_FORMAT_VERSION_DEFAULT:
```

### Comparing `tecton-0.9.2/tecton_spark/udfs.py` & `tecton-0.9.3/tecton_spark/udfs.py`

 * *Files identical despite different names*

